2016-08-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Allow to concat dialog methods by
	returning this.

2016-08-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Extract an OMPDialogAction from OMPAction.

2016-08-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Introduce a gsa.derive function to
	simplify creating class inheritance.

2016-08-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Create a common base class for all
	dialogs.

2016-08-02  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (get_trash): Add missing xmlns so contents
	are shown again.

2016-08-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (report summary): Remove the id from the report
	summary. It is now placed within the section header info in all report pages.

2016-08-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (report-section-toolbar, report-section-header):
	Move the progress bar from the section header into the section toolbar of a
	report.

	* src/html/classic/css/gsa-style.css: Update styling of report progress bar
	now it is in the toolbar.

2016-08-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (report-section-header): Add section header info to
	report pages.

2016-08-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsli (ovaldef-details): Remove duplicate name row from
	ovaldef details page.

2016-08-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Remove duplicate names from all secinfo pages.

2016-08-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (report-icons, section-link): Move the link to the
	list of corresponding results of a report as an icon to the toolbar.

2016-08-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Fix displaying the names in all secinfo section
	headers.

2016-08-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPAction): Simplify FormData handling.

2016-08-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/help.xsl (mode="help" match="powerfilter.html"):
	Added a section for resource-specfic keywords.
	(mode="help" match="powerfilter.html", mode="help" match="notes.html",
	mode="help" match="overrides.html"):
	Removed the specific keywords from here.

2016-08-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Remove the requirement of the css class
	last for report_section_list. Use last-child selector instead.

2016-08-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (report section-list): Remove list item for the
	task. The task can now be reached via an icon in the toolbar.

2016-08-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (report apps): Fix report of applications by using
	the correct path to the report id and not an undefined variable.

2016-08-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (report-icons): Add icon to the corresponding taks
	to the report pages toolbars.

2016-08-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (result-details): Add icons for links to the
	corresponding report and task to the result details page. Remove the original
	link and icon.

2016-08-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (host-details): Use heading level of 3 for host
	identifier section.

2016-08-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Remove details section header from all report
	result pages.

2016-08-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (credential details): Add list of scanners using
	the credential to the credential details page.

2016-08-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (host-details): Allow to fold identifiers in host
	details page.

2016-08-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/help.xsl (new_credential.html): Fix link to installer
	details.

2016-08-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/wizard.xsl (quick-first-scan-wizard, quick-task-wizard):
	Allow 2000 characters for host in quick task wizards.

2016-07-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_base.c (gsad_message): Allow sending message without a
	function name.  Add envelope if credentials are given.

	* src/gsad.c (FILE_NOT_FOUND): Remove.
	(NOT_FOUND_TITLE, NOT_FOUND_MESSAGE): New constants.
	(file_content_response): Use a common "not found" message generated
	with gsad_message instead of using fixed HTML.
	(handle_request): Return common "not found" message generated with
	gsad_message if URL starts with "//", if help a template was
	not found or if a file was not found.

	* src/html/classic/gsad.xsl (error_dialog): Hide menu header and
	and duplicate footer if token is missing.  Add option to go to
	login page if the suggested URL starts with "/login".

2016-07-27  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone-ui.js (greenbone.spinner): Only check spinner
	value when the input fileds lost the focus. This avoids resetting the field to
	the previous value if the field has been emptied.

2016-07-26  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_topology_chart.js
	(TopologyChartGenerator.prototype.generate): Remove click listener
	generating test output.

2016-07-26  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_topology_chart.js
	(TopologyChartGenerator.prototype.generate): Adjust position of node
	labels for hosts with is_scanner property and add 1px extra distance.

	* src/html/classic/js/gsa_chart_helpers.js (extract_host_topology_data):
	Change way is_scanner property is set so it also works for traceroutes
	that consist of only one host.

2016-07-26  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_chart_helpers.js (extract_host_topology_data):
	Add is_scanner property to hosts which is set to true for ones that
	are first in traceroutes.

	* src/html/classic/js/gsa_topology_chart.js
	(TopologyChartGenerator.prototype.generate): Mark hosts with the
	is_scanner property with a green border and by making them larger.

2016-07-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_chart_helpers.js
	(gsa.detached_chart_resize_listener): Fix resizing of detached charts.

2016-07-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (Dashboard.prototype.resize): Allow to
	change the height of the rows when calling dashboard resize.

2016-07-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (Dashboard.prototype.getNumRows): Add
	Dashboard method to return the current number of rows.

2016-07-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (host-details): Add a show results for host link to
	the host details page.

2016-07-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* CMakeLists.txt, src/html/classic/gsad.xsl (html-gsa-logo),
	src/html/classic/css/gsa-style.css, src/html/classic/img/gsa.svg: Use svg
	version of gsa logo instead of rastered png.

2016-07-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/wizard.xsl: Move dashboard actions above the horizontal
	line into the section header.

2016-07-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Remove cellspacing and cellpadding attributes from
	most tables. Both attributes are deprecated and got replaces by corresponsing
	css styles in the gbntable classes.

2016-07-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (list-window),
	src/html/classic/js/greenbone.js,
	src/html/classic/wizard.xsl (wizard-icon): Avoid opening of dialogs several
	times. Set a data-dialog-id attribute to identifiy a dialog. If this dialog-id
	is set it will first be checked if the dialog is already open when a user
	clicks on the corresponding button.

2016-07-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/help.xsl (new_alert.html): Add short info about the
	credentials and the "Known Hosts" field.

2016-07-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (host-details): Refactor host detail identifiers
	table to use fixed layout. This allows to cut of long values in the table.
	Also it uses now a table head, body and footer for better sematic layout.

2016-07-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Don't require to set odd and even
	classes for gbntables.

2016-07-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Also mark table headers with black
	background if gbntablehead2 class is set.

2016-07-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Add table-fixed css class to allow
	defining width of table cols. Also hide long text in table-fixed cells.

2016-07-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Add css styles for gbntable to replace
	deprecated cellspacing and cellpadding table attributes.

2016-07-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add page for detached assets chart.

	* src/gsad_omp.c (generate_page): Add case for get_assets_chart.
	(get_assets_chart, get_assets_chart_omp): New functions.

	* src/gsad_omp.h (get_assets_chart_omp): New function prototype.

	* src/gsad.c (init_validator, exec_omp_get, handle_request): Add
	cases for get_assets_chart command.

	* src/html/classic/gsad.xsl (envelope): Do not add header and footer
	elements for get_assets_chart.

	* src/html/classic/omp.xsl (get_assets_chart): New template.

2016-07-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Update coding style.

2016-07-22  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (send_settings_filters, save_my_settings_omp): Wrap
	modify_setting responses in "save_setting" elements that contain the
	name or id of the setting.

	* src/html/classic/js/greenbone.js (RESPONSE_SELECTORS): Add case for
	edit_my_settings.
	(OMPDialog.prototype.error): Add status_code parameter.
	(OMPDialog.prototype.setErrorFromResponse): Only select OMP responses
	without an "OK" status code.  Add name of setting to modify to message
	title where applicable.  Add status code as parameter to error function
	instead of appending it to the message here.

2016-07-22  Timo Pollmeier <timo.pollmeier@greenbone.net>

	(handle_request): Search template for help page in the XSL files
	and set HTTP status to 404 if it's not found.

2016-07-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad_omp.c (get_report): Remove reports with level g from report
	results.

	* src/html/classic/omp.xsl (report): Don't show report results with level g
	when selecting report results of applications.

2016-07-20  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (report): Remove Details section from report
	results.

2016-07-20  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (report): Improve message if no results could be
	found in a report.

2016-07-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-create-permission-form): Select the command
	that follows "Super" by default, to make the form simpler initially.

2016-07-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_topology_chart.js
	(TopologyChartGenerator.prototype.generate): Make the nodes link to
	the host details pages if a uuid is available.

2016-07-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator, params_append_mhd, params_mhd_add): Add
	hashtable param "include_id_list".

	* src/gsad_omp.c (save_report_format_omp): Check new include_id_list
	params which id list params should be sent and send empty lists if no
	id_list params are given.

	* src/html/classic/omp.xsl (param-edit): Adjust to new subelements of
	value elements and add hidden include_id_list input to allow setting
	empty lists.
	(param-details): If available, show links labeled with the name in
	report format lists.

2016-07-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-permission-form): Only show Resource
	Type if Permission field is set to super.

2016-07-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-permission-form): Change
	html-edit-persmission-form into an edit dialog and use new horizontal form
	class styling.

2016-07-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-permission-form): Only show Resource
	Type if Permission field is set to super.

2016-07-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-permission-form): Change
	html-create-permission-form into an edit dialog and use new horizontal form
	class styling.

2016-07-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (nvt [edit], nvt [details]): Adjust for nvt
	summary removal.

2016-07-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator, params_append_mhd, params_mhd_add): Add
	array param "id_list".

	* src/gsad_omp.c (edit_report_format): Additionally get list of
	all report formats.
	(save_report_format_omp): Add special handling for modifying id list
	report format parameters.

	* src/html/classic/omp.xsl (param-edit): Add case to show a report
	format selection list for parameters of type report_format_list.

2016-07-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/ldap.svg,
	src/html/classic/img/radius.svg: Replaced placeholder by
	actual images.

2016-07-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Do not redirect after POST requests returning errors and show an
	error message dialog instead.

	* src/gsad_omp.c (next_page_url): Use value of next_xml param for
	xml param in returned url.
	(response_from_entity): Do not redirect on errors.

	* src/gsad.c (init_validator): Add next_xml parameter.

	* src/html/classic/omp.xsl (trashcan-icon, user-tags-window-checked)
	(toggle-tag-icon, details-header-icons, html-config-table)
	(note-detailed, override-detailed, report-icons, report [summary]):
	Add ajax-post class to submit icons for sending POST requests.

	* src/html/classic/js/greenbone.js (InfoDialog): Add options for
	changing the fade duration and making the dialog modal.
	(on_ready): Modify submit icons with "ajax-post" class to submit forms
	via a AJAX request that will show a dialog on errors.

2016-07-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/graphics.xsl (dashboard): Add hosts topology chart to the
	middle of the second row at the main dashboard.

2016-07-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (asset [host-details]): Add route info.

2016-07-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (get_feeds, html-feed-row): Remove actions column
	from feed status table.

2016-07-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/gsad.xsl (html-gsa-navigation): Move feed menu from
	Administration to Extras and rename it to "Feed Status".

2016-07-05  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (auth_settings): Update auth_settings template to
	look like a standard page. Also add a message text if radius or ldap is not
	available.

2016-07-05  Björn Ricks <bjoern.ricks@greenbone.net>

	* CMakeLists.txt, src/html/classic/img/ldap.svg,
	src/html/classic/img/radius.svg: Install placeholder icons for radius and ldap
	authentication.

2016-07-05  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (get_users): Remove authentication settings from
	users page.

2016-07-05  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/gsad.xsl (html-gsa-navigation): Add menu entries for ldap
	and radius authentication settings.

2016-07-05  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (auth_settings): Add new template to handle
	auth_settings elements.

2016-07-05  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad.c (exec_omp_get): Call auth_settings_omp function when omp is
	called with a http get method and cmd parameter is auth_settings.

2016-07-05  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad_omp.c, src/gsad_omp.h: Add new omp command auth_settings. This will
	allow to handle the auth settings on an own page in future.

2016-07-05  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad.c (handle_request): Return MHD_HTTP_METHOD_NOT_ALLOWED if the an
	other method as get or post is used in the request.

2016-07-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad_omp.c (next_page_url): Add get_name parameter for wizard_get
	responses. This fixes the redirect url in post responses within the its
	interface.

2016-07-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/its/omp.xsl: Fix: Change closing tag from anchor to div.

2016-07-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/its/omp.xsl: Change form to be invisible. These forms are only used
	for special operations of buttons.

2016-07-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/its/omp.xsl: Use menu-buttons for all buttons in the its face. It
	would be better to unify all button css and usage but currently this should
	only fix the its face.

2016-07-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/its/omp.xsl: Improve tooltips by moving the tooltips outside of the
	anchors.

2016-07-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/its/gsad.xsl, src/html/its/omp.xsl: Remove inline style
	definitions.

2016-07-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/its/gsad.xsl (html-its-header): Use column based layout instead of
	table based.

2016-07-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/its/css/gsa-style.css: Update coding stlye.

2016-07-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/its/CMakeLists.txt, src/html/its/gsad.xsl,
	src/html/its/gsa-base.css: Add base css from the classic interface for the
	column based layout.

2016-07-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/its/CMakeLists.txt, src/html/its/gsad.xsl,
	src/html/its/gsa-style.css: Move css file to css subdir. All files in the
	"root" directory require token as parameter in the http request. Files in js,
	css and img subdirs not.

2016-07-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (dashboard): Add a dummy get_info OMP request to
	test if SCAP and CERT databases are available. Free entity at the end.

	* src/html/classic/graphics.xsl (dashboard): Add warning message if
	SCAP or CERT database is missing.

2016-07-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_chart_helpers.js (csv_from_records): Skip
	data formatting if no column_info is defined.
	(html_table_from_records): Fix documentation and skip data formatting
	if no column_info is defined.

	* src/html/classic/js/gsa_topology_chart.js
	(TopologyChartGenerator.prototype.generateCsvData)
	(TopologyChartGenerator.prototype.generateHtmlTableData): Add actual
	generation of CSV and HTML tables.

2016-07-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Move dashboard controls into the
	list window header. This will display the dashboard control icons above the
	section line.

	* src/html/classic/css/gsa-style.css: Add styles to display the dashboard
	control icons on top of the section.

2016-07-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_chart_helpers.js (severity_colors_gradient):
	Change colors so the severity classes High, Medium and Low are more
	distinguishable.

2016-07-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Remove details section header for a
	list pages.

2016-07-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Use left margin for dashboard action
	icon buttons.

2016-07-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (Dashboard.prototype.init): Put
	dashboard action icons into an own container element. Reorder action buttons
	and change some icons.

	* src/html/classic/css/gsa-style.css: Add right margin for dashboard action
	icon buttons.

2016-07-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (handle_request): Check if the name of a requested help
	page is a valid XML element name so invalid ones do not cause XSLT
	errors.

2016-07-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsad.xsl (gsa-navigation-menu): Use custom URLs and
	filters also in the top button.

2016-07-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (Dashboard.prototype.init): Ensure
	default_heights_string is always a string.

2016-07-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (Dashboard.prototype.resetEdit): Don't
	stop editing and also don't save changes when reset button has been clicked.
	This will allow to cancel the resetting.

2016-07-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js
	(Dashboard.prototype.updateDisplaysFromDefaultStrings): Don't set
	filters_string, controllers_string and heights_string properties when updating
	the displays from default strings. Instead call the new internal
	_updateDisplaysFromStrings methods. This allows resetting the dashboard to the
	latest set strings.

2016-07-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js
	(Dashboard.prototype.updateDisplaysFromStrings): Extract the update process
	into a "private" method that allows to pass the actual strings as arguments.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (Dashboard): Rename
	updateDisplaysFromString to updateDisplaysFromStrings.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (Dashboard): Add button to dashboard in
	edit mode to reset the dashboard to the defaults.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (Dashboard.prototype.resetEdit): Add
	method to reset the dashboard to the defaults and stop editing.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js
	(Dashboard.prototype.updateDisplaysFromDefaultStrings): Add method to update
	the rows and displays of a dashboard form the default controllers, filters and
	heights strings.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (Dashboard.prototype.save): Allow to
	force saving of a dashboard.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (Dashboard.prototype.init, on_ready):
	Pass default filters, controllers and heights to the dashboard.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay): Store header as
	jquery element.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay.prototype.showError):
	Hide loading element if error occured during loading a chart.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay.prototype.showError):
	Add missing showError method to DashboardDisplay.

2016-06-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-notes-top-visualization)
	(js-overrides-top-visualization, dashboard [main], dashboard [scans])
	(dashboard [assets]): Use more sensible charts when adding new ones
	to a dashboard.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (Dashboard.prototype.registerRow):
	Check if add new display button can be shown when a display is removed.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardRow.prototype.init): Don't
	add height attribute to dashboard row element when creating it. The height is
	set per css call afterwards already.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay.prototype.resize):
	Add some comments about height and width calculation in DashboardDisplay
	resize method.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay.prototype.resize):
	Fix setting the height of a Display in resize method.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardRow.prototype.resize): Fix
	resizing of a DashboardRow by setting its element css width and height in
	resize method.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js (Dashboard.prototype.cancelEdit):
	Reset changed markers if dashboard editing is canceled.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js (Dashboard): Use new _allUnchanged
	method in constructor of Dashboard.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js (Dashboard.prototype._allUnchanged):
	Add new method to reset all changed markers to unchanged.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js
	(Dashboard.prototype.initDisplaysFromString): Fix splitting the correct
	heights string variable.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js (Dashboard): Fix typo in docstring of
	Dashboard constructor parameter heights_string.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js (on_ready): Pass dashboard controls as
	id string to Dashboard constructor. It is passed to jquery anyway. Therefore
	there is no need to get the element already in on_ready.

2016-06-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-assets-top-visualization)
	(dashboard [assets]): Add topology chart to the default selections.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js
	(DashboardRow.prototype.getHeight): Fix getting the height of a row.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js
	(Dashboard.prototype.updateDisplaysFromString): Fix typo to get the correct
	heights string list.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js
	(Dashboard.prototype.updateHeightsString): Fix resetting the heights_string.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js (Dashboard.prototype.cancelEdit): Use
	updateDisplaysFromString to discard changed when editing of the dashbaord has
	been canceled.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js (DashboardDisplay.prototype.update):
	Add docstring for DashboardDisplay.prototype.update.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js
	(Dashboard.prototype.updateDisplaysFromString): Add new method to rebuild the
	dashboard, its rows and displays from controllers, filters and heights
	strings.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js (DashboardRow.prototype.update): Add a
	new method to update a row from new controllers, filters and heights strings.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js (DashboardDisplay.prototype.update):
	Add method to update a display from a new controller and filter string.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js
	(DashboardDisplay.prototype._createFilterSelector): Update docstring.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js
	(DashboardDisplay.prototype._selectFilter): Set filter_string when calling
	selectFilter.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js
	(DashboardDisplay.prototype._updateCurrentController): Add new "private"
	method to update the current controller from the controller string in
	DashboardDisplay.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js (DashboardDisplay): Use new
	_updateFilterSelection method in DashboardDisplay to reduce duplicate code.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js (DashboardDisplay): Use new
	_updateCurrentFilter method in DashboardDisplay constructor function.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js
	(DashboardDisplay.prototype._updateCurrentFilter): Add "private" method to
	update the current filter of a display from the filter string.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js
	(DashboardDisplay.prototype._updateFilterSelection): Add "private" method to
	update the filter selection element value without triggering a filter change
	event.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js (DashboardRow): Use new
	_updateControllersStringList and _updateFiltersStringList methods in
	DashboardRow constructor function.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js (DashboardRow): Add new "private"
	method to update the filters and controllers string list in a DashboardRow.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js (DashboardRow): Use new method
	forEachDisplayOrdered in dashboard row.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js (DashboardRow.prototype.init): Use
	Array.prototype.forEach to iterate over the controller string list instead of
	for loop.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js
	(Dashboard.prototype.initDisplaysFromString): Not necessary to check for
	undefined filter string. Accessing an array with an invalid index will always
	return undefined.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js (Dashboard): Use new forEachRowOrdered
	to reduce duplicate code.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js
	(DashboardRow.prototype.forEachDisplayOrdered): Add new method to iterate over
	all displays in a dashboard row in the order of their occurence in the
	displayed html.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	*  src/html/classic/js/gsa_dashboard.js
	(Dashboard.prototype.forEachRowOrdered): Add new method to iterate over all
	rows in a dashboard in the order of their occurence in the displayed html.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js: Fix getting the bounding box of an
	svg element for firefox. Under some mysterious circumstances firefox raises an
	internal NS_NOT_IMPLEMENTED error when accessing getBBox on svg elements.

2016-06-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (Dashboard.prototype.startEdit,
	Dashboard.prototype.stopEdit): Fix acting on escape key for chrome. Chrome
	only triggers the keypress event for "normal" keys. Therefore use keydown
	event to abort editing the dashboard on escape being pressed.

2016-06-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-scan-management-top-visualization)
	(js-assets-top-visualization, js-secinfo-top-visualization)
	(js-notes-top-visualization, js-overrides-top-visualization)
	(dashboard [main], dashboard [scans], dashboard [assets])
	(dashboard [secinfo]): Rearrange data attributes and add ones for
	default controllers, filters and heights.

2016-06-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay.prototype.init): Fix
	loading the data initially be not calling redraw. redraw will already be
	called in resize now here because the inner_height is not set yet.

2016-06-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (Dashboard.prototype.startEdit): Add
	keypress event listener to cancel editing when escape is pressed.

2016-06-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (Dashboard.prototype.init): Save
	changes when clicking on the stop editing button in the dashboard.

2016-06-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (Dashboard.prototype.saveEdit): Add a
	method to Dashboard to save the changes (filters, controllers and heights
	strings) and stop the editing.

2016-06-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (Dashboard.prototype.startEdit): Show
	cancel edit button if editing is started.

2016-06-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (Dashboard.prototype.init): Add a
	cancel edit button the the dashboard.

2016-06-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js
	(Dashboard.prototype.cancelEdit): Add a method to Dashboard to cancel the
	editing mode.

2016-06-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay.prototype.stopEdit):
	Hide filter and controller elements when editing is stopped.

2016-06-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay.prototype.startEdit):
	Show filter and controller select elements when start editing.

2016-06-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay.prototype.resize):
	Save inner height of display as property and also call redraw if the inner
	height changed since the last resize.

2016-06-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay): Put filter and
	controller select elements into a div container and hide both containers if
	they should not be shown initially.

2016-06-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js
	(DashboardDisplay.prototype._showFilterSelect): Return true if filter element
	should be shown and the display is in edit mode.

2016-06-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay): Only consider
	controller select element for display heigth calculation when in edit mode.

2016-06-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay): Add
	_showControllerSelect method to DashboardDisplay.

2016-06-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay): Only allow to
	change filter and controller of display when in edit mode.

2016-06-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay): Always create
	filter and controller selection elements.

2016-06-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (Dashboard): Add methods to check
	wether filters, controllers or heights in a dashboard have changed. Only save
	parts that have actually changed.

2016-06-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (Dashboard): Refactor save to save
	heights, filters and controllers. Add saveFilters and saveControllers methods.

2016-06-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_topology_chart.js
	(TopologyChartGenerator.prototype.generate): Move the layout size
	outside the update_layout function. Start the layout and run it for
	several ticks only on update and resume it otherwise.

2016-06-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_topology_chart.js
	(TopologyChartGenerator.prototype.generate): Create new layout on
	update.

2016-06-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_chart_helpers.js (clone_svg): New function.
	(svg_from_elem): Use clone_svg function and add doc for return value.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay): Use filter.type ===
	null for empty filter selection when creating a DashboardDisplay instead of
	checking for id.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js
	(DashboardDisplay.prototype._createFilterSelector): Select current filter on
	filter selector creation.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_chart_helpers.js (gch.extract_host_topology_data):
	Fix adding new host for target ip.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_chart_helpers.js (gch.extract_host_topology_data):
	Update coding style to satisfy jscs.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js: Coding style improvement.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js
	(ChartController.prototype.getDetachedUrl): Remove obsolete TODOs.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	Refactor DataSource request handling

	* src/html/classic/js/gsa_dashboard.js: Merge sendRequest and addRequest
	methods of DataSource because sendRequst actually didn't send a request in
	many cases. It only adds a request for data to a queue. Add a removeRequest
	method to ChartController that forward calls DataSource removeRequest. Move
	aborting a request from DataSource checkRequests to removeRequest.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Fix copy and paste mistake and
	assign function to the correct prototype.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DataSource.prototype._extractData):
	Remove now obsolete method _extractData from DataSource. Extracting the data
	info is now done in the generators.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js: Rework DataSource checkRequests
	methods to store only the xml data. Move extracting the data info into the
	controller and generators.

2016-06-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (assets-dashboard-data): Fix attribute
	data-aggregate-type and remove unused filter attributes for the
	Hosts Topology chart.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Add extractData methods to base
	chart generators. These methods will convert the xml data into data that will
	be understand by generateData methods.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_topology_chart.js: Derive TopologyChartGenerator
	from AssetChartGenerator and remove obsolete function generateData.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Add new AssetChartGenerator.

2016-06-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (get_title_generator): Correct
	order of title_static parameters in case for type "host".

2016-06-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* CMakeLists.txt: Install src/html/classic/js/gsa_topology_chart.js.

	* src/gsad_omp.c (get_assets): Add ignore_pagination parameter.

	* src/html/classic/graphics.xsl (init-d3charts): Also load the file
	gsa_topology_chart.js.
	(js-assets-top-visualization, assets-dashboard-data): Add new chart
	"Hosts Topology".

	* src/html/classic/js/gsa_chart_helpers.js (extract_host_topology_data):
	New function.

	* src/html/classic/js/gsa_dashboard.js (DataSource.prototype.init)
	(DataSource.prototype.checkRequests, DataSource.prototype._extractData)
	(get_selector_label, get_title_generator): Handle new type "host" and
	command "get_assets".

	* src/html/classic/js/gsa_topology_chart.js: New JavaScript for
	topology charts.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (ChartController.prototype.dataLoaded):
	Check if the generator supports the command of the datasource.

	* src/html/classic/js/gsa_bar_chart.js,
	src/html/classic/js/gsa_bubble_chart.js,
	src/html/classic/js/gsa_cloud_chart.js,
	src/html/classic/js/gsa_donut_chart.js,
	src/html/classic/js/gsa_gantt_chart.js,
	src/html/classic/js/gsa_h_bar_chart.js,
	src/html/classic/js/gsa_line_chart.js: Update to new generator api. Remove
	generateData method where it doesn't differ from BaseChartGenerator. Derive
	chart generators from AggregateChartGenerator or TaskChartGenerator.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js
	(BaseChartGenerator.prototype.supportsCommand): Add method that checks if a
	command is supported by a chart generator.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js
	(BaseChartGenerator.prototype.generateData): Add a default implementation for
	generateData method. This method is mostly the same for all chart generators.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Add AggregateChartGenerator and
	TaskChartGenerator base classes for charts.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js: Fix setting log.error and log.warn
	functions.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay): Put empty filter in
	the list of all filters if no filter is passed to the DashboardDisplay.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (create_uri): Fix handling of filters
	when creating an uri. If a filter is passed to create_uri it is only applied
	if it has a valid id. This fixes the drill down of the charts.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js: Change meaning of empty/no filter to
	filter.type === null. Now a filter with type === null should be handled if it
	is empty and not set at all.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DataSource): Add missing outputError
	method to DataSource.

	* src/html/classic/js/gsa_chart_helpers.js (gch.output_error): Remove
	output_error function. The functionality is only used in DataSource. Therefore
	this function belongs the this class.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js
	(BaseChartGenerator.prototype.addSvgMenuItems): Fix getting the title of a
	display.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay.prototype.getTitle):
	Remove unnecessary parameter new_title from getTitle method of
	DashboardDisplay.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js
	(ChartController.prototype.getDetachedUrl): Fix creating the detached url by
	using the correct function name to get the current filter.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js
	(ChartController.prototype.getDetachedUrl),
	src/html/classic/js/gsa_graphics_base.js
	(BaseChartGenerator.prototype.addDetachedChartMenuItem): Rename detachedURL
	function to getDetachedUrl to have a consistent naming.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay.prototype.resize):
	Fix calculating the height of the DashboardDisplay when no filter selection
	element is shown.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay): Add a "internal"
	_showFilterSelect method to DashboardDisplay.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay): Add a
	getCurrentFilter method to DashboardDisplay.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js (DashboardDisplay): Distinguish between
	all available filters and filters corresponding the the current chart
	controller. With this change the filters array property of DashboardDisplay
	only contains the appropriate filters for the current controller. If the
	current controller is changed the filters array will be updated.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js
	(DashboardDisplay.prototype._selectFilter): Allow to select the empty filter
	(filter.term === '') by not passing an index argument to _selectFilter.

2016-06-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_dashboard.js
	(DashboardDisplay.prototype._rebuildFilterSelection): Rename
	rebuildFilterSelection to _rebuildFilterSelection to mark the function as an
	"internal" method of DashboardDisplay. Use also Array.prototype.forEach
	instead of for loop and put all filters from the filters array into the
	selection. The filters array property of DashboardDisplay should only contain
	usable filters for the current controller in future.

2016-06-27  Björn Ricks <bjoern.ricks@greenbone.net>

	Refactoring of the dashboard chart code.
	- Use prototype based classes
	- Use consistent names (e.g. Display instead of component)
	- Remove a lot of inter depenendencies
	- Use events for communication between objects
	- Remove a lot of unused and obsolete code paths
	- ...

	* CMakeLists.txt: Install new JS files gsa_chart_helpers.js and
	gsa_dashboard.js.

	* src/html/classic/graphics.xsl: Include new js files in html code for
	charts.

	* src/html/classic/css/gsa-style.css: Update CSS classes for component to
	display renaming.

	* src/html/classic/js/gsa_bar_chart.js,
	src/html/classic/js/gsa_bubble_chart.js,
	src/html/classic/js/gsa_cloud_chart.js,
	src/html/classic/js/gsa_donut_chart.js,
	src/html/classic/js/gsa_gantt_chart.js,
	src/html/classic/js/gsa_h_bar_chart.js,
	src/html/classic/js/gsa_line_chart.js: Update chart generator classes for api
	changes.

	* src/html/classic/js/gsa_dashboard.js,
	src/html/classic/js/gsa_graphics_base.js,
	src/html/classic/js/gsa_chart_helpers.js: Split original gsa_graphics_base.js
	into three files. gsa_graphics_base.js only contains the BaseChartGenerator
	now. gsa_dashboard.js contains all dashboard related classes and helper
	functions and gsa_chart_helpers.js contains all general helper functions.

2016-06-27  Björn Ricks <bjoern.ricks@greenbone.net>

	Fix possible error in d3.tip

	* src/html/classic/js/lib/d3.tip.js: Be save when generating d3 tips be
	checking if the svg element is valid.

2016-06-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Add Default CA Cert setting.

	* src/gsad.c (init_validator): Add which_cert.

	* src/gsad_omp.c (save_scanner_omp): Add cases for new "use default"
	CA cert option.

	* src/html/classic/omp.xsl (html-edit-scanner-form): Add options for CA
	cert.
	(get_my_settings): Add "Default CA Cert".

2016-06-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (DEFAULT_GSAD_GUEST_CHART_X_FRAME_OPTIONS): Changed
	from empty string to "SAMEORIGIN" to disallow embedding
	of charts by default when guest mode is enabled. It can be configure
	back to off on the command line in combination with the guest mode.

2016-06-23  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-nvt-table): Remove superfluous ">"
	after SecInfo database warning.

2016-06-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt: Increase required cmake version from 2.6
	to 2.8 because 2.8 is the minimum version we are sure it
	works with.

	* INSTALL: Update accordingly.

2016-06-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt: Drop the handling regarding gthread library
	for glib versions prior 2.32 now that we have 2.32 as minimum.

	* src/gsad.c (gsad_init): Drop now unnecessary initialization
	of gthread.

2016-06-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt, INSTALL: Increase dependency for glib from 2.16 to
	2.32 in order to allow the use of newer API elements. Also,
	prior to 2.32 there is subject to the (disputed) CVE-2012-0039.

2016-06-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (AUTH_CONF_SETTING): New macro.
	(save_auth_omp): Move KEY and VALUE attributes to elements.

	* src/html/classic/omp.xsl (html-create-user-form, user [edit])
	(group [ldapauth], group [radiusauth]): Get KEY and VALUE from elements.

2016-06-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (group [ldapauth]): Add LDAP cert info.

2016-06-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt, INSTALL: Imcrease dependency for gnutls from 2.8 to
	3.2.15 in order to enforce the presence of newer (more secure)
	TLS and ciphers.

2016-06-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Increase version for the next official release from 6.1 to 7.0
	because the number of changes is more comprehensive than originally
	assumed.

	* CMakeLists.txt: Set version to 7.0+beta1.

2016-06-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_auth_omp): Pass CA cert to manager if given.

	* src/html/classic/omp.xsl (group [ldapauth]): Add CA Certificate field.

2016-06-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (group [ldapauth]): Clean up alignment.

2016-06-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt, INSTALL: Increase dependency for openvas-libraries
	from version from 8.0.0 to 9.0.0.

2016-06-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/css/gsa-base.css (.form-horizontal .control-label):
	Replace the larger line-height with a top margin.

2016-06-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add info about certificates to Credential and Scanner details pages,
	add certificate status and download to the Edit Scanner dialog and
	add missing certificate download buttons.

	* src/html/classic/omp.xsl (certificate-info-table, certificate-status):
	New templates.
	(credential [details]): Add download icons and certificate info.
	(html-edit-scanner-form): Add certificate download icons and status.
	(scanner [details]): Add client certificate download icon, client and
	CA certificate info.
	(scanner): Add client certificate download icon.
	(scanner-icons): Change unused "key_pub" parameter to "credential" and
	use it to show a download icon for the client certificate.

2016-06-16  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (filtered_list_url): Apply
	special rules to all columns where the name contains "severity".

2016-06-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_many): Build the levels filter keyword for
	results using the level_high, level_medium, etc. request parameters.

	* src/html/classic/omp.xsl (filter-window-part): Get the severity
	levels also from the "levels" keyword.
	(list-window): Add filter_options param for filter-window-part to
	always show apply_overrides and min_qod for results, reports and tasks;
	autofp and levels for results as well as first and rows for all types.

2016-06-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog.prototype.setContent):
	Do not submit on "enter" key press if a multi-line textarea is focused.

2016-06-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_report, new_note, new_override): Remove handling
	of min_cvss_base request param.

	* src/gsad.c (init_validator): Remove params min_cvss_base and
	apply_min_cvss_base.  Make default_severity a normal param.

	* src/html/classic/omp.xsl (filter-criteria, filter-extra)
	(filter-window-part, report [filterbox], report [section-filter-full])
	(report [apps]): Remove min_cvss_base filter keyword.

	* src/html/classic/js/gsa_graphics_base.js (extract_filter_info):
	Remove min_cvss_base filter keyword.

2016-06-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/help.xsl (new_alert.html): Add new placeholders
	$N, $u, $U for email subject and message.

2016-06-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Make the "Edit My Settings" dialog send OMP requests only for settings
	that changed and remove the various get_... OMP requests in the
	save_my_settings which should be done by edit_my_settings.

	* src/gsad_omp.c (send_settings_filters): Add param "changed" for
	checking which settings were changed.
	(save_my_settings_omp): Check "settings_changed:" request params to
	see which settings must be saved.  Do not get resources as
	edit_my_settings will do so.

	* src/gsad.c (init_validator, params_append_mhd, params_mhd_add): Add
	hashtable param "settings_changed".

	* src/html/classic/js/greenbone.js (on_ready): Add listeners and hidden
	"settings_changed:" inputs for elements with "setting-control" CSS
	class to check for changes in settings.

	* src/html/classic/omp.xsl (edit-settings-resource)
	(edit-settings-filters, severity-settings-list): Add CSS class
	"setting-control" and "data-setting" attribute to select elements.
	(timezone-opts): New template.  Add option elems for timezone-select.
	(timezone-select): Add param "for-settings" to add CSS class
	"setting-control" and "data-setting" attribute to select element.  Use
	the timezone-opts template to get the options.
	(edit_my_settings): Add CSS class "setting-control" and "data-setting"
	attribute to select elements.

2016-06-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (ref_xref_list): Mark urls from nvts as external.
	This will allow the user to open the links after clicking on follow link
	button in the opened warning dialog.

2016-06-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_ready): Add a handler for external
	links. Anchors (<a>) can now be marked as external links by setting the
	external class. In this case clicking at the link will open a dialog that
	shows a warning to the user.

2016-06-09  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-override-form): Use horizontal form
	for create override dialog.

2016-06-09  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-override-form): Change create override
	dialog into an edit dialog.

2016-06-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (init_input): Remove debug statement.

2016-06-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_ready): Fix initialization of checkbox
	and radio elements form form-selection-control and form-enable-control. For
	each element group (element group means elements with the same name attribute)
	the init function must only be called once.

2016-06-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad.c (handle_request): Improve debugging messages. Add full url with
	params in debug output. This helps a lot to find the actual current request.
	Add debug output if a token couldn't be found in the http params.

2016-06-07  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Always uri encode task name because the task name
	may contain problematic characters like #.

2016-06-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-part): Rename some labels in update
	filter dialog.

2016-06-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-part): Disable 'Full CVE match' and
	'Partial CVE match' radios if 'Trust vendorsecurity updates' is not set.

2016-06-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_ready): Allow usage of
	form-enable-control for checkbox checked values.

2016-06-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-note-form): Change create note dialog
	into an edit dialog and use form horizontal for the layout.

2016-06-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (task-icons): Add info if a schedule is only
	run once or a limited number of times to the schedule icon tooltip.

2016-06-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_many): Handle min_qod request parameter for
	tasks, reports and results.
	(get_report): Remove apply_min_qod requirement for min_qod filter
	keyword to be added.

	* src/gsad.c (init_validator): Remove apply_min_qod.

	* src/html/classic/omp.xsl (filter-window-part): Check autofp option
	"Full CVE match" if autofp in filter is not 2.  Remove checkbox to
	apply min_qod.
	(report [filterbox]): Remove checkbox to apply min_qod.
	(task [details], report, task, asset [host-detail]): Remove
	apply_min_qod parameter and unused min_qod parameter from report links.

2016-06-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (field_name_colors): Remove call of
	unavailable default_scale_1 function.

2016-06-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_uri): Fix checking if a
	filter has been provided to the create_uri function. The filter argument can
	also be null. Also update the coding style.

2016-06-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_chart_controller): Show
	loading when a data request is started. Hide the loading element if the data
	has been received.

2016-06-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_dashboard_component):
	Remove all svg elements before a chart is redrawn.

2016-06-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_dashboard_component): Add
	showLoading and hideLoading functions to dashboard component/display. This
	will show or hide a loading text in the dashboard.

2016-06-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Add styles for displaying a loading
	element in a dashboard.

2016-05-31  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (filter_exists): Handle special filt_id cases
	"0" and "-2" as existing.

2016-05-31  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_gantt_chart.js (generate): Remove bars of
	tasks no longer in the current filter.

2016-05-31  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_uri): Test if filter
	is defined with gsa.is_defined before checking its id and term.

2016-05-31  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_many): Do not use or overwrite last_filt_ids
	filter history if request parameter no_filter_history is true.

	* src/gsad.c (init_validator): Add request parameter no_filter_history.

	* src/html/classic/js/gsa_graphics_base.js (create_data_source):
	Add no_filter_history parameter for Task data sources.
	(create_uri): Add blank dummy filter if filter id and term are empty to
	prevent usage of the default from the user's settings.

2016-05-31  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog.prototype.postForm): Show
	overlay if a second dialog is opened automatically after a first dialog was
	successful.

2016-05-31  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (init_omp_dialog,
	OMPDialog.prototype.show): Add callback to allow to run code when an
	OMPDialog is opened.

2016-05-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/css/gsa-style.css (#list-window-filter *): New rule
	to make text in child elements of filter section left aligned.

2016-05-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsad.xsl (gsa-navigation-menu): New template.
	(html-gsa-navigation): Genenerate all the menus using the
	gsa-navigation-menu template.

2016-05-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Update coding style.

2016-05-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js (generate): Use correct enter
	selection when updating point markers.

2016-05-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Add special handling of new scan
	config button to open the edit button after the scan config has been
	created (cloned).

2016-05-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog, init_omp_dialog): Allow to open
	a new dialog after the first dialog has been closed successfully. Allow to
	reload the current window when a dialog is beeing closed.

2016-05-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad.c (main): Log gsad version when starting.

2016-05-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-config-form): Change create scan
	config into an edit dialog and use new horizontal form.

2016-05-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (verbose): Remove.  Now in main.
	(main): Note that --verbose has no effect.

	* INSTALL: Add section Logging Configuration.

2016-05-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/tracef.h: Remove.  No longer used.

2016-05-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Replace tracef with g_debug.  No real gain having these messages
	controlled by --verbose, when the log config does the same thing.

	This is also simpler, and removes the mix of tracef and g_debug that had
	crept in.

	* src/gsad_base.c, src/gsad_omp.c, src/validator.c: Replace tracef.

	* src/gsad.c: Replace tracef.
	(G_LOG_DOMAIN): Define for logging.

2016-05-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (main): Use convenience log function for consistency.

2016-05-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c: Add #include <time.h> and #include <sys/time.h>.
	(get_feeds_omp): Add the current UTC time to the response.

	* src/html/classic/gsad.xsl (html-gsa-navigation): Rename entry
	"Feed Management" to "Feed".

	* src/html/classic/help.xsl (contents.html, feed_management.html):
	Change title of "Feed Management" page to "Feed".

	* src/html/classic/omp.xsl (get_feeds): Change page title to "Feed".
	(html-feed-row): Replace param content_text with content_html which
	can contain markup.  Add feed description as tooltip of "Origin" text.
	Show the age of the feed in the status column if there is no other
	status message.
	(feed-get_info-link): New template.
	(describe_feed_response, describe_scap_response)
	(describe_cert_response): Change the feed content text so it includes
	icons and links to the corresponding get_info pages.

	* src/html/classic/css/gsa-style.css (.icon-m): New class style.

2016-05-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-scan-management-top-visualization):
	Replace duration_y parameter with y_format and y2_format.

	* src/html/classic/js/gsa_line_chart.js (init): Make left and right
	margins 5px wider.
	(generate): Allow setting a special "duration" format for the data on
	the y axes that shows durations in a more human-readable form.
	(evaluateParams): Add params y_format, y2_format.
	(duration_tick_format, duration_ticks): New functions.

2016-05-26  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-scan-management-top-visualization):
	Show both average and maximum durations in duration timeline.

	* src/html/classic/js/gsa_graphics_base.js (field_name_colors): Choose
	colors based on statistic if there is more than one y or y2 field.

2016-05-26  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-scan-management-top-visualization):
	Add new chart "Reports: Duration timeline".

2016-05-26  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-secinfo-top-visualization):
	Change the default chart controller selection for NVTs to
	"by-class|by-created|nvt-by-family".

2016-05-26  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (get_feeds): Display feeds in a table and
	remove link to help section about side effects.
	(html-feed-form): Remove. Replaced with html-feed-row.
	(html-feed-row): New template displaying feed data as a table row.
	(describe_feed_response, describe_scap_response)
	(describe_cert_response): Use new html-feed-row template and remove
	error message, which is now included in the status column of
	html-feed-row.

2016-05-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js
	(DonutChartGenerator.prototype.generate): Show tooltip on mouse position when
	no label text is available.

2016-05-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/lib/d3.tip.js (show): Allow to pass absolute coordinates
	for tooltip position to d3.tip.show function.

2016-05-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js
	(DonutChartGenerator.prototype.generate): Add some comment about the label
	rendering.

2016-05-25  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/dashboard.svg,
	src/html/classic/img/scan.svg: Updated appearance.

2016-05-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-create-credential-form): Show
	"Privacy Algorithm" selection for SNMP credentials.

2016-05-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Combine individual feed management pages into a single one and
	introduce more generic functions and templates for feed management
	to reduce redundancy.

	* src/gsad_omp.c (get_feeds_omp): New command handler function.
	(get_feed_omp, get_scap_omp, get_cert_omp): Remove. Combined into new
	function get_feeds_omp.
	(sync_feed): New function. Generic function for feed sync commands.
	(sync_feed_omp, sync_scap_omp, sync_cert_omp): Remove duplicate code
	by using new generic sync_feed function.

	* src/gsad_omp.h (get_feeds_omp): New function prototype.
	(get_feed_omp, get_scap_omp, get_cert_omp): Remove. Replaced by
	get_feeds_omp.

	* src/gsad.c (init_validator, exec_omp_get): Replace get_feed, get_scap
	and get_cert commands with get_feeds.

	* src/html/classic/help.xsl (contents.html): Combine the three Feed
	Management pages into one.
	(feed_management.html): Remove note about Administrator role and update
	so it applies to mulitple feeds now shown on the Feed Management page.
	(scap_management.html, cert_management): Remove.

	* src/html/classic/omp.xsl (get_feeds): New template for showing all
	feeds on a single page.
	(html-feed-form): Make the template a generic one for all feed types,
	also moving the toolbar, page title and link to side effects help to
	the the new get_feeds template.
	(describe_feed_response): Add params for new generic html-feed-form.
	(describe_scap_response): Use html-feed-form template.
	(html-scap-form): Remove. Replaced by generic html-feed-form.
	(describe_cert_response): Use html-feed-form template.
	(html-cert-form): Remove. Replaced by generic html-feed-form.

	* src/html/classic/gsad.xsl (html-gsa-navigation): Replace the
	menu items "NVT Feed", "SCAP Feed", "CERT Feed" with "Feed Management".

2016-05-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js
	(DonutChartGenerator.prototype.generate): Use gsa.is_defined to check for
	undefined.

2016-05-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js
	(DonutChartGenerator.prototype.generate): Put tooltip on top of the label. If
	the label has the class empty use the position of the current hovered element
	for the tooltip. Also resolve the label via the id now.

2016-05-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js
	(DonutChartGenerator.prototype.generate): Move generating tooltip label text
	elements back to the end of elements. SVG has a different rendering model as
	HTML. It is not possible to set a z index for element in SVG. Instead the z
	order depends on the sequence of elements in the DOM. Later elements in the
	DOM have a higher order an therefore cover previous elements. As a result the
	label texts have been cutted on some donut charts. Also add an id attr to the
	text elements and the css class empty if the label has no text.

2016-05-24  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-scan-management-top-visualization)
	(js-assets-top-visualization): Set new default controllers.
	(js-notes-top-visualization, js-overrides-top-visualization): Set new
	default controllers and column heights.  Remove unused filter settings.
	(dashboard [main], dashboard [scans], dashboard [assets]): Set new
	default controllers and filters.

2016-05-23  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (filter_resource_types): Add type "Asset".

2016-05-23  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsad.xsl (html-gsa-navigation): Add divider line
	after "Dashboard" menu entries.

2016-05-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js
	(BubbleChartGenerator.prototype.generate): Show tooltip always above the
	anchor text of a bubble.

2016-05-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js
	(DonutChartGenerator.prototype.generate): Show tooltip always above of the
	anchor text when hovering over a donut chart slice.

2016-05-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/lib/d3.tip.js (show): Add comment about the
	Array.prototype.slice usage and reset target if not passed as argument.

2016-05-23  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_h_bar_chart.js (generate): Fix removal of
	unused bars and move axis origin on updates to adapt to label changes.

2016-05-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js
	(DonutChartGenerator.prototype.generate): Move generating the slice label
	within generating the slice anchor. This allows to remove duplicate code and a
	better svg element structure.

2016-05-23  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (edit-settings-filters): Allow selecting
	filters without a type.
	(get_my_settings, edit_my_settings): Add "Assets Filter" setting.

2016-05-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-task-alert): Fix creating an alert in
	edit task wizard.

2016-05-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (new_task): Add create alert button after alert
	select box in new task dialog.

2016-05-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog.prototype.postForm): No need to
	destroy and re-create a select2. It should be enough to trigger a change event
	to reload the displayed items in the select2 box.

2016-05-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog.prototype.postForm): Be more
	save about the done element in a dialog. We must ensure that the done element
	really contains a valid element from the dom and is not just an empty jquery
	element wrapper.

2016-05-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Fix width of multiple select boxes.
	select2 adds a width to the style which is not the preferred width we need
	here. E.g. if the select box is empty the width is set to something like 10px.
	Because the width of the inner elements is bigger when using a multiple select
	the following element would be displayed under the text box. Setting the width
	to auto fixes this behaviour.

2016-05-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/gsad.xsl (html-gsa-logo): Rename link title of
	main logo to "Dashboard"

2016-05-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (extract_column_info): Add
	column info for value of individual subgroups.

2016-05-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-assets-top-visualization)
	(assets-dashboard-data) Change the title of the chart "Most vulnerable
	Operating Systems" to "Operating Systems by Vulnerability Score".

2016-05-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_h_bar_chart.js (evaluateParams): Get
	empty_text param.
	(generate): Fix fallback for empty_text.

2016-05-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add dashboards "Scans" and "Main" and use the Main dashboard as the
	start page.

	* CMakeLists.txt: Install src/html/classic/img/dashboard.svg and
	src/html/classic/img/scan.svg.

	* src/gsad_omp.c (dashboard): Show "main" dashboard when no dashboard
	name is given instead of "secinfo".

	* src/gsad.c (exec_omp_get): Show the dashboard if "cmd" param is NULL.

	* src/html/classic/img/dashboard.svg: New image.

	* src/html/classic/img/scan.svg: New image.

	* src/html/classic/graphics.xsl (dashboard): Add dashboards "main" and
	"scans".
	(dashboard [main], scans-dashboard-data, dashboard [scans])
	(assets-dashboard-data): New templates.
	(dashboard [assets]): Add data sources and chart controllers
	using new template assets-dashboard-data also used for main dashboard.
	(secinfo-dashboard-data): New template.
	(dashboard [secinfo]): Add data sources and chart controllers
	using new template secinfo-dashboard-data also used for main dashboard.

	* src/html/classic/gsad.xsl (html-gsa-navigation): Add "Dashboard"
	item to main menu and a "Dashboard" item to the "Scans" menu.

	* src/html/classic/css/gsa-style.css (#gb_menu > ul > li): Change width
	to 12.5% so the added dashboard button fits.

	* src/html/classic/js/gsa_graphics_base.js (create_dashboard_component):
	Allow limiting the component to a certain filter type which can be set
	with the filterType function.
	(select_controller_index): Get the filter type from the new controller
	and update the filters list accordingly.
	(apply_select2): Handle case where value is "--".
	(create_chart_controller): Add filterType function which gets the
	filter type from the data source.
	(create_data_source): Define a filter_type to limit the selection of
	filters in the chart component and add filterType function to get it.
	(filter_type_name): New. Gets the filter type name for a a given type.

2016-05-20  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (report): Add icons to create a new alert to the
	report result summary table.

2016-05-20  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Update styling for small_form ids.
	Currently we need this id in report result summary to style the alert buttons
	correctly.

2016-05-20  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Add an entity selector for new alerts.
	This allows to add a newly created alert to a select box.

2016-05-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-task-scanner): Fix check for existing
	scanner.

	* src/html/classic/omp.xsl (new_task): Fix checking for existing OpenVAS
	Scanner.

	* src/html/classic/omp.xsl (html-edit-task-form): Only show OSP Scanner radio
	if a osp scan config is available.

2016-05-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_gantt_chart.js (generate): Use d3.tip to display
	tooltips in gantt charts.

2016-05-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js (generate): Use d3.tip to show
	tooltips in bubble charts.

2016-05-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js (generate): Use d3.tip to set
	tooltips in donut charts. The title attributes are not shown in chrome and
	firefox >= 49. We should always use our tooltips instead of title attributes
	because title attributes are intended for ARIA not for tooltips.

2016-05-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js (generate): Extract creating the
	title from data into a reuseable function to avoid copy and paste code.

2016-05-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/lib/d3.tip.js: Update coding style to get es5 compatible
	javascript code.

2016-05-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/lib/d3.tip.js: Extend d3.tip library to fix an issue
	with the bordered box calculation on tspan svg elements in firefox. The
	calculation was used to get the position for the displayed tooltips.

2016-05-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js
	(DonutChartGenerator.prototype.generate): Add missing i variable.

2016-05-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (gsa.array_sum): Return 0 if passed array
	is empty, undefined, null or not an array type.

2016-05-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js: Use gsa.is_defined function instead
	of checking for undefined directly.

2016-05-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js,
	src/html/classic/js/gsa_bar_chart.js,
	src/html/classic/js/gsa_donut_chart.js,
	src/html/classic/js/gsa_h_bar_chart.js: Add array_sum function to gsa module.
	Use the new function to calculate the sum of intger values in an array.

2016-05-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/CMakeLists.txt: Replace Flawfinder check with a cppcheck one.

	* src/gsad.c (file_content_response, handle_request, main): Remove
	Flawfinder annotations.

2016-05-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/asset.svg: Replaced temporary icon
	with actual asset icon.

2016-05-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add new Assets Dashboard.

	* CMakeLists.txt: Install src/html/classic/img/asset.svg.

	* src/html/classic/graphics.xsl (dashboard): Add case for "assets".
	(dashboard [assets]): New template.

	* src/html/classic/gsad.xsl (html-gsa-navigation): Add dashboard as new
	top item in Assets menu.  Also show menu when user has "get_assets"
	permission.

	* src/html/classic/img/asset.svg: New image.

2016-05-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_aggregate_omp): Replace request parameters
	sort_field, sort_stat, sort_order with their new hashtable variants
	sort_fields, sort_stats, sort_orders, allowing sorting by multiple
	fields using the new sort element in the OMP command.

	* src/gsad.c (init_validator, params_append_mhd, params_mhd_add):
	Add new hashtable params sort_fields, sort_orders and sort_stats.

	* src/html/classic/graphics.xsl (js-scan-management-top-visualization):
	Add modification time as secondary sorting column for "Top 10"
	bar charts and change sort data attribute names to their plural forms.

	* src/html/classic/js/gsa_graphics_base.js (create_data_source)
	(on_ready): Replace parameters sort_field, sort_stat, sort_order with
	sort_fields, sort_stats, sort_orders.

2016-05-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js (generate): Fix extra tooltip
	lines.

	* src/html/classic/js/gsa_h_bar_chart.js (generate): Fix extra tooltip
	lines.

2016-05-13  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c (start_unix_http_daemon, start_http_daemon)
	(start_https_daemon): Increase limit of maximum connections per IP as
	the previous limit did not properly address more complex use cases.

2016-05-13  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad_omp.c (filter_exists, get_many): Check if a filter still exists
	when calling get many with a filter id in the params. Reset filter id if the
	filter doesn't exist anymore.

2016-05-13  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad_omp.c (find_by_value, delete_filter_omp): Change find_by_value to
	store a list of keys. The last filter id tree may contain several keys for a
	filter id. Therefore we should remove all entries for the to be deleted filter
	id.

2016-05-13  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/gsad.xsl (error_window): Refactor error window template to
	use error panel instead of gb window. Also improve the layout of the page to
	use standard layout and css classes.

2016-05-13  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Also show footer in header color for
	error panels.

2016-05-13  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-alert-form, html-edit-alert-form: Add
	margin before create credential icon. To get a margin after a select a select2
	box must be followed by an element with icon css class.

2016-05-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator): Add param restrict_credential_type.

	* src/html/classic/omp.xsl (html-create-credential-form): Show only
	credential types listed in restrict_credential_type when it is given.
	(html-create-alert-form, html-edit-alert-form, html-create-target-form)
	(html-edit-target-form, html-create-scanner-form)
	(html-edit-scanner-form, html-create-slave-form, html-edit-slave-form):
	Add buttons to create a new Credential and add restrict_credential_type
	param to existing buttons.

2016-05-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-alert-form): Also use the hidden
	field when submethod is not present.

2016-05-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (data_severity_level_counts):
	Remove records where the count is zero.

2016-05-12  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Add missing gsa.is_array function.

2016-05-12  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad_omp.c (find_by_value, delete_filter_omp): Add function to find a
	the first key in a g_tree by a value. Use this function to also delete a
	filter id from the last filter id tree when a filter gets deleted.

2016-05-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (append_alert_method_data): Return explicitly if data
	is NULL, to reduce indentation.

2016-05-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-create-alert-form): Use hidden field
	for submethod, as it's always "syslog".
	(html-edit-alert-form): When the submethod is "syslog" use a hidden
	field, otherwise show the dropdown.

2016-05-12  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (get_info_response): Always show get info content
	independent of an error.

2016-05-12  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/gsad.xsl (error_window, command_result_dialog: Use new
	error panel to display error boxes instead of gb_window classes. At the end we
	must get rid of all gb_window stuff.

2016-05-12  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Introduce panel css classes for a panel
	component. A panel is some kind of dialog box with an optional header and
	footer and some body for a message. Currently four panel types are provided:
	default (gray), success (light green), warning (light orange) and error
	(light red).

2016-05-12  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad_omp.c (save_filter_omp): Send save request to server via
	openvas_server_sendf_xml instead of openvas_server_sendf. We are sending xml
	and the content must be escaped because filter term may contain xml characters
	like ">".

2016-05-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-create-alert-form): Remove SNMP syslog
	option, like in edit form.
	(html-create-alert-form): Remove test field.

2016-05-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (alert, alert [details]): Add details for
	SNMP.

2016-05-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js
	(LineChartGenerator.prototype.generate): Move generating the axis components
	into the init function.

2016-05-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (append_alert_method_data): Add "snmp_message".

	* src/html/classic/omp.xsl (html-create-alert-form)
	(html-edit-alert-form): Add field for SNMP message.

	* src/html/classic/help.xsl (new_alert.html): Describe SNMP message
	replacements.

2016-05-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_h_bar_chart.js
	(HorizontalBarChartGenerator.prototype.evaluateParams): Remove superflous else
	branches when setting the bar style.

2016-05-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js
	(LineChartGenerator.prototype.generate): Use is_defined function instead of
	checking for undefined.

2016-05-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_h_bar_chart.js
	(HorizontalBarChartGenerator.prototype.evaluateParams): Make setting the bar
	style even less error prone.

2016-05-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js
	(BaseChartGenerator.prototype.showLoading): Remove showLoading method from
	chart generators. This method isn't usefull anymore.

2016-05-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js,
	src/html/classic/js/gsa_bubble_chart.js,
	src/html/classic/js/gsa_cloud_chart.js,
	src/html/classic/js/gsa_donut_chart.js,
	src/html/classic/js/gsa_gantt_chart.js,
	src/html/classic/js/gsa_h_bar_chart.js,
	src/html/classic/js/gsa_line_chart.js: Remove setting the title at the display
	form the generate methods.

	* src/html/classic/js/gsa_graphics_base.js
	(BaseChartGenerator.prototype.getTitle, on_data_loaded): Add getTitle method
	to BaseChartGenerator. It is always the same for all generators. Set display
	title after data has been generated.

2016-05-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_h_bar_chart.js (evaluateParams): Apply
	field-based bar style if gen_params.chart_template is undefined.

2016-05-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-create-alert-form, new_alert)
	(html-edit-alert-form, edit_alert, alert, alert [details]): Replace
	username and password fields of SCP and verinice alert methods with
	credential selection.

	* src/gsad_omp.c (new_alert): Get credentials list.
	(append_alert_method_data): Replace scp_username, scp_password,
	verinice_server_username and verinice_server_password with
	scp_credential and verinice_server_credential.
	(edit_alert): Get credentials list.

2016-05-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js,
	src/html/classic/js/gsa_bubble_chart.js,
	src/html/classic/js/gsa_cloud_chart.js,
	src/html/classic/js/gsa_donut_chart.js,
	src/html/classic/js/gsa_gantt_chart.js,
	src/html/classic/js/gsa_h_bar_chart.js,
	src/html/classic/js/gsa_line_chart.js: Update generate methods to accept
	display instead of controller as parameter.

	* src/html/classic/js/gsa_graphics_base.js (on_data_loaded): Pass display to
	generator generate method instead of controll and don't pass gen_params
	anymore.

2016-05-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js
	(BaseChartGenerator.prototype.generate,
	BaseChartGenerator.prototype.generateCsvData): Update parameter sequence to
	start with controller also for the BaseChartGenerator.

2016-05-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js (BarChartGenerator.prototype.generate):
	Don't calculate max y value twice.

2016-05-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js,
	src/html/classic/js/gsa_bubble_chart.js,
	src/html/classic/js/gsa_cloud_chart.js,
	src/html/classic/js/gsa_donut_chart.js,
	src/html/classic/js/gsa_gantt_chart.js,
	src/html/classic/js/gsa_graphics_base.js,
	src/html/classic/js/gsa_h_bar_chart.js,
	src/html/classic/js/gsa_line_chart.js: Reverse mustUpdate logic and adjust
	generator generate methods accordingly. We must do an update if the last
	generator is not the current generator.

2016-05-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js (BarChartGenerator.prototype.generate):
	Display bars above the x axis and not on it.

2016-05-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (on_ready): No need to xml unescape
	the selector label for the chart controller.

2016-05-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_h_bar_chart.js (data_top_list): Be more relaxed
	about missing y_fields and use count as default if it is missing.

2016-05-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js
	(DonutChartGenerator.prototype.generateLink): Use gsa.is_defined to check for
	undefined.

2016-05-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-overrides-table): Add dashboard to overrides
	list.

	* src/html/classic/graphics.xsl (js-overrides-top-visualization): Add new
	template to generate a overrides dashboard.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js (active_status_transform): Add
	original data value to transformed value. With this change the generated links
	for filtering the notes dashboard will use the original values.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js (active_status_transform): Remove
	debug statement from active_status_transform function.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/graphics.xsl (js-notes-top-visualization): Fix passing
	filter term and filter id to the notes charts.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/graphics.xsl: Add chart for notes active status to notes
	dashboard.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js: Use gsa.is_defined to check for
	undefined.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js: Add transfrom function for note
	active status to DonutChartGenerator. The transform function is used if the
	chart template is set to active_status.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Remove chart_template property
	from chart controller.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js,
	src/html/classic/js/gsa_h_bar_chart.js: Move color scale and bar style
	selection into evaluteParams methods.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Update coding style.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Pass chart_template to generator
	params. This allows to move the bar style and data transform function
	selection into the chart generator evaluateParams methods. Its better to move
	this selection into the chart generator because each generator knows which
	functions it is supporting.

2016-05-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-create-alert-form)
	(html-edit-alert-form): Remove comment that referred to removed
	variable.

2016-05-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (append_alert_method_data): Add return removed in
	r18026.  This was causing "Sourcefire Connector" parameters to be sent
	for every type of alert.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js: Add missing record variable
	declaration.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js,
	src/html/classic/js/gsa_graphics_base.js,
	src/html/classic/js/gsa_line_chart.js: Rename noChartLinks to no_chart_links
	and pass the variable only to the chart generator via generator params. It is
	not necessary to put the setting into the dashboard.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js: Call super method in
	LineChartGenerator.prototype.evaluateParams.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js: Use gsa.is_defined and gsa.has_value
	function and also update some coding style issues.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js: Rename time_line method to timeLine
	in LineChartGenerator.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js: Remove unused method is_defined.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_gantt_chart.js: Move evaluating the generator params
	to an own evaluateParams method in GanttChartGenerator.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js,
	src/html/classic/js/gsa_cloud_chart.js: Extract generating the links to a
	generateLink method and call super method while evaluating the generator
	params.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js: Add evaluateParams method to
	BubbleChartGenerator.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_h_bar_chart.js: Refactor HorizontalBarChartGenerator
	to be a child of BarChartGenerator. This allows removing duplicate code.
	Also fix some coding style issues found by jshint and jscs.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js: Extract generating bar chart links to
	an own method of BarChartGenerator.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js: Add evaluateParams method to
	BarChartGenerator.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Extend BaseChartGenerator to
	evaluate no_chart_link parameter. Add functions to get a common behaviour for
	(mostly) all chart generators when creating links.

2016-05-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-create-alert-form)
	(html-edit-alert-form): Match method ordering, by making them
	alphabetical.

2016-05-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Remove reference to old Administrator
	module.

2016-05-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Match "users" to "login".

2016-05-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Add alert method SNMP.

	* src/gsad_omp.c (append_alert_method_data): Add SNMP param checks.

	* src/html/classic/omp.xsl (html-create-alert-form): Add method SNMP.
	(html-edit-alert-form): Add method SNMP.  Remove the SNMP submethod from
	the syslog alert.

2016-05-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (append_alert_method_data): Correct method name.  This
	was preventing "submethod" from being sent.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Differentiate between getting a
	chart generator and instantiating a new generator. Export get_chart_generator
	function to gsa namespace. This allows to retrieve a chart generator
	constructor in other components via the gsa object.

2016-05-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js: Update coding style to fix errors
	from jshint and jscs.

2016-05-09  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js (create_bubble): Don't pass the
	complete controller to create_bubble. We only need to pass a parameter wether
	to create links or not.

2016-05-09  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js (generateData): Remove unnecessary
	gen_params Parameter from DonutChartGenerator.prototype.generateData.

2016-05-09  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js: Add
	DonutChartGenerator.prototype.evaluteParams function and remove gen_params
	parameter from DonutChartGenerator.prototype.generate method.

2016-05-09  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Use is_defined, has_value and
	is_function where possible.

2016-05-09  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js, src/html/classic/js/gsa_graphics_base.js:
	Update coding style to satisfy jshint and jscs.

2016-05-09  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Add is_function function to gsa namespace.

2016-05-09  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js (generate): Pass self to
	create_bubble as controller.
	(create_bubble): Add controller parameter so the function can access
	the controller options like noChartLinks correctly.

2016-05-09  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_chart_controller):
	Add no_chart_links param in get_detached_url.
	(on_ready): Rename linksDisable to noChartLinks as expected by other
	function.  Copy noChartLinks param from dashboard to gen_params.

2016-05-09  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Allow more than one field for each y axis in the line chart.

	* src/html/classic/graphics.xsl (js-assets-top-visualization): Add
	host counts of "High" subgroup as additional y and z fields.

	* src/html/classic/js/gsa_graphics_base.js: Use gsa.field_color_scale
	to get gsa.severity_level_color_scale.
	(gsa.field_color_scale): Add case for "severity_level"/"threat", which
	now also includes the values "Error", "Debug" and "False Positive".
	(field_name_colors): New function. Generates a d3 color scale for
	field names.

	* src/html/classic/js/gsa_line_chart.js (init): Replace string
	properties y_field and y2_field with arrays y_fields and y2_fields.
	(generate, generateCsvData, generateHtmlTableData): Allow more than one
	field for each y axis.

2016-05-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (extract_column_info): Keep jshint
	and jscs happy by updating coding style and use is_defined function.

2016-05-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-notes-table): Add dashboard to notes pages.

2016-05-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/graphics.xsl (js-notes-top-visualization): Add template for
	a notes dashboard.

2016-05-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (extract_simple_records)
	(extract_column_info, extract_task_records): Remove unused parameters
	from d3 selection.each callbacks.

2016-05-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (extract_simple_records): Refactor
	setting record values into functions to avoid duplicate code.

2016-05-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_cloud_chart.js: Use evaluateParams function in
	CloudChartGenerator to seperate gen_params from the generate function.

2016-05-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (extract_simple_records): Fix usage
	of this element in subfunction.

2016-05-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (extract_simple_records): Simplify
	code be moving duplicate code into functions and variables to improve
	readability.

2016-05-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_aggregate_omp): Replace empty filters with
	"rows=-2" when no filt_id is given, so the default number of rows
	is used for links inside charts.

2016-05-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator): Add param no_chart_links.

	* src/html/classic/graphics.xsl (js-scan-management-top-visualization)
	(js-assets-top-visualization, js-secinfo-top-visualization)
	(dashboard [secinfo]): Add option to disable links in charts with the
	no_chart_links param.

	* src/html/classic/omp.xsl (get_aggregate): Add option to disable links
	in charts with the no_chart_links param.

	* src/html/classic/js/gsa_bar_chart.js (generate): Disable links
	inside chart if noChartLinks is set in the dashboard.

	* src/html/classic/js/gsa_bubble_chart.js (generate): Disable links
	inside chart if noChartLinks is set in the dashboard.

	* src/html/classic/js/gsa_cloud_chart.js (generate): Disable links
	inside chart if noChartLinks is set in the dashboard.

	* src/html/classic/js/gsa_donut_chart.js (generate): Disable links
	inside chart if noChartLinks is set in the dashboard.

	* src/html/classic/js/gsa_gantt_chart.js (generate): Disable links
	inside chart if noChartLinks is set in the dashboard.

	* src/html/classic/js/gsa_h_bar_chart.js (generate): Disable links
	inside chart if noChartLinks is set in the dashboard.

	* src/html/classic/js/gsa_line_chart.js (generate): Disable links
	inside chart if noChartLinks is set in the dashboard.

	* src/html/classic/js/gsa_graphics_base.js (create_dashboard):
	Inititialize the noChartLinks variable and add noChartLinks getter
	function to the returned object.
	(on_ready): Get noChartLinks value from no-chart-links data attribute
	of the dashboard.

2016-05-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (resource-permissions-window): Set
	data-reload attribute on New Permission link, so the dialog returns to
	the current page on exit.

2016-05-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_container_task_omp): Align string.

2016-05-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/gsad.xsl (html-gsa-navigation): Where the menu is
	generated from a list, get the default command from the list.  Also
	check the item count in the "last" check, because last() does not seem
	to work when there's only one item.

2016-05-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_aggregate_omp): Handle new request param
	subgroup_column.

	* src/gsad.c (init_validator): Accept square brackets in x_field,
	y_fields, and z_fields params and add new param subgroup_column.

	* src/html/classic/graphics.xsl (js-assets-top-visualization): Add new
	chart hosts timeline chart.

	* src/html/classic/omp.xsl (get_aggregate): Add param subgroup_column.

	* src/html/classic/js/gsa_graphics_base.js (create_data_source):
	Get subgroup_column in init function.
	(extract_simple_records, extract_column_info, default_column_label):
	Handle subgroups.
	(BaseChartGenerator): Handle subgroup_column in data source definitions.

	* src/html/classic/js/gsa_line_chart.js (LineChartGenerator.generate):
	Handle subgroups and fix point markers using the y2 axis.

2016-05-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Remove unused function
	fit_detached_window.

2016-05-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Update coding style.

2016-05-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (feedback-icon): Fix layout of feedback-icon by
	adding class icon to the anchor element.

2016-05-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_ready): Move element initalization code
	for form enable and form selection controls into a common function.

2016-05-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_ready): Initialize form enable
	controls. This will deactivate elements when a dialog is opened.

2016-05-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-task-form): Deactivate radio options
	min_qod and apply_overrides if in_asset is set to no (0).

2016-05-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad_omp.c (create_task_omp, save_task_omp): Require parameters min_qod
	and apply_overrides options only if in_asset is set to 1.

2016-04-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-task-form): Refactor edit task dialog
	to use a horizontal form for all elements.

2016-04-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad.c (init_validator): Update hour validation regexp to remove
	necessary leading zero.

2016-04-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog.prototype.postForm): Redirect to
	login page if we get a 401 response from a dialog form submit.

2016-04-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone-ui.js (greenbone.spinner): Allow empty values
	in spinner. This allows to use backspace or delete keys to remove all content
	from spinner inputs.

2016-04-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Improve styling of error messages within
	dialogs.

2016-04-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_ready): Open datepicker on enter key
	press in deactivated input element.

2016-04-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (init_omp_dialog): Open OMPDialog on mouse
	click and on enter key press.

2016-04-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog.prototype.setContent): Submit
	dialog form on enter key press.

2016-04-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone-ui.js (greenbone.spinner): Allow selection
	with shift and ctrl keys in spinner inputs. Also fix typo in widget name.

2016-04-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-scan-management-top-visualization):
	Fix typo in text shown when Tasks Gantt chart is empty.

2016-04-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/help.xsl (help-header): Fix formatting of section heading
	in help pages (also in the about dialog).

2016-04-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (get_aggregate): Use correct variable for
	data-z-fields attribute of chart.

2016-04-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-assets-top-visualization): Split
	parameters for extra tooltip lines and severity score breakdown into
	multiple simple strings.

	* src/html/classic/js/gsa_bar_chart.js (generate): Adjust to new extra
	tooltip line params.

	* src/html/classic/js/gsa_h_bar_chart.js (generate): Adjust to new
	extra tooltip line and severity score breakdown params.

2016-04-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-task-form): Change edit task dialog to
	an edit dialog structure.

2016-04-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (new_task): Disable "qod" and "overrides" in new
	task dialog if is "add to assets" is set to no.

2016-04-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_ready): Allow to disable also spinner
	elements with .form-enable css classes.

2016-04-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_ready): Allow to set a value on
	which elements will be disabled for .form-enable css class usage.

2016-04-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Also show not allowed pointer on disabled
	text input fields.

2016-04-27  Björn Ricks <bjoern.ricks@greenbone.net>

	* doc/form-examples.html: Add an examples to show radio selected form parts.

2016-04-27  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (new_task): Refactor new_task dialog to use a
	horizontal form for all form elements.

2016-04-27  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (new_task): Start to refactor new_task dialog to
	use a new horizontal form.

2016-04-27  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Fix rendering issue of radio and
	checkboxes in a horizontal dialog form.

2016-04-27  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (new_task): Update new task dialog to an edit
	dialog structure.

2016-04-27  Björn Ricks <bjoern.ricks@greenbone.net>

	* doc/form-examples.html: Add some more examples to show more possible
	combinations.

2016-04-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-assets-top-visualization): Add
	"Most vulnerable Operating Systems" chart.

	* src/html/classic/js/gsa_h_bar_chart.js (default_bar_style): New.
	(init): Use default bar style.
	(generate): Set special bar styles for severity.  Apply abbreviation
	of tick labels in x axis tickFormat instead of domain.  Shorten
	CPE ids at the start, not at the end.  Add special case for
	"severity_score" fields in tooltip.

2016-04-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-assets-top-visualization): Get
	"modified" timestamp for "Most vulnerable Hosts" chart and use it
	as an extra tooltip field.

	* src/html/classic/js/gsa_bar_chart.js (generate): Make tooltip the
	same as horizontal bar chart and add option to add extra fields.

	* src/html/classic/js/gsa_graphics_base.js (extract_simple_records):
	Convert all ISO timestamp columns to Date objects.
	(get_selector_label): Add cases for average severity.

	* src/html/classic/js/gsa_h_bar_chart.js (generate): Add option to add
	extra fields.

2016-04-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad.c (init_validator): Allow # in name parameters e.g. task names.

2016-04-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog): Always use our dialog
	submission function when the user clicks on a submit button or presses enter
	within an input field. This fixes displaying an error message in the dialog
	instead of in a seperate page.

2016-04-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPAction.prototype.do): Fix adding values
	to FormData object. The FormData.prototype.set function is only available in
	Chrome >= 50, Firefox >= 39. FormData.prototype.append only requires Chrome >=
	7, Firefox >= 4.0 and IE >= 10.

2016-04-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* doc/form-examples.html: Add a basic html exmaple file to show how to use the
	css classes for horizontal forms.

2016-04-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Align all elements within form-items
	vertically in the middle.

2016-04-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Don't set min-height for radio or
	checkbox labels. This prevents to align them vertically in the middle.

2016-04-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Render select input elements the same as
	text inputs. The padding top and button must be inside of the border.

2016-04-26  Sven Haardiek <sven.haardiek@greenbone.net>

	* COPYING: Fix some path

2016-04-26  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator): Add "host" and "os" to aggregate_type.

	* src/html/classic/graphics.xsl (js-assets-top-visualization): New
	template.

	* src/html/classic/omp.xsl (html-hosts-table, html-oss-table): Add top
	dashboard.

	* src/html/classic/js/gsa_graphics_base.js (gsa.severity_level): New
	function.
	(gsa.resource_type_name): Add new case for "OS".

	* src/html/classic/js/gsa_h_bar_chart.js (generate): Show severity
	level name instead of percentage in tooltips if the y field is a
	severity.

2016-04-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (task [details]): Hide Add to Assets for
	container tasks.

2016-04-26  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/greenbone.js (gsa.is_date): New function.

	* src/html/classic/js/gsa_line_chart.js (time_line): Use new function
	gsa.is_date to test if a value is a date.

2016-04-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js (generate): Ignore mouse down
	events if there are less than two points.

2016-04-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-task-scan-options): Remove
	param_yes code.  We no longer have the plus buttons that reload the
	page.

2016-04-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (extract_simple_records):
	Convert ISO datetime strings to JS Date objects.

	* src/html/classic/js/gsa_line_chart.js (time_line): Change conditions
	to expect JS Date objects and ensure the range covers the maximum date.

2016-04-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_task_omp): Send Add to Assets preferences.

	* src/html/classic/omp.xsl (task [details]): Add % after QOD.
	(new_task): Add Add to Assets preferences.
	(html-edit-task-scan-options): Make QOD input smaller.

2016-04-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog): Fix reseting the submit button
	of a dialog. done was used as variable and prototype function name. Rename
	done function to finished.

2016-04-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Remove obsolete update button from
	list table bodies. The update is done automatically via js on selection change
	event.

2016-04-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (report-icons): Mention QOD and overrides in
	tooltip of "Add to Assets" icon.

2016-04-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (result-details): Fix xpath to the tag response.
	This fixes displaying the add user tag form within the result details.

2016-04-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (user-tags-window-checked): Refactor adding a user
	tag into a inline form. This allows removing the inline style definitions from
	the elements.

2016-04-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Add some margin for inline forms.

2016-04-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (user-tags-window-checked): Always reload current
	window if a tag has been created instead of going to the tag list.

2016-04-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_ready): Use button field for displaying
	the date value. The datepicker jquery ui elements requires to show this input
	field to be able to react on events like keyboard input. Therefore we MUST NOT
	hide it. To be able to use a unified date format without having to rely on the
	set date format of the datepicker the javascript Date class is used now.

	* src/html/classic/wizard.xsl, src/html/classic/os.xml: Remove obsolete field
	for datepicker value. The datepicker value is now shown in the datepicker
	button field directly. As a result the button for the datepicker is always
	shown on the right.

2016-04-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Remove style for #datevalue. #datevalue
	isn't used anymore. Set vertical align to middle for datepicker input field.

2016-04-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_ready): Set tooltip on date value input
	field of a datepicker.

2016-04-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_ready): Open datepicker when clicking
	into datepicker value input field.

2016-04-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl, src/html/classic/wizard.xsl: Don't disable
	datepicker value input elements to be able to react on javascript events at
	those elements.

2016-04-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_ready): Remove acting on #datepicker
	ids. All datepickers are no using css classes.

2016-04-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-schedule-form,
	html-create-schedule-form): Change datepicker component to use css classes
	instead of ids. Also set a size attribute for the date input field to not cut
	the date representation string.

2016-04-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/wizard.xsl (modify-task-wizard): Refactor modify task
	wizard into a horizontal form and change datepicker to use spinners for hour
	and minute.

2016-04-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/wizard.xsl (quick-task-wizard): Remove unnecessary
	container div.

2016-04-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Display tooltips for datepicker buttons.

2016-04-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/wizard.xsl: Use 'Start Scan' as button text for the task
	wizard dialog and remove the original 'Start Scan' submit button. We must not
	use submit buttons within any dialog form.

	* src/html/classic/js/greenbone.js: Pass button text from element attribute to
	a wizard dialog. This allows setting the wizard dialog button text via an
	attribute.

2016-04-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/wizard.xsl: Update the advanced task wizard. Remove
	scrolling by increasing the dialog sice. Let the explanation text flow arround
	the wizardess. Use 5/12 of the width for the explanation text and 7/12 for the
	formular. Use new horizontal form for the formular. Also use spinner for hour,
	minute and port selection.

	* src/html/classic/css/gsa-style.css: Set margins for heading in advanced
	task wizard dialog.

2016-04-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog): Allow to set the height of a
	OMPDialog via data-height attribute.

2016-04-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Fix 1px bug for icon menues. Sometimes
	the icon drop down menu was shown 1px to low which resulted in a flickering
	and inaccessible menu.

2016-04-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Remove default height of dialogs.

2016-04-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog): Rename parameter element to
	done.

2016-04-20  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-schedule-form): Refactor edit schedule
	dialog to a horizontal form and update the date and time selection.

2016-04-20  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-schedule-form): Update edit schedule
	dialog to a new edit dialog without using gb_window css classes.

2016-04-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_task_omp): Send new asset preferences.
	(save_my_settings_omp): Remove asset settings.

	* src/html/classic/omp.xsl (task [details]): Show asset preferences.
	(html-edit-task-scan-options): Add asset preferences.
	(get_my_settings, edit_my_settings): Remove asset settings.

2016-04-20  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Add css class to format the displayed
	date of a datepicker.

	* src/html/classic/omp.xsl (html-create-schedule-form): Update datepicker in
	create schedule form.

2016-04-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (next_page_url): Include "name" param of wizards.

2016-04-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (wizard): Test if "name" param is valid.

2016-04-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (report-icons): Fill in filter params for
	"Remove from Assets" icon.

2016-04-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Add the function
	resource_type_name_plural to the gsa object.

	* src/html/classic/js/gsa_line_chart.js (generate): When selecting a
	range, show a tooltip box with the selected range and number of items.
	Also open linked page directly after ending the selection.

2016-04-20  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (editAlertUpdateForm): Remove now obsolete
	editAlertUpdateForm function. De-/activation of conditional elements is done
	by form-selection css classes now.

2016-04-20  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-alert-form, html-edit-alert-form):
	Only show result filter in report result filter selection.

2016-04-20  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-alert-form, html-edit-alert-form):
	Rework alert forms to use new horizontal form and more important to hide/show
	elements based on the method and event selections.

2016-04-20  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_ready): Introduce form-selection-input
	css classes. This classes can be used to deactive and activate input elements
	of forms which must not be included in the http request after form submission.
	The disabled property is used to de-/activate the input elements. Disabled
	input elements will not be send within the http request.

2016-04-20  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_ready): Use prop (property) jquery
	function to deactivate elements. For details between prop() and attr() see
	https://api.jquery.com/prop/.

2016-04-19  Matthew Mundell <matthew.mundell@greenbone.net>

	Send filter when creating assets from a report, so that the overrides
	and min QOD settings are used.

	* src/gsad_omp.c (save_my_settings_omp): Send new Asset settings.
	(create_asset_omp): Send FILTER/TERM in CREATE_ASSET.

	* src/html/classic/omp.xsl (report-icons): Fill in filter params.
	(get_my_settings, edit_my_settings): Add new Asset settings.

2016-04-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js (generate): Resize the tooltip
	marker line and range marker together with the rest of the chart.
	Fix the date display in tooltip for empty records.

2016-04-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (get_my_settings): Add "(immutable)" to Max
	Rows Per Page.

2016-04-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-alert-form): Change edit alert dialog
	into an edit based dialog. This removes the old gsa_ styling.

2016-04-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Allow to set height of a textarea via
	rows attribute when form-control css class is set.

2016-04-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js: Rename "marker" elements
	and variables of range marker to avoid confusion with point markers.

2016-04-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_ready): Allow to set a specific value
	for element activation/deactivation on selection changes. Also initialize the
	the selection.

2016-04-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (ADD_CONTENT_SECURITY_HEADERS)
	(ADD_GUEST_CHART_CONTENT_SECURITY_HEADERS): Remove.  Now a function.  No
	need for a macro.
	(add_content_security_headers)
	(add_guest_chart_content_security_headers): New functions.  From macros.

2016-04-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (get_my_settings): Display "Max Rows Per
	Page".

2016-04-18  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (gsa.iso_time_format): New
	d3 time format.
	(gsa.filtered_list_url): Add special "range" relation.

	* src/html/classic/js/gsa_line_chart.js (generate): Allow marking a
	time range, the marker linking to a filtered page restricted to the
	selected range.

2016-04-18  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Simplify CPACK_SOURCE_IGNORE_FILES by ignoring the
	entire build directory.

2016-04-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-alert-form): Change new alert dialog
	into an edit dialog.

2016-04-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (handler_send_response): If MHD_queue_response returns
	MHD_NO, assume the cause was a bad request.  This keeps MHD
	"Internal application error" out of the log.

2016-04-18  Björn Ricks <bjoern.ricks@greenbone.net>

	Allow to use several form selections in a form

	* src/html/classic/js/greenbone.js (on_ready): Use id attribute to identify
	selections items to switch on and off.

	* src/html/classic/omp.xsl (html-create-credential-form): Add an id of the
	form selection controller to all form selection items.

2016-04-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Rename request_handler to a verb, because it's a function.

	* src/gsad.c (request_handler): Remove.  Renamed.
	(handle_request): New function.  Was request_handler.
	(start_https_daemon, main): Update for name.

2016-04-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Update coding style to fix
	warnings and errors of jshint and jscs.

2016-04-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (handler_send_response): Return the MHD_queue_response
	return, instead of blindly returning MHD_YES.

2016-04-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (send_redirect_to_urn, request_handler): Send a response
	instead of dropping the connection, to prevent libmhd from adding
	"Internal application error" to the log.

2016-04-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): When the token is NULL skip
	validation, cookie retrieval and user search, because the result is
	always USER_BAD_MISSING_TOKEN.

2016-04-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (send_redirect_to_uri, handler_send_response)
	(request_handler): Log a warning when returning MHD_NO, to clarify the
	"Internal application error" message that libmhd adds to the log.

2016-04-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Format ! like everywhere else.

2016-04-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/xslt_i18n.c (xslt_ext_strformat): Free members of format_args too.

2016-04-15  Matthew Mundell <matthew.mundell@greenbone.net>

	Close some leaks found with valgrind.

	* src/gsad_omp.c (get_many): Free filter_type if it is not added to
	last_filt_ids.

	* src/xslt_i18n.c (xslt_ext_strformat): Free data.
	(init_language_lists): Free columns.

2016-04-15  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (generate_page): Correct condition of current_page
	UTF-8 check and set current_page to NULL if it fails.

2016-04-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (send_redirect_to_uri, file_content_response)
	(request_handler): Let MHD use the GSA buffer when creating responses,
	to reduce the maximum amount of memory used.

2016-04-15  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Set version to 6.1+beta5.

2016-04-15  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 6.1+beta4 release.

	* CHANGES: Updated.

2016-04-15  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Add CMAKE_BINARY_DIR to CPACK_SOURCE_IGNORE_FILES to
	generally ignore files created in out-of-source builds.

2016-04-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (xsl_transform_omp): Free xml earlier, to reduce max
	memory requirement.

2016-04-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_base.c (xsl_transform_with_stylesheet): Free doc earlier, to
	reduce the amount of memory allocated at once.  Call malloc_trim after
	freeing everything, to force Glib to check if it can reduce the heap size.

2016-04-15  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Remove 'cmake$' from CPACK_SOURCE_IGNORE_FILES to
	avoid accidentally excluding custom CMake scripts from the tar ball.

2016-04-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Set version to 6.1+beta4.

2016-04-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Preparing the gsa 6.1+beta3 release.

	* CHANGES: Updated.

2016-04-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (fill_empty_fields): Set
	"~original" columns to empty string instead of 'N/A' and do not
	change columns with value 0.
	(filtered_list_url): Append new keyword instead of prepending so it
	works with criteria containing the "not" keyword.

2016-04-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js (init): Remove color scale
	initialization.
	(generate): Initialize color scale using the type and value column name
	if it is still undefined.  Try getting scale color for original value
	if the current one does not work.

	* src/html/classic/js/gsa_graphics_base.js (gsa.field_color_scale): New
	function to get column-specific color scales.
	(BaseChartGenerator.prototype.scaleColor): Return undefined if color
	is not valid.

2016-04-13  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (get_client_address): Fix stack bufferoverflow introduced
	in r24780. Can be triggered with: curl -k -H "X-Real-IP: `python -c
	'print "A"*300'`" https://localhost/omp?token=foo

2016-04-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (BAD_REQUEST_PAGE): New define.
	(request_handler): Send bad request page instead of dropping the
	connection when URL is bad, to keep MHD "Internal application error"
	warnings out of the logs.

2016-04-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Do the export check earlier, to save
	calling reconstruct_url in one or two cases.

2016-04-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Move report_format_id into an explicit
	"if" statement, so that it is only retrieved when needed.

2016-04-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (append_param): Check key and value before using them.  In
	particular, value can legitimately be NULL for requests like
	http://foo/bar?key.

2016-04-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (start_unix_http_daemon): Remove unix socket so that bind
	works correctly, and use its permissions for new socket.

2016-04-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (start_unix_http_daemon): Don't recreate the socket if it
	already exists, in order to keep previous setup permissions.

2016-04-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Check UTF8 of reconstructed URL.

2016-04-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (new_credential_update_form): Remove the
	now obsolete function new_credential_update_form.

2016-04-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-credential-form): Use new javascript
	code for dynamically enabling/disabling and hiding of form elements at the
	create credentials dialog.

2016-04-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_ready): Add code for a flexible hidding
	of elements on input selection changes and also code for enabling/disabling of
	elements depending on other input elements.

2016-04-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Add styles for disabled form controls.

2016-04-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-credential-form): Change missing
	newCredentialUpdateForm function calls to gsa.new_credential_update_form.

2016-04-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-credential-form),
	src/html/classic/js/greenbone.js: Rename newCredentialUpdateForm to
	new_credential_update_form and put the function into the gsa namespace.

2016-04-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-credential-form): Use horizontal form
	style for edit credential dialog.

2016-04-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-credential-form): Change dialog to an
	edit dialog.

2016-04-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Account for the return from
	send_redirect_to_urn, so that the connection closes when there is an
	error in the request.  This prevents DOS-like behaviour when clients
	like "openssl sclient" send erroneous HTTP requests.

2016-04-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-credential-form): Use horizontal form
	style for new credential dialog.

2016-04-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-credential-form): Change dialog to an
	edit dialog.

2016-04-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-schedule-form): Use spinner element
	for hour and minute selection in first time parameter.

2016-04-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_ready): Use each function to active
	datepickers. This will allow to use a css class instead of an id for
	datepickers in future more easily.

2016-04-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_ready): Mark text of calender widget
	icon button as translateable.

2016-04-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad.c: Make the 0 prefix in minute params optional.

2016-04-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-schedule-form): Use spinner element
	for period and duration selection in create schedule dialog.

2016-04-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (send_redirect_to_urn): Use same syntax for unix sockets.
	(request_handler): Handle USER_IP_ADDRESS_MISSMATCH case instead of
	aborting on it.
	(get_client_address): Fix for unix socket case.

2016-04-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_dashboard): Count
	total number components after initializing them in the function
	init_components_from_string.

2016-04-07  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Align calendar selection icon button
	vertically in the middle.

2016-04-07  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-schedule-form): Change new schedule
	dialog to use horizontal form.

2016-04-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/help.xsl (hosts.html): Show help text for "Edit"
	action, add description for "Create Target from Host" and fix heading
	for "Delete Host".
	(new_target.html): Add input field "Hosts: From host assets".

2016-04-07  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-schedule-form): Change new schedule
	dialog to an edit dialog.

2016-04-07  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Use pointer as cursor for calendar
	icon buttons.

2016-04-07  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (FilterDialog): Fix displaying the content
	of the update filter dialog after it has been closed. The dialog got changed
	to use the original content and not the cloned one because the cloned content
	didn't had cloned event listeners. Now with the original content we must
	ensure that it isn't removed from the DOM when closing the dialog.

2016-04-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (main): Add --unix-socket option.
	(send_redirect_to_urn): Adjust for unix socket daemon case.
	(gsad_cleanup): Cleanup unix socket child too.
	(start_unix_http_daemon): New function.

	* doc/gsad.8: Update documentation.

2016-04-07  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Don't log errors of i18n to console. It's
	ok to not find translation files because we have a sane fallback.

2016-04-07  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Add margin between "sections" of the
	filter selection in the toolbar.

2016-04-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Also count "os" assets
	subtype for bulk actions.

2016-04-07  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl, src/html/classic/js/greenbone.js: Use new slider
	component for min cvss and min qod values in update filter dialog.

2016-04-07  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Add css styles for formatting the slider
	ui component.

2016-04-07  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone-ui.js: Add css class gb-spinner to our spinner
	component.

2016-04-07  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone-ui.js: Pass name parameter to slider input
	element. This allows to use the new slider within forms.

2016-04-07  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone-ui.js: Introduce a slider ui component which
	is a combination of our spinner and the jquery ui slider.

2016-04-07  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone-ui.js: Pass keydown event also to super widget
	class. Fix checking for min values in spinner.

2016-04-07  Björn Ricks <bjoern.ricks@greenbone.net>

	* CMakeLists.txt, src/html/classic/gsad.xsl,
	src/html/classic/js/greenbone-ui.js, src/html/classic/js/greenbone.js:
	Move our special handling for the spinner ui element to an own jquery ui
	widget. This allows access to the internals and to reuse the component more
	easily.

2016-04-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (exec_omp_post, request_handler): Test if caller is NULL
	before UTF-8 validation.

2016-04-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (generate_page): Test if current_page is valid UTF-8.

	* src/gsad.c (UTF8_ERROR_PAGE): New #define.
	(params_mhd_validate): Separate test if param is valid UTF-8 from other
	validations.
	(exec_omp_post): Test if caller is valid UTF-8.
	(send_redirect_to_urn): Test if "Host" and "X-Forwarded-Protocol"
	headers are valid UTF-8.
	(redirect_handler): Test if "Host" header is valid UTF-8.
	(get_client_address): Test if "X-Real-IP" header is valid UTF-8 and
	change return type to int to return whether the check failed.
	(request_handler): Return error message if URL, "X-Real-IP" header
	or "Accept-Language" header is not valid UTF-8.  Also check encoding of
	"cmd" and "report_format_id" in expired/bad/missing token/cooke case.

	* src/validator.c (openvas_validate): Test whether name and value are
	valid UTF-8 if they are not NULL.

2016-04-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/gsad.xsl (envolope): Don't put action status into the
	header. It belongs to the main content. This fixes displaying errors from
	gsad. It is still no perfect because the error should be displayed beyond the
	toolbar but that may require much more work.

2016-04-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (report-icons): Remove "Return to default filter
	view" icon buttons from reports.

2016-04-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_read): Refactor spinner to allow float
	and int values. Also convert inputs to a spinner only if the spinner class is
	set.

	* src/html/classic/omp.xsl (filter-window-part): Add spinner class to first
	result and max input fields in update filter dialog. Also set the data type to
	int.

2016-04-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-part): Set max value of first result
	parameter to at least 1. It won't work for lower values then 1.

2016-04-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-part): Set maximim value of first
	result parameter in update filter dialog to number available entries returned
	from gsad.

2016-04-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_read): Extract the spinner change event
	handler to a reusable on_spinner_change function. Also reset spinner to
	previous value if value is smaller then min or bigger then max.

2016-04-06  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-part): Set minimum value of first
	result parameter to 1 in update filter dialog.

2016-04-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (get_client_address): Neaten formatting.
	(request_handler): Get client address as late as possible.

2016-04-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl (new_alert.html): Add SCP section.

2016-04-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (report_format [details]): Correct path for
	count.

2016-04-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (get_report): In alert case, add report_id removed during
	transition to full report powerfilter.

2016-04-05  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (edit_report_format): Use new horizontal form
	styles to fix layout of edit report format dialog. Also convert the dialog to
	an edit dialog.

2016-04-05  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (cvss_calculator): Use standard drop down selects
	for cvss calculation. No need for select2 search completion here.

2016-04-05  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_read): Don't use select2 for select
	elements with css class no-select2. This allows to explicit render selects as
	standard select drop downs in the browser style.

2016-04-05  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (cvss_calculator): Use new colum and
	horizontal form layout for the cvss calculator.

2016-04-05  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Add a button-block class to allow using
	the full width (of a column) for the button.

2016-04-05  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-part): Add button for resetting the
	filter to the filter toolbar.

2016-04-05  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Set line height, font size and font
	family from parent elements and not from the browser default for button,
	input, select and textarea elements.

2016-04-05  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_read): Prevent illegal characters
	beeing inserted into number input fields. Hint: currently our number input
	fields only accept integers not floats.

2016-04-05  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_cloud_chart.js,
	src/html/classic/js/gsa_donut_chart.js,
	src/html/classic/js/gsa_gantt_chart.js,
	src/html/classic/js/gsa_graphics_base.js: Update coding style.

2016-04-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (resource_type_counts)
	(qod_type_counts, percentage_counts): Do not overwrite "~original"
	fields of records if they exist.
	(fill_empty_fields): Add an empty string as "~original" to empty fields
	in records.

2016-04-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js (generate): Make the bars link
	to list or details pages.

	* src/html/classic/js/gsa_gantt_chart.js (data_task_schedules): Add
	filter_info to the new data object.
	(generate): Make the bars link to details pages.

	* src/html/classic/js/gsa_graphics_base.js (filtered_list_url): Fix
	case where "Log" severity can be > 0.0.  Handle cases for numeric
	severity.

	* src/html/classic/js/gsa_h_bar_chart.js (generate): Make the bars link
	to list or details pages.

2016-04-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (task-icons): Reload window after uploading a
	report to a task to show the changes.

2016-04-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Fix displaying "Task is already active" icon
	button in task details page.

2016-04-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (on_ready): Use jquery-ui spinner component
	for all number input fields.

2016-04-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-part): Set min values for rows and
	first result filter params.

2016-04-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (FilterDialog.prototype.show): Don't clone
	filter dialog content. Use the original to keep all already connected event
	handlers. Using a clone doesn't clone the event listeners.

2016-04-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/jquery-ui.structure.css,
	src/html/classic/css/jquery-ui.structure.min.css: Update jquery-ui.structure
	css files to include all components which are also included in the jquery-ui
	javascript files.

2016-04-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js (generate): Have bubble
	charts grouped by uuid link to details pages and pass full filter_info
	to filtered_list_url for other group columns.

	* src/html/classic/js/gsa_cloud_chart.js (generate): Have the words
	link to filtered list pages.

	* src/html/classic/js/gsa_donut_chart.js (generate): Pass full
	filter_info to filtered_list_url.

	* src/html/classic/js/gsa_graphics_base.js (extract_filter_info): Make
	keywords field in filter_info an array to preserve multiple occurences
	of keywords.  Add fields for criteria and extra options and their
	string representations to filter_info.
	(cmd_type): New function.
	(filtered_list_url): Add new filter criteria instead of replacing them.
	Use new cmd_type function to get the type for the get_... command.
	(details_page_url): New function.

2016-04-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Change label from Password to New Password when
	changing a users password in the edit user dialog.

2016-04-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Pre select current authentication mode when
	editing a user.

2016-04-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Refactor user edit dialog to use new
	form-horizontal css style. Now the edit user dialog has the same layout as the
	create user dialog.

2016-04-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-user-form): Only show radio button for
	password if other authentication methods are available and enabled.

2016-04-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js (create_bubble): Update coding style
	and remove debug statements.

2016-04-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-user-form): Refactor html create user
	dialog to use edit dialog pattern and the new horizontal form css layout.

2016-04-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Add style for formatting a multiline
	selection widget within a horizontal form.

2016-04-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js (generate): Pass data object
	to create_bubble.
	(create_bubble): Add param "data" and add filtered list page links to
	the bubbles.
	(simple_bubble_data): Add new column "group_data" containing the
	column originally used for grouping.

2016-04-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js,
	* src/html/classic/js/gsa_graphics_base.js: Update coding style and fix some
	smaller javascript issues.

2016-04-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-part): Rework update filter dialog
	to use new css form classes.

2016-04-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Adjust the size of our dynamic select
	elements. They should use the same height as text inputs (22 pixels).

2016-04-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Add default styles for form elements
	inspired by bootstrap 3 css framework. With this change we have two different
	kind of forms that can by sized with the col-* based layout: horizontal and
	inline form. Horizontal should be used for dialogs and longer forms. A "row"
	within the horizontal form can be set by form-group css class. Within the
	form-group a control-label can be used to highlight description of a form
	entry. If an element e.g. an input text field should use the full width of its
	container form-control can be set. Example for a horizontal form:

	<form class="form-horizontal">
		<div class="form-group">
			<label class="col-2 control-label">My Label</label>
			<div class="col-10">
				<input type="text" class=form-control"/>
			</div>
		</div>
		<div class="form-group">
		...
		</div>
	</form>

	An inline form can be used to put several form elements like text inputs in
	one row e.g. for quick filters in a menu. In inline forms form groups will be
	displayed as inline-blocks. Example:

	<form class="form-inline">
		<div class="form-group">
			<label class="control-label">My Label</label>
			<input type="text" class=form-control"/>
		</div>
		<div class="form-group">
		...
		</div>
		<input type="submit" class="button"/>
	</form>

	For a more detailed explanation please take a look at
	https://getbootstrap.com/css/#forms

2016-04-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js (generate): Make the slices
	and legend items links to filtered list pages.

	* src/html/classic/js/gsa_graphics_base.js (extract_filter_info): Also
	extract the filter keywords.
	(resource_type_counts, qod_type_counts, percentage_counts): Copy the
	original values of modified columns to new columns suffixed "~original"
	to make them available for filters.
	(filtered_list_url): New function.

2016-04-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Fix layout of icon buttons in report result
	overrides. Remove usage of direct style definitions and use icon class
	instead.

2016-04-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css, src/html/classic/omp.xsl: Merge
	override_box_box and note_box_box css class into hint-box.

2016-04-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Return to report result details page after a note
	or a override have been created or edited. Also use css classes instead of
	inline styles for the icon buttons.

2016-04-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Add left margin for icon within note
	boxes.

	* src/html/classic/omp.xsl: Fix layout of icon buttons in report result notes.

2016-03-31  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Fix displaying the icon menu. Remove gap
	between the icon and the hover menu.

2016-03-31  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-part): Use params
	apply_overrides, first_result and max_results instead of overrides,
	first and max on the report pages.

2016-03-31  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Fix displaying the toolbar icons of host and os
	assets by removing the direct style formatting and useing icon css class
	instead.

2016-03-31  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Remove hidden css class from
	gsa-style.css. It is already defined in gsa-base.css.

2016-03-31  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Fix alignment of icons in the toolbar.

2016-03-31  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Remove direct style formatting and use icon css
	class to fix diplaying the toolbar icons at the result details page.

2016-03-31  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css, src/html/classic/omp.xsl: Fix the
	report details header by adding a surrounding section-header div element. Also
	add a new css class to position the severity bar in the report section header
	correctly.

2016-03-31  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Add clearfixes for toolbar and
	section-header. Both are rows with floating elements. Therefore we need to
	clear the floats afterwards.

2016-03-31 Michael Meyer <michael.meyer@greenbone.net>

	* src/html/classic/os.xml:
	Added some more CPEs.

2016-03-31  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Fix displaying the icons in a report. Remove all
	direct styles and use generic css classes e.g. icon class.

2016-03-31  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Fix displaying the severity bar in the report
	details section.

2016-03-31  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Add margin after select2 containers (our
	dynamic select boxes) if they are followed by an icon.

2016-03-31  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Remove padding from column elemnts
	inside the toolbar. The toolbar has already an outer padding. This removes the
	extra space before the icon buttons in the toolbar.

2016-03-31  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Display form inline elements as inline
	block. This allows to declare form inlines outside of form elements e.g. in a
	surrounding div block element.

2016-03-31  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/gsad.xsl: Add a greenbone logo to the menu which is only
	visible when the menu is fixed (sticky) to the top. Also add a gsa-head
	div element arround the header and the main menu.

	* src/html/classic/js/greenbone.js: Add sticky class to gsa main element if
	the user did scroll beyond the header.

	* src/html/classic/css/gsa-style.css: Add sticky css classes for getting a
	position fixed gsa main menu.

2016-03-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Move filter dialog form outside of the
	filter form. This allows to have seperated layouts for the dialog and the
	filter toolbar forms.

	* src/html/classic/js/greenbone.js: Update FilterDialog for reworked filter
	form layout.

2016-03-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Update coding style.

2016-03-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Fix layout of filter in toolbar for report pages.

2016-03-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/gsa-style.css: Wrap footnote of filter in toolbar after
	500px.

2016-03-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Use from-group instead of ctrl-group css class.

	* src/html/classic/gsa-style.css: Remove ctrl-group css classes.

2016-03-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (FilterDialog): Adjust displaying the
	formular for the filter dialog.

2016-03-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Refactor toolbar to use a column
	based layout, inline form,  form groups and form controls. Also change the
	ordering of the elements in the filter toolbar to use the sequenece in which
	they are rendered. Remove all direct styles from the toolbar filter elements.

2016-03-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Update styles for rendering the filter
	section within the toolbar.

2016-03-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Improve css classes for forms. Reduce
	margin between form rows (form-group). Add a generic layout for form-controls.
	Add a css class for inline forms (form-inline).

2016-03-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (preference-details)
	(edit-config-preference): Show "hr_name" instead of "name" in the
	"Name" column.

2016-03-30  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Rename css class hide to invisible and
	introduce new class hidden. invisible will keep the redering space and hidden
	will not allocate any space for rendering.

	* src/html/classic/gsad.xsl: Use invisible css class instead of hide.

2016-03-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css, src/html/classic/omp.xsl: Simplify css
	by removing the extra stuff for list-window. Use section-header css class
	instead.

2016-03-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog [setErrorFromResponse]):
	Add text from gsad_msg in addition to the status_text if it is not
	empty.

2016-03-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (next_page_url): Add "asset_type" to the parameters
	that are copied to the next page URL.

2016-03-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (delete-icon): Remove margin-left from
	style for icons that are not for the type "user".
	(asset/os): Add class "table-actions" to the action td. Remove
	margin-left from icons and use class "icon" instead.

2016-03-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Reduce max size of pop up dialogs to
	500px in height.

2016-03-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (filter [details]): Only include alerts
	if the user may run GET_ALERTS.

2016-03-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (filter_resource_types): New template.
	(html-create-filter-form, html-edit-filter-form): Use
	filter_resource_types, which includes all types, and does i18n.

2016-03-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (credential [details]): Only include slaves
	if the user may run GET_SLAVES.

2016-03-24  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/gsad.xsl: Remove user icon from guest login button.

2016-03-24  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_h_bar_chart.js: Fix rendering horizontal bar charts.

2016-03-24  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (get_client_address): Consider the setting
	to ignore the use of x_real_ip.
	(main): Add the command line parameter "--ignore-x-real-ip".

2016-03-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (get_client_address): Get the header X-Real-IP and
	use this one as clienbt address. Else take the one of the
	MHD connection as before. This helps to operate gsad
	behind a proxy. The is based on a patch by Benoit Allard.

2016-03-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_credential_omp): Remove duplicate initialisation,
	and random spaces.
	(authenticate_omp): Init auth_opts to defaults, so that all fields are
	always initialised.

2016-03-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_agent_omp): Remove name and comment checks,
	this is done by CHECK_PARAM_INVALID.  Hence remove redundant entity and
	response initialisations, as Clang should understand now.

2016-03-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Remove "+" submit rules.  No longer used.

	* src/gsad_omp.c (create_task_omp, save_task_omp, create_user_omp)
	(save_user_omp): Remove submit "+" handling.  No longer used.

2016-03-23  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch MESSAGE_INVALID from a macro to a function because it no longer
	needs to be a macro (it's used seldom, and callers always just return the
	result).   This also gives it a return, which makes the flow of control
	easier to follow.

	* src/gsad_omp.c (MESSAGE_INVALID): Remove.  Now a function.
	(message_invalid): New function.  Was MESSAGE_INVALID.
	(CHECK_PARAM_INVALID, create_report_omp, create_credential_omp)
	(create_target_omp, create_user_omp, create_user_omp, save_user_omp)
	(save_user_omp): Use new function.

2016-03-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/gsad.xsl: Change default charts for ovaldef to:
	1. OVAL definitions by Severity Class, 2. OVAL definitions by creation time,
	3. OVAL definitions by class.

	For all other secinfo types set default use 1. by Severity Class,
	2. by Creation Time, 3. by CVSS.

2016-03-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/gsad.xsl: Change default charts for secinfo nvts to:
	Row 1:
		* NVTs by Severity Class
		* NVTs by family
		* NVTs by CVSS
	Row 2:
		* NVTs by Creation Time
		* NVTs by QoD Type

2016-03-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/gsad.xsl: Change default charts for secinfo dashboard to:
	Row 1:
		* NVTs by Severity Class
		* CVEs by creation time
		* CVEs by Severity Class
	Row 2:
		* CERT-Bund by creation time
		* CERT-Bund by CVSS

2016-03-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/gsad.xsl (login_page): Correct alignment.

2016-03-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_report_omp): Return error if report is missing.

2016-03-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Fix width of chart menu entries during
	hovering.

2016-03-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/favicon.gif, src/html/classic/img/favicon.gif,
	CMakeLists.txt, src/html/classic/gsad.xsl: Move favicon to img directory and
	also install the icon under the img location. This allows to serve the static
	favion via nginx and also we don't install it twice. Additionally set the
	correct mime type for the gif favicon in the html header.

2016-03-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Update coding style and add missing
	closing bracket in statement.

2016-03-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-login.css, src/html/classic/gsad.xsl: Refactor
	login page. Move error message to an own box above the login. Also move the
	guest login button to a box under the user login.

2016-03-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Use a new css class for primary buttons.
	This button can be used to highlight the main button. Also add css to allow to
	use images within button captions.

2016-03-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Use a bold font for button captions.
	Also use a green background for focused or hovered buttons.

2016-03-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Add css class to hide elements. This
	allows to reseve the space used by the element if it would be visible.

2016-03-23  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog.prototype.postForm): Get
	"next" page if the response of the POST is one containing an
	action_result and get entity for select option from there.

2016-03-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-create-alert-form): Add ID to SCP
	report row.

	* src/html/classic/js/greenbone.js (editAlertUpdateForm): Show and hide
	SCP report row according to alert event type.

2016-03-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Redirect to new tasks when a new task has been
	created from an existing task detail view.

2016-03-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Set default reload options for edit, new
	and delete action icons.

2016-03-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Add options to set a default reload
	parameter when calling init_omp_dialog. If the element data-reload attribute
	is not set the default reload options will be used.

2016-03-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Add new reload option next for OMPDialogs.
	This options allows to redirect to the returned next url of the http response.

2016-03-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Add functions to parse and encode a url.

2016-03-22  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog [setErrorFromResponse]):
	Add status code to error title if one is given.

2016-03-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl: Add calculator heading.
	(user [edit]): Align tag.

2016-03-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Add new alert method 'SCP'.

	* src/html/classic/omp.xsl (html-create-alert-form)
	(html-edit-alert-form): Add SCP input.
	(alert, alert [details]): Add SCP data.

	* src/gsad_omp.c (append_alert_method_data): Add SCP checks.

2016-03-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* FindPythonModule.cmake: Fix exporting PY_module_FOUND variable in
	find_python_module cmake function. This fixes building the json translation
	files.

2016-03-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* FindPythonModule.cmake: Change tabs into spaces and remove unnecessary
	whitespace.

2016-03-22  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (report [section-pager-new]): Renamed to
	report [section-pager].
	(report [section-pager]): New. Renamed report [section-pager-new].
	(report [results]): Change section-pager-new to section-pager.

2016-03-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js: Fix transforming data for line
	charts.

2016-03-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Add a evaluateParams prototype
	function to BaseChartGenerator. This function will be called before
	generateData and should be used to initialize generator specific parameters.

2016-03-22  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (report [results-pager]): Remove. Replaced
	by new template: report [section-pager-new].
	(section-pager): Remove. Replaced by section-filter-full and
	section-filter-restricted.
	(report-section-pager): Remove. Replaced by report [section-pager-new].

2016-03-22  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (get_report_topology_response)
	(report [topology]): Remove. Templates are no longer used.

2016-03-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Remove is_object and is_string
	functions from gsa_graphics_base.js.

	* src/html/classic/js/greenbone.js: Add is_object, is_string, is_defined and
	has_value functions to the gsa namespace.

2016-03-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-create-permissions-form): Add caller
	param to multiple permissions form.

2016-03-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Refactor adding, updating,
	removing components and rows in a dashboard. Use consistend function names and
	parameters.

2016-03-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Use a consistent naming for our
	chart components. Use component instead of a mix of component and box.

2016-03-21  Benoît Allard  <benoit.allard@greenbone.net>

	Only run the po conversion programs if the right python module is
	installed.

	* FindPythonModule.cmake: Added
	* src/po/CMakeLists.txt: Make use of the new function.

2016-03-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Clarify loop iterator variable.

2016-03-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js,
	src/html/classic/js/gsa_bar_chart.js,
	src/html/classic/js/gsa_bubble_chart.js,
	src/html/classic/js/gsa_cloud_chart.js,
	src/html/classic/js/gsa_donut_chart.js,
	src/html/classic/js/gsa_gantt_chart.js,
	src/html/classic/js/gsa_h_bar_chart.js,
	src/html/classic/js/gsa_line_chart.js: Refactor calling the generate functions
	of a generator instance. Use a common argument order for alle generate
	functions. Call addMenuItems in the controller not in the generator. Pass the
	transformed data to generator.generator instead of transforming the data
	within this function.

2016-03-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js,
	src/html/classic/js/gsa_bar_chart.js,
	src/html/classic/js/gsa_bubble_chart.js,
	src/html/classic/js/gsa_cloud_chart.js,
	src/html/classic/js/gsa_donut_chart.js,
	src/html/classic/js/gsa_gantt_chart.js,
	src/html/classic/js/gsa_h_bar_chart.js,
	src/html/classic/js/gsa_line_chart.js: Refactor register_chart_generator to
	accept constructor functions. This allows to remove the explicit class
	generator functions.

2016-03-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Remove exporting functions to the
	global namespace. All our shared functions should be called via the gsa
	namespace.

2016-03-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Export default_column_label
	function to gsa namespace. This function is used within LineChartGenerator.

2016-03-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_gantt_chart.js: Store elements in the object
	instance instead of a variable in the generate function. This fixes the no
	update case.

2016-03-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js: Refactor LineChartGenerator
	to derive from BaseChartGenerator.

	* src/html/classic/js/gsa_graphics_base.js: Remove registration of
	LineChartGenerator from gsa_graphics_base.js. Also move  find_record_index
	function to gsa_line_chart.js because it is only used within
	LineChartGenerator.

2016-03-18  Benoît Allard  <benoit.allard@greenbone.net>

	* tools/po2json: Make executable

2016-03-18  Benoît Allard  <benoit.allard@greenbone.net>

	* src/gsad_omp.c (create_agent_omp): Prevent usage of sometimes
	  uninitialised values.

2016-03-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js: Mark static tile of BarChartGenerator
	as translateable.

2016-03-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_h_bar_chart.js: Refactor HorizontalBarChartGenerator
	to derive from BaseChartGenerator.

	* src/html/classic/js/gsa_graphics_base.js: Remove registration of
	HorizontalBarChartGenerator from gsa_graphics_base.js. Also move data_top_list
	function to gsa_h_bar_chart.js because it is only used within
	HorizontalBarChartGenerator.

2016-03-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_gantt_chart.js: Refactor GanttChartGenerator to
	derive from BaseChartGenerator.

	* src/html/classic/js/gsa_graphics_base.js: Remove registration of
	GanttChartGenerator from gsa_graphics_base.js.

2016-03-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js: Coding style++.

2016-03-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_cloud_chart.js: Refactor CloudChartGenerator to
	derive from BaseChartGenerator. Removed a lot of unused besides of duplicate
	code.

	* src/html/classic/js/gsa_graphics_base.js: Remove registration of
	CloudChartGenerator from gsa_graphics_base.js.

2016-03-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-login.css: Set fixed width and height for all login
	logo images because the size of an alternate image may be different.

2016-03-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-login.css: Remove invalid and unnecessary style for
	login logo image height and width from the login css file.

2016-03-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/gsad.xsl (login_page): Reformat login page to use column
	based layout. Also add buttons to login and login as guest.

	* src/html/classic/css/gsa-login.css: Remove obsolete styles from the login
	css file.

2016-03-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Remove margin from button class because
	with a margin they won't work within columns. Reduce also padding on both
	sides of the button by 5 pixel.

2016-03-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Add left and right padding to columns in
	the grid layout. Add offset classes to indent elements within the grid.

2016-03-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Add styles for generic formulars inspired
	by twitter bootstrap.

2016-03-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-base.css: Update styles for .button css class.

2016-03-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css, src/html/classic/css/gsa-base.css:
	Move generic css classes like element default styles, grid system and buttons
	to a new base css file.

	* CMakeLists.txt: Install new gsa-base.css file.

2016-03-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-login.css: Move greenbone log behind the login box
	when the screen size is reduced.

2016-03-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Allow @ in comment and tag_value.

2016-03-16  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Use own detector class for language
	detection in i18next javascript library. Read html tag property lang and
	fallback to http request headers if the lang property is not set. This will
	set the same language for javascript translations as used in xsl files.

2016-03-16  Björn Ricks <bjoern.ricks@greenbone.net>

	Update i18next javascript libraries

	* src/html/classic/js/: Remove map files because they aren't available in
	newer releases. Update i18next from 2.2.0 to 2.3.4. Update i18next-xhr from
	0.4.0 to 0.5.3. Update i18next-languagedetector from 0.1.0 to 0.2.2.

	* COPYING:  Update paths for i18next

	* src/html/classic/omp.xsl: Update versions of i18next js files in script
	tags.

	* CMakeLists.txt: Update installed version if i18next js libraries and only
	install minified versions in release mode.

2016-03-16  Sven Haardiek <sven.haardiek@greenbone.net>

	* COPYING:  Update some paths and add i18next

2016-03-16  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (key_prog_apps, report [prognostic_apps]):
	Look for CPE in "nvt" element instead of "cve".

2016-03-16  Björn Ricks <bjoern.ricks@greenbone.net>

	* INSTALL: Update text about the python polib requirement.

2016-03-16  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/po/CMakeLists.txt: Only run po2json to generate the javascript
	translations if a python interpreter has been found.

2016-03-16  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad.c (request_handler): Use new defines for checking user_find return
	values in request_handler function.

2016-03-16  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad.c (user_add): Imporve docstring for user_add function. Remove
	unnecessary setting of user->language. It has been overwriten by the later
	call to set_language_code function.

2016-03-16  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad_base.c (set_language_code): Update docstring of language paremeter
	for set_language_code function.

2016-03-16  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad.c: Remove unnecessary code after calling
	accept_language_to_env_fmt. accept_language_to_env_fmt always returns a
	language code in new allocated memory.

2016-03-16  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad.c: Update docstring of gsad_connection_info langauge parameter. The
	parameter will contain the language code and not the accept language header
	content.

2016-03-16  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad.c: Use new defines for checking user_find return values in
	exec_omp_post.

2016-03-16  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/xslt_i18n.c: Update docstring for accept_language_to_env_fmt function.
	Clarify the return value description.

2016-03-16  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad.c: Introduce defines for user_find return values. It is really hard
	to remember int return values of functions. Therefore rememberable names
	should be used always.

2016-03-15  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js: Refactor BubbleChartGenerator to
	derive from BaseChartGenerator prototype.

2016-03-15  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* ChangeLog: Fix filename in last entry for file
	src/html/classic/omp-doc.xsl.

2016-03-15  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/po/CMakeLists.txt: Remove generation of obsolete
	gsad_js-${LANG}-merged.po files.

2016-03-15  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp-doc.xsl (structure-line): Apply templates
	to filter_keywords element in attrib.
	(filter_keywords): New template.

2016-03-15  Björn Ricks <bjoern.ricks@greenbone.net>

	* tools/xsl2pot: Update coding style for pep8 requirements

2016-03-15  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js: Mark strings for translations.

2016-03-15  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Reload window after edit settings dialog has been
	closed and saved successfully.

2016-03-15  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/greenbone.js: Add "/" at start of i18next
	loadPath so it works correctly on help pages.

2016-03-15  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/po/CMakeLists.txt: Use .po files from source directory to create
	translation JSON files.

2016-03-14  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/po/gsad_js-de.po: Add a draft for German translation of javascript ui.

2016-03-14  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/po/CMakeLists.txt: Rebuild json translation files if po files have been
	changed.

2016-03-14  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Use gsad instead of gsa as namespace for
	translations. This allows to use the same filename pattern for the javascript
	and xslt translations.

2016-03-14  Björn Ricks <bjoern.ricks@greenbone.net>

	* tools/po2json: Only add messages to json file if they are translated. This
	allows to display the English text if no translation is available.

2016-03-14  Björn Ricks <bjoern.ricks@greenbone.net>

	* CMakeLists.txt, src/po/CMakeLists.txt: Add generation and installation of
	translation files for javascriot to cmake build files.

2016-03-14  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/po/gsad_js-de.po, src/po/gsad_js-ru.po, src/po/gsad_js-zh_CN.po: Add
	stubs for po file translations generated from javascript.

2016-03-14  Björn Ricks <bjoern.ricks@greenbone.net>

	* tools/po2json: Add python script to convert po files into json files that
	can be loaded by i18next.

2016-03-14  Björn Ricks <bjoern.ricks@greenbone.net>

	* tools/js2pot: Add script to extract translatable messages from our
	javascript files.

2016-03-14  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js, src/html/classic/js/gsa_graphics_base.js:
	Mark strings for translation.

2016-03-14  Björn Ricks <bjoern.ricks@greenbone.net>

	Add i18next library for translations in javascript code

	* CMakeLists.txt,
	src/html/classic/gsad.xsl,
	src/html/classic/js/greenbone.js,
	src/html/classic/js/lib/min/i18next-2.2.0.js,
	src/html/classic/js/lib/min/i18next-2.2.0.js.map,
	src/html/classic/js/lib/min/i18next-languagedetector-0.1.0.js,
	src/html/classic/js/lib/min/i18next-languagedetector-0.1.0.js.map,
	src/html/classic/js/lib/min/i18next-xhr-0.4.0.js,
	src/html/classic/js/lib/min/i18next-xhr-0.4.0.js.map: Add i18next library for
	translation support in our javascript files. The i18n translation function is
	exported as gsa._ to allow extracting via xgettext and to allow switching the
	i18n library easily if i18next doesn't fit to our requirements anymore. The
	i18next project only releases minified source code. This versions of the
	minified code are generated from corresponding git tags. The code itself is
	released under a MIT licence.

2016-03-14  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/: Move external javascript libraries to a new sub
	directory called lib. This will allow to better differentiate between external
	and our code.

2016-03-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/vul_report.svg: New.

	* CMakeLists.txt: Install the new icon.

	* src/html/classic/omp.xsl (report-section-header): Use the new icon
	for this section.

2016-03-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (prognostic_hosts, prognostic_apps): Change
	to new design using new toolbar and header templates.

2016-03-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Use the standard filter boxes for report section pages where applicable
	and add options for report filtering to them.  Change the report
	section pages to the new style overall.

	* CMakeLists.txt: Install new dropdown icon in classic face.

	* src/html/classic/img/style/dropdown_arrow_black.png: New icon.

	* src/html/classic/css/gsa-style.css (progressbar_box): Set display
	property to inline-block.
	(#report_section_list ul li a): Change text color to black.
	(#report_section_list ul li a#section_list_first)
	(#report_section_list:hover ul li a#section_list_first): Move arrow
	down 3 pixels and use black icon for inactive menu.
	(.ctrl-group, .ctrl-group .left-column, .ctrl-group .right-column):
	Use table and table-row display property instead of absolute
	positioning and margins.

	* src/html/classic/omp.xsl (filter-window-pager): Add special cases
	for type "report_result" so template can be used on report section
	pages.
	(filter-window-part): Add param "filter_options" to force options to
	be visible even if the keyword is missing.  Add param "filters" to
	give the list of all filters.  Limit size of text box showing "extra"
	filter keywords.  Add input fields for keywords "delta_states",
	"notes", "overrides", "result_hosts_only", "min_cvss_base", "min_qod",
	"timezone", "levels".
	(report [section-filter-restricted]): New template for "restricted"
	report section filter.
	(report [section-filter-full]): New template. Uses list-window-filter
	to create full report section filter box.
	(report [section-pager]): New template. Uses filter-window-pager
	to create pagination elements for report sections.
	(report [section-toolbar]): New template for icon and filter toolbar.
	(report-section-header): New template for main page header.
	(report [results], report [hosts], report [hosts], report [ports])
	(report [vulns], report [os], report [apps]): Change to new design
	using new toolbar, header and pager templates.
	(report-icons): Remove status bar, which was moved to the header line.
	(report [closed_cves], report [cves], report [ssl_certs])
	(report [errors], report [summary]): Change to new design using new
	toolbar, header and pager templates.

2016-03-09  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/os_arubanetworks.png,
	src/html/classic/img/os_checkpoint.png,
	src/html/classic/img/os_huawai.png,
	src/html/classic/img/os_ipfire.png,
	src/html/classic/img/os_mcafee.png,
	src/html/classic/img/os_ruggedcom.png,
	src/html/classic/img/os_sourcefire.png,
	src/html/classic/img/os_synology.png: New.

	* CMakeLists.txt: Install new icons.

2016-03-09  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Move filter box into toolbar
	so it does not overlap with title if window is not wide enough.

2016-03-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_result): Pass autofp, apply_override, notes
	and overrides to get_results as filter keywords, not as attributes.

2016-03-07  Benoît Allard  <benoit.allard@greenbone.net>

	* src/gsad.c (send_redirect_to_urn): Use the X-Forwarded-Protocol
	  header if present and valid.

2016-03-07  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/graphics.xsl: Don't use data source name twice. With the
	current implementation the data source name isn't that importent anymore but
	it is still a identifier and should't be reused.

2016-03-07  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Fix typo to pass correct sort
	field to the data source.

2016-03-07  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js, src/html/classic/js/gsa_graphics_base.js:
	Move declaration of gsa object into greenbone.js. The gsa object will be our
	common module in future.

2016-03-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-scan-management-top-visualization)
	(js-secinfo-top-visualization, dashboard [secinfo]): Add comments
	describing the chart setting parameters and change the defaults to be
	type-dependent.

2016-03-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_report): Add search_phrase to filter when
	building the filter and when it is given.

	* src/html/classic/gsad.xsl (html-gsa-navigation): Change overrides
	parameter of "Hosts (Classic)" link to apply_overrides.

	* src/html/classic/omp.xsl (assets, host [classic], report [assets]):
	Update paths of filter keywords and change overrides parameter to
	apply_overrides. Automatically submit the overrides
	switch. Update links to use apply_overrides and the "host" keyword for
	selecting report results. Apply the levels filter in the links.

2016-03-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (delete_trash_icon): Stay on tash page after
	deleting an item from the trash.

2016-03-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Fix layout of help icons in header of ldap and
	radius sections at the users list page.

2016-03-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Reload users list after a user has been deleted.

2016-03-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Refactor delete user confirm dialog to a new style
	dialog and update its layout to show the inherited user selection.

2016-03-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Fix applying postfix to delete commands
	via delete action icons.

2016-03-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js (relax_labels): Add some comment to
	the relax_labels function.

2016-03-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Fix color scale for severity donut
	charts.

2016-03-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js (generate): Define y_max and
	use correct variable self.y_field in tooltip text.

2016-03-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js: Refactor DonutChartGenerator to
	derive from BaseChartGenerator prototype.

2016-03-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js: Fix setting the correct constructor
	function. The constructor function is not important but may be used to
	identify an object.

2016-03-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (BaseChartGenerator): Add prototype
	method to run scaling color function.

2016-03-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Export fill_empty_fields and
	wrap_text to the gsa namespace.

2016-03-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (filter-criteria, filter-extra): Add equals
	sign to keyword with blank column if relation is "=".

2016-03-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js,
	src/html/classic/js/gsa_graphics_base.js: Register DonutChartGenerator in
	gsa_donut_chart.js now.

2016-03-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js: Add an anonymous self invoking
	function to gsa_donut_chart.js to create a "module".

2016-03-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js: Refactor BarChartGenerator to derive
	from BaseChartGenerator.

2016-03-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Remove obsolete BaseChartGenerator
	variable svg_transition_timeout. This variable was left over from refactoring.

2016-03-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Update last generator and last
	generator params in controller instead of letting the generator update them.

2016-03-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Add a BaseChartGenerator
	javascript "class" that provides all common chart generator functions.
	This will allow reusing common code paths for all chart generators in future.

2016-03-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Use the new filter syntax for report results in the filter box.

	* src/gsad_omp.c (get_report): Make apply_overrides a separate option
	from overrides. Use both filter and filter_extra to build filter. Add
	some keywords only if they are given when building from individual
	parameters.

	* src/gsad.c (init_validator): Replace the various "esc_..." parameters
	with "esc_filter".

	* src/html/classic/omp.xsl (filter-criteria, filter-extra): Add
	"notes", "overrides", "timezone", "result_hosts_only", "levels",
	"min_cvss_base", "min_qod" and "delta_states" as special keywords.
	(result-overrides-icon): Adapt to new filter response syntax in report.
	(report [filterbox]): Remove form tag, adapt to new filter syntax
	in report, add "Apply Overrides" input and remove "Search phrase".
	(report [results]): Adapt to new filter response syntax in report and
	add with-filterbox param to section-filter template call.
	(report [report]): Output filtered severity and result counts.
	(report [section-filter]): Add param "with-filterbox" to optionally
	add the extended filter box here so it can use the "Filter:" input.
	(full-report-export-form, filtered-report-export-form): Adapt to new
	filter syntax.
	(report [summary])): Adapt to new filter syntax and fix alignment
	of alert and export forms.

2016-03-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js: Fix missing renaming of public chart
	generator functions in line charts: show_loading -> showLoading,
	title -> setTitleGenerator, data_transform -> setDataTransformFunc and
	color_scale -> setColorScale.

2016-03-03  Benoît Allard  <benoit.allard@greenbone.net>

	Add a CMAKE option to disable the serving of static assets (raw files)
	by gsad. This option is disabled by default (no change in behavior),
	and can be enabled by passing '-DSERVE_STATIC_ASSETS=0' to the cmake
	call.

	* CMakeLists.txt, src/CMakeLists.txt, src/gsad.c: Updated.

2016-03-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (result [result-headers]): Disable link in
	solution type and QOD columns for delta reports, because Manager does
	not support sorting delta reports by these columns.

2016-03-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js,
	src/html/classic/js/gsa_bar_chart.js, src/html/classic/js/gsa_cloud_chart.js,
	src/html/classic/js/gsa_donut_chart.js,
	src/html/classic/js/gsa_gantt_chart.js,
	src/html/classic/js/gsa_h_bar_chart.js, src/html/classic/js/gsa_line_chart.js,
	src/html/classic/js/gsa_bubble_chart.js: Rename public chart generator
	functions: show_loading -> showLoading, title -> setTitleGenerator,
	data_transform -> setDataTransformFunc, bar_style -> setBarStyle and
	color_scale -> setColorScale.

2016-03-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js: Extract adding menu items to an own
	function.

2016-03-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js: Remove unused function
	relax_labels.

2016-03-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Don't register bar chart generator
	anymore. This is done in gsa_bar_chart.js now.

2016-03-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js: Use an internal object instead of a
	function for the returned generator.

2016-03-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js: Fix coding style to satisfy jshint and
	jscs. Also use global and gsa objects since gsa_bar_chart.js is a "module".

2016-03-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Export data_raw function also to
	gsa namespace.

2016-03-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js,
	src/html/classic/js/gsa_graphics_base.js: Move severity_bar_style function
	from gsa_bar_chart.js to gsa_graphics_base.js. It is used in several modules.
	therefore it should belong to gsa_graphics_base.js.

2016-03-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js: Put gsa_bar_chart code into an self
	invoking anonymous function to create a module.

2016-03-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Add copyright header to greenbone.js file.

2016-03-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Update coding style to satisfy jshint and
	jscs.

2016-03-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Pass global objects as parameters to the
	module function.

2016-03-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Add sort reverse by date to the links to the
	reports at the tasks list page. Reports should be sorted by date descending by
	default.

2016-03-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Fix layout of task selection in filter dialog.
	First don't let the dynamic select element hide the label and second don't
	show the selection if the response doesn't contain any tasks.

2016-03-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Fix layout of filter dialog. Don't float the
	filter udpate dialog content on the right side.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js: Use new setTitle function in
	BubbleChartGenerator.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Add dashboard_box setTitle
	function.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js: Refactor BubbleChartGenerator to
	use an internal object instead of an internal function.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js: Rename
	BubbleChartGenerator.create_bubble function into create_bubble. It is not
	necessary to attach the function to BubbleChartGenerator.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js,
	* src/html/classic/js/gsa_bubble_chart.js: Register the BubbleChartGenerator
	only once in the gsa_bubble_chart.js module.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Refactor registering and getting
	of chart generators. Add a gsa function to allow registering of a specific
	generator for a chart type. Also remove setting the title generator from the
	get_chart_generator function. Now the get_chart_generator only returns a
	generator for a chart type and nothing more.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/graphics.xsl (init-d3charts): Remove check and declartion
	of gsa.dashboards and gsa.data_sources javascript objects from init-d3charts
	xslt template. Both variables will always be initialized by
	gsa_graphics_base.js now.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/graphics.xsl: Update copyright year and add me as author.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_cloud_chart.js: Remove
	BubbleChartGenerator.create_bubble from gsa_cloud_chart.js. This function is
	already defined identically in gsa_bubble_chart.js.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js: Use gsa object to access shared
	functions from gsa_graphics_base.js. Also register BubbleChartGenerator
	temporarily in the global namespace.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Register more functions into the
	gsa "namespace".

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js: Update coding style in
	gsa_bubble_chart.js. Fix most warnings of jshint and jscs.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js: Convert gsa_bubble_chart.js into a
	sperate module by using an outer anonymous self invoking function.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_data_source): Merge
	create_aggregate_data_source function into create_data_source.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js,
	src/html/classic/js/gsa_bubble_chart.js: Start to export functions to gsa
	object instead of to the global namespace.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (on_ready): Handle all dashboard
	elements now. All xslt code has been migrated to javascript.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (unescapeXML): Rename unescapeXML
	function to unescape_xml.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Don't access global variables
	directly. Therefore pass the window object as parameter to the initialization
	function. Also access timout functions via the global parameter.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/.jshintrc: Update jshint config file. Don't allow global
	console and jquery access.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Don't pollute the global namespace
	by removing functions from the global namespace not used outside of
	gsa_graphics_base.js.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (js-tasks-chart-factory,
	js-tasks-data-source): Remove now unused and obsolete xslt templates for
	generating task charts. This code got replaced by a javascript
	implementation.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (js-aggregate-chart-factory,
	js-aggregate-data-source): Remove now unused and obsolete xslt templates for
	generating aggregate charts. This code got replaced by a javascript
	implementation.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (is_string): Fix checking the type
	of the passed parameter.

2016-02-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (get_aggregate): Use jquery to create aggreagte
	based charts for a detached window instead of generating javascript code
	directly.

2016-02-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Use jquery to create task based charts for a
	detached window instead of generating javascript code directly.

2016-02-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Add dashboard element data
	attributes to hide the controller selection and to resize a chart in a
	detached window automatically. This is both required for displaying detached
	charts.

2016-02-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Add function is_object for
	checking if a value is a JavaScript object. Use this function to create init
	and gen params of a chart. Both params must only be created if the element
	returns correct json in its corresponding data attributes.

2016-02-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Add function is_string for
	checking if a value is a JavaScript string.

2016-02-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Check more carefully for ''. null
	and undefined values. At several places the variable can be null or undefined.
	This fixes the resizing of the chart heights.

2016-02-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/graphics.xsl: Refactor secinfo charts to use jquery instead
	of beeing generated via xslt directly.

2016-02-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (field_name): Replace undescores
	with spaces for field names.

2016-02-25  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/gsad.xsl (html-gsa-navigation): Removed indention
	in menu "Configuration". Credentials are used in other places meanwhile
	so the indention does not make sense anymore.

2016-02-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/graphics.xsl: Fix reports high results timeline chart. Use
	correct element attribute name for data columns.

2016-02-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Use css class table-form for edit scanner
	preferences formular.

2016-02-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/graphics.xsl, src/html/classic/omp.xsl: Use jquery to
	create charts for scans tasks, results and reports instead of generating
	javascript via xslt.

2016-02-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Always hide dashboard-data-source and
	dashboard-chart elements.

2016-02-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (on_ready): Remove handler for
	dashboard-controller css class. The handler got replaced by
	dashboard-data-source and dashboard-chart.

2016-02-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/graphics.xsl: Use dashboard-data-source and dashboard-chart
	instead of dashboard-controller.

2016-02-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (on_ready): Add handler for
	dashboard-data-source and dashboard-chart css classes. This allows separation
	of data sources and its representation by different chart types.

2016-02-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_aggregate_data_source),
	src/html/classic/graphics.xsl: Remove special handling of info_by_class and
	info_by_cvss chart template types in create_aggregate_data_source. This will
	allow a better seperation between data source and chart controllers.

2016-02-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_aggregate_data_source):
	Register data source in create_aggregate_data_source.

2016-02-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_aggregate_data_source):
	Refactor create_aggregate_data_source to support also tasks besides
	aggregates.

2016-02-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (on_ready): Pass additional
	optional parameters to create_aggregate_data_source.

2016-02-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (get_chart_generator): Support
	gantt charts required for tasks dashboards.

2016-02-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (get_selector_label,
	get_title_generator): Add parameter type to get_selector_label and
	get_title_generator. The type parameter is required to support task charts.

2016-02-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (get_title_generator): Fix title
	generator for cloud chart types.

2016-02-19 Michael Meyer <michael.meyer@greenbone.net>

	* src/html/classic/os.xml:
	Added some CPEs.

2016-02-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (on_ready): Create init params and
	gen params for the chart controllers.

2016-02-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (on_ready): Pass all optional
	parameters to create_aggregate_data_source.

2016-02-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_aggregate_data_source):
	Allow to set sort_stat parameter for an aggregate data source.

2016-02-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (get_selector_label,
	get_title_generator): Allow to pass a titel text to get_selector_label and
	get_title_generator. If this parameter is set it will be used to set the
	selector label and title directly.

2016-02-25  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (edit-config-preferences)
	(preferences-details): Fix quote issue.

2016-02-25  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (edit-config-preferences)
	(preferences-details): Specify the target credentials to be used in
	credential_up case.

2016-02-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (edit-config-preferences)
	(preferences-details): Add target credentials case to osp_credential_up
	case.

2016-02-24  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Remove create functions from
	global object. We should not use this functions outside of gsa_graphics_base.

2016-02-24  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_dashboard): Move evaluation
	of optional parameters to init function.

2016-02-24  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_data_source): Refactor
	data source to use an internal object instead of an internal function.

2016-02-24  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_chart_controller): Refactor
	chat controller to use an internal object instead of an internal function.

2016-02-24  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Add controller showError function.
	The display should not be accessed directly.

2016-02-24  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Pass console as parameter to
	global anonymous wrapping function.

2016-02-24  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_dashboard_box): Refactor
	dashboard box to use an internal object instead of an internal function. Also
	rename dashboard_box.show_error to showError.

2016-02-24  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_dashboard_new_row_target):
	Refactor dashboard row target to use an internal object instead of internal
	function.

2016-02-24  Björn Ricks <bjoern.ricks@greenbone.net>

	Fix help pages icons

	* src/html/classic/img/secinfo.svg: Rename secinfo.svg to allinfo.svg. The
	info type for all sec info is allinfo. The info type is used at several places

	to create the links and icon locations for the help page.
	* src/html/classic/graphics.xsl: Use allinfo.svg instead of secinfo.svg.

	* src/html/classic/help.xsl: Update types for reports, results, oval defs and
	cert advisories. This fixes displaying the correct icon at the help pages.

	* src/html/classic/omp.xsl: Use allinfo as info type for all sec info. This
	fixes the link to the help page of all sec info.

	* CMakeLists.txt: Update installation of renamed secinfo.svg  file.

2016-02-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (edit-config-preferences)
	(preferences-details): Adjust osp credentials types names.

2016-02-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_dashboard_new_row_target):
	Use jquery to create add row div placeholder element.

2016-02-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (dashboard_box.show_error):
	text function is only available if it is a jquery or d3 element. Therefore
	for resetting the svg element it is converted to a d3 element.

2016-02-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_dashboard_new_row_target):
	Fix keeping the event handlers when moving a box to a new row at the top or
	bottom. If the element is deleted the box in the row has no click event
	handlers anymore.

2016-02-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Use jquery hide and show functions
	to show buttons when editing the dashboard.

2016-02-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Use javascript:void(0); for anchor
	links with click event handler. This avoids having to call
	event.preventDefault() and to scroll upwards on every click.

2016-02-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_dashboard_box): Refactor
	dasboard box to use init method and jquery for html manipulation.

2016-02-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_dashboard_row): Refactor
	dashboard row to use an internal object instead of internal function.

2016-02-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_dashboard): Move init
	function to the top. This allows to see what is happening first easily. The
	most important information (interface and initialization) is on top of the
	function now.

2016-02-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Hide and show add new component
	button if a component is added or removed dependend of maximum allowed
	components.

2016-02-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Move storing of the filters,
	controllers and heights strings into own functions. Remove saveFiltersString
	from public dashboard api. It is only used within the dashboard.

2016-02-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Use an order by date descending for links to
	report lists at the task detail page.

2016-02-23  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-permissions-form): Fix create multiple
	permission dialog by using new style popup dialog. Also remove unused code
	from the template.

2016-02-23  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/greenbone.js (FilterDialog.prototype.show):
	Rebuild select2 drop-down lists so they function correctly.

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (create_dashboard): Use an object
	to return for a new dashboard. This allows to view the complete interface of
	the dashboard.

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Use jquery each function to
	iterate over dashboard rows to update height, filters and controllers string.

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Store dashboard element as jquery
	object in dashboard.

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Use jquery for intializing
	dashboard buttons. We should use jquery for html manipulation and d3 only for
	charts.

2016-02-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (page_url_append_param): Remove.  No longer used.
	(get_one, get_task, get_config, get_report): Remove ID check, now that
	"create" pages no longer go to the created resource.

2016-02-22  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (edit-config-preference [edit-details]):
	Specify up credentials in dropdown for osp_credential_username and
	osp_credential_password parameters.

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/graphics.xsl: Set max components to 8 for secinfo
	dashboard.

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Rename ChartController to
	create_chart_controller and also rename the internal my function to
	controller.

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Rename DataSource to
	create_data_source. Also rename the internal my function to data_source.

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Rename create_data_source to
	create_aggregate_data_source. Currently this function is a special function to
	create a data source for aggregated charts.

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Rename DashboardBox to
	create_dashboard_box. The function is not used as a class. It is
	only a factory to return a new box for charts. Also rename the internal my
	function object to dashboard_box.

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Rename DashboardNewRowTarget to
	create_dashboard_new_row_target. The function is not used as a class. It is
	only a factory to return a new dashboard object for displaying a row
	container.

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Rename DashboardRow to
	create_dashboard_row. The function is not used as a class. It is only a
	factory to return a new dashboard row object.

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js
	(create_dashboard.dashboard.addNewRow): Refactor function to use an object as
	parameter. This allows passing only requried parameters.

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Rename Dashboard function to
	create_dashboard. The function is not used as a class. It is only a factory
	function. Also rename the internal my function object to dashboard which is
	the real dashboard object.

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Don't use typeof operator to check
	if global gsa object is initialized.

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Allow to pass all dashboard
	constructor parametes via html data attributes.

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Remove jshint warning about
	"Expected a conditional expression and instead saw an assignment.".

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Pass more globally used variables
	to encapsulating function. This allows a better minification and code
	separation.

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/.jshintrc: Update jshint config to ignore unused
	function parameters. Sometimes unused parameters are required for callbacks.
	Also don't allow to use variables before they have been defined. It is only
	allowed to access functions before they are defined.

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (DashboardBox.my.redraw): Fix
	redraw function of DashBoard. The used request_data function got renamed to
	sendRequest.

2016-02-22  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Don't add filterSelectElem change
	event listener if filterSelectElem is not set.

2016-02-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js:
	(DashboardBox.my.createFilterSelector): Don't use a string to create a
	javascript event handler. This is potentially insecure for script injection.
	We must change the generation of event handlers via a string on several
	additional code places later too.

2016-02-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/graphics.xsl (js-add-dashboard-filter): Remove theunsed
	and obsolete template js-add-dashboard-filter. The filters can be added
	via html class dashboard-filter now.

2016-02-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js, src/html/classic/graphics.xsl:
	Allow to init the secinfo dashboard per html class and data attributes. This
	removes the requirement of generating possible insecure javascript per xslt
	for the dashboard. Also it is easier to read and debug the code now.
	* src/html/classic/css/gsa-style.css: Hide new dashboard data elements.

2016-02-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (ChartController),
	src/html/classic/graphics.xsl: Remove the paramter add_to_display from
	ChartController. It is always true.

2016-02-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (Chart),
	src/html/classic/graphics.xsl: Rename Chart function into ChartController.
	Actually it is not the chart that displays the svg. It's the controller of
	the diagram.

2016-02-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (DataSource.my.checkRequest):
	Simplify code by storing the request controller object in a variable.

2016-02-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (DataSource.my.sendRequest): Rename
	function parameter chart to controller. We should use a consistend naming
	scheme.

2016-02-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Rename request_data functions to
	sendRequest.

2016-02-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (Chart): Don't pass this to
	functions. this may point to an unwanted object in special cases. Therefore
	pass the my function object instead.

2016-02-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (DataSource): Reload window to show
	login page when an ajax request for data returns 401 (Authentication
	Required).

2016-02-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (Dashboard): Move the actual saving
	of the filters string into an own function.

2016-02-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (Dashboard): Fix checking if
	heigtsString and FiltersString must be updated.

2016-02-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (Dashboard): Ensure that
	heightsString variable is always a string.

2016-02-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Update coding style.

2016-02-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/graphics.xsl, src/html/classic/js/gsa_graphics_base.js:
	Initialize global gsa objects carefully. We can't ensure the loading order.

2016-02-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Allow stopping scheduled Tasks on details page.

	* src/html/classic/omp.xsl (task-icons): Add new parameter
	show-stop-when-scheduled for showing stop button for scheduled tasks.
	(task [details]): Add show-stop-when-scheduled param to task-icons.

2016-02-19 Michael Meyer <michael.meyer@greenbone.net>

	* src/html/classic/os.xml:
	Added Cisco ADE-OS.

2016-02-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (response_from_entity): Do not set no_redirect on
	errors.

	* src/html/classic/js/greenbone.js (OMPDialog.prototype.postForm): Add
	no_redirect parameter.

2016-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_task): Provide sensible defaults for config and
	target.
	(new_target): Provide sensible defaults for port list.

	* src/html/classic/wizard.xsl (quick-task-wizard): Correct empty
	config_id check.

2016-02-18  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator): Add parentheses to ifaces_allow regexp.

2016-02-18  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_report): Build filter term instead of using old
	separate command attributes.

2016-02-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/wizard.xsl (modify-task-wizard): Use the datepicker jquery
	ui element also in the modify task dialog to create a schedule.

2016-02-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/wizard.xsl,
	src/html/classic/js/greenbone.js,
	src/html/classic/css/gsa-style.css: Use datepicker for date selection in
	advanced task wizard. The new datepicker activation is a bit more flexible as
	before by using class attributes instead of hardcoded ids and input names.

2016-02-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/wizard.xsl: Remove extra "Create Task" button from advanced
	task wizard.

2016-02-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Keep the current filter when deleting a host.

2016-02-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Change import report dialog into an new style
	dialog to fix layout issues.

2016-02-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad_omp.c (delete_asset_omp): Use PRG (Post-Request-Get) pattern when
	deleting an asset.

2016-02-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Remove "Import Report" content from task detail
	page. Importing a report should be done via the upload icon at the icon
	toolbar.

2016-02-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad.c (request_handler): Fix setting the content type
	to application/xml only if xml_flag param is set in POST requests.

2016-02-17  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Change user edit dialog into an new style dialog
	to fix layout issues.

2016-02-17  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/gsad.xsl (html-gsa-navigation): Renamed menu item
	"SecInfo Dashboard" to simply "Dashboard".

2016-02-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-task-alert): Add missing colon.

2016-02-15 Michael Meyer <michael.meyer@greenbone.net>

	* src/html/classic/os.xml:
	Added Cisco UCOS.

2016-02-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_container_task_omp): Send Auto Delete params with
	MODIFY_TASK.

2016-02-12  Matthew Mundell <matthew.mundell@greenbone.net>

	Add task preference for auto deleting reports.

	* src/gsad.c (init_validator): Add auto_delete and auto_delete_data.

	* src/gsad_omp.c (create_task_omp, save_task_omp): Pass auto delete
	parameters to OMP.

	* src/html/classic/omp.xsl (task [details], new_task)
	(html-edit-task-scan-options): Add field Auto Delete Reports.

2016-02-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/css/gsa-style.css (html): Add "overflow-y: scroll"
	to always show scrollbar, preventing sudden, often difficult to handle
	changes in page width due to the scrollbar appearing or disappearing.

2016-02-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (DataSource): Remove unused
	functions data_uri and last_uri. Fix sending OMP errors to controllers.

2016-02-12  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Remove event listener for
	DOMSubtreeModified. It was introduced to act on appearing scrollbars to resize
	the graphs. But the event is fired many many time even when hovering over our
	menu. Therefore the javascript performance is very poor on slow machines.
	Currently no JavaScript standard for listining on appearing or hiding
	scrollbars exists.

2016-02-11  Björn Ricks <bjoern.ricks@greenbone.net>

	Adjust javascript coding style settings

	* src/html/classic/js/.jshintrc: Allow to create javascript uris.
	* src/html/classic/js/.jscsrc: Allow usage of Number and String without new,
	disallow spaces before commas and require all object keys to be one one line
	or each at a seperate line.

2016-02-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Update Copyright and add me as an
	author.

2016-02-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js: Update JavaScript code for new
	coding style requirements. This fixes most errors and warnings of jshint and
	jscs.

2016-02-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsad.xsl (i18n_po_path): Remove. No longer used.

2016-02-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/help.xsl (my_settings.html): Add help for settings
	"Dynamic Severity" and "Default Severity".

2016-02-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/.jshintrc: Remove setting for ECMA script version 5. Its
	the default for jshint.

2016-02-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/.jscsrc: Add a config for jscs (http://jscs.info). jscss
	a code style linter/formatter.

2016-02-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classis/js/gsa_graphics_base.js: Use self invoking function to
	create a javascript "module". Also use strict mode to ensure we are using es5
	(for details see
	http://ejohn.org/blog/ecmascript-5-strict-mode-json-and-more/).

2016-02-10  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/graphics.xsl: Remove unused template js-create-chart-box.

2016-02-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (create_credential_omp): Allow creating SNMP
	credentials without privacy params.
	(save_credential_omp): Add case for empty privacy_algorithm.

	* src/gsad.c (init_validator): Allow empty credential_login and
	privacy_algorithm.

	* src/html/classic/omp.xsl (html-create-credential-form)
	(html-edit-credential-form, credential [details]): Add "None" option
	for privacy algorithm.

2016-02-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_config_family): Request timeout and set
	preferences_config_id, so that the config's timeout is returned.

	* src/html/classic/omp.xsl (edit-config-family): Get the config's actual
	timeout, now that it is available in the "all" list of NVTs.

2016-02-09 Michael Meyer <michael.meyer@greenbone.net>

	* src/html/classic/os.xml: Added Cisco CNU-OS.

2016-02-09  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css, src/html/classic/omp.xsl: Fix layout of
	icons at the gb_window_part_center element. It would be better to rework this
	layout completely but we'll get rid of the gb_window usage in future.

2016-02-08  Benoît Allard  <benoit.allard@greenbone.net>

	* src/gsad.c: Move the handling of the /login/login.html page out of
	  file_content_response.

2016-02-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js (generate),
	src/html/classic/js/gsa_bubble_chart.js (generate),
	src/html/classic/js/gsa_cloud_chart.js (generate),
	src/html/classic/js/gsa_donut_chart.js (generate),
	src/html/classic/js/gsa_gantt_chart.js (generate),
	src/html/classic/js/gsa_h_bar_chart.js (generate),
	src/html/classic/js/gsa_line_chart.js (generate): Reset html_table_url
	so the HTML table is updated when filter is changed.

2016-02-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Reenable highlighting of the hovered
	main menu entry.

2016-02-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css (.footer): Adjust margins for the footer.

2016-02-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Reorder css definitions for main menu
	(gb_menu).

2016-02-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Remove unnecessary style declartions.

2016-02-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Fix width of highlighted entries in the
	main menu (gb_menu).

2016-02-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (Dashboard): Wait until
	page is loaded before adding resize and DOMSubtreeModified listeners.

2016-02-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/css/gsa-style.css (.progressbar_box): Use value
	content-box for box-sizing here to correct sizes of progress bars.

2016-02-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js (BarChartGenerator):
	Initialize x and width of bars in generate function.

	* src/html/classic/js/gsa_h_bar_chart.js (HorizontalBarChartGenerator):
	Initialize y and height of bars in generate function.

2016-02-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (alert [details]): In the Method field, use
	"list of resources" for SecInfo in the Send case.  For SecInfo in the
	Email case also include the Content, Subject and Message, because these
	can be edited now.

2016-02-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Adapt width of dashboard box placeholder to available space.

	* src/html/classic/css/gsa-style.css: Add new rules for
	dashboard-placeholders in rows with .num-components-N class, N being
	a number from 1 to 4.
	(.dashboard-placeholder): Set default width to 100%;

	* src/html/classic/js/gsa_graphics_base.js
	(Dashboard.updateComponentCountClasses): New function
	(DashboardRow.updateComponentCountClasses): New function.
	(DashboardRow.updateComponents): Call updateComponentCountClasses.
	(DashboardRow.startEdit): Call updateComponentCountClasses of dashboard
	on change.

2016-02-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (edit-config-family): Reload parent dialog if edit
	scan config familiy has been saved successfully.

2016-02-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (user-tags-window-checked): Allow to toggle user
	tags section in detail views.

2016-02-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Fix layout of tag section in new task dialog.

2016-02-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Fix layout of action icons at the trashcan page.
	Also remove direct style formatting and obsolete values.

2016-02-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/css/gsa-style.css (chart-top-buttons): Remove now
	superfluous margin.

	* src/html/classic/js/gsa_graphics_base.js (DashboardBox): Adjust SVG
	element size to new box-sizing.

2016-02-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-override-form): Fix layout of the edit
	override dialog by using the table-form css class. Also remove the deprecated
	td attributes.

2016-02-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsad.xsl (html-head): Add "Content-Type" meta tag
	because the one added implicitly otherwise is not closed correctly.

2016-02-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (Dashboard): Fix check for
	height changes.
	(DashboardBox): Calculate width according to new box-sizing.

	* src/html/classic/css/gsa-style.css (.chart-head, .chart-top-buttons):
	Adjust height and padding to new box-sizing.
	(.dashboard.edit .chart-head): Add "-webkit-grab" cursor in case "grab"
	does not work, e.g. in Chrome.

2016-02-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (edit-families-family): It is not required to set
	an empty data-done attribute on action icons anymore. In fact setting the
	data-done attribute prevents reloading the parent dialog or window now.

2016-02-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/greenbone.js: Fix toggling sections via ToggleIcon class.
	Store the correct current collapsed state in the local storage of the browser.

2016-02-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/greenbone.js: Update coding style to reduce jshint
	warnings. Use ' instead of ", always use {} for if, for, while. Remove unsed
	variables. Use === and !=== for comparisions (see
	https://javascriptweblog.wordpress.com/2011/02/07/truth-equality-and-javascript/).

2016-02-04  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/.jshintrc: Add a config file for jshint (javascript
	linter).

2016-02-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add filter selection dropdowns on SecInfo dashboard. Remove test output
	and prevent unnecessary update events. Remove unused "Display".

	* src/gsad_omp.c (dashboard): Select filters with empty type as well.

	* src/html/classic/graphics.xsl (js-add-dashboard-filter): New template.
	(dashboard [secinfo]): Add filter selection for charts and define
	the defaultControllerString.

	* src/html/classic/js/gsa_graphics_base.js (Dashboard): Add filter
	selection. Remove debug output used for testing. Have controller and
	filter selection elements only active after initialization. Fix resized
	event handler.
	(DashboardRow): Add filter selection.
	(DashboardBox): Add filter selection and activation of select dropdowns.
	(Chart): Make id more unique and add filter selection.
	(DataSource): Add filter selection and manage data for multiple filters.
	(Display): Remove. Obsoleted by DashboardBox.

2016-02-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (preference): Use edit dialog to change the
	preferences of a nvt.

2016-02-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (preference): Open link to nvt details in a new
	browser tab if nvt preference is displayed in a dialog.

2016-02-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (alert [details]): In the "Send to host"
	case, leave out the report format, because it's not used.

2016-02-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (alert): Use type-name-plural for Updated
	case of 'New SecInfo arrived' too.

2016-02-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/wizard.xsl: Use new edit-dialog css classes for the wizard
	dialogs.

2016-02-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/wizard.xsl: Fix modify task wizard by using the new
	css column layout.

2016-02-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/greenbone.js: Update coding style: Use camelCase for
	methods and underscore for functions in JavaScript.

2016-02-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/greenbone.js: Remove unused function isStatusOk.

2016-02-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Reload window if main dialogs for creating or
	editing resources are closed. This will display the changes afterwards.

2016-02-03  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/greenbone.js (init_omp_dialog): Don't reload the page or
	dialog of a done element is set. The done element is used to add an entry to
	the parent dialog dynamically.

2016-02-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/greenbone.js (OMPAction.prototype.do): Don't use redirect
	for POST in OMPActions. The PRG pattern is not required for ajax requests
	and only causes a higher latency.

2016-02-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Set text color for link button. This
	avoid having a blue text color applied from a:link to a button.

2016-02-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-role-form): Refactor edit role
	formular to use the dialog action for submitting the post requests
	asynchronously.

2016-02-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-role-form): Fix creating permissions
	from the edit role formular. The parameter role_id got renamed to
	permission_role_id.

2016-02-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-role-form): Change edit role form into
	and edit dialog.

2016-02-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-port-list-form): Fix disabling the new
	port range button only if the port list is in use.

2016-02-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Add generic style for buttons. This
	style will allow to render button, anchor and input elments with the same
	layout.

2016-02-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad.c (request_handler): Respect xml parameter also for POST responses.

2016-02-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/greenbone.js, src/html/classic/omp.xsl: Rename css class
	dialog-delete-action to dialog-action. This css class is used to apply a
	OMPAction to the element.

2016-02-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/greenbone.js: Don't pass cmd option to OMPAction. This
	option isn't used anymore.

2016-02-02  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/greenbone.js: Don't set datatype for ajax requests.
	Datatype is intended to override the response content type explicitly.

2016-02-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-role-form): Use new OMPAction to
	delete general command permissions in the edit role dialog.

2016-02-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/greenbone.js: Avoid duplicate code by merging the two error
	handling methods of OMPDialog.

2016-02-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-port-list-form): Use new OMPAction to
	delete port ranges in the port edit dialog. Using the OMPAction allows to
	send the delete request asynchronously and refresh the edit dialog on
	success.

2016-02-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/greenbone.js: Add new OMPAction class to allow sending
	formulars via ajax.

2016-02-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/greenbone.js: Refactor setting the error from a 4XX
	response into an own method of OMPDialog.

2016-02-01  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl(html-edit-port-list-form): Only show add new port
	range if port list is not in use.

2016-01-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (params_mhd_validate_values, params_mhd_validate): Before
	calling openvas_validate, check that the param is valid UTF-8.  This
	prevents the Glib functions from running on invalid UTF-8, which can
	lead to segfaults, and so can be used to bring GSA down.

2016-01-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Close connection if "url" is not valid
	UTF-8.  This prevents Glib from segfaulting when printing the URL to the
	login page XML, which could be used to bring GSA down.

2016-01-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Check that params has been setup before
	accessing param "cmd", because in some cases params is still NULL.
	Prevents a Glib critical error due to accessing NULL as a hashtable.

2016-01-29  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (name="include-message-default")
	(name="attach-message-default"): Removed the sentence about
	scan engine.

2016-01-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Reload parent dialog after adding a port range
	successfully.

2016-01-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Reload window after closing the dialogs
	from the main icon menu successfully.

2016-01-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Refaktor OMPDialog to use a more
	generalized option for reloading after success. Currently the option accepts
	two values: 'window' and 'parent'.

2016-01-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-port-list-form): Refactor edit port list
	to open up a child dialog for adding a new port range.

2016-01-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Introduce a template for displaying a form to
	add a new port range to a port list.

2016-01-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad.c, src/gsad_omp.c, src/gsad_omp.h: Introduce a new_port_range omp
	command. This command is intended to only return html for adding a new port
	range.

2016-01-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (init_omp_dialog): Don't reload the
	browsers window if a child dialog wants to reload only the parent dialog.

2016-01-29  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (init_omp_dialog): Allow to overwrite
	parent reload option via the data-parent-reload attribute on the button
	element. With this change a button for a new dialog can decide weather a
	parent dialog should be reloaded after the new dialog is closed.

2016-01-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl (html-edit-alert-form): Correct name of
	message fields under the "include" radio.

2016-01-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl (help [new_alert.html]): Add new $
	variables.

2016-01-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Add an own template for editing scan config nvts.
	This allows displaying a different content when editing a scan config nvt in
	a dialog.

2016-01-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-create-alert-form): Add count and date
	to SecInfo subject.

2016-01-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (preferences-edit-details): Remove the submit
	button from the template. The template is used within an edit dialog.
	Therefore no submit button is necessary anymore.

2016-01-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Split editing a scan config nvt into an own
	template. The new template is used to display an edit dialog.

2016-01-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Pass oid to edit config nvt dialog formular.
	The oid is required to find the corresponding nvt.

2016-01-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Fix bulk action dialogs which are using
	POST as http method.

2016-01-28  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog.prototype.set_error_content):
	Fix getting the content of an error response in an OMPDialog.

2016-01-27  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl, src/html/classic/js/gsa_graphics_base.js,
	src/html/classic/css/gsa-style.css: Rename csss class gsa_footer to
	gsa-footer. We should use a common naming scheme for all css classes.

2016-01-27  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Allow to toggle sections in edit scan config
	dialog.

2016-01-27  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Update paddings and margins after adding
	the gsa-main container.

2016-01-27  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/gsad.xsl (envelope): Put main content in an extra diff with
	class gsa-main. This allows easier stlying (padding, margin, ...) of all
	contents without having to touch the xsl.

2016-01-27  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (init_omp_dialog): Pass parameters as
	object to init_omp_dialog. Add new optional parameter parent_reload. This
	allows disabling of reload for create new OMPDialogs.

2016-01-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Refactor OMPDialog to allow reloading a
	parent dialog after its child is closed.

2016-01-26  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Change OMPDialog constructor function to
	accept an object instead of parameters. This allows easier handling of
	optional parameters.

2016-01-26  Benoît Allard  <benoit.allard@greenbone.net>

	* src/gsad.c: Optimize that one case where the buffer is actually
	  persistent.

2016-01-26  Benoît Allard  <benoit.allard@greenbone.net>

	* src/gsad.c: Re-introduce MHD_HTTP_METHOD_NOT_ACCEPTABLE for when the
	  library doesn't define it (yet).

2016-01-26  Benoît Allard  <benoit.allard@greenbone.net>

	* src/gsad.c: Fix usage of deprecated symbol MHD_HTTP_METHOD_NOT_ACCEPTABLE

2016-01-26  Benoît Allard  <benoit.allard@greenbone.net>

	* src/gsad.c: Fix usage of deprecated function MHD_create_response_from_data

2016-01-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Refactor toggling of sections via icon
	click. Move existing functions into a class. Also remove obsolete code for
	gsa.displays. Add an element data variable (collapsed) for setting the initial
	state of the toggle.

2016-01-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (edit-config-family): Update edit scan config
	family to new html structure for using it within a javascript OMPDialog.

2016-01-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog.prototype.show): Show login page
	when session has expired and a 401 is returned to a dialog request.

2016-01-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog.prototype.show): Remove all
	submit buttons from the OMPDialog not only the first one. In a dialog no
	button should be shown beside the main dialog button.

2016-01-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog.prototype.show): Introduce new
	html content structure for edit dialogs. A new edit dialog should have the
	structure <div class="edit-dialog"><div class="title">...</div><div
	class="content">...</div></div>.

2016-01-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Allow user to specify email subject and content for SecInfo alerts too.

	* src/html/classic/omp.xsl (include-message-default-secinfo)
	(attach-message-default-secinfo): New variables.
	(html-create-alert-form, html-edit-alert-form): Add two subject fields,
	one task case and one secinfo case.  These are hidden according to the
	event type.  Same for message and message radio.

	* src/html/classic/js/greenbone.js (editAlertUpdateForm): Adjust email
	subject and content fields according to event type.

2016-01-25  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Split html-config-family-table into two templates.
	The existing html-config-family-table displays the details and
	edit-config-familiy the edit page now. This will allow to render a different
	html structure for our edit dialog in future.

2016-01-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog.prototype.show): Refactor
	done_func to allow handling of other response content then a html page with
	gb_window in future.

2016-01-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Fix displaying the action icons in one row at the
	report details page.

2016-01-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl, src/html/classic/wizard.xsl: Remove direct style
	attributes for adding icon margins.

2016-01-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl, src/html/classic/help.xsl: Fix usage of .icon-lg
	and remove usage of #small-icon.

2016-01-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl, src/html/classic/graphics.xsl: Remove direct style
	for big icons in the section header.

	* src/html/classic/css/gsa-style.css: Remove now obsole #big-icon css
	definition.

2016-01-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Remove direct style for small icons in the section
	header.

	* src/html/classic/css/gsa-style.css: Remove now obsole #small-icon css
	definition.

2016-01-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Remove direct style for section header info boxes
	at the right of the detail pages. Use new css class section-header-info
	instead.

	* src/html/classic/css/gsa-style.css: Introduce new css class
	section-header-info.

2016-01-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-config-family-table): Refactor scan config
	family details to use new layout.

2016-01-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Fix marging for help and new taks
	icon by using the icon css class.

2016-01-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Make the my_setting icon on help page work.

	* src/html/classic/img/mysettings.svg: Renamed to
	my_setting.svg.

	* src/html/classic/img/my_setting.svg: New, see above.

	* CMakeLists.txt, src/html/classic/omp.xsl: Adjust filename accordingly.

2016-01-21  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Fix rendering the detail table action icons. Put
	them into one row again.

	* src/html/classic/css/gsa-style.css: Introduce new css class table-actions.
	This css class is intended to be used within detail tables for styling icon
	buttons.

2016-01-20  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Update coding style and make jshint happy.

2016-01-20  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-config-nvt-table): Refactor scan config nvt
	details page to use the new layout.

2016-01-20  Björn Ricks <bjoern.ricks@greenbone.net>

	Refactor using icons as action buttons

	* src/html/classic/omp.xsl: Remove the direct formatting via style
	attributes for several icons. Especially in the section headers.

	* src/html/classic/css/gsa-style.css: Introduce icon and icon-action css
	classes for formatting icon button at secion headers and in toolbars.

2016-01-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Refactor initializing of OMPDialogs. Use a
	common function for edit, create, upload and delete dialogs. This reduces the
	code duplication for initializing the dialog.

2016-01-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Add style to set the maximum height of a
	dialog. If the content is larger then the maximum height scrollbars should be
	shown.

2016-01-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl(delete_user, report, process_bulk): Remove usage of
	deprecated <center> element for styling.

2016-01-19  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Add css classes for text layout. Set a
	better default for paragraph elements. A paragraph should only have a margin
	on the bottom.

2016-01-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Remove usage of <br/> for paragraph layouts.

2016-01-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Don't use <br/> for rendering comments in task
	details.

2016-01-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Fix calculating the width of icon actions after
	using box-sizing: border-box by default.

2016-01-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Remove #wizardess css styles.

	* src/html/classic/wizard.xsl: Refactor advanced create task dialog to use new
	grid layout and table form.

2016-01-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Set a common width for all select2 drop
	down boxes. For a unified layout and easier reading all selects should have
	the same width in table bases formulars.

2016-01-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Introduce a draft for a grid layout
	similar to bootstrap (http://getbootstrap.com/css/#grid) or
	skeleton (http://getskeleton.com/#grid).
	This new grid system is intended to replace our table based layout in future.

2016-01-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Reorder CSS declarations. First define
	standard element styles for normalization. Afterwards introduce new css
	classes.

2016-01-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Use common css classes pull-right and
	pull-left for floating. Remove float_left and float_right classes.

	* src/html/classic/omp.xsl, src/html/classic/help.xsl,
	src/html/classic/help_de.xsl, src/html/classic/help_ru.xsl,
	src/html/classic/help_zh_CN.xsl: Always use pull-right and pull-left css
	classes for floating. Remove usage of direct styles for floating from all
	elements.

2016-01-18  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/css/gsa-style.css: Set default box width and height
	calculation model to the more intuitive border-box mode. For details please
	take a look at https://css-tricks.com/box-sizing/

2016-01-15  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/wizard.xsl: Remove usage of <br/> elements for formatting.
	<br/> should only be used in texts for an explicit line break after a word or
	sentence but not to ensure an empty line for a paragraph.

2016-01-15  Björn Ricks <bjoern.ricks@greenbone.net>

	Remove usage of obsolete border attribute

	* src/html/classic/css/gsa-style.css: Disable border for all tables.

	* src/html/classic/omp.xsl, src/html/classic/wizard.xsl: Remove all
	occurences of the border attribute. This html attribute should not be used
	anymore.

2016-01-15  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/classic/omp.xsl (get_info_response): Fix typo in message.

2016-01-15  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-target-form): Add new action icons
	for creating port lists and credentials in a sub dialog to the edit target
	dialog.

2016-01-15  Björn Ricks <bjoern.ricks@greenbone.net>

	Improve the edit task dialog.

	* src/html/classic/omp.xsl: Use new table-from css class for the edit task
	dialog. Add new action icons to allow creating of schedules, alerts, etc.
	directly from within the edit task dialog.

2016-01-15  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Add an entity selector for newly created
	scan config. This allows selecting the new scan config after they have been
	created in a sub dialog.
	Also add a console warning if a entity selector is missing.

2016-01-15  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/gsa-style.css: Display a pointer mouse cursor on
	pause/resume button at the info dialog.

	* src/html/classic/js/greenbone.js: Use progress mouse cursor in the new info
	dialog instead of wait.

2016-01-15  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl, src/html/classic/wizard.xsl: Remove "(optional)"
	term from all field labels. With our new dialogs it is much more obvious which
	fields are optional.

2016-01-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (dashboard [secinfo]): Show dashboard
	again without filter selection.

2016-01-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/wizard.xsl (name="wizard"): Rewrite the text,
	move the wizard icon top left and make the text available to
	translations.

2016-01-14  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl: Remove "(optional)" term from comment fields
	labels. By default all comments are optional.

2016-01-14  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/omp.xsl (html-create-target-form): Add buttons to create
	credentials directly from the new target dialog.

2016-01-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (Chart.detached_url)
	(create_uri): Encode individual components instead of whole string so
	ampersands and other special character are also encoded.

2016-01-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-aggregate-chart-factory)
	(js-tasks-chart-factory): Unescape extra gen_params.

	* src/html/classic/js/gsa_graphics_base.js (Dashboard.resized): Fix
	height check.

2016-01-14  Björn Ricks <bjoern.ricks@greenbone.net>
	Introduce a new info dialog

	* src/html/classic/css/gsa-style.css: Add icon-lg css class for large icons
	with size of 50x50 pixels. Also add styles for the new info dialog.

	* src/html/classic/img/pause.png: Add new button for pause actions.

	* src/html/classic/img/wizard.svg: Add a svg version of the wizard icon to
	allow scaling of the icon.

	* CMakeLists.txt: Install pause.png and wizard.svg.

	* src/html/classic/js/greenbone.js: Add new InfoDialog class for displaying
	a help text within a dialog. It is possible to use a timeout to close the
	dialog automatically. The timeout can be pause and resumed afterwards.

	* src/html/classic/wizard.xsl: Display an info dialog if the user has not
	created any tasks yet.

2016-01-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js (generate): Fix updating of
	markers.

2016-01-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/css/gsa-style.css (.dashboard.edit .chart-head): New
	rule to show a "grab" cursor on dashboard box headers in edit mode.

2016-01-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Save dashboard row heights, fix resizing of detached chart and add some
	missing unescaping.

	* src/html/classic/graphics.xsl (js-aggregate-chart-factory)
	(js-tasks-chart-factory): Unescape init params and selector label.
	(js-scan-management-top-visualization, js-secinfo-top-visualization):
	Rename default_components to default_controllers, add row heights
	setting ID parameter for Dashboard.

	* src/html/classic/omp.xsl (get_tasks_chart, get_aggregate): Add
	heights parameter for Dashboard. Run fit_detached_window after page is
	loaded and run resize listener once automatically.

	* src/html/classic/js/gsa_graphics_base.js (Dashboard): Add parameter
	"heightsString" and dashboardOpt "heightsPrefID".
	(Dashboard.updateControllersString): Do not delete controllersString.
	Check component count instead of rowControllersString to test whether
	to insert separator.
	(Dashboard.updateHeightsString): New function.
	(Dashboard.updateRows): Update heights string if applicable.
	(Dashboard.newComponent): Do not apply Select2 here.
	(Dashboard.resized): Add parameter to also check height.
	(Dashboard.resize): Set row heights if the heightsString is null.
	(Dashboard.initComponentsFromString): Process heightsString to set
	row heights if available.
	(DashboardRow.height): New function.
	(DashboardRow.updateControllersString): Do not delete controllersString.
	(DashboardRow.updateComponents): Do not delete components.
	(DashboardRow.startEdit): Update heights string on resize stop.
	(DashboardBox.redraw): Apply Select2 here.
	(DashboardBox.updateControllerSelect): Do not apply Select2 here.
	(DashboardBox.applySelect2): New function.
	(detached_chart_resize_listener): Remove debug output and call
	resized function on dashboard.

2016-01-14  Björn Ricks <bjoern.ricks@greenbone.net>

	Use a common layout for create and edit dialogs based on css.

	* src/html/classic/css/gsa-style.css: Add additional styles for table based
	formulars to align its elements.

	* src/html/classic/omp.xsl: Refactor create and edit dialogs to use a common
	layout. The new layout removes the usage of deprecated html attributes (like
	e.g. valign or cellspacing) and fixes the vertical alignment of radio-,
	checkboxes and images.

2016-01-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator): Correct regular expressions for
	"cmd", "auth_algorithm", "boolean", "min_cvss_base", "day_of_month",
	"hosts_allow", "month", "package_format", "port_type",
	"privacy_algorithm" and "calendar_unit".

2016-01-13  Matthew Mundell <matthew.mundell@greenbone.net>

	Prevent a few segfaults when OMP server is down.

	* src/gsad_omp.c (omp, ompf): Add success return to doc.
	(save_report_format_omp): When saving a parameter give up instead of
	continuing, so that the user at least knows that the parameter was not
	changed.  Add note about checking response.  When saving report format
	use ompf response when ompf returns -1, because there is no entity.

2016-01-13  Matthew Mundell <matthew.mundell@greenbone.net>

	Extend the NVT alerts to any SecInfo type.

	* src/gsad_omp.c (append_alert_event_data): Add 'secinfo_type'.
	(create_alert_omp, save_alert_omp): Update event names.

	* src/html/classic/js/greenbone.js (window.editAlertUpdateForm): Update
	event name.

	* src/html/classic/omp.xsl (html-create-alert-form): Update event name.
	Add type dropdown.  Add "details=1" to "details_url".
	(html-edit-alert-form): Update event names.  Specify name for 'status'.
	Add type dropdown.
	(alert): Add type.  Put status on same line as event name.
	(condition): Update event name.
	(alert [details]): Add SecInfo to name.  Update event names.

2016-01-13  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Add entry selectors for new slaves and
	schedules.

	* src/html/classic/css/gsa-style.css: Set mininum width of select elements in
	table based forms.

	* src/html/classic/omp.xsl: Add "new action" icons for schedule and slaves to
	new task dialog.

2016-01-13  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/js/greenbone.js: Update OMPDialog to use Post-Redirect-Get
	pattern. This fixes selecting newly created subelements (e.g. a new schedule)
	in the "New Task" dialog.

2016-01-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Use a new, more dynamic method for creating dashboards / chart boxes
	which makes their size adapt to the screen width, and which also allows
	editing of dashboards like rearranging, removing and adding of new
	components and resizing the row heights.

	* src/gsad_omp.c (authenticate_omp): Change filter for getting
	dashboard settings.

	* src/html/classic/graphics.xsl (init-d3charts): Add variable
	"dashboards" and remove unused variables "generators", "displays" and
	"charts".
	(js-aggregate-chart, js-tasks-chart): Remove. Renamed to
	js-aggregate-chart-factory and js-tasks-chart-factory.
	(js-aggregate-chart-factory): New. Most functionality from
	js-aggregate-chart and js-tasks-chart. Builds a JS function generating
	chart controllers instead of creating the controller directly. Also
	adjusted to new dashboard creation method.
	(js-scan-management-top-visualization, js-secinfo-top-visualization):
	Use new, more flexible dashboard creation method.
	(dashboard [secinfo]): Comment out chart creation code.

	* src/html/classic/omp.xsl (list-window): Use new Dashboard creation
	method for top mini-dashboard.
	(get_tasks_chart, get_aggregate): Use new Dashboard creation method.

	* src/html/classic/css/gsa-style.css: Update CSS for dashboards.

	* src/html/classic/js/gsa_graphics_base.js (Dashboard, DashboardRow)
	(DashboardNewRowTarget): New constructor functions for objects managing
	rearrangable and resizable dashboards.
	(DashboardBox): New constructor function. Replacement for Display
	using the new editable Dashboard.
	(Chart): Use addController function of DashboardBox. Add function "id".
	(fit_detached_window, detached_chart_resize_listener): Adapt to new
	Dashboard.

	* src/html/classic/js/jquery-ui.js
	src/html/classic/js/min/jquery-ui.js: Update to a version including all
	components.

2016-01-12  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad_omp.c (MESSAGE_INVALID): Fix returning the correct error message in
	the http response.

2016-01-12  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad_omp.c (create_container_task_omp): Check if the name parameter is
	valid before creating a container task.

2016-01-12  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad_omp.c: Don't return a redirect response for unsuccessful post
	request. Therefore rename the macros MESSAGE_REDIRECT to MESSAGE_INVALID and
	CHECK_PARAM_REDIRECT to CHECK_PARAM_INVALID for more meaningful names.

2016-01-12  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad_omp.c (response_from_entity): Don't return a redirect response in
	error cases.

2016-01-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/gsad_omp.c (next_page_url): Consider xml parameter from request for
	next page url.

2016-01-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): If "url" starts with "//" then drop the
	connection, otherwise the guest link can be used as a redirect.

2016-01-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/wizard.xsl: Remove unused xslt template wizard_list.

2016-01-11  Björn Ricks <bjoern.ricks@greenbone.net>

	Improve icon menus to look similar to the main menu.

	* src/html/classic/gsa-style.css: Rename css class menu_icon to icon-menu.
	Update icon-menu css class to make css class wizard_list obsolete.
	Use :first-child and :last-child css pseudo-classes to remove unnecessary
	first and last css classes.
	Remove wizard_list css classes completely.

	* src/html/classic/omp.xsl, src/html/classic/wizard.xsl: Use new icon-menu
	css class instead of menu_icon. Remove usage of wizard_list, first and last
	css classes.

2016-01-11  Michael Wiegand <michael.wiegand@greenbone.net>

	Make a better distinction between hardening flags for compiling and
	for linking to avoid using flags in a context where they make no
	sense.

	* CMakeLists.txt: Separate linker hardening flags from compiler
	hardening flags.

	* src/CMakeLists.txt: Use linker hardening flags when linking.

2016-01-11  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/gsa-style.css: Use common indentation of 2 spaces.
	Update Copyright year in header.

2016-01-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl: Apply escaping to all generated
	JS strings.

	* src/html/classic/js/gsa_graphics_base.js (unescapeXML): New function.

	* src/html/classic/omp.xsl (gsa:escape-js): Escape special characters
	to XML entities.

2016-01-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/gsa-style.css: Introduce new css classes:
	A valign-middle class to center elements vertically.
	Several css classes for formatting of tables as formulars.

	* src/html/classic/omp.xsl: Remove obsolete html elements and attributes
	which can be styled by css from the new task dialog.
	Also fix several layout issues in the new task dialog.

2016-01-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/help_de.xsl: Update German "Not Found" help page to new
	frameless style.

2016-01-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/help.xsl: Fix css class to use new layout at
	"all secinfo" page.

2016-01-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (preference [edit-details]): Fix osp
	credential selection default value.

2016-01-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/help.xsl: Add space after edit icon to improve
	readability.

2016-01-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/help.xsl: Fix icon links to the scanner config.

2016-01-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/help_de.xsl: Fix links to the credential help pages
	at the content page.

2016-01-08  Björn Ricks <bjoern.ricks@greenbone.net>

	* src/html/classic/help_de.xsl: Update German help pages to new style
	without the old boxes.

2016-01-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator): Make regex match options for
	aggregate_type, asset_type and sort_order exactly.

2016-01-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* gsad.xsl, help.xsl, help_ru.xsl: Extend the copyright year to 2016.

2016-01-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/help.xsl, src/html/classic/help_de.xsl,
	src/html/classic/help_ru.xsl, src/html/classic/help_zh_CN.xsl
	(mode="help" match="contents.html"): Removed unnecessary note.

2015-01-05  Matthew Mundell <matthew.mundell@greenbone.net>

	Allow the sysadmin to provide an alternate login image.

	* src/gsad_base.c (login_xml): Add ALTERNATE_LABEL flag to LOGIN_PAGE.

	* src/html/classic/gsad.xsl (login_box): If ALTERNATE_LABEL is not 0
	then use label.png instead of login-label.png.

2015-01-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_config): Get credentials information.

	* src/html/classic/omp.xsl (preference-details, edit-config-preference):
	Handle osp_credential_username and osp_credential_password.

2015-01-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Add version to login page header.  Add option --vendor-version, so that
	the user can override the version (in the header and on the About page).

	* src/gsad.c (request_handler): Add VERSION and VENDOR_VERSION to
	ENVELOPE.
	(main): Add --vendor-version.

	* src/gsad_base.c (vendor_version): New variable.
	(vendor_version_set, vendor_version_get): New function.
	(login_xml): Add VENDOR_VERSION to LOGIN_PAGE.

	* src/gsad_base.h: Add headers accordingly.

	* src/gsad_omp.c (xsl_transform_omp): Add VERSION and VENDOR_VERSION to
	ENVELOPE.

	* src/html/classic/gsad.xsl (login_page): Set header version from XML.
	(version, vendor_version): New dummy templates.

	* src/html/classic/help.xsl (help [about]): Set version from XML.

2015-01-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_report_omp, create_container_task_omp)
	(create_task_omp, move_task_omp, save_credential_omp)
	(create_agent_omp, get_aggregate_omp, create_target_omp): Return
	response from "omp" when return value is -1, because in this case
	there is no entity available, so a break leads to a segfault.

2015-01-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Consolidate multiple login XML locations into single function.

	* src/gsad_base.c (login_xml): New function.

	* src/gsad_base.h: Add header accordingly.

	* src/gsad.c (exec_omp_post, file_content_response)
	(request_handler): Use login_xml to generate login XML.

	* src/gsad_omp.c (logout): Use login_xml to generate login XML.

2015-12-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Make resource icons appear properly in help pages.

	* src/html/classic/help.xsl (name="help-header"): Fix variable reference.
	(mode="help" match="overrides.html", mode="help" match="tasks.html"):
	Overrides and Tasks were wrongly marked as assets, now fixed to be
	regular resources.

2015-12-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c: Move down G_LOG_FATAL_MASK definition, to fix compiler
	redifinition warning.

2015-12-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/login-label.png: Updated.

2015-12-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/css/gsa-login.css (header .version): Add some margin
	that is equals to the left-hand title string.

2015-12-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (note-detailed, override-detailed): Disable
	trash, edit and clone buttons if current user lacks permission or
	the action cannot be performed for other reasons.

2015-12-18  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/css/gsa-login.css, src/html/classic/gsad.xsl:
	  Reduce the size of the green bar on the top of the login page.
	  (Based on an original idea from Jan-Oliver Wagner).

2015-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Enable alert condition "Filter count at least" for NVT alerts.

	* src/gsad_omp.c (new_alert, edit_alert): Get all filters, so XSL can
	choose the type.

	* src/html/classic/js/greenbone.js (editAlertUpdateForm): Don't hide
	"Filter count at least" field, instead adjust it according to the alert
	condition type.

	* src/html/classic/omp.xsl (condition-field): Add "show" arg, which
	controls whether the condition is for an NVT event type.  Don't hide
	"Filter count at least", instead add extra elements that can be shown
	or hidden by the Javascript according to the event type.
	(html-edit-alert-form): Pass show to condition-field.

2015-12-15  Matthew Mundell <matthew.mundell@greenbone.net>

	Add "Details URL" param for NVT alerts.  Hide more fields that do not
	apply to NVT alerts.

	* src/gsad_omp.c (append_alert_method_data): Add details_url.

	* src/html/classic/js/greenbone.js (editAlertUpdateForm): Hide and show
	method fields.

	* src/html/classic/omp.xsl (html-create-alert-form): Add IDs so rows can
	be hidden.  Add Details URL field.
	(html-edit-alert-form): For NVT alerts hide Email Subject and
	Content, and Report.  Add Details URL field.
	(alert [details]): Just show addresses for NVT alerts.  Add Details URL
	field.

2015-12-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Remove static login page as the login page is always generated by XSLT.

	* src/html/its/login/login.html: Remove.

	* src/html/its/CMakeLists.txt: Remove installation of file
	src/html/its/login/login.html.

	* src/html/classic/login/login.html: Remove.

	* CMakeLists.txt: Remove installation of file
	src/html/classic/login/login.html.

2015-12-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-scan-management-top-visualization)
	(js-secinfo-top-visualization): Load charts automatically again.

2015-12-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Fix text shown when Gantt and horizontal bar charts have no data.

	* src/html/classic/omp.xsl (get_tasks_chart): Add empty xmlns for
	init_params and gen_params.

	* src/html/classic/js/gsa_h_bar_chart.js (generate),
	src/html/classic/js/gsa_gantt_chart.js (generate): Move existing
	text for empty data instead of adding a new one on every redraw.

2015-12-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (name="list-window"): Drop the fold toggle
	for the charts section and thus make the charts section mandatory.

2015-12-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (name="list-window"): Remove the "Summary"
	section header and its line to have a more harmonic impression
	by resolving the double line. Move the fold toggle button to the
	upper section line.

2015-12-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/nvt.svg,
	  src/html/classic/img/result.svg: New.

	* src/html/classic/img/cert_bund_adv.svg: Updated.

	* CMakeLists.txt: Install new icons.

2015-12-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Add alert event "Updated NVTs arrived".

	* src/gsad_omp.c (create_alert_omp, save_alert_omp): Check if the event
	should be "Updated NVTs arrived" when the event is "New NVTs arrived".

	* src/html/classic/omp.xsl (html-create-alert-form)
	(html-edit-alert-form): Add New/Updated dropdown to "NVTs arrived"
	event.

2015-12-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/css/gsa-style.css (.chart-foot): Due to last commit,
	the font color of course needs to be dark now.

2015-12-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/css/gsa-style.css (.chart-foot): Use same light
	gray for background as for the chart itself.

2015-12-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/css/gsa-style.css (.dashboard_box): Remove border.
	(.chart-foot): Use lighter gray background.

2015-12-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/cert_bund_adv.svg,
	  src/html/classic/img/dfn_cert_adv.svg,
	  src/html/classic/img/ovaldef.svg: New.

	* CMakeLists.txt: Install new icons.

2015-12-10  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/css/gsa-login.css: Make the size of the head
	  somewhat proportional.

2015-12-10  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/gsad.xsl: Disable the input fields once the login
	  operation is running.

2015-12-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (credential [trash])
	(html-credentials-trash-table): Add columns type and allow_insecure.

2015-12-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add "allow_insecure" property of credentials.

	* src/gsad_omp.c (create_credential_omp, save_credential_omp): Add
	parameter allow_insecure.

	* src/gsad.c (init_validator): Add parameter allow_insecure.

	* src/html/classic/omp.xsl (html-create-credential-form)
	(html-credentials-table, html-edit-credential-form, credential)
	(credential [details]): Add elements for new property "allow_insecure".

2015-12-09  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/gsad.xsl: Fix the spaces in the logout_box.

2015-12-08  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/cpe.svg, src/html/classic/img/cve.svg: New.

	* CMakeLists.txt: Install new icons.

2015-12-07  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Only set the refresh rate when the
	  quick_first_scan is being run.

2015-12-07  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Set the autorefresh to 30sec. when
	  the wizard is called.

2015-12-07  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js, src/html/classic/omp.xsl: Improve
	  the Filter dialog further.

2015-12-07  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (name="filter-window-part"): Moved
	"Apply overrides" to the left column for consistency.

2015-12-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Only load charts when the Summary section is unfolded.

	* src/html/classic/graphics.xsl (js-scan-management-top-visualization)
	(js-secinfo-top-visualization): Do not load the chart data here.

	* src/html/classic/js/greenbone.js (onload): Load charts the first time
	the Summary section is unfolded after loading the page.

	* src/html/classic/js/gsa_graphics_base.js (Display): Add variable
	and function "requested".

2015-12-07  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/css/gsa-style.css, src/html/classic/js/greenbone.js,
	  src/html/classic/omp.xsl: Make a two-column layout for the filter
	  dialog.

2015-12-07  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/css/gsa-login.css: Lower a bit the labels.

2015-12-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (match="group" mode="radiusauth"): Apply
	the new style.

2015-12-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (get_my_settings, edit_my_settings): Remove
	setting "Wizard rows".

	* src/gsad_omp.c (save_my_settings_omp): Remove setting "Wizard rows".

2015-12-04  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Write 'Updating...' when reloading
	  the page with a new filter.

2015-12-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (toggle_tag_omp): Remove unused next_url.

2015-12-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Use redirect or short responses for most creation, modification and
	deletion commands and make param checks more consistent.

	* src/gsad_omp.c (MESSAGE_REDIRECT): New function macro. Message
	and redirect generation from CHECK_PARAM_REDIRECT.
	(CHECK_PARAM_REDIRECT): Use MESSAGE_REDIRECT.
	(next_page_url): Use command in "next_error" if the action_status
	indicates an error.
	(response_from_entity): New function.
	(next_page_error): Remove as it's now unused.
	(delete_resource, resource_action, create_report_omp, CHECK)
	(create_container_task_omp, create_task_omp, save_task_omp)
	(save_container_task_omp, move_task_omp, create_credential_omp)
	(save_credential_omp, create_agent_omp, save_agent_omp)
	(create_alert_omp, save_alert_omp, test_alert_omp, create_target_omp)
	(clone_omp, restore_omp, empty_trashcan_omp, create_tag_omp)
	(save_tag_omp, toggle_tag_omp, save_target_omp, create_config_omp)
	(import_config_omp, save_config_omp, create_note_omp, save_note_omp)
	(create_override_omp, save_override_omp, create_slave_omp)
	(save_slave_omp, create_scanner_omp, save_scanner_omp)
	(create_schedule_omp, import_report_format_omp, save_report_format_omp):
	(run_wizard_omp, create_group_omp, save_group_omp)
	(create_permission_omp, CHECK_OMPF_RET, new_permissions)
	(create_permissions_omp, save_permission_omp, create_port_list_omp)
	(create_port_range_omp, save_port_list_omp, import_port_list_omp)
	(create_role_omp, save_role_omp, create_filter_omp, save_filter_omp)
	(save_schedule_omp, create_user_omp, save_user_omp, save_auth_omp)
	(bulk_delete_omp, create_host_omp, create_asset_omp, save_asset_omp):
	Use new macros for param checking and response_from_entity for
	generating the main responses.

2015-12-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (redirect_handler): Handle IPv4-mapped IPv6 addresses too.

2015-12-04  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Make the filter dialog actually
	  work.

2015-12-04  Benoît Allard  <benoit.allard@greenbone.net>

	Move the Edit Filter to a js dialog.

	* src/html/classic/js/greenbone.js, src/html/classic/omp.xsl:

2015-12-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/wizard.xsl (name="quick-first-scan-wizard"):
	Simplified the text a bit. With the new dialog in dialog
	concept we don't need the hint about the sequence anymore.
	(name="quick-task-wizard"): Slightly simplified.

2015-12-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (match="group" mode="ldapauth"): Apply
	the new style.

2015-12-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/login-label.png: New.

	* CMakeLists.txt: Install new label.

	* src/html/classic/gsad.xsl (match="login_page"): Use new label
	for login dialog.

2015-12-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/report.svg: New.

	* CMakeLists.txt: Install new icon.

2015-12-03  Benoît Allard  <benoit.allard@greenbone.net>

	Make the Wizard a js dialog.

	* src/html/classic/css/gsa-style.css, src/html/classic/js/greenbone.js,
	  src/html/classic/omp.xsl, src/html/classic/wizard.xsl: Updated

2015-12-03  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/gsad.xsl: Fix image name.

2015-12-03  Benoît Allard  <benoit.allard@greenbone.net>

	Rework the login page.

	* CMakeLists.txt, src/html/classic/css/gsa-login.css,
	  src/html/classic/gsad.xsl: Updated
	* src/html/classic/img/greenbone.svg: Added

2015-12-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/secinfo.svg: New.

	* CMakeLists.txt: Install new icon.

	* src/html/classic/graphics.xsl (match="dashboard" mode="secinfo"):
	Apply new section header.

	* src/html/classic/omp.xsl (name="html-allinfo-table"): Fix
	subtype name to show the new icon.

2015-12-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/alert.svg,
	src/html/classic/img/os.svg: Updated with fonts
	converted to paths.

	* src/html/classic/img/agent.svg, src/html/classic/img/config.svg,
	src/html/classic/img/permission.svg, src/html/classic/img/scanner.svg:
	New.

	* CMakeLists.txt: Install the new icons.

	* src/html/classic/omp.xsl (name="html-config-table"): Fix icon name.

2015-12-02  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js (generate): Use length of
	actual slices array in condition of slice drawing loop.

	* src/html/classic/js/gsa_graphics_base.js (DataSource [request_data]):
	Correct insertion of data_uri into error messages and add HTTP
	status code to chart title.

2015-12-02  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Two more namespace corrections.

2015-12-02  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/graphics.xsl, src/html/classic/omp.xsl: More
	  explicit usage of the empty namespace around graphic charts.

2015-12-02  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Explicitely put our custom elements
	  (columns) in an empty namespace to get them through.

2015-12-02  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/gsad.xsl: Set the namespace to an empty one when
	  constructing custom elements.

2015-12-02  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/gsad.xsl: Remove a wrongly used <br/> tag

2015-12-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (match="cvss_calculator"): Fixed typo,
	found by Timo Pollmeier.

2015-12-01  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Fix typo in the tag name.

2015-12-01  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/graphics.xsl, src/html/classic/gsad.xsl,
	  src/html/classic/help.xsl, src/html/classic/help_de.xsl,
	  src/html/classic/help_ru.xsl, src/html/classic/help_zh_CN.xsl,
	  src/html/classic/omp-doc.xsl, src/html/classic/omp.xsl,
	  src/html/classic/wizard.xsl: Cleanup xmlns declaration. Now the
	  whole document is under the same namespace (XHTML).

2015-12-01  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/gsad.xsl: No need to introduce extra div.

2015-12-01  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Make it possible to select top-level
	  elements.

2015-12-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_task): Skip details, because there may be many
	reports, and counts are now available in RESULT_COUNT.

	* src/html/classic/omp.xsl (task [details]): Get result count from new
	RESULT_COUNT element.

2015-11-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add status messages and indicators on pages redirected to. In New Tag
	and Edit Tag dialogs, get status messages directly without requesting
	next page.

	* src/gsad_omp.c (CHECK_PARAM_REDIRECT): New function-like macro.
	(capitalize): New function.
	(next_page_url): Add parameters prev_action, action_status,
	action_message to allow delivering short error messages via the URL.
	(action_result_page): New function.
	(delete_resource, resource_action, clone_omp, restore_omp)
	(empty_trashcan_omp, create_tag_omp, save_tag_omp, toggle_tag_omp):
	Handle no_redirect request param and respond with redirect or
	action_message.

	* src/gsad.c (init_validator): Add params action_message,
	action_status, prev_action and no_redirect.

	* src/html/classic/gsad.xsl (action_status [response-indicator]): New
	template.
	(html-gsa-logo): Add case for action_status param.
	(command_result_dialog): Add always-visible param.
	(action_result): New template.
	(envelope): Add case for action_status param.

	* src/html/classic/omp.xsl (action_status): New template.

	* src/html/classic/js/greenbone.js (OMPDialog.prototype.postForm):
	Handle new error types.
	(OMPDialog.prototype.show): Add hidden no_redirect field.

2015-11-29  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/alert.svg,
	src/html/classic/img/credential.svg,
	src/html/classic/img/port_list.svg,
	src/html/classic/img/report_format.svg: New.

	* CMakeLists.txt: Install the new icons.

2015-11-29  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/cvss_calculator.svg,
	src/html/classic/img/mysettings.svg,
	src/html/classic/img/performance.svg: New.

	* CMakeLists.txt: Install the new icons.

2015-11-29  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/host.svg, src/html/classic/img/os.svg: New.

	* CMakeLists.txt: Install the new icons.

2015-11-29  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (name="list-window"): Use the subtype
	for the icon in case a subtype is defined.

2015-11-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/gsad.xsl (html-gsa-navigation): Remove stray
	BR that was causing extra space at the bottom of the Administration
	menu.

	* src/html/classic/js/gsa_graphics_base.js
	(create_or_get_menu_item): Add arg "last".  If true then give the LI
	attribute "last", so that the green hover overlay is rounded.

	* src/html/classic/js/gsa_bar_chart.js,
	src/html/classic/js/gsa_bubble_chart.js,
	src/html/classic/js/gsa_cloud_chart.js,
	src/html/classic/js/gsa_donut_chart.js,
	src/html/classic/js/gsa_gantt_chart.js,
	src/html/classic/js/gsa_h_bar_chart.js,
	src/html/classic/js/gsa_line_chart.js (generate): Flag last menu item,
	so that green hover overlay is rounded.

2015-11-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/help.xsl (configs.html, new_config.html):
	Fix type so that proper links are created.
	(config_details.html): Fix type and add some more explanations
	about synchonizing a config.

2015-11-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (html-config-table): Move sync config button
	inside the div.
	(config): Remove Sync Config button from actions table.

	* src/html/classic/help.xsl: Move sync config documentation to
	config_details.html page.
	(details-window-line-actions): Fix exporting header.

2015-11-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (upload_report): Get only container tasks.
	(new_alert, get_alert, get_alerts, edit_alert, new_note)
	(new_override): Add schedules_only to GET_TASKS because only name
	and ID is required, and getting all the other info is slower.

2015-11-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/feed.svg: New.

	* CMakeLists.txt: Install new icon.

2015-11-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/gsad.xsl (name="error_dialog"): Instead of
	the login form, use a simple logout as fallback when no token
	is available. This will automatically lead to the login page.

2015-11-26  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (cmd_response_data_init): Init redirect with NULL.

2015-11-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_reports): Remove the GET_TASKS call.  It does not
	seem to be used, and can be slow when there are lots of tasks.

2015-11-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (save_config_omp): Fix scanner element in OMP command.

2015-11-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Allow modifying name and comment of configs that are in use.

	* src/gsad_omp.c (check_modify_config): Change message to say that
	modifying the name and comment is allowed.

	* src/html/classic/omp.xsl (html-config-table-edit): Hide fields
	other than name and comment if config is in use.

2015-11-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (exec_omp_post): Also return the login form if the
	username or password contains invalid characters.

2015-11-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (request_handler): Initialize con_info->redirect and
	user in POST case.

2015-11-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (delete_user_confirm): Initialize response and entity
	and skip output of GET_USERS response when the command is disabled.

2015-11-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (resource_action): Redirect to next page on success
	instead of generating it.

2015-11-24  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Redirect on successful clone, delete and restore requests instead of
	responding with the next page directly.

	* src/gsad_base.h (cmd_response_data_t): Add field "redirect".

	* src/gsad_omp.c (next_page_url): New function.
	(delete_resource): Change type of "get" parameter to "const char*".
	Redirect to next page on success instead of generating it.
	(delete_credential_omp, delete_agent_omp, delete_alert_omp): Adjust
	delete_resource call.
	(clone_omp): Redirect to next page on success instead of generating it.
	(delete_target_omp, delete_trash_agent_omp, delete_trash_config_omp)
	(delete_trash_alert_omp, delete_trash_credential_omp)
	(delete_trash_report_format_omp, delete_trash_schedule_omp)
	(delete_trash_slave_omp, delete_trash_target_omp)
	(delete_trash_task_omp): Adjust delete_resource call.
	(restore_omp, empty_trashcan_omp): Redirect to next page on success
	instead of generating it.
	(delete_trash_tag_omp, delete_trash_note_omp, delete_trash_override_omp)
	(delete_slave_omp, delete_scanner_omp, delete_trash_scanner_omp)
	(delete_schedule_omp, delete_report_format_omp, delete_trash_group_omp)
	(delete_group_omp, delete_trash_permission_omp, delete_port_list_omp)
	(delete_trash_port_list_omp, delete_port_range_omp)
	(delete_trash_role_omp, delete_role_omp, delete_trash_filter_omp)
	(delete_filter_omp, delete_user_omp): Adjust delete_resource call.

	* src/gsad.c (gsad_connection_info): Add field "redirect".
	(exec_omp_post): Copy redirect to con_info and set answercode to
	MHD_HTTP_SEE_OTHER if redirect is set in response_data.
	(request_handler): If redirect is set in con_info send a redirect HTTP
	response and reset it.

2015-11-24  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (name="protocol"):
	Convert to new style.

2015-11-24  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/trashcan.svg: New.

	* CMakeLists.txt: Install the new icon.

	* src/html/classic/omp.xsl (match="get_system_reports_response",
	match="get_trash", name="html-feed-form", name="html-scap-form",
	name="html-cert-form", match="get_my_settings"):
	Convert to new details style.

2015-11-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (match="asset" mode="os-details",
	match="asset" mode="host-details"): Convert to new details style.

2015-11-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (group [radiusauth]): Change radius key input
	type to password.

2015-11-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (match="result" mode="details"
	name="result-details"): Convert to new details style.

2015-11-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (match="task" mode="details",
	match="note" mode="details", match="override" mode="details"):
	Convert to new details style.

2015-11-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (cve-details, cpe-details, ovaldef-details,
	cert_bund_adv-details, dfn_cert_adv-details, nvt-details):
	Convert to new details style.
	(match="nvt" mode="details"): Removed ID-box because
	it is now handle in nvt-details.

2015-11-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (match="user" mode="details",
	match="group" mode="details", match="role" mode="details"):
	Convert to new details style.

2015-11-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (match="filter" mode="details",
	match="scanner" mode="details", match="slave" mode="details",
	match="report_format" mode="details", match="tag" mode="details",
	match="permission" mode="details"): Convert to new details style.

2015-11-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/schedule.svg: New.

	* CMakeLists.txt: Install the new icon.

	* src/html/classic/omp.xsl (match="alert" mode="details",
	match="schedule" mode="details"): Convert to new details style.

2015-11-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (match="config" mode="families"): only show
	last line if there is at least one selection. For example, this
	is the case for OSP configs.
	(html-config-table): Convert to new details style. Also removed all handling
	for "edit" case.
	(html-config-table-edit): New, all "edit" cases of html-config-table.
	(get_config_response): Call the template html-config-table-edit for
	the "edit" case.

2015-11-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Allow modifying credentials of every type.

	* src/gsad_omp.c (save_credential_omp): Handle params for credential
	types other than username and password.

	* src/gsad.c (init_validator): Add params "change_community",
	"change_passphrase", "change_password" and "change_privacy_password".

	* src/html/classic/omp.xsl (html-edit-credential-form): Use a disabled
	dropdown list to show type (for consistency with "New Credential" form
	and add elements for the various credential types.

2015-11-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/help.xsl (users.html): Update RADIUS authentication
	documentation.

2015-11-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Add auth_method parameter. Remove
	enable_ldap_connect parameter.

	* src/gsad_omp.c (create_user_omp): Add support for radius_connect
	authentication method.
	(save_user_omp): Support RADIUS authentication method. Improve code
	style.

	* src/html/classic/omp.xsl (html-create-user-form, user)
	(user [details], user [edit]): Add RADIUS authentication support and
	adjust interface accordingly.

2015-11-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* COPYING: Updated locations of minified versions of d3, jQuery and
	Select2.  Added jQuery UI files.

2015-11-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Add radius form related parameters.

	* src/gsad_omp.c (save_auth_omp): Adjust to handle RADIUS Authentication
	form too.

	* src/html/classic/omp.xsl (html-users-table, user): Change LDAP
	Authentication column to Authentication Type.
	(group [auth]): Change mode name to ldapauth.
	(group [radiusauth]): New template.
	(describe_auth_response [show]): Handle method:radius_connect case too.

2015-11-17  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (match="credential" mode="details"): Convert
	to new details style.

2015-11-17  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (match="port_list" mode="details"): Convert
	to new details style.

2015-11-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-alert-form): Also hide the filter
	field when event is "New NVTs arrived".

2015-11-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Hide certain rows on Create Alert and New Alert when the event is "New
	NVTs arrived".

	* src/html/classic/js/greenbone.js (editAlertUpdateForm): New function.

	* src/html/classic/omp.xsl (condition-field): Add hide arg.
	(html-create-alert-form, html-edit-alert-form): Add onChange handlers
	for rows that must hide when "New NVTs arrived" is selected.  Hide the
	same rows with CSS initially if "New NVTs arrived" is selected
	initially.

2015-11-16  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (target [trash], html-targets-trash-table):
	Merge credential columns into one as in regular table and add SNMP
	credential.

2015-11-16  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (edit_my_settings): Show only credentials
	of the correct types in the dropdown lists.

2015-11-16  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add SNMP credentials to targets.

	* src/gsad_omp.c (new_target, create_target_omp, save_target_omp):
	Handle new snmp_credential_id parameter.

	* src/gsad.c (init_validator): Add param "snmp_credential_id".

	* src/html/classic/omp.xsl (task [details]): Add SNMP credential of
	target to related resources for permissions.
	(html-create-target-form, html-edit-target-form, html-targets-table)
	(target): Add elements for selecting or showing SNMP credential.
	(target [trash]): Check if SNMP credential is in trash for target
	restore icon.
	(target [details]): Add SNMP credential.
	(report [hosts]): Add indicator icons for SNMP authentication.
	(get_my_settings, edit_my_settings): Add "Default SNMP Credential".
	(html-edit-asset-form): Add snmp_credential_id input.

2015-11-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Make the big icon a bit smaller for a improved harmonic view.

	* src/html/classic/css/gsa-style.css: Decrease sizes of big icon from
	64 to 50.

	* src/html/classic/omp.xsl (): Decrease spacing to condense the table a bit.

2015-11-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Turn Filter section into a toolbar-like compact element.

	* src/html/classic/css/gsa-style.css: Slight vertical adjustment of
	icon toolbar.

	* src/html/classic/omp.xsl (filter-window-part): Drop the reload icon because
	the drop down box will always execute the reload automatically. Instead place
	here the expand icon for the filter details dialog. And prepend "Filter:" to
	the entire line.
	(list-window): Drop the entire section header for "filter" and shift the
	the filter up to the same level as the icon toolbar.

2015-11-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Simplify div arrangement to replace/reduce  by the (section-header,section-box) pairs.

	* src/html/classic/css/gsa-style.css: Add a margin to section-header and section-box.
	Also add some bottom-margin to the section-box to have a nice separation of the sections.

	* src/html/classic/omp.xsl (user-tags-window-checked, resource-permissions-window, list-window): Remove surrounding gb_window, just
	let the section pairs do the job.

2015-11-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-create-alert-form)
	(html-edit-alert-form): Add radio for event "New NVTs arrived".

2015-11-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (exec_omp_post): Changed wording for case of OMP service
	unavailable to indicate it might only be a temporary problem (which is typcially
	the case) and not indicate a severe problem.

2015-11-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Renamed Charts to Summary and
	Table to Details.

2015-11-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Introduce a icon toolbar for overview and details pages.
	For details only for Targets as a reference.
	Also add a bottom bar for the overview titles.

	* src/html/classic/css/gsa-style.css (list-window-header):
	Add a border-bottom.
	(toolbar): New.

	* src/html/classic/omp.xsl (list-window): Move icons into a toolbar.
	(match="target" mode="details"): Move icons into a toolbar.

2015-11-12  Matthew Mundell <matthew.mundell@greenbone.net>

	Allow modification of some scanner fields when the scanner is in use.

	* src/gsad_omp.c (save_scanner_omp): Skip some elements if scanner is in
	use.

	* src/html/classic/omp.xsl (html-edit-scanner-form): Disable some
	elements if scanner is in use.

2015-11-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Simplify the titles for permissions and user tags: The name of the
	resource does not need to be mentioned again.

	* src/html/classic/omp.xsl (user-tags-window-checked, user-tags-window):
	Drop title and title_shortened.  Use static "User Tags" instead.
	(resource-permissions-window): Drop title and title_shortened.  Use
	static "Permissions" instead.

2015-11-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (match="target" mode="details"):
	Turn "Target Details" into a new section style.

	* src/html/classic/css/gsa-style.css: Add big-icon.

2015-11-11  Matthew Mundell <matthew.mundell@greenbone.net>

	Add alert method "Send", for sending the report to a TCP listener.

	* src/gsad_omp.c (append_alert_method_data): Add Send cases.

	* src/html/classic/omp.xsl (html-create-alert-form)
	(html-edit-alert-form): Add Send option.
	(alert, alert [details]): Add Send cases.

2015-11-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (html-create-credential-form): Drop
	the "optional" indicator for the type. There is always a type.

2015-11-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (create_credential_omp): Add error message in case
	type passes validation but is not handled by the function.

2015-11-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add new SNMP credential type.  Simplify use of "New Credential" dialog
	by removing duplicate fields and showing only those relevant to the
	selected type.

	* src/gsad_omp.c (create_credential_omp): Add params for SNMP type and
	separate autogenerate param.  Remove duplicate parameters for "cc"
	type and restructure parameter checks and credential creation.

	* src/gsad.c (init_validator): Add auth_algorithm, autogenerate,
	certificate, community, privacy_algorithm, privacy_password.  Remove
	cc_certificate and cc_private_key.

	* src/html/classic/omp.xsl (html-create-credential-form): Add input
	fields for SNMP and separate autogenerate selection.  Remove duplicate
	fields for client certificate and show fields as appropriate for the
	selected type and autogenerate setting using JS.
	(credential [details]): Add "Auth Algorithm" and "Privacy Algorithm"
	for SNMP credentials.

	* src/html/classic/js/greenbone.js (newCredentialUpdateForm): New
	function.

2015-11-09  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (match="target" mode="details"): Turn "Tasks using this Target"
	into a new section style.

2015-11-09  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (user-tags-window-checked): Replace "gb_window"
	style by the section style with a horizontal line. Moved the icons right
	hand above the line. Made the section collapsable.

2015-11-09 Michael Meyer <michael.meyer@greenbone.net>

	* src/html/classic/os.xml: Added Cisco AsyncOS.

2015-11-09  Matthew Mundell <matthew.mundell@greenbone.net>

	Add alert conditions for triggering alerts according to result counts
	matched by a filter.

	* src/gsad_omp.c (append_alert_condition_data): Add special cases for
	filter conditions, because the conditions use the same data names.
	(get_alert, get_alerts): Correct message.  Get filters for the condition
	link.

	* src/html/classic/omp.xsl (condition-field): New template.
	(html-create-alert-form): Use condition-field for the condition.
	(radio-button): Align better.
	(html-edit-alert-form): Use condition-field for the condition.
	(alert, alert [details]): Use "condition" to display the condition.
	(condition): New template.

2015-11-08  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/css/gsa-style.css: Added icon element for section header.

	* src/html/classic/omp.xsl (resource-permissions-window): Replace "gb_window"
	style by the section style with a horizontal line. Moved the icons right
	hand above the line. Made the section collapsable.

2015-11-07  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/group.svg, src/html/classic/img/role.svg,
	src/html/classic/img/user.svg: New.

	* CMakeLists.txt: Install the new icons.

2015-11-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Introduce new style for help pages, compatible with the new style
	of the overview pages.

	* src/html/classic/img/help.svg: New.

	* CMakeLists.txt: Install the new help icon.

	* src/html/classic/css/gsa-style.css: Add definitions for h1 and h2 of
	section-header where so far only h3 was defined. Also add an (so far)
	empty section-box to be used in a box below a section header.
	Finally added small-icon for 16x16 version of SVG icons.

	* src/html/classic/help.xsl (help-header): New macro for the head of help pages.
	Changed all of the pages to use the new header. Some links like for "new" dialogs
	were removed as they don't make sense with the new gui.

2015-11-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-targets-table): Set position of
	credential sort order buttons to align them with dropdown and use
	"ascending" and "descending" icons for them. Reload page automatically
	on credential type selection using current order.

2015-11-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Merge columns for individual credential types in targets table
	into a single one with JS-based sort field selection.

	* src/html/classic/omp.xsl (filter-window-part): Allow to hide columns
	with a hide_in_filter element.
	(list-window): Allow to hide column with hide_in_table element. Add
	column headers without link if no field is given for a column.
	Allow HTML additions for all top level column headers.
	(html-targets-table, target): Merge columns for individual credential
	types into a single one with JS-based sort field selection.

2015-11-05  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/gsa-style.css, src/html/classic/omp.xsl,
	src/html/classic/wizard.xsl: Change small_inline_form from id to class.
	Fixes libxml duplicate ID definition error.

2015-11-05  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (configs.html [help], config_editor.html):
	Update documentation.

2015-11-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_config): Handle scanner parameter of config
	editing.

	* src/html/clssic/omp.xsl (html-config-table): Add scanner parameter in
	OSP configs edit mode.

2015-11-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Consolidate help pages for topic Permissions: Reduce page about table
	to main table contents description and drop description of standard
	actions and filter in favour of respective links.

	* src/html/classic/help.xsl (permissions.html): Add links, remove
	standard actions and filters.
	(new_permission.html): Add links to details and table help.
	(permission_details.html): Drop permissions, add links to other permission
	topics.

2015-11-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Replace the Certificate and Private Key in Scanners with a Credential.
	Add credential as related resource of Scanners and Slaves for
	permissions.  Also fix an issue with empty parameter names in the
	permission window and correct i18n contexts for some credential
	references.

	* src/gsad_omp.c (xsl_transform_omp): Check if a parameter name is
	empty and log a warning in this case or if it is NULL.
	(get_credential): Add "credentials" parameter.
	(new_scanner): Get list of client certificate credentials.
	(create_scanner_omp): Replace key_pub and key_priv with credential_id.
	(edit_scanner): Get list of client certificate credentials.
	(save_scanner_omp): Replace key_pub and key_priv with credential_id.

	* src/html/classic/omp.xsl (resource-permissions-window): Do not add
	ampersand after last parameter.
	(credential): Add list of scanners for client certificate type. Correct
	i18n contexts.
	(html-create-scanner-form): Replace the Certificate and Private Key
	upload with Credential selection.
	(html-scanners-table): Add Credential column.
	(html-edit-scanner-form): Replace Certificate/Private Key.
	(scanner [details]): Replace Certificate/Private Key. Add Credential
	as related resource for permission creation.
	(scanner): Add Credential column.
	(scanner [trash]): Add Credential column and check if credential needs
	to be restored first.
	(html-create-slave-form, html-edit-slave-form): Correct i18n context
	for Credential
	(slave [details]): Add Credential as related resource for permissions.
	(html-scanners-trash-table): Add Credential column.

2015-11-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (html-config-table): Add the config's scanner
	to the details page.

2015-11-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator, exec_omp_get): Handle sync_config command.

	* src/gsad_omp.c (sync_config_omp): New function.

	* src/gsad_omp.h: Add function prototype.

	* src/html/classic/omp.xsl (sync_config_response [response-indicator]):
	New template.
	(html-gsa-logo): Handle sync config indicator.

	* src/html/classic/omp.xsl (config, html-config-table)
	(html-configs-table): Add sync config icon.
	(sync_config_response): New template.

2015-10-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (edit-config-preference)
	(edit-scanner-details): Show default instead of current values
	for OSP preferences like it's done for OpenVAS scanner preferences.

2015-10-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Flush trailing whitespace.

2015-10-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (asset [host-details], html-hosts-table)
	(asset/host): Add Hostname and IP.

	* src/html/classic/help.xsl (hosts.html): Add Hostname and IP

2015-10-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (new_task, html-edit-task-scanner): Remove
	the scanner selection for CVE tasks, because there's only ever one CVE
	scanner.
	(html-edit-task-form): Skip the config for CVE tasks, as they don't have
	configs.
	(html-create-config-form): Skip the config for the CVE scanner too.

2015-10-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (exec_omp_get): In download_credential case, change
	filename prefix to "credential-" and use UUID if the login name
	is empty.

	* src/html/classic/omp.xsl (credential [details]): Show Slaves section
	only for username + password credentials and hide Targets section
	for client certificate credentials.

2015-10-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-credential-form): Show type
	of credential and hide fields "login" and "password" for client
	certificate credentials.  Rearrange conditions for other types.

2015-10-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog.prototype.postForm):
	Handle errors where Manager returns a generic omp_response element.

2015-10-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add new client certificate credential type.

	* src/gsad_omp.c (create_credential_omp): Handle params cc_certificate,
	cc_private_key and new credential type "cc".
	(download_credential_omp): Handle new "pem" format for certificates.

	* src/gsad.c (init_validator): Add cc_certificate and cc_private_key.
	Add "pem" option to package_format.

	* src/html/classic/omp.xsl (html-create-credential-form): Add input
	fields for new "client certificate" type.
	(credential-download-icons): Add download for client certificate.
	(credential [details]): Hide login field for client certificate type.
	(html-create-target-form, html-edit-target-form): Show only username
	and password or username and key credentials for SSH.

2015-10-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (asset [host-details]): Show Created column
	in "Latest Identifiers" mode too.

2015-10-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-role-form, role [details]): Rename
	"Permissions" table to "General Command Permissions".

2015-10-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* ChangeLog: Remove extra entry from earlier.

2015-10-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Replace login and password in slaves with credential and show slaves
	using a credential on the credential details page.

	* src/gsad_omp.c (get_credential): Add slaves attribute.
	(new_slave): Get list of credentials.
	(create_slave_omp): Use credential_id instead of login and password.
	(edit_slave): Get list of credentials in addition to slave.
	(save_slave_omp): Use credential_id instead of login and password.

	* src/html/classic/omp.xsl (credential [details]): Add table of slaves
	using the credential.
	(html-create-slave-form): Replace login and password fields with
	credential selection and "New Slave" icon.
	(html-slaves-table): Add column "Credential".
	(html-edit-slave-form): Replace login and password fields with
	credential selection.
	(slave, slave [trash], slave, html-slaves-trash-table): Add credential.

	* src/html/classic/js/greenbone.js (NAME_SELECTORS): Add case for
	new_credential.

	* src/html/classic/help.xsl (slave_details.html): Correct and Update
	description.
	(slaves.html, new_slave.html): Replace login and password with
	credential.

2015-10-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_one): For roles, users and groups, also get
	permissions where the subject is the role/user/group for the
	"Permissions for ..." dialog.

2015-10-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Get tags working for Assets.

	* src/gsad.c (init_validator): Add host and os to resource types.

	* src/html/classic/omp.xsl (gsa:type-name): Add OS.
	(tagged_resource_link, tag_resource_types): Add host and OS cases.
	(asset [os-details]): Add the User Tags window.

2015-10-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (permission [trash]): Replace link to
	resource with simple text and "in trashcan" message if the resource is
	also in the trashcan.

2015-10-23  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-create-credential-form): Split the
	autogenerate option into "Autogenerate password" and
	"Autogenerate SSH key pair".
	(html-credentials-table): Reduce icon-count to 7.
	(credential-download-icons): Add "type" param and choose which icons to
	show based on it.
	(credential, credential [details]): Always include template
	credential-download-icons and pass credential type for icon selection.

	* src/gsad_omp.c (create_credential_omp): Use correct type names to
	determine which params to check. Split type "gen" into "gen_up" and
	"gen_usk".

2015-10-23  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/greenbone.js (RESPONSE_SELECTORS): Remove "lsc_"
	from names of credential commands and response elements.

2015-10-22  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-create-permissions-form): Replace
	the resource type and uuid input with a link and show the names of
	the resource and related resources.

	* src/gsad_omp.c (new_permissions): Get the permissions' resource
	and related resources to allow getting the names.  Make links open
	in a new window.

2015-10-22  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Use new element and parameter names without "lsc_" for credentials in
	targets.

	* src/gsad_omp.c (new_target, create_target_omp, save_target_omp): Use
	the names "ssh_credentials_id", "smb_credential_id" and
	"esxi_credential_id" to refer to the credentials.

	* src/gsad.c (init_validator): Replace lsc_credential_id,
	lsc_esxi_credential_id, lsc_smb_credential_id with ssh_credential_id,
	esxi_credential_id and smb_credential_id.

	* src/html/classic/omp.xsl (task [details], html-create-target-form)
	(html-edit-target-form, target, target [trash], targe [details])
	(html-edit-asset-form): Use new element and parameter names for
	credentials in targets.

2015-10-22  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Remove mention of the empty task list when
	  editing a scan config.

2015-10-21  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Remove the extra 'Save Config' button in
	  the middle of the Edit Config dialog.

2015-10-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* src/html/classic/help.xsl, CMakeLists.txt: Set version to 6.1+beta3.

2015-10-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 6.1+beta2 release.

	* CHANGES: Updated.

2015-10-21  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/css/gsa-login.css, src/html/classic/gsad.xsl,
	  src/html/classic/js/greenbone.js: Fixed the way to grap the error
	  message in the login page.

2015-10-21  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Remove mention of the total unfiltered
	  count if the filtered table is empty.

2015-10-21  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Remove mention of the total in the pager.

2015-10-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CHANGES: Updated.

2015-10-21  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/css/gsa-style.css: Make the filter more narrow,
	  and stick to the right.

2015-10-21  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-part): Remove the 'View
	  filters' button.

2015-10-20  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/css/gsa-style.css, src/html/classic/omp.xsl: Get
	  rid of the fixed-with of #list-window-title

2015-10-20  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Fix the vertical alignment of the inner
	  filter forms.

2015-10-20  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Remove a margin in the filterbox.

2015-10-20  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/gsad.xsl (error_window): Remove one more <center>

2015-10-20  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/css/gsa-style.css, src/html/classic/gsad.xsl
	  (error_dialog): Center the dialog without using <center>

2015-10-20  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Better not check the visibility of
	  elements that are not (yet) visible, we have a storage we can rely
	  on.

2015-10-20  Benoît Allard  <benoit.allard@greenbone.net>

	Delete alert.svg as it is not the alert we are talking about.

	* CMakeLists.txt: Update
	* src/html/classic/img/alert.svg: Remove

2015-10-20  Benoît Allard  <benoit.allard@greenbone.net>

	* CMakeLists.txt: Install the files added in r23635.

2015-10-20  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js, src/html/classic/omp.xsl: Remember
	  the collapsed states.

2015-10-20  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/css/gsa-login.css, src/html/classic/gsad.xsl:
	  Center the login page without the <center> element.

2015-10-20  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-part): Remove the old filter
	  collapse button.

2015-10-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/alert.svg, src/html/classic/img/filter.svg,
	src/html/classic/img/note.svg, src/html/classic/img/override.svg,
	src/html/classic/img/slave.svg:  New.

	* src/html/classic/img/tag.svg, src/html/classic/img/target.svg,
	src/html/classic/img/task.svg: Removed some meta data.

	* CMakeLists.txt: Install the new svg icons.

2015-10-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (scanner [details]): Add parameter mandatory
	value column.

2015-10-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-create-target-form): Correct hidden
	credential inputs added when user may not access credentials.
	(target [trash]): Consider ESXi credential as well when checking if
	restoring is possible.

2015-10-19  Benoît Allard  <benoit.allard@greenbone.net>

	Update the layout of the main list pages.

	* CMakeLists.txt, src/html/classic/css/gsa-style.css,
	  src/html/classic/js/greenbone.js, src/html/classic/omp.xsl
	  (list-window): Update
	* src/html/classic/img/tag.svg, src/html/classic/img/target.svg,
	  src/html/classic/img/task.svg: Add

2015-10-19  Benoît Allard  <benoit.allard@greenbone.net>

	* src/gsad.c, src/gsad_base.h: Add support for the svg Content-Type.

2015-10-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/style/gsa-logo.png: Updated with dark
	font color RGBA #393637ff in the [0-f] notation instead of (39,36,37)
	in the [0-255] notation.

2015-10-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/style/gsa-logo.png: Updated with dark
	font color.

2015-10-16  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl (resource-permissions-window): remove menu
	  with 'New permission' here, make the JS dialog do what's intended.

2015-10-15  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Remove menu with extra
	"Create Multiple Permissions" option here.

2015-10-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Split "New Permission" and "Create Multiple Permissions" into two
	separate pages.

	* src/gsad.c (init_validator, exec_omp_get): Add new_permissions
	command.

	* src/gsad_omp.c (new_permissions, new_permissions_omp): New functions.

	* src/gsad_omp.h (new_permissions_omp): New function prototype.

	* src/html/classic/omp.xsl (resource-permissions-window, list-window):
	Add a menu to the "New Permission" with additional choice
	"Create Multiple Permissions".
	(html-create-permission-form): Remove "Create Multiple Permissions"
	form, which is moved to a sepate new template.
	(new_permissions, html-create-permissions-form): New templates
	with the multiple permissions form.

	* src/html/classic/help.xsl (new_permission.html): Remove section for
	"Create Multiple Permissions", moved to new template.
	(new_permissions.html): New template for "Create Multiple Permissions".

2015-10-14  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl (result-row): Make the New Note and
	  Override button also open a popup dialog.

2015-10-14  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl (nvt-details): New Note and New Overrides
	  also open a popup dialog.

2015-10-14  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl (user-tags-window-checked): Make the 'New
	  Tag' button starts a popup.

2015-10-14  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js (onReady): Allow for extra
	  parameters to be given for the new dialog.

2015-10-14  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/css/gsa-style.css, src/html/classic/gsad.xsl: Add
	  some place between the refresh and the logout_pane.

2015-10-14  Matthew Mundell <matthew.mundell@greenbone.net>

	Add alert method "Start Task".

	* src/gsad_omp.c (new_alert, get_alert, get_alerts, edit_alert): Get
	tasks for "Start Task" option.
	(append_alert_method_data): Add "Start Task".

	* src/html/classic/omp.xsl (html-create-alert-form): Add "Start Task"
	field.
	(new_alert, edit_alert): Add tasks param.
	(html-edit-alert-form): Add "Start Task" field.
	(alert, alert [details]): Add "Start Task" case.

2015-10-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Removed the download icon from the
	title bar. The download of all XML objects is also available via bulk action.
	Also, offering a download button for all XML objects at such a prominent
	location can cause trouble. For example, there could be millions of results.

2015-10-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add options to have a user inherit resources from a user being deleted.

	* src/gsad.c (init_validator): Add command delete_user_confirm and
	parameter inheritor_id.
	(exec_omp_get): Add case for delete_user_confirm.

	* src/gsad_omp.c (delete_resource): Add inheritor_id param for
	delete_users if given.
	(delete_user_confirm, delete_user_confirm_omp): New functions.
	(process_bulk_omp): Get users for user delete dialog.
	(bulk_delete_omp): Add inheritor_id to delete_user commands if given.

	* src/gsad_omp.h (delete_user_confirm_omp): New function prototype.

	* src/html/classic/omp.xsl (delete-icon, user): Show confirmation
	dialog with inheritor selection instead of directly deleting a user.
	(delete_user): New template.
	(process_bulk): Add inheritor selection when about to delete users.

	* src/html/classic/js/greenbone.js (RESPONSE_SELECTORS): Add entry for
	delete_user.
	(onReady): Add case for delete-action-icon class.

2015-10-13  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/gsad.xsl, src/html/classic/omp.xsl: Remove any
	  remains of the autorefresh as a server-side feature. The C code
	  still needs cleaning.

2015-10-13  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/gsad.xsl, src/html/classic/js/greenbone.js: Add a
	  #autorefresh select to the header, and move the storage of the
	  interval to the local browser storage.

2015-10-13  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Remove the mention of the
	  filter above the table.

2015-10-13  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Re-add the count of objects
	  in the title.

2015-10-13  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/css/gsa-style.css: .logout_panel: Align the text on
	  the right.

2015-10-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (user): Fix hiding of action icons when
	bulk selection checkboxes are shown.

2015-10-12  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Move the pager from the top of the page to
	  the top of the table.

2015-10-12  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/css/gsa-style.css: Make sure the multiple select
	  widget is not too narrow, even when empty.

2015-10-09  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsad.xsl (error_dialog, login_page): Add CSS classes
	to the dialog boxes to help selecting them.

	* src/html/classic/js/greenbone.js (OMPDialog [error]): Add parameter
	to set title of the error.
	(OMPDialog [postForm, show]): Handle requests returning the internal
	error dialog and the login form.

2015-10-09  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Remove usage of deprecated parameters.

2015-10-09  Benoît Allard  <benoit.allard@greenbone.net>

	Set the new/edit User -> group selection a multiple select box.

	* src/gsad.c, src/gsad_omp.c, src/html/classic/omp.xsl: Updated

2015-10-09  Benoît Allard  <benoit.allard@greenbone.net>

	* src/gsad_omp.c: Handle the case where all roles have been removed.

2015-10-09  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog [waiting, done]): Remove
	erroneous space in button selector.

2015-10-09  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog [waiting]): Only select
	the "ui-button" class buttons to avoid conflicts, e.g. with datepicker.
	(OMPDialog [done]): Use same selection as in "waiting" to reset button
	correctly and avoid conflicts with other widget types.

2015-10-09  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Remove unused templates

2015-10-09  Benoît Allard  <benoit.allard@greenbone.net>

	Set the new/edit User -> role selection a multiple select box.

	* src/gsad.c, src/html/classic/omp.xsl, src/gsad_omp.c: Updated.

2015-10-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/greenbone.js (OMPDialog): Remove "Cancel" button.

2015-10-07  Matthew Mundell <matthew.mundell@greenbone.net>

	Add option to Create Group to create permissions to share all resources
	between group members.

	* src/gsad.c (init_validator): Add grant_full.

	* src/gsad_omp.c (create_group_omp): Add SPECIALS to CREATE_GROUP,
	according to grant_full arg.

	* src/html/classic/omp.xsl (html-create-group-form): Add Special Groups
	field.

2015-10-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_one): Get permissions of any name, so that Super
	is included.  The resource ID is enough alone to limit the permissions.

2015-10-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (permission-subject-selection): Rename ID
	params, otherwise they can clash with the ID param given for the next
	page (for example role_id when creating a permission from Role Details).

	* src/gsad.c (init_validator): Add permission ID aliases.

	* src/gsad_omp.c (create_permission_omp, create_permissions_omp): Use
	new param names.

2015-10-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (group [details], role [details])
	(user [details]): Add permissions window.

	* src/html/classic/gsad.xsl (html-gsa-logo): Apply indicator icons for
	new permissions windows.

2015-10-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (report [results]): Correct typo.

2015-10-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (report [vulns]): When there are notes and
	overrides add icons that link to the notes and overrides pages.

2015-10-06  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (gsad_address_init): Check if IPv6 is supported when
	setting default listening address.

2015-10-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (export_many): Use correct subtype parameter name
	"asset_type" for assets.

2015-10-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Adapt to lsc_credentials now being named credentials. Use new
	credential types and show them in the credentials table and details.

	* src/gsad_omp.c: Change "lsc_credential" in commands for the
	credentials type and corresponding functions to "credential".

	* src/gsad_omp.h: Change function names as above.

	* src/gsad.c (init_validator): Change "lsc_credential" in commands
	and params for the credentials type to "credential". Update regular
	expressions for types to use "credential" instead of "lsc_credential".
	(exec_omp_post, exec_omp_get): Change "lsc_credential" to "credential".

	* src/html/classic/gsad.xsl: Match response elements for "credential"
	instead of "lsc_credential" for indicator. Change GET_LSC_CREDENTIALS
	to GET_CREDENTIALS.

	* src/html/classic/help.xsl: Rename "lsc_credential" pages to
	"credential".

	* src/html/classic/omp.xsl: Rename "lsc_credential" commands and help
	page URLs to "credential" and add new credential type fields / columns.
	Use new type abbreviations.

	* src/html/classic/wizard.xsl: Rename "lsc_credential" commands to
	"credential".

2015-10-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (list-window, asset/host): Add class and
	data-type attributes to bulk icons for actions that are not downloads:
	deleting, moving to trashcan and creating a new Target.

	* src/html/classic/js/greenbone.js (RESPONSE_SELECTORS): Add
	process_bulk case.
	(OMPDialog): Add a "Cancel" button and allow specifying a request
	method (GET or POST).
	(onReady): Show dialog for non-download bulk actions.

2015-10-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsad.xsl (gsa:n-i18n): Correct condition for using
	the default plural.

2015-10-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-override-form): Add radio button
	for "yes, for the next ... days" option that was missing when override
	was always active.

2015-10-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/css/gsa-style.css (.visualization)
	(.visualization-row, .visualization-box, .visualization-spacer): New
	classes to arrange charts in a table-like layout.

	* src/html/classic/omp.xsl (list-window): Add spacing that adapts to
	window width between charts.

	* src/html/classic/graphics.xsl (js-scan-management-top-visualization)
	(js-secinfo-top-visualization): Set chart parents to use new layout.
	(dashboard [secinfo]): Add adaptive width spacing between charts.

2015-10-01  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js, src/html/classic/gsad.xsl: Make
	  the autorefresh perform a genuine 'reload'. Browser support is
	  better: position in the page is kept as well as forms content.

2015-10-01  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/css/gsa-style.css: Remove the gradient in the
	  header altogether, set font color dark gray. The logo still needs
	  fixing.

2015-09-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/css/gsa-style.css (gb_menu): Make the text of the top
	buttons dark grey, to match the text of the selected item in the menu.

2015-09-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/css/gsa-style.css (gb_header): Change gradient so
	that the bottom flows into the green of the top menu items.

2015-09-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_base.c (params_add): Init new "array_len" field.

	* src/gsad_base.h (struct param): Add new field "array_len".

	* src/gsad_omp.c (create_task_omp, save_task_omp): Get Alerts from
	"alert_ids:" parameter if no "alert_id_optional" hashtable param is
	given and handle case without any Alert parameters.

	* src/gsad.c (init_validator): Add "alert_ids:" param.
	(params_append_mhd, params_mhd_add): Add "alert_ids:" as new param type
	which is accessed like a hashtable but is given as multiple params
	with the same name.

	* src/html/classic/omp.xsl (new_task, html-edit-task-alert): Change
	the name of the Alert selection field to "alert_ids:" and in the edit
	form use a variable for the Alerts already assigned to the task.

2015-09-30  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Stop the autorefresh when a dialog
	  is up.

2015-09-30  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js, src/html/classic/gsad.xsl: Move the
	  autorefresh to JavaScript.

2015-09-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (import_port_list): Update to new style that calls
	"omp" function, so that HTTP status is set on error.

2015-09-30  Matthew Mundell <matthew.mundell@greenbone.net>

	Move the port list upload out of "New Port List" and onto new page
	"Import Port List".

	* src/gsad.c (init_validator, exec_omp_get): Add upload_port_list.

	* src/gsad_omp.c (upload_port_list, upload_port_list_omp): New
	functions.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/classic/omp.xsl (details-header-icons): Add upload icon.
	(html-port-lists-table, port_list [details]): Enable upload icon.
	(upload_port_list): New template.

	* src/html/classic/js/greenbone.js (RESPONSE_SELECTORS): Add
	upload_port_list.

2015-09-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (asset [os-details]): Remove "Hosts using
	this Operating System" table.

2015-09-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add HTTP error codes for messages generated with gsad_message in
	src/gsad.c and in case the XSL transformation fails.

	* src/gsad_omp.c: Add response_data parameter for the functions
	manager_connect, logout and gsad_message to return an HTTP error code
	if XSL transformation fails.

	* src/gsad_omp.h (cmd_response_data_t): Remove. Moved to
	src/gsad_base.h.
	(xsl_transform_with_stylesheet, xsl_transform, gsad_message): Add new
	response_data parameter.

	* src/gsad_base.c: Add #include <microhttpd.h>.
	(xsl_transform_with_stylesheet, xsl_transform, gsad_message): Add new
	response_data parameter.

	* src/gsad_base.h (cmd_response_data_t): New. Moved from
	src/gsad_omp.h.

	* src/gsad.c (exec_omp_post, exec_omp_get, file_content_response)
	(request_handler): Set HTTP error codes for various error messages
	using gsad_message and add new response_data parameter for calls of
	xsl_transform and gsad_message.

2015-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (asset [host-details]): Show Created column
	when showing all identifiers.

2015-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Simplify the Host Details page a little.

	* src/gsad.c (init_validator): Add show_all.

	* src/html/classic/omp.xsl (asset [host-details]): Show only the latest
	identifiers initially, with a link to show them all.  Remove the Created
	column and merge the Source Type column into the Source column.

2015-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (os-details): Add Latest Severity and Highest
	Severity fields.
	(html-oss-table): Add Highest Severity column.
	(asset [os-details], asset/os): Remove Severity column.

2015-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (asset [os-details], asset/os): Make the host
	count a link to the Operating Systems page.

2015-09-29  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/graphics.xsl: Stop using a non-existing version of
	  d3.

2015-09-29  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Make the alert selection for edit task
	  dialog a multiple select (gsad still needs fixing).

2015-09-29  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Remove the waiting cursor in case
	  of errors.

2015-09-28  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Make the alert selection for new task a
	  multiple select widget (gsad also needs a fix)

2015-09-28  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Remove unused 'new-task-group-select'
	  template.

2015-09-28  Benoît Allard  <benoit.allard@greenbone.net>

	Get rid of the JavaScript indicator and its help page.

	* src/html/classic/help.xsl, src/html/classic/help_ru.xsl,
	  src/html/classic/help_de.xsl, src/html/classic/help_zh_CN.xsl,
	  src/html/classic/gsad.xsl: Updated

2015-09-28  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Make sure the dialog is cleaned up
	  when it's closed.

2015-09-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Skip the ID check for "asset" and
	"prognostic" type reports.

2015-09-28  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Move the error handling to a
	  separate callback.

2015-09-25  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (html-import-report-form): Make Report
	the first entry because that is what the dialog is about.

2015-09-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (host-link): If the host is not in the asset
	db, then link to the list of hosts that have the same IP.  Remove the
	list icon that was always linking to the list of hosts.

2015-09-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (details-header-icons): Add New Task menu.

2015-09-24  Matthew Mundell <matthew.mundell@greenbone.net>

	For container tasks replace the start icon with an Import Report icon.

	* src/html/classic/omp.xsl (task-icons): Replace start with import.
	(html-gsa-logo): Add indicator icons.

	* src/html/classic/js/greenbone.js (onReady): Pass the task_id into the
	OMPDialog in the upload case, so that the right task is selected in the
	dropdown.

2015-09-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Add an icon for creating a container task on the Import Report dialog.
	To support this remove the report field from New Container Task, and add
	a dedicated cmd "new_container_task" for the page (instead of using
	"create_report").

	* src/gsad.c (init_validator, exec_omp_post): Add create_container_task.

	* src/gsad_omp.c (upload_report, upload_report_omp): Move up in file.
	(create_report_omp): If the report is missing, just create a container
	task.  Check which cmd was called to determine next page on error.
	(create_container_task_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/classic/gsad.xsl (create_report_response): Use Create Report
	as command.
	(html-gsa-logo): Add indicator icons.

	* src/html/classic/js/greenbone.js (NAME_SELECTORS): Add
	new_container_task.

	* src/html/classic/omp.xsl (html-import-report-form): Add New icon for
	creating container.  Correct button text.
	(upload_report): Match with mode to differentiate from
	new_container_task case.
	(new_container_task): Switch cmd to new_container_task.  Get single task
	next, like in other create situations.  Remove report field.
	(get_report): Match create_report_response.

2015-09-23  Matthew Mundell <matthew.mundell@greenbone.net>

	Move the New Container Task window from the New Task page to a new
	separate page.  Give the New icon for tasks a dropdown for regular
	and container tasks.

	* src/gsad.c (init_validator, exec_omp_get): Add new_container_task.

	* src/gsad_omp.c (new_container_task, new_container_task_omp): New
	functions.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/classic/js/greenbone.js (RESPONSE_SELECTORS): Add
	new_container_task.

	* src/html/classic/omp.xsl (list-window): Add special case for task new
	icon with menu.
	(new_container_task): New template.  From new_task.
	(new_task): Remove "New Container Task" window.

2015-09-23  Matthew Mundell <matthew.mundell@greenbone.net>

	Add an upload icon to the Reports page header, and a new page Upload
	Report.

	* src/gsad.c (init_validator, exec_omp_post, exec_omp_get): Add
	import_report and upload_report.

	* src/gsad_omp.c (upload_report, upload_report_omp)
	(import_report_omp): New functions.
	(get_report): Look for an ID in a create response if the is no ID.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/classic/js/greenbone.js (RESPONSE_SELECTORS): Add
	upload_report.

	* src/html/classic/omp.xsl (html-import-config-form, upload_report): New
	templates.
	(html-reports-table): Enable upload icon.

2015-09-22  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (report [results]): Added some notes for
	the user on what could be the reason for 0 results.

2015-09-22  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (report [results]): Add the number of hosts
	if there are no results.

2015-09-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (result [result-row], result)
	(report [errors]): Get the asset ID from the parent HOST instead of
	the detailed HOST.

2015-09-22  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_gantt_chart.js (generate): Move and scale
	future run markers when chart is resized.

2015-09-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (host-link): Add a tooltip on the link to
	make it clearer what it is.  Add a list icon that is always present and
	links to all asset hosts having the IP.

2015-09-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-create-target-form): Disable the link
	on the asset host count.  If there's only 1 host use singular instead
	of plural for "hosts".  When there are 0 hosts still display the "From
	host assets" radio, but grey it out.

2015-09-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/js/greenbone.js (RESPONSE_SELECTORS): Add new_host.

2015-09-21  Matthew Mundell <matthew.mundell@greenbone.net>

	Add Asset Host editing.

	* src/gsad.c (init_validator, exec_omp_post, exec_omp_get): Add
	edit_asset and save_asset.

	* src/gsad_omp.c (edit_asset, edit_asset_omp, save_asset_omp): New
	functions.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/classic/omp.xsl (role [details]): Specify permission name for

	* src/html/classic/js/greenbone.js (RESPONSE_SELECTORS): Add edit_asset.

2015-09-21  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Move onReady later, to benefit
	  the advantages of the viewPort.

2015-09-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (role [details]): Specify permission name for
	"id" variable too, as there may be multiple permissions.

2015-09-18  Benoît Allard  <benoit.allard@greenbone.net>

	Use minified version of the javascript in Release mode only.

	* src/html/classic/gsad.xsl, CMakeLists.txt: Updated
	* src/html/classic/js/jquery-2.1.4.min.js,
	  src/html/classic/js/jquery-ui.min.js,
	  src/html/classic/js/d3.v3.min.js,
	  src/html/classic/js/select2.min.js: Moved to min/ directory
	* src/html/classic/js/min, src/html/classic/js/min/jquery-2.1.4.js,
	  src/html/classic/js/min/select2.js,
	  src/html/classic/js/min/jquery-ui.js,
	  src/html/classic/js/min/d3.v3.js: Moved from parent directory.

2015-09-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (CHECK): Add missing brackets.

2015-09-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (list-window-line-icons): Add a resource
	arg so that asset/host can use this in the future.

2015-09-18  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Make the select2 get keyboard
	  interaction also when inside dialogs.

2015-09-18  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Don't show the UserTags and permission
	  when editing a config.

2015-09-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_host_omp): Handle host comment.

	* src/html/classic/omp.xsl (html-create-host-form): Add comment field.
	(asset/host): Display comment.

2015-09-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (set_http_status_from_entity): If entity is NULL set
	http_status_code.

2015-09-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (SET_HTTP_STATUS_FROM_ENTITY): Remove.  Now a function.
	(set_http_status_from_entity): New function.  Was macro.  Also add
	entity check.  Update all callers.

2015-09-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (host-link): Skip the link if an asset ID
	is not available.

2015-09-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (host-link): Link to asset Host Details
	instead of Assets.
	(result [result-row], result, report [hosts], report [closed_cves])
	(report [ssl_certs], report [errors]): Update host-link call.

2015-09-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Move bulk new icon to the
	right of the delete icon, to match the row icons.

2015-09-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (tag_resource_types, html-configs-table): Use
	Scan Config instead of Scan Configuration, like everywhere else.

	* src/html/classic/help.xsl (new_config.html, glossary.html)
	(my_settings.html, config_details.html, config_editor.html)
	(config_editor_nvt_families.html, config_editor_nvt.html)
	(config_family_details.html, config_nvt_details.html): Refer to configs
	as "Scan Configs" everywhere, instead of mixing in the term "Scan
	Configuration", because "Scan Config" is what is used in the interface.

2015-09-17  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Simplify/consolidate online help by introducing some generic
	pages. As an example, the resource type "Target" is converted
	to use the new scheme.
	This covers the following changes in genereal:
	    - drop the list/details/etc icons in the help title bar.
	    - drop the description of actions, filter, sorting from the bottom of the pages
	    - link resource group at the top: table, details, new/edit
	    - link general description at the top: Standard Actions, Filtering
	Also, changes the phrases slightly, because new/edit is a modal dialog now.

	* src/html/classic/help.xsl (sorting): Drop the title h3.
	(new_target.html): Renamed to new_edit_target.html and applied the above
	described changes.
	(standard_actions.html, filtering.html): New.
	(target_details.html, targets.html): Applied above changes.

2015-09-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (solution-icon): Correct file name for
	"Mitigation" icon.

2015-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (list-window, html-config-table): Use
	"Import" instead of "Upload" in the tooltip.

2015-09-16  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js, src/html/classic/omp.xsl: Make the
	  schedule dialog work again as popup dialog.

2015-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Enable pop-up dialog for config upload.

	* src/html/classic/omp.xsl (list-window, html-config-table): Correct
	upload icon class.

	* src/html/classic/js/greenbone.js (RESPONSE_SELECTORS): Add
	upload_config.
	(onReady): Add upload-action-icon case.

2015-09-16  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (SET_HTTP_STATUS_FROM_ENTITY): Move up so it can be
	used in simple_ompf.
	(simple_ompf, setting_get_value, export_resource, PARAM_OR_SETTING)
	(new_task, save_target_omp, get_report, save_my_settings_omp)
	(save_filter_omp): Set HTTP status code on OMP errors.
	(authenticate_omp): Remove response_data param from doc which is not
	part of the actual function signature. Add NULL response_data param to
	setting_get_value calls.

2015-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Move Import Scan Config form from New Config page to dedicated page.

	* src/gsad.c (init_validator, exec_omp_get): Add upload_config.

	* src/gsad_omp.c (upload_config, upload_config_omp): New functions.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/classic/omp.xsl (list-window): Add upload icon.
	(new_config): Remove html-import-config-form call.
	(upload_config): New template.
	(html-config-table): Add upload icon.
	(html-configs-table): Enable upload icon.

2015-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_my_settings_omp): Use the filters instead of
	defaults when sending resource filters.

2015-09-16  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (redirect_handler): Fix check for IPv6.

2015-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (asset [os-details]): Add second column in
	Unavailable case, for completeness.

2015-09-16  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c: Set HTTP status codes for messages generated with
	gsad_message and on OMP errors responses for commands that check the
	response entity.
	(xsl_transform_omp, check_modify_config, omp, simple_ompf, ompf)
	(send_settings_filters): Add response_data parameter.

2015-09-16  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Only remove the last submit button
	  row.

2015-09-16  Benoît Allard  <benoit.allard@greenbone.net>

	Separate jquery-ui theme and structure, switch to greenbone-ish theme.

	* CMakeLists.txt, src/html/classic/gsad.xsl: Update
	  src/html/classic/css/jquery-ui.theme.min.css,
	  src/html/classic/css/jquery-ui.structure.css,
	  src/html/classic/css/jquery-ui.structure.min.css,
	  src/html/classic/css/jquery-ui.theme.css: Add
	* src/html/classic/css/jquery-ui.css,
	  src/html/classic/css/jquery-ui.min.css: Remove
	* src/html/classic/css/images/*.png: Refresh.

2015-09-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (process_bulk_omp): Remove "uuid=" from string, it's
	added for each ID.

	* src/html/classic/omp.xsl (list-window): Add host_count for "Apply to
	selection" case too.
	(html-create-target-form): If the host count is 0 then use the count of
	bulk_selected params.  This is for the "Apply to selection" case.

2015-09-15  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Display an error when part of the
	  page was ignored.

2015-09-15  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Add support for more new dialogs.

2015-09-15  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Set the cursor on the html
	  element, it's even bigger.

2015-09-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl: Change any "Last modified" into just "Modified"
	in the user interface. The shorter term is used for columns already and in
	fact no other value than the latest modification date makes sense and
	users would never expect some other than this. The shorter term
	looks more consistent and is, well, shorter.

2015-09-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/help.xsl (mode="help" match="nvts.html"): Fix minor typo.

2015-09-15  Matthew Mundell <matthew.mundell@greenbone.net>

	Add creation of targets from bulk selection to Hosts page.

	* src/gsad.c (init_validator): Add asset_hosts to target_source.
	Add new params.

	* src/gsad_omp.c (create_target_omp): Add ASSET_HOSTS to OMP if "From
	host assets" radio was selected.
	(process_bulk_omp): Add create action.
	(create_host_omp): Correct fallback page.

	* src/html/classic/omp.xsl (list-window): Add inputs for creating target
	to Hosts page bulk inputs.
	(html-create-target-form): Add "From host assets" radio.
	(asset/host): Replace New Target row icon with form icon.

2015-09-15  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Make the dialog a property of the
	  object.

2015-09-15  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl, src/html/classic/js/greenbone.js,
	  src/html/classic/gsad.xsl: Enable the new dialog on most of the
	  'new' buttons (not functionnal everywhere yet).

2015-09-15  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl, src/html/classic/js/greenbone.js:
	  Implement the dialog for all remaining edit buttons (almost).

2015-09-14  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Add a waiting cursor before the
	  dialog show up.

2015-09-14  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Add support for most of the edit
	  buttons.

2015-09-14  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl, src/html/classic/js/greenbone.js: Enable
	  the edit dialog on all tables. (not functionnal yet)

2015-09-14  Benoît Allard  <benoit.allard@greenbone.net>

	* CMakeLists.txt, src/html/classic/css/gsa-style.css,
	  src/html/classic/js/greenbone.js: Implement a waiting state.
	* src/html/classic/img/loading.gif: Add

2015-09-14  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Make the edit dialog code more generic
	  (type independant)

2015-09-14  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js, src/html/classic/omp.xsl: Wire the
	  edit-task button to the corresponding code.

2015-09-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Add comments.

2015-09-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-create-target-form): Fill manual hosts
	from hosts param if given.
	(html-create-target-form): Increase number of icons.
	(asset/host): Add New icon.

2015-09-11  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Add support for edit_task.

2015-09-11  Michael Wiegand <michael.wiegand@greenbone.net>

	Simplify project version setting. Use SVN version at build time in
	binary instead of SVN version at configuration time. Make SVN revision
	retrieval work with SVN >= 1.7.

	* CMakeLists.txt: Set project version independently of CPack
	configuration. Make switching between beta and stable version schemes
	easier. Use version string with possible SVN revision suffix for the
	CPack package version, but skip SVN revision suffix for GSAD_VERSION
	since we do not care about the revision at configuration time. Improve
	SVN checkout detection to work with SVN >= 1.7 as well. Change non
	release version style to be consistent with other modules.

	* src/CMakeLists.txt: Determine build time SVN revision if the build
	type is not "Release" and SVN information is available.

	* src/gsad.c: Include SVN revision in version information if it is
	available.

	* getsvn.cmake: New. CMake script to write SVN revision to a header
	file if SVN information is available.

2015-09-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (host-link): New template.
	(result [result-row], result, report [hosts], report [closed_cves])
	(report [ssl_certs], report [errors]): Link to new asset Hosts instead
	of classic Host Details.

2015-09-11  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Also recognize gsad error as such.

2015-09-11  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js: Switch to XML for the answer of
	  the POST request

2015-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl (object-used-by, cpe_details.html)
	(config_details.html, config_editor.html)
	(config_editor_nvt_families.html, config_family_details.html): Remove
	reference to details icon.
	(hosts_classic.html, user_details.html, filter_details.html)
	(group_details.html): Remove commented section.
	(tag_details.html): Remove details icon, which is only for going to an
	example page.

2015-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (user-tags-window-checked)
	(tag [for_resource], lsc_credential [details], alert [details])
	(filter [details], target [details], html-config-family-table)
	(preference, family, config [families], html-config-table)
	(schedule [details], scanner [details], slave [details])
	(cve-details, port-list [details], report_format [details])
	(role [details], asset [os-details]): Remove the details icon from
	the Action column, and remove the action column if it was the only
	icon.  Make the name column a link to the details.

	(get_info_allinfo_action): Remove.  Not used.

2015-09-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c: Add a response_data output param to the command
	functions for returning additional data for the HTTP response like
	HTTP status codes.
	(cmd_response_data_init, cmd_response_data_reset): New functions.

	* src/gsad_omp.h: Add a response_data output param to the command
	functions.
	(cmd_response_data_t): New type.
	(cmd_response_data_init, cmd_response_data_reset): New prototypes.

	* src/gsad.c (exec_omp_post, exec_omp_get, request_handler): Add
	response_data output param to the command functions and set HTTP
	status code according to http_status_code field in response_data.

2015-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (asset/host, asset/os): Add export to
	actions.

2015-09-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_gantt_chart.js (generate): Set the size of
	bars for schedules without duration and period to 24 hours.

2015-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl (glossary.html): Order alphabetically.

2015-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Update help for Assets.

	* src/html/classic/help.xsl (details-window-line-actions): Add clone,
	new and edit params.
	(host_details.html): New template.
	(hosts.html): Convert to Asset version of Hosts page.
	(hosts_classic.html): New template.  Body from old hosts.html.
	(glossary.html): Add asset and host.
	(new_host.html, os_details.html, oss.html): New template.

	* src/html/classic/omp.xsl (assets, host [classic])
	(html-create-host-form): Switch classic asset links to new page.
	(html-oss-table): Hide new icon.

2015-09-10  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/js/greenbone.js, src/html/classic/omp.xsl: When a
	  new resource is created, automatically fill it in the sub-dialog.

2015-09-10  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl, src/html/classic/js/greenbone.js: Rewrite
	  the js code to use OOP.

2015-09-10  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl, src/html/classic/js/greenbone.js: Fix the
	  ajax requests.

2015-09-09  Benoît Allard  <benoit.allard@greenbone.net>

	Add a pop-up dialog when creating a new target from the new task menu.

	* src/html/classic/gsad.xsl, src/html/classic/css/jquery-ui.css,
	  src/html/classic/css/jquery-ui.min.css, src/html/classic/omp.xsl,
	  src/html/classic/js/jquery-ui.min.js,
	  src/html/classic/js/jquery-ui.js, CMakeLists.txt: Updated.
	* src/html/classic/js/greenbone.js: Added.

2015-09-09  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/gsad.xsl: Insert the 'token' in the DOM of the page
	  for easy access.

2015-09-09  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Use the datepicker in the edit schedule
	  dialog.

2015-09-09  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/css/gsa-style.css, src/html/classic/omp.xsl: Fix
	  the table stripping once for all (New Schedule).

2015-09-09  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/add_to_assets.png,
	src/html/classic/img/calendar.png,
	src/html/classic/img/remove_from_assets.png: New.

	* CMakeLists.txt: Install the new icons.

	* src/html/classic/omp.xsl (html-create-schedule-form): Use new calendar
	icon.
	(report-icons): Use new asset icons.

2015-09-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_info, get_asset): Remove extra space.

2015-09-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (asset [host-details]): Put a link to the
	user in the Source column when the source type is User.

2015-09-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Serve the login pages with different HTTP status codes depending on
	the situation.

	* src/gsad.c (exec_omp_post, request_handler): Send login form response
	with HTTP status code 503 if OMP service is down or an authorization
	error occurs. Send code 401 if the credentials are wrong, the token or
	cookie is bad or missing, or if the session is expired. Send code 400
	if the credentials contain invalid characters or the user tries logging
	out while already logged out.

2015-09-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-create-host-form): Correct next and add
	asset_type params, so that the next page is the created host and not the
	host list.

2015-09-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (asset [host-details]): Add new icon, like on
	other details pages.

2015-09-08  Matthew Mundell <matthew.mundell@greenbone.net>

	Implement exporting of assets.

	* src/gsad.c (init_validator): Add export commands and subtype.
	(exec_omp_get): Add export commands.

	* src/gsad_omp.c (export_resource): If there's a subtype then add it to
	the OMP.
	(export_many): Add asset special case.
	(export_asset_omp, export_assets_omp): New functions.

	* src/html/classic/omp.xsl (list-window): Add special case for asset
	export icon.
	(asset [os-details], asset [host-details]): Correct tooltip.  Add export
	icon.

2015-09-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (manager_connect): Add tests if param "html" is NULL.

2015-09-08  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Make sure the gb_window class is used
	  everywhere.

2015-09-08  Benoît Allard  <benoit.allard@greenbone.net>

	Add a datepicker to support the date entry for new schedules.

	* src/gsad.c, src/html/classic/js/jquery-ui.min.js,
	  src/html/classic/js/jquery-ui.js, src/html/classic/gsad.xsl,
	  src/html/classic/css/jquery-ui.css,
	  src/html/classic/css/jquery-ui.min.css,
	  src/html/classic/css/gsa-style.css, src/html/classic/omp.xsl,
	  CMakeLists.txt: Updated.

2015-09-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (host [classic]): Handle host_status host
	detail.

2015-09-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add Asset to resource types.

	* src/html/classic/omp.xsl (list-window): Use delete instead of trashcan
	for assets.

2015-09-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Add subtype to refresh icon if
	given.

2015-09-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (asset [host-details]): Correct asset type
	in delete icon.

2015-09-07  Matthew Mundell <matthew.mundell@greenbone.net>

	Add manual creating of host assets.

	* src/gsad.c (init_validator, exec_omp_get, exec_omp_post): Add
	create_host and new_host.

	* src/gsad_omp.c (new_host, new_host_omp, create_host_omp): New
	functions.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/classic/gsad.xsl (html-gsa-logo): Add CREATE_ASSET indicator.

	* src/html/classic/omp.xsl (list-window): Use the subtype in the new
	command, if a subtype is given.
	(html-create-host-form, new_host): New templates.

2015-09-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_gantt_chart.js: Add CSV and HTML tables as
	well as SVG export. Create label shadows as separate elements as
	paint-order attribute is not well supported.

	* src/html/classic/js/gsa_graphics_base.js (tasks_column_info): Correct
	"schedule_first_time" entry.
	(svg_from_elem): Insert CSS into an existing "defs" subelement if one
	exists.

2015-09-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_gantt_chart.js (generate): Use an opacity
	gradient on bars without a well-defined end. Remove "Next scheduled
	run" from tooltip of bars.

2015-09-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (asset-os-icon): Make tooltip for os icon
	independent of "scanning" aspect.

2015-09-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Add deleting of Hosts.

	* src/html/classic/omp.xsl (asset [os-details]): Correct asset_type and
	title.
	(asset [host-details]): Add delete icon.
	(html-hosts-table): Use actual icon count, because there is one.
	(html-oss-table): Remove Action column and use actual icon count, so
	that Action column is produced automatically.
	(asset/host): Add delete icon.
	(asset/os): Move delete icon into bulk action check, else an extra
	column is produced.

2015-09-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add option to move a Task to a new slave on the details and edit pages.

	* src/gsad_omp.c (edit_task): Add static header.
	(generate_page): Add edit_task.
	(move_task_omp): New function.
	(get_task): Get slaves list.

	* src/gsad_omp.h (move_task_omp): New function prototype.

	* src/gsad.c (init_validator, exec_omp_post): Add move_task command.

	* src/html/classic/gsad.xsl (move_task_response [response-indicator]):
	New template.
	(html-gsa-logo): Add indicator for move_task on get_task and edit_task
	pages.

	* src/html/classic/omp.xsl (move_task_icon): New template.
	(task [details]): Add "Move task" menu icon.
	(move_task_response): New template.
	(html-edit-task-form): Add "Move task" menu icon.

2015-09-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (asset [os-details]): Add delete icon.

2015-09-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Add deleting to OSs page.

	* src/html/classic/omp.xsl (html-oss-table): Add Actions column.
	(get_assets): Match create and delete responses.
	(asset/os): Add delete icon.

2015-09-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp-doc.xsl (match="type" mode="details"): Removed
	usage of "wrap" because this is now done via style of <pre>.

	* src/html/classic/rnc.xsl (rnc-wrap, rnc-wrap-line): Removed. These
	were never used.

2015-09-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Make it possible to add all assets from a report.

	* src/gsad.c (init_validator, exec_omp_post): Add create_asset.

	* src/gsad_omp.c (create_asset_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/classic/omp.xsl (get_report): Match create_asset_response.
	(report-icons): Add "Add to Assets" icon.
	(create_asset_response): New template.

	* src/html/classic/gsad.xsl (create_asset_response): New template.
	(html-gsa-logo): Add indicator for report page CREATE_ASSET.

2015-09-03  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Get rid of the last occurences of the wrap
	  template.

2015-09-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-scan-management-top-visualization):
	Add empty_text to gen_params of scheduled Tasks chart.

	* src/html/classic/js/gsa_gantt_chart.js (generate): Add arrows to
	indicate scheduled tasks that are out of view and text if the list of
	scheduled tasks is empty.

2015-09-03  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Fix typo in the method name.

2015-09-03  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Cleanup erroneous usage of the wrap
	  template. There are better ways to limit the length of a field.
	  `text-overflow: ellipsis` is an option for instance.

2015-09-03  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/css/gsa-style.css, src/html/classic/omp.xsl:
	  Let the browser do the wrapping in the <pre> elements.

2015-09-03  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/css/gsa-style.css: Unify the greens used in the
	  menu elements.

2015-09-03  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/css/gsa-style.css: Give the logo some breathing
	  space.

2015-09-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Add deleting of all assets that came from a report.

	* src/gsad_omp.c (delete_asset_omp): Do the delete by hand, in order to
	pass report_id if given.

	* src/html/classic/omp.xsl (get_report): Match delete_asset_response.
	(report-icons): Add "Remove from Assets" icon.

	* src/html/classic/gsad.xsl (delete_asset_response): New template.
	(html-gsa-logo): Add indicator for report page DELETE_ASSET.

2015-09-02  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-scan-management-top-visualization):
	Add empty_text to gen_params of Top 10 Tasks chart. Correct chart_name
	for the right scheduled Tasks chart.

	* src/html/classic/js/gsa_h_bar_chart.js (generate): Adjust left margin
	and axis to label length and show text if the records list is empty.

2015-09-02  Benoît Allard  <benoit.allard@greenbone.net>

	Remove the fixed max-width, use all the space available.

	* src/html/classic/gsad.xsl, src/html/classic/css/gsa-style.css:
	  Updated.

2015-09-02  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (struct user): Add address element.
	(user_add): Add user's IP address.
	(user_find): Check that the client's address matches the user's.
	(exec_omp_post, request_handler): Adjust user_add() and user_find()
	calls and handle return values accordingly.

2015-09-02  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-aggregate-chart, js-tasks-chart):
	Use correct count of node-set parameters for placing commas.
	(js-scan-management-top-visualization): Add empty_text to gen_params
	of the "'High' results per host" bubble charts.

	* src/html/classic/js/gsa_bubble_chart.js: Filter out records with
	zero size_value for bubble creation. Add a dummy bubble if there are no
	non-zero records.

2015-09-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Add deleting of host identifiers.

	* src/gsad.c (init_validator, exec_omp_post): Add delete_asset.

	* src/gsad_omp.c (delete_resource): Add next_id handling in case the ID
	for the next page would have the same name.
	(delete_asset_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/classic/omp.xsl (delete_asset_response): New template.
	(asset [host-details]): Add delete icon.
	(get_asset): Match delete response.

2015-09-02  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsad.xsl (html-head): Consolidate conditional
	loading of scripts and stylesheets and load gsa-style.css second to
	allow overwriting of styles from select2.min.css.

	* src/html/classic/css/gsa-style.css: Add styles to make size of
	Select2 dropdown boxes more like the old basic ones.

2015-09-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/css/gsa-style.css: Increase envelope width
	from 1200 to 2000. The GUI looks OK for upto that size and then
	gets a bit harder to read (eg. the expanded results.

2015-09-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-create-target-form)
	(html-edit-target-form): Only show "pass" type credentials in SMB and
	ESXi dropdowns.

2015-08-31  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (export_many): XML escape the filter.

2015-08-31  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsad.xsl (login_page): Use last page URL for guest
	login if available.

2015-08-31  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/css/gsa-style.css: Make better use of the width of
	  the display.

2015-08-31  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: REstore the display of the extra filter\
	  elements above the filterbox.

2015-08-31  Benoît Allard  <benoit.allard@greenbone.net>

	Integrate the menu bar into the header.

	* CMakeLists.txt, src/html/classic/css/gsa-style.css,
	  src/html/classic/gsad.xsl: Updated
	* src/html/classic/img/style/background.png: Removed

2015-08-31  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add Gantt chart of Task schedules and update D3.js.

	* CMakeLists.txt: Install file src/html/classic/js/gsa_gantt_chart.js.

	* src/gsad_omp.c (generate_page): Add get_tasks_chart.
	(get_tasks): Add parameters ignore_pagination and schedules_only.
	(get_tasks_chart, get_tasks_chart_omp): New functions.

	* src/gsad_omp.h (get_tasks_chart_omp): New function prototype.

	* src/gsad.c (init_validator): Add command get_tasks_chart and params
	ignore_pagination and schedules_only.
	(exec_omp_get): Add case for get_tasks_chart.
	(request_handler): Apply guest chart content security headers to
	get_tasks_chart as well.

	* src/html/classic/graphics.xsl (init-d3charts): Add script
	/js/gsa_gantt_chart.js.
	(js-tasks-data-source, js-tasks-chart): New templates.
	(js-scan-management-top-visualization): Add Gantt chart of Task
	Schedules.

	* src/html/classic/gsad.xsl (envelope): Do not add menus, logo and
	footer for get_tasks_chart.

	* src/html/classic/omp.xsl (get_tasks_chart): New template

	* src/html/classic/js/d3.v3.js, src/html/classic/js/d3.v3.min.js:
	Update to version 3.5.6.

	* src/html/classic/js/gsa_gantt_chart.js: New JavaScript file for Gantt
	charts.

	* src/html/classic/js/gsa_graphics_base.js (Chart [detached_url]):
	Use get_tasks_chart if command is get_tasks.
	(DataSource): Add case for get_tasks.
	(tasks_column_info, extract_task_records): New functions.
	(fit_detached_window): Select #tasks-display as well.

2015-08-28  Benoît Allard  <benoit.allard@greenbone.net>

	Make the top menu flat, integrate the buttons with the header.

	* CMakeLists.txt, src/html/classic/gsad.xsl,
	  src/html/classic/css/gsa-style.css: Updated
	* src/html/classic/img/style/top_menu_buttons.png: Removed

2015-08-28  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl: Dynamically toggle the filterbox.

2015-08-27  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/gsad.xsl, src/html/classic/css/gsa-style.css: Enable
	  select2 for all selects on all pages.

2015-08-26  Benoît Allard  <benoit.allard@greenbone.net>

	Add select2 to all pages, we still need to enable it.

	* src/html/classic/js/select2.js, src/html/classic/js/select2.min.js,
	  src/html/classic/css/select2.css,
	  src/html/classic/css/select2.min.css: Added
	* COPYING, CMakeLists.txt, src/html/classic/gsad.xsl: updated

2015-08-26  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* CMakeLists.txt: Install src/html/classic/js/d3.tip.js instead of
	the minified version.

	* COPYING: Update file name for d3-tip.

	* src/html/classic/graphics.xsl (init-d3charts): Replace d3.tip.min.js
	with d3.tip.js.

	* src/html/classic/js/d3.tip.min.js: Remove. Replaced with d3.tip.js.

	* src/html/classic/js/d3.tip.js: New. Current non-minified version of
	d3-tip.

2015-08-26  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/css/gsa-style.css: Fix the path to the background
	  image.

2015-08-26  Benoît Allard  <benoit.allard@greenbone.net>

	Move the CSS files in their own directory.

	* CMakeLists.txt, src/gsad.c, src/html/classic/gsad.xsl: Updated
	* src/html/classic/gsa-style.css -> src/html/classic/css/gsa-style.css
	* src/html/classic/gsa-login.css -> src/html/classic/css/gsa-login.css

2015-08-26  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (get_client_address): Use sockaddr_as_str().

2015-08-26  Benoît Allard  <benoit.allard@greenbone.net>

	* COPYING: Add paragraph about jQuery.

2015-08-26  Benoît Allard  <benoit.allard@greenbone.net>

	Add jQuery on all pages except the login page.

	* src/html/classic/js/jquery-2.1.4.js,
	  src/html/classic/js/jquery-2.1.4.min.js,
	  src/html/classic/js/jquery-2.1.4.min.map: Add
	* src/html/classic/gsad.xsl, CMakeLists.txt: Update

2015-08-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (asset [os-details]): Add Average Severity
	field.  Add Severity column for hosts.
	(html-oss-table, asset/os): Add Latest and Average Severity columns.

2015-08-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add options to set special content security headers for charts
	requested by the guest user, which are less restrictive to allow
	embedding by default.

	* src/gsad.c (DEFAULT_GSAD_GUEST_CHART_X_FRAME_OPTIONS)
	(DEFAULT_GSAD_GUEST_CHART_CONTENT_SECURITY_POLICY)
	(ADD_GUEST_CHART_CONTENT_SECURITY_HEADERS): New #defines.
	(http_guest_chart_x_frame_options)
	(http_guest_chart_content_security_policy): New static variables.
	(handler_send_response): No longer add content security headers here.
	(request_handler): Add content security headers here, using special
	guest chart ones if the user is the guest user and the command is
	"get_aggregate".
	(main): Add arguments http-guest-chart-frame-opts and
	http-guest-chart-csp.

	* doc/gsad.8: Add new options http-guest-chart-frame-opts and
	http-guest-chart-csp.

2015-08-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (exec_omp_post): Log authentication failed attempts.

2015-08-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js (generate),
	src/html/classic/js/gsa_bubble_chart.js (generate),
	src/html/classic/js/gsa_cloud_chart.js (generate),
	src/html/classic/js/gsa_donut_chart.js (generate),
	src/html/classic/js/gsa_h_bar_chart.js (generate),
	src/html/classic/js/gsa_line_chart.js (generate): Generate HTML table
	on demand so the actual chart finishes generating earlier.

2015-08-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (DEFAULT_GSAD_CONTENT_SECURITY_POLICY): Change to include
	blob: as an img-src as required by copyable SVG of charts.

	* doc/gsad.8: Update the --http-csp option accordingly.

2015-08-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-create-target-form): Insert client
	address into hosts field.

2015-08-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js (generate),
	src/html/classic/js/gsa_h_bar_chart.js (generate): Calculate percentage
	in tooltip based on maximum instead of sum for fields other than count.

2015-08-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/wizard.xsl (quick-first-scan-wizard)
	(quick-task-wizard): Insert client address into the target hosts field.

2015-08-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-groups-table): Add missing
	filtered-count param for list-window template call.

2015-08-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-nvt-table): Fix swapped i18n msgid and
	context for Severity column.

2015-08-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (edit-header-icons): Use correct URL for
	config editor help.

2015-08-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (data_top_list): New
	data transformation function. Selects only first 10 records with
	non-zero y field.

	* src/html/classic/js/gsa_h_bar_chart.js (generate): Get top 10 list
	using data_transform function instead of doing it directly.

2015-08-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (create_task_omp): Remove leftover test output.

2015-08-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (new_task): Get tag names list.
	(create_task_omp): Add option for automatically adding a tag directly
	after creating the task.

	* src/gsad.c (init_validator): Add "add_tag" parameter.

	* src/html/classic/omp.xsl (new_task): Add fields for adding a tag.

	* src/html/classic/help.xsl (new_task.html): Add help for tag fields.

2015-08-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-scan-management-top-visualization):
	Add correct "Top 10" chart to left visualization box.

2015-08-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add word cloud charts for Results.

	* CMakeLists.txt: Install new JS files.

	* COPYING: Add copyright and license info for d3 cloud layout.

	* src/gsad.c (init_validator): Add param "aggregate_mode".

	* src/html/classic/omp.xsl (get_aggregate): Add param "aggregate_mode".
	(html-results-table): Add charts.

	* src/html/classic/graphics.xsl (init-d3charts): Add new JS files.
	(js-aggregate-data-source): Add param "aggregate_mode".
	(js-aggregate-chart): Add chart type "cloud".
	(js-scan-management-top-visualization): Add word clouds for columns
	"vulnerability" and "description" of results.

	* src/gsad_omp.c (get_aggregate_omp): Handle aggregate_mode param.

	* src/html/classic/js/d3.layout.cloud.js: New file. Cloud layout for d3
	by Jason Davies.

	* src/html/classic/js/gsa_cloud_chart.js: New JS file for word clouds.

2015-08-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (asset [host-details], html-hosts-table)
	(asset/host): Rename GET_ASSETS MAX_SEVERITY to SEVERITY.

2015-08-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (asset [host-details]): Skip the report link
	if the report has been deleted.

2015-08-18  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_h_bar_chart.js: Add file missing from last
	commit.

2015-08-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add new "Top 10" horizontal bar chart for tasks and options to sort
	and limit aggregates in chart data sources.

	* CMakeLists.txt: Install new file src/html/classic/h_bar_chart.xsl.

	* src/gsad_omp.c (get_aggregate_omp): Add params sort_field, sort_stat,
	sort_order, first_group and max_groups.

	* src/gsad.c (init_validator): Add params sort_stat, first_group and
	max_groups.

	* src/html/classic/omp.xsl (get_aggregate): Add new params sort_field,
	sort_stat, sort_order, first_group and max_groups.

	* src/html/classic/graphics.xsl (init-d3charts): Add js/h_bar_chart.xsl
	script file.
	(js-aggregate-data-source): Add new optional params sort_field,
	sort_stat, sort_order, first_group and max_groups.
	(js-aggregate-chart): Add chart type "horizontal_bar".
	(js-scan-management-top-visualization): Add "Top 10" horizontal bar
	chart for Tasks.

	* src/html/classic/h_bar_chart.xsl: New file.

2015-08-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (asset [os-details], html-oss-table): Rename
	Installs column to Hosts.  Rename Modified to Updated.
	(asset [host-details], html-hosts-table): Rename Max Severity to
	Severity.  Rename Modified to Updated.

2015-08-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/gsad.xsl, src/html/classic/help.xsl,
	src/html/classic/help_de.xsl, src/html/classic/omp.xsl:
	Renamed "Scan Management" to "Scans", "Asset Management" to "Assets"
	and "SecInfo Management" to "SecInfo".

2015-08-14  Matthew Mundell <matthew.mundell@greenbone.net>

	Add OS icon to asset hosts.

	* src/html/classic/omp.xsl (asset-os-icon): New template.
	(asset [host-details[): Add OS field.
	(html-hosts-table, asset/host): Add OS column.

2015-08-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-scan-management-top-visualization):
	Remove "of last report" from title of the Tasks high results chart.

2015-08-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (asset [host-details]): Add Max Severity.
	(html-hosts-table): Add Max Severity column.
	(html-oss-table): Correct category.
	(asset/host): Add Max Severity.

2015-08-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (get_aggregate): Add text_columns parameter
	to js-aggregate-data-source template call.

	* src/html/classic/js/gsa_graphics_base.js (detached_url): Add missing
	ampersand before x_field and remove superfluous quotes around
	chart_init and chart_gen values.

2015-08-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add text_columns support for charts and add new bubble chart
	"'High' results per host of last report" for Tasks.

	* src/gsad_omp.c (get_aggregate_omp): Handle text_columns parameters.

	* src/gsad.c (init_validator, params_append_mhd, params_mhd_add): Add
	text_columns hashtable parameter.

	* src/html/classic/graphics.xsl (js-aggregate-data-source): Add new
	parameter text_columns.
	(js-scan-management-top-visualization): Add new bubble chart
	"'High' results per host of last report" for Tasks.

	* src/html/classic/js/gsa_graphics_base.js (extract_simple_records)
	(extract_column_info): Extract text columns.

2015-08-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (asset [os-details]): Add "Hosts using this
	Operating System".

2015-08-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (save_my_settings_omp): Add new "Default Severity"
	setting.

	* src/gsad.c (init_validator): Add default_severity.

	* src/html/classic/omp.xsl (get_my_settings, edit_my_settings): Add new
	"Default Severity" setting.

2015-08-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (get_asset): Combine two versions of same
	template.

2015-08-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_base.h (credentials_t): Add client_address element.

	* src/gsad.c (get_client_address): New function.
	(request_handler): Add client address to envelope, adjust
	functions calls.
	(credentials_new, credentials_free, exec_omp_post): Adjust for
	client_address.

	* src/gsad_omp.c (xsl_transform_omp): Add client address to envelope.

	* src/html/classic/gsad.xsl (client_address): New template.

2015-08-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add new parameters to charts for customizing the fields shown, the
	chart title and the field labels.

	* src/gsad.c (init_validator): Add hashtable params chart_gen,
	chart_init, y_fields, z_fields and add x_field.
	(params_append_mhd, params_mhd_add): Add new hashtable params.

	* src/html/classic/graphics.xsl (js-aggregate-chart): Add parameters
	init_params, gen_params, x_field, y_fields, z_fields to customize
	charts.
	(js-scan-management-top-visualization): Add parameters to set fields,
	a custom title and to hide the "max." in the legend.

	* src/html/classic/omp.xsl (get_aggregate): Copy new parameters to the
	generated chart.

	* src/html/classic/js/gsa_graphics_base.js (Chart): Add parameters to
	set generator and init parameters.
	(Chart [request_data]): Pass gen_params to generator.
	(Chart [detached_url]): Add the new parameters to URL.

	* src/html/classic/js/gsa_bar_chart.js (generate): Get fields from
	gen_params and hide statistic type if extra parameter show_stat_type
	is set to false.

	* src/html/classic/js/gsa_bubble_chart.js (generate): Get fields from
	gen_params and hide statistic type if extra parameter show_stat_type
	is set to false.
	(simple_bubble_data): Use the new x_field, y_fields, z_fields for
	the label, size and color data.

	* src/html/classic/js/gsa_donut_chart.js (generate): Get fields from
	gen_params and hide statistic type if extra parameter show_stat_type
	is set to false.

	* src/html/classic/js/gsa_line_chart.js (generate): Get fields from
	gen_params and hide statistic type if extra parameter show_stat_type
	is set to false.

2015-08-10  Benoît Allard  <benoit.allard@greenbone.net>

	* src/gsad.c (request_handler): Reduce the scope of the variable
	  'help_language'.

2015-08-10  Benoît Allard  <benoit.allard@greenbone.net>

	* src/gsad_omp.c (get_many): Be more strict when validating the
	  boolean parameter 'build_filter'.

2015-08-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add - to hosts_opt, for ranges in Host
	Access on New User and Edit User.

2015-08-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (scanner [details]): Show name of OSP
	scanner parameters instead of id.

2015-08-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (ADD_CONTENT_SECURITY_HEADERS): Do not add headers that
	have been set to an empty string.

2015-08-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (GSAD_X_FRAME_OPTIONS, GSAD_CONTENT_SECURITY_POLICY)
	(ADD_CONTENT_SECURITY_HEADERS): New #defines for adding HTTP headers
	"X-Frame-Options" and "Content-Security-Policy".
	(send_response, send_redirect_to_uri, handler_send_response): Add new
	content security HTTP headers.
	(main): Add new command line options --http-frame-opts and --http-csp.

	* doc/gsad.8: Add new command line options.

2015-08-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-pager): Add some comments.

2015-08-05  Matthew Mundell <matthew.mundell@greenbone.net>

	Add new pages Hosts, Host Details, OSs and OS Details.

	* src/gsad.c (init_validator): Add asset pages and params.
	(exec_omp_get): Add asset pages.

	* src/gsad_omp.c (generate_page): Add asset pages.
	(get_asset, get_asset_omp, get_assets, get_assets_omp): New functions.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/classic/gsad.xsl (html-gsa-navigation): Add Hosts and
	Operating Systems to Asset Management menu.

	* src/html/classic/omp.xsl (host): Add classic mode.
	(get_reports_response [asset]): Match host with classic mode.
	(asset [os-details], asset [host-details], get_asset, html-hosts-table)
	(html-oss-table, get_assets_response, get_assets, asset/os): New
	templates.

2015-08-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* CMakeLists.txt: Install gsa-login.css instead of gsa-style.css to
	${GSA_DATA_DIR}/classic/login.

2015-08-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Use a separate smaller stylesheet for the login page of the classic
	face.

	* CMakeLists.txt: Install src/html/classic/gsa-login.css.

	* src/gsad.c (request_handler): Allow /gsa-login.css without token.

	* src/html/classic/gsa-login.css: New stylesheet.

	* src/html/classic/gsad.xsl (html-head): Use gsa-login.css stylesheet
	on login pages.

	* src/html/classic/login/login.html: Use gsa-login.css stylesheet.

2015-08-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl: Add exclude-result-prefixes attribute to
	root xsl:stylesheet element so namespaces are not added to the XHTML
	output.

2015-08-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (get_aggregate): Handle data_columns
	parameters.

	* src/html/classic/js/gsa_graphics_base.js (format_data_default):
	Do not try to format null or undefined data.
	(csv_from_records): Output null or or undefined data as empty string.

	* src/html/classic/js/gsa_line_chart.js (time_line): Insert records
	only if values are defined or one of the y fields is count or c_count.
	(mouse_moved): Handle missing records correctly.
	(generate): Get y fields at start from original data. Add markers at
	data points if the column is not count or c_count.

2015-08-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (redirect_handler): Support IPv6 redirection case.

2015-07-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-create-user-form): Move the Password
	INPUT outside the LABEL, as browsers like Iceweasel 31.7 have focus
	problems when it is inside the LABEL.

2015-07-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/style/logo_l.png,
	src/html/classic/img/style/logo_m.png,
	src/html/classic/img/style/logo_r.png: Removed.

	* src/html/classic/img/style/background.png,
	src/html/classic/img/style/gsa-logo.png: New.

	* CMakeLists.txt: Adjust the image installation
	accordingly.

	* src/html/classic/gsa-style.css: Add a background image
	for the top header. Replace the logo_l, logo_m, logo_r
	triple by a single logo class which is basically logo_l.

	* src/html/classic/gsad.xsl (html-gsa-logo): Use new class
	logo instead of logo_[lmr]. Reduce height of logo and drop
	the extra line to reduce total height and match the
	background bar.


2015-07-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl (new_alert.html): Add $t and $i.

2015-07-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Adjust the email alert inputs to provide defaults that are the same as
	in the past.

	* src/html/classic/omp.xsl (include-message-default)
	(attach-message-default): New variables.
	(html-create-alert-form, html-edit-alert-form): Move subject up.  Add
	a message field for the email include and the email attach.  Remove the
	shared message field.

	* src/gsad_omp.c (append_alert_method_data): Add a special case for
	email data "message", in order to tell between the attach and include
	message.

2015-07-23  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/language_names.tsv: Correct code for Japanese.

2015-07-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* ChangeLog: Repair last entry.

2015-07-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl (new_alert.html): Add $H.  Correct $f.
	Reorder.

2015-07-22  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Change the language code of the current Chinese translation to zh_CN.
	Allow selecting help files with country code suffixes in their name.
	Add lang attribute to html root element in classic face.

	* CMakeLists.txt: Rename src/html/classic/help_zh.xsl to
	src/html/classic/help_zh_CN.xsl

	* src/CMakeLists.txt: Rename help_zh-xsl-syntax to help_zh_CN-xsl-syntax
	and update file name.

	* src/gsad_base.c (set_language_code): Change the code for Chinese
	to "zh_CN".

	* src/gsad.c (request_handler): Try all languages in the user's
	language string in full and shortened form.

	* src/language_names.tsv: Change code for Chinese from zh to zh_CN and
	rename to "Chinese (China)".

	* src/html/classic/gsad.xsl (): Add variable "html-lang".
	(/): Add lang attribute to html root element.

	* src/html/classic/help_zh.xsl: Remove. Renamed to
	src/html/classic/help_zh_CN.xsl.

	* src/html/classic/help_zh_CN.xsl: New. Renamed
	src/html/classic/help_zh.xsl.

	* src/po/CMakeLists.txt: Change code for Chinese from zh to zh_CN.

	* src/po/gsad_xsl-zh.po: Remove. Renamed to src/po/gsad_xsl-zh_CN.po.

	* src/po/gsad_xsl-zh_CN.po: New. Renamed src/po/gsad_xsl-zh.po.

2015-07-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl (new_alert.html): Remove extra heading.  Add
	email section with message and subject format specifiers.

2015-07-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/po/gsad_xsl-zh.po: Update with translations by Winland Q. Yang.

2015-07-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Allow using multiple data columns in charts. Add charts for reports.

	* src/gsad_omp.c (get_aggregate_omp): Handle data_columns parameters.

	* src/gsad.c (init_validator): Add data_columns:name and
	data_columns:value.
	(params_append_mhd, params_mhd_add): Add data_columns hashtable param.

	* src/html/classic/graphics.xsl (js-aggregate-data-source): Add
	data_columns parameter.
	(js-scan-management-top-visualization): Add Reports charts.

	* src/html/classic/omp.xsl (html-reports-table): Add Reports charts.

	* src/html/classic/js/gsa_bubble_chart.js (simple_bubble_data):
	Use new column name for mean of the first data column.

	* src/html/classic/js/gsa_graphics_base.js (create_uri): Handle
	parameter arrays.
	(extract_simple_records): Update column extraction to new OMP syntax
	with multiple data columns.
	(field_name): Add cases for "high" and "high_per_host".
	(format_data_default): Round decimal numbers to three places.

	* src/html/classic/js/gsa_line_chart.js (time_line): Fill in 0 for all
	statistics by default and remove debug output.
	(generate): Use data columns as y data if available.

2015-07-20  Matthew Mundell <matthew.mundell@greenbone.net>

	Add subject and message input for email alerts.

	* src/gsad_omp.c (append_alert_method_data): Add "message" and
	"subject".

	* src/html/classic/omp.xsl (html-create-alert-form)
	(html-edit-alert-form, alert [details]): Add subject and message fields.

2015-07-17  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* src/html/classic/help.xsl, CMakeLists.txt: Set version to 6.1+beta2.

2015-07-17  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 6.1+beta1 release.

	* CHANGES: Updated.

	* INSTALL: Note that Debian Jessie is now the reference system.

2015-07-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (manager_connect): Init html to keep compiler quiet.

2015-07-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* CMakeLists.txt: Remove installation of XML translation files.

	* src/html/classic/po/de.xml: Remove. Obsoleted by gettext .po file.

	* src/html/classic/po/zh.xml: Remove. Obsoleted by gettext .po file.

2015-07-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/help_ru.xsl: Add author and update copyright info.

	* src/po/gsad_xsl-de.po: Add author, license and copyright info.

	* src/po/gsad_xsl-ru.po: Add author, license and copyright info.

	* src/po/gsad_xsl-zh.po: Add author, license and copyright info.

2015-07-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/language_names.tsv: Remove superfluous space.

	* src/xslt_i18n.c (init_language_lists): Change success log message to
	g_debug.

2015-07-10  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c, src/gsad_omp.c: Fix documentation issues found with
	Doxygen.

2015-07-10  Michael Wiegand <michael.wiegand@greenbone.net>

	* doc/Doxyfile_full.in: Harmonized settings with Doxygen configurations
	of other OpenVAS modules.

2015-07-10  Michael Wiegand <michael.wiegand@greenbone.net>

	* doc/Doxyfile.in, doc/Doxyfile_full.in: Updated Doxygen configuration
	files with Doxygen 1.8.8.

2015-07-09  Matthew Mundell <matthew.mundell@greenbone.net>

	Prevent logout the user saves themself with LDAP and the previous method
	was also LDAP.

	* src/gsad_omp.c (save_user_omp): If modify_password is 3 then specify
	ldap_connect, but stay logged in.

	* src/html/classic/omp.xsl (user [edit]): Make modify_password 3 for
	LDAP when the source was already LDAP.

2015-07-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (logout): New function.  Body from manager_connect.
	(save_user_omp): Logout if the user is modifying themself, and the
	authentication method is set to LDAP.  We do not have the LDAP password
	so we cannot run further OMP commands, and this is the simplest way to
	get the password from the user.
	(manager_connect): Use logout.

2015-07-09  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Use HTTP POST method for process_bulk instead of GET to avoid issues
	with HTTP header memory limits.

	* src/gsad.c (gsad_connection_info): Add fields content_type,
	content_disposition and content_length.
	(free_resources): Free content_disposition string.
	(exec_omp_post): Add case for process_bulk.
	(exec_omp_get): Remove case for process_bulk.
	(gsad_add_content_type_header): Move above send_response function.
	(send_response): Add parameters content_type, content_disposition and
	content_length to responses that are not HTML pages, rename parameter
	page to content.
	(redirect_handler, request_handler): Add new send_response parameters.

	* src/html/classic/omp.xsl (list-window): Use the POST method to send
	the bulk action form.

2015-07-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add Russian translation by Ilmar Habibulin and rebuild Chinese
	translation.

	* CMakeLists.txt: Install new src/html/classic/help_ru.xsl.

	* src/CMakeLists.txt: Add syntax check for Russian translation.

	* src/html/classic/help_ru.xsl: New help file. Originally created by
	Ilmar Habibulin.

	* src/po/CMakeLists.txt: Add Russian translation files.

	* src/po/gsad_xsl-ru.po: New file. Generated from old style XML file
	by Ilmar Habibulin and merged with .pot file.

	* src/po/gsad_xsl-zh.po: Newly generated from old XML and merged with
	.pot file.

2015-07-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* INSTALL: Mention that locale should be an English one.

	* src/gsad.c: Add #INCLUDE <langinfo.h>
	(main): Test LC_ALL instead of LC_MESSAGES. Warn if locale is not an
	"en_..." one or if the encoding is not UTF-8. Mention environment
	variables in warning messages.

2015-07-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-tasks-table, html-cpe-table)
	(html-cve-table, html-nvt-table, html-ovaldef-table)
	(html-cert_bund_adv-table, html-dfn_cert_adv-table, html-allinfo-table)
	(html-reports-table, html-results-table): Use new "Severity Short"
	and "CVSS Vector Short" components so table header text can be
	abbreviated in tables without much space.
	(cvss_calculator): Add i18n for vector components.

	* src/po/gsad_xsl-de.po: Update translations.

2015-07-07  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/xslt_i18n.h: Fix include to include only glib.h. Anything else
	is regarded an error by glib.

2015-07-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/language_names.tsv: Correct authors and copyright year.

2015-07-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Use ISO codes for the User Interface Language setting and list of
	supported languages dynamically at startup from the locale directory
	and a TSV file of language names.

	* CMakeLists.txt: Install file src/language_names.tsv.

	* INSTALL: Note that the installed Locale must use UTF-8 encoding.

	* src/gsad_base.c (set_language_code): Accept values other than the
	predefined names to allow using ISO codes in the settings.

	* src/gsad_omp.c: Add #include "xslt_i18n.h".
	(get_my_settings, edit_my_settings): Add XML containing the installed
	languages.
	(save_my_settings_omp): Set language to null if language_code is NULL.

	* src/gsad.c: Remove #define DEFAULT_GSAD_LANGUAGE, moved to file
	src/xslt_i18n.h.
	(user_set_language_code): Remove.
	(exec_omp_post): Allow NULL (Browser Language) value for the language
	setting in save_my_settings case.
	(init_validator): Update regex of "lang" to accept ISO code lists.
	(file_content_response, request_handler): Convert the Accept-Language
	HTTP header to format used by gettext in LANGUAGE environment variable.
	(main): Correct typo in debug message. Inititialize language lists.

	* src/language_names.tsv: New file.

	* src/xslt_i18n.c: Add #include <assert.h>, #include <dirent.h> and
	#include <errno.h>. Add #define GSA_XSL_TEXTDOMAIN. Add static
	variables for language lists: installed_languages, language_names,
	native_language_names.
	(xslt_ext_gettext, xslt_ext_ngettext): Use LC_ALL locale category.
	Use GSA_XSL_TEXTDOMAIN macro to ensure consistency.
	(register_i18n_ext_module): Use GSA_XSL_TEXTDOMAIN for consistency.
	(init_language_lists, buffer_languages_xml, accept_language_to_env_fmt):
	New functions.

	* src/xslt_i18n.h: Add #include <glib/gstring.h> and #define
	DEFAULT_GSAD_LANGUAGE.
	(init_language_lists, buffer_languages_xml, accept_language_to_env_fmt):
	New function prototypes.

	* src/html/classic/gsad.xsl (i18n_language): Do not truncate language
	codes.

	* src/html/classic/omp.xsl (get_my_settings, edit_my_settings): Use
	choices from a generated list for the User Interface Language setting.

2015-07-02  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* INSTALL: List prerequisites for translations separately and add a
	non-"C" locale as prerequisite. Add section about disabling
	translations or using a different locale.

	* src/gsad.c (): Add #include "xslt_i18n.h".
	(attach_sid, remove_sid): Reset the locale correctly.
	(main): Test setting the locale for category LC_MESSAGES and disable
	translations if it fails or is set to "C" and log test result.

	* src/xslt_i18n.c (xslt_ext_gettext, xslt_ext_ngettext): Return
	original message directly if gettext is disabled. Do not set LC_ALL
	environment variable, set only LC_MESSAGES locale, not LC_ALL and reset
	locale correctly.
	(get_ext_gettext_enabled, set_ext_gettext_enabled): New functions.

	* src/xslt_i18n.h (get_ext_gettext_enabled, set_ext_gettext_enabled):
	New function prototypes.

2015-07-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/os_fortinet.png: New.

	* CMakeLists.txt: Install the new icon.

	* src/html/classic/os.xml: Added fortinet.

2015-06-23  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (result [result-body]): Correct context of
	"Result".

2015-06-23  Michael Wiegand <michael.wiegand@greenbone.net>

	* doc/i18n-howto.txt: Remove duplicate "the".

2015-06-23  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* doc/i18n-howto.txt: Rewrite to describe new gettext based format.

	* src/html/classic/dynamic_strings.xsl (type-bulk-delete-confirm)
	(type-bulk-trash-confirm): Correct singular of Tag and Permission
	message.

	* src/html/classic/omp.xsl (resume-icon, task-icons): Change context of
	"Resume" to "Action Verb" for consistency.
	(task [details], new_task, html-tasks-table): Change context of
	"Sequential", "Random" and "Reverse" to "Task|Hosts Ordering" to
	clarify. Change context of "Current" and "Last" to "Task|Report".
	(report [apps]): Consolidate tooltip text for unknown installations
	count with gsa-i18n:strformat and use gsa:n-i18n.
	(report [summary]): Use correct context "Results" for "Total".
	(html-tasks-trash-table): Change context of "First" and "Last" to
	"Task|Report".

	* src/po/gsad_xsl-de.po: Update to include new messages and contexts.
	Remove unused messages.

2015-06-18  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Correct various strings for i18n and add i18n for some text lacking it.

	* src/html/classic/dynamic_strings.xsl: Use correct closing tags
	for templates and add ending </xsl:stylesheet>. Correct template name
	to type-name-plural for plural type nams.
	(type-name, type-name-plural, type-global): Add messages for "Config"
	and "Scan Configuration".
	(status, trust): New templates.

	* src/html/classic/gsad.xsl (html-gsa-logo): Change context of "Logout"
	to "Action Verb" for consistency with "Login".
	(html-footer): Change context of "Backend operation" to
	"Performance Timing".
	(html-gsa-navigation): Apply i18n to "SecInfo Dashboard" text generated
	by script.
	(login_page): Apply i18n to text "Login as a guest".

	* src/html/classic/omp.xsl (task [details]): Add i18n for "Unavailable".
	(list-window): Add i18n for "Hide Charts" and "Show Charts".
	(lsc_credential): Add i18n for "Unavailable" and "UUID".
	(html-agents-table): Change context of "Trust" to "Trust".
	(agent, agent [trash], agent [details]): Use context "Trust" for trust
	related text.
	(alert): Change context of "Test" to "Action Verb".
	(alert [details], filter [details], tag [details]): Add i18n for
	"Unavailable" and "UUID".
	(html-targets-table): Correct table header "Hosts".
	(target (details), html-config-table): Add i18n for "Unavailable"
	and "UUID".
	(schedule [details]): Add i18n for Tasks table headers, "Unavailable"
	and "UUID".
	(scanner [details]): Add i18n for "N/A", "builtin scanner", parameters
	table headers, "Unavailable" and "UUID". Replace i18n of whitespace
	with xsl:text elements.
	(slave [details]): Add i18n for "Unavailable" and "UUID".
	(ref_cve_list): Change context of "CVE" to "SecInfo|References"
	(ref_bid_list, ref_cert_list, ref_xref_list): Add i18n to reference
	type name.
	(ovaldef-details): Add i18n for "Status".
	(permission [details], port_list [details]): Add i18n for "Unavailable"
	and "UUID".
	(report_format, report_format [trash], report_format [details]): Use
	context "Trust" for trust related text. Add i18n for "Unavailable"
	and "UUID".
	(host): Add i18n for "not finished". Correct contexts for trash icon.
	(report [result_header]): Rename parameter "capital-name" to
	"label-text" and do not apply i18n to it here.
	(result [result-headers]): Apply i18n to header names and use new
	param name.
	(html-results-table): Apply i18n to "Vulnerability".
	(report [assets]): Apply i18n to "IP" header, "View report" and
	"not finished".
	(get_reports_response/report/report [report-assets]): Add i18n for "IP"
	and "not finished".
	(report [section-filter]): Consolidate "New Result Filter ..." message.
	(report [hosts]):  Add i18n for "not finished".
	(html-agents-trash-table): Use context "Trust" for "Trust".
	(user): Consolidate "User cannot be deleted" message.
	(user [details]): Add i18n for "Unavailable" and "UUID".

	* tools/pot-test (main): Correct and simplify coverage test generation.

2015-06-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* tools/pot-test: New file. Python script to gather data from .pot
	files to test them for common problems like redundant contexts.

2015-06-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Consolidate and clarify i18n contexts.

	* src/html/classic/dynamic_strings.xsl (login-msgs): Change context
	to "Login Message".

	* src/html/classic/gsad.xsl (html-gsa-navigation): Change context "MM"
	to "Main Menu". Use the type names as contexts for SecInfo.
	(login_page, password_warning) Use context "Login Message" for
	login messages, "Auth Data" for "Username" and "Password",
	"Action Verb" for "Login".

	* src/html/classic/omp.xsl: Consolidate and clarify i18n contexts:
	Change "Filter Box" to "Filter".  Use "Action Verb" for various generic
	actions.  Use "Property" for generic properties like "Name", "Comment"
	or "Description".  Use "Delta Result" for delta result types like
	"same" and "new". Use "Time" for the message "Timezone".  Use
	"Task|Schedule" for the "Next due" messages.  Use "Value" for "N/A"
	and "Default".  Use the type name as context for itself more
	consistently.  Use "Meta Property" for messages like "optional"
	and "immutable".  Use "Auth Data" for messages related to data used for
	authentication like "Username", "Password" and "Private key".  Clarify
	some ambiguous contexts like the one for "Replace existing value with"
	or "increased".  Use "Alert|Email" for properties specific to email
	Alerts.  Use "Target|Credential" context more consistently. Use context
	"List Conjunction" for "and".  Use "Port" for "Port" and "Host" for
	"Host" and "Hosts" more consistently.  Change context "Reference List"
	to "SecInfo|References".  Use the "Date" context more consistently.
	Consolidate some generic SecInfo messages like "Referenced CVEs" into
	"SecInfo" context.  Use "NVT or Result" for messages shared between
	both types.  Use "Note or Override" more consistently for shared
	messages.  Correct context for "no".  Use message "None" instead
	of "No NVT", which was a placeholder.  Use the context "Actions" more
	consistently.

	* src/html/classic/wizard.xsl: Use context "Task Wizard" for messages
	that can be used by all Task related wizards. Use the contexts from
	omp.xsl for messages that also appear there.

2015-06-16  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/xslt_i18n.c (): Add #include <math.h>.
	(xslt_ext_gettext): Improve error message. Move getenv calls to locked
	section and reset environment variables with unsetenv if the getenv
	returned NULL.
	(xslt_ext_ngettext): Improve error messages. Push correct count object
	back to value stack. Move getenv calls to locked section and reset
	environment variables with unsetenv if the getenv returned NULL.

2015-06-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl: Replace the contexts "Window" and
	"Generic Resource" with more specific ones.

2015-06-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/dynamic_strings.xsl (type-filter, type-new-filter):
	Correct contexts of the messages for Reports and Results.

2015-06-10  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/gsa-style.css, src/html/classic/omp.xsl: Change
	small_inline_form from id to class. Fixes libxml duplicate ID
	definition error.

2015-06-09  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (task [details]): Change the labels for the
	Report, Result, Note and Override counts to strformat strings. Change
	i18n context of Report related strings to "Task|Reports".
	(edit-families-family, family): Change context of " of " to
	"Scan Config|NVTs"
	(html-allinfo-table): Change i18n context for "Type" to
	"All SecInfo Information".
	(nvt [details]): Change the labels for the Note and Override counts to
	strformat strings.
	(port_list [trash]): Correct capitalization of "in use" string.
	(port_list [details], html-edit-port-list-form): Change i18n context
	of Port Range related strings to "Port Range".
	(html-create-report-format-form): Correct i18n context of
	"New Report Format" label.
	(os-icon): Add missing i18n context to string "OS conflict".
	(report-image): Change error messages to strformat strings.
	(html-tasks-trash-table): Change i18n context of Report related strings
	to "Task|Reports".
	(get_trash): Change context for "Scan Configs" to "Scan Config".

2015-06-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/xslt_i18n.c (xslt_ext_gettext, xslt_ext_ngettext): Always use the
	glib string duplication functions and free the result strings after
	creating the result XPath object.
	(xslt_ext_strformat): Free the result string, not just the GString
	after creating the result XPath object.

2015-06-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* tools/xsl2pot (process): Add empty msgstr_plural entries if
	msgid_plural but no default plural is given.

2015-06-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/po/CMakeLists.txt (MAKE_TRANSLATION): Also change name pattern
	in -o argument of msgmerge command.

2015-06-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/po/CMakeLists.txt (MAKE_TRANSLATION, gettext-po-files): Change
	the name pattern of merged .po files to gsad_xsl-${_LANG}-merged.po to
	avoid conflicts with source .po files when building in-source.

2015-06-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (gsa:permission-description): Correct
	text for get and modify permissions on a specific resource.

2015-06-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (filter-criteria, filter-extra): Put
	task_id in editable filter if there are any logical operator keywords.
	(task [details]): Add number of results with a link to a list of
	results for the task.

2015-06-06  Sven Haardiek <sven.haardiek@greenbone.net>

	* src/CMakeLists.txt: Remove obsolete checks with splint and rats.

2015-06-06  Sven Haardiek <sven.haardiek@greenbone.net>

	* CMakeLists.txt: Enable preprocessor defition for GSAD_PID_DIR

2015-06-05  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c: Guard thread initialization macros deprecated in
	libgcrypt >= 1.6.0 with defines.

2015-06-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-part): Do not apply gsa:i18n
	to column names as they should already be translated.
	(task-icons): Set context for "Next due" strings to "Task|Schedule".

2015-06-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Consolidate text made out of multiple parts into single strings and
	ensure i18n default is always the same as msgid. Also add missing
	comments referring to dummy templates and correct some template names
	in dynamic_strings.xsl.

	* src/html/classic/dynamic_strings.xsl: Give various templates their
	correct names: type-details, type-filter, type-edit.
	(type-global, type-owned): New templates.
	(type-details): Add Report and Result.
	(type-details-long, type-export, type-export-xml)
	(type-export-multiple-filtered-xml): New templates.
	(type-filter): Add Report and Result.
	(type-permissions, type-new-filter, type-action-denied): New templates.
	(permission-descriptions): Capitalize "Description" in context and
	add strings for specific resources.
	(type-bulk-delete-confirm, type-bulk-trash-confirm, bulk-actions): New
	templates.

	* src/html/classic/omp.xsl (): Add gsa-i18n extension prefix.
	(gsa:permission-description, gsa:view_details_title)
	(filter-window-part, edit-header-icons, get-settings-resource)
	(list-window-line-icons, user-tags-window, resource-permissions-window)
	(task-icons, list-window, details-header-icons, task)
	(lsc_credential [trash], alert [trash], alert [details]
	(filter [trash], tag [trash], target [trash], html-config-table)
	(config [trash], schedule [trash], scanner [trash], slave [trash])
	(get_info_allinfo_action, cve-details, cpe-details, ovaldef-details)
	(cert_bund_adv-details, dfn_cert_adv-details, nvt-details)
	(observers-icon, group [trash], permission [trash], port_list [trash])
	(report_format [trash], note-detailed, override-detailed)
	(result-details, report [assets])
	(get_reports_response/report/report [report-assets])
	(get_report_summary_response, html-edit-role-form, role [trash])
	(get_trash, process_bulk): Consolidate text and add missing comments
	referring to dummy templates.

2015-06-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Switch modify_password to a number.

	* src/gsad_omp.c (save_user_omp): Also choose LDAP if modify_password
	is 2.

	* src/html/classic/omp.xsl (html-create-user-form, user [edit]): Move
	the "Allow LDAP Authentication Only" field up into the password field.
	This makes it clear that no password is stored when LDAP is chosen, and
	forces the user to enter a password when switching from LDAP to regular
	authentication.

2015-06-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_schedule_omp): Always put the COMMENT in the
	OMP, otherwise it gets escaped.  Comment will always be given anyway.

2015-06-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Allow colons in comments.

2015-06-02  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (list-window, html-alerts-table)
	(html-filters-table, html-tags-table, column-name, html-targets-table)
	(html-configs-table, html-schedules-table, html-scanners-table)
	(html-cpe-table, html-cve-table, html-nvt-table, html-ovaldef-table)
	(html-cert_bund_adv-table, html-dfn_cert_adv-table, html-allinfo-table)
	(html-notes-table, html-overrides-table, html-groups-table)
	(html-permissions-table, html-port-lists-table)
	(html-report-formats-table, html-reports-table, html-results-table)
	(html-roles-table, html-users-table): Apply gsa:i18n directly to
	the "name" element of the columns so xsl2pot can extract the strings.
	Always set "field" of columns explicitly.

2015-06-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_schedule_omp): Check comment.
	(save_schedule_omp): Move comment to the invalid parameter check.
	Remove redundant name comparison.

2015-06-02  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/dynamic_strings.xsl: New file. Dummy templates for
	xsl2pot, containing strings that are not used literally in the other
	XSL files because they are generated before translation.

	* src/html/classic/omp.xsl: Merge i18n contexts "<Type> Table Row" and
	"<Type> Window" into "<Type>" and contexts "Table Row" and "Window"
	into "Generic Resource".

	* src/po/CMakeLists.txt (gettext-po-files): Add .pot file dependency.
	(gsad_xsl.pot): Add .xsl files as dependencies.

2015-06-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* tools/xsl2pot (unescape): New function.
	(process): Unescape extracted strings.

2015-06-01  Benoît Allard  <benoit.allard@greenbone.net>

	* tools/xml2po: Don't use short variable names

2015-06-01  Benoît Allard  <benoit.allard@greenbone.net>

	* tools/xml2po (char_data): Group events that belong together.

2015-05-29  Benoît Allard  <benoit.allard@greenbone.net>

	* src/gsad_omp.c: Add variable definition.

2015-05-29  Benoît Allard  <benoit.allard@greenbone.net>

	* INSTALL: mention the prerequisities for the translation.
	* src/gsad_omp.c (get_reports): Reduce the scope of a variable.

2015-05-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* ChangeLog: Correct filename src/po/gsad_xsl-zh.po in last entry.

2015-05-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add a wrapper function for ngettext and a KDE-style text formatting
	function. Remove support for the old XML-based translations.

	* src/xslt_i18n.c (xslt_ext_gettext): Add comment with expected params
	and free context_obj if it's not NULL.
	(xslt_ext_ngettext, xslt_ext_strformat): New functions.
	(init_i18n_module, shutdown_i18n_module): Add new functions ngettext
	and strformat.

	* src/html/classic/gsad.xsl (): Add comment about functions added via
	libxslt extension.
	(gsa:i18n): Remove old XML-based translation.
	(gsa:n-i18n): New function.

	* src/po/gsad_xsl-de.po: Add Plural-Forms clause to header.

	* src/po/gsad_xsl-zh.po: Add Plural-Forms clause to header.

	* tools/xsl2pot (): Accept empty default strings in gettext_re. Add
	ngettext_re.
	(process): Mark msgstr values set to defaults as fuzzy. Add handling
	of the ngettext wrapper.

2015-05-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/po/CMakeLists.txt (MAKE_TRANSLATION): Use file cmake command
	instead of the deprecated make_directory one. Set dependency to the
	.po file in the source directory explicitly. Add command to merge
	.pot file with existing .po file.
	(gettext-mo-files): Change message as it's shown after the mo files
	were generated.
	(gettext-po-files, gettext-pot-files): New optional targets.

2015-05-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/xslt_i18n.c (xslt_ext_gettext): Correct args count check.

2015-05-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/xslt_i18n.c (GSA_I18N_EXT_URI): Remove cast and add doc.
	(locale_env_mutex): Add doc.
	(xslt_ext_gettext): Add doc and correct error message.
	(init_i18n_module): Add doc, remove debug output and use URI passed
	as parameter.
	(shutdown_i18n_module): Add doc, remove debug output and unregister
	gettext function.
	(register_i18n_ext_module): Add doc and add cast for GSA_I18N_EXT_URI.

2015-05-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add a libxslt extension that allows using gettext for translations
	if internal transformations are enabled and convert the existing
	translations to po files.

	* CMakeLists.txt: Set new variable GSA_LOCALE_DIR.

	* src/CMakeLists.txt: Add new static library gsad_xslt_ext currently
	consisting of xslt_i18n and include po subdirectory.

	* src/gsad_base.c: Add #include "xslt_i18n.h".
	(xsl_transform_with_stylesheet): Register the i18n extension module.

	* src/gsad_log_conf.cmake_in: Add new log domain "gsad xslt".

	* src/xslt_i18n.c: New file. XSLT extension for i18n functions.

	* src/xslt_i18n.h: New header file.

	* src/html/classic/gsad.xsl: Add gsa-i18n namespace and extension.
	(gsa:i18n): Use the gsa-i18n:gettext extension function if available.

	* src/po/CMakeLists.txt: New file.

	* src/po/gsad_xsl-de.po: New file. German gettext format translations
	generated from src/html/classic/po/de.xml with tools/xml2po.

	* src/po/gsad_xsl-zh.po: New file. Chinese gettext format translations
	generated from src/html/classic/po/zh.xml with tools/xml2po.

2015-05-28  Benoît Allard  <benoit.allard@greenbone.net>

	* tools/xsl2pot: Added, this utility generates pot files from the xslt
	  sheets.
	* tools/xml2po: Added, this utility converts the older xml translation
	  files in the gettext format.

2015-05-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_permission): Reduce permission to GET for getting
	groups and roles, like for users.

2015-05-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (gsa:permission-description): Do not build
	text for describe_... and sync_... commands from parts so the strings
	can be extracted more easily for translation.
	(start-icon): Do not apply gsa:i18n to alt param, add name param
	for untranslated name.
	(alert): Add name param for start-icon template call.
	(process_bulk): Do not build text from parts to simplify i18n.

2015-05-18  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (data_severity_level_counts):
	Make CVSS to severity level mapping works with severity classifications
	that skip levels like PCI-DSS.
	(severity_colors_gradient): Use max_log as upper bound of log level.

2015-05-15  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Handle severity scores >= 0.0 not classified as "High", "Medium" or
	"Low" as "Log" consistently and improve handling of jumps in the
	severity classes like the "Log" to "High" for PCI-DSS.

	* CMakeLists.txt: Install src/html/classic/img/p_bar_gray.png.

	* src/html/classic/graphics.xsl (init-d3charts): Get min and max values
	of severity levels directly and also for "log".
	(js-aggregate-chart): Add max_log parameter for severity_bar_style.

	* src/html/classic/gsa-style.css (.progressbar_bar_gray): New class
	style.

	* src/html/classic/omp.xsl (gsa:cvss-risk-factor): Change "None" to
	"Log" and count non-zero scores < 4.0 as log for pci-dss.
	(gsa:risk-factor-max-cvss): Add "log" as alias for "none". Fix limits
	for pci-dss. Always return 0.0 for unknown level names.
	(gsa:risk-factor-min-cvss): New template.
	(gsa:threat-color): Add "non"/"log" case.
	(severity-bar): Add gray fill for "Log" level.

	* src/html/classic/img/p_bar_gray.png: New image file.

	* src/html/classic/js/gsa_bar_chart.js (severity_bar_style): Add
	parameter max_log and handle the "Log" level as a range.

	* src/html/classic/js/gsa_graphics_base.js (data_severity_level_counts):
	Handle "log" level as a range.
	(severity_level_color_scale): Rename "None" to "Log".

2015-05-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (gsa:cvss-risk-factor): Update PCI-DSS min.

	* src/html/classic/help.xsl (my_settings.html): Update PCI-DSS min.

2015-05-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/os_paloalto.png: New.

	* CMakeLists.txt: Install the new icon.

	* src/html/classic/os.xml: Added paloalto.

2015-05-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (full-report-export-form)
	(filtered-report-export-form): Add min_qod and apply_min_qod params.

2015-05-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (result [result-body]): Set the info_type
	param in the Method link according to the format of the OID.  Add a
	details param to the link so that it works for CVEs.

2015-05-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (report [hosts]): Add "host=" to filter
	column for selecting the host in auth icons.

2015-05-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (host, report [assets], report-ports-link):
	Make search phrase for selecting host exact in Report links.

2015-05-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (main): Set the parent death signal to SIGKILL in the
	redirect child.  This ensures that the child gets a SIGKILL when the
	parent does.

2015-05-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (report): Add replace_task_id param to the
	delta link, because it's present on the reports page.

2015-05-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_task): Correct check if GET_ALERTS command is
	enabled and handling of empty IDs.

2015-05-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (resource-permissions-window)
	(html-create-permission-form): Add or correct i18n function parameters.

	* src/html/classic/po/de.xml: Add strings for permissions list and
	multi-permissions dialog.

2015-05-05  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (main), doc/gsad.8: Remove --redirect option.

2015-05-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_task): Get the Alerts and Target of the Task.

	* src/html/classic/omp.xsl (task [details]): Set parameter "related"
	of resource-permissions-window template call.
	(html-create-permission-form): Add list of links to related resources.

	* src/html/classic/omp.xsl (new_permission.html): Add related resources
	for Tasks and sentence about the list of related resources.

2015-05-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/gsad.xsl (login_page): Correct typo in enctype, to
	prevent form text from being escaped.  This was preventing login with
	passwords that contain a space, for example.

2015-05-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (main): Add --no-redirect option. Make --redirect the
	default behaviour.

2015-04-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/help.xsl (new_permission.html): Add section about
	the "Create Multiple Permissions" dialog.

2015-04-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (create_permissions_omp): Add start_task, stop_task
	and resume_task as part of the "proxy" permissions for Tasks.

	* src/html/classic/omp.xsl (task-permissions-window): Remove.
	(task [details]): Use template resource-permissions-window instead of
	task-permissions-window.
	(html-create-permission-form): Add "Task" in type selection of
	multi-permissions form.

2015-04-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add permission window for details pages of other types in the
	Configuration menu. Add permission related indicator icons.

	* src/gsad_omp.c (get_config): Add the permissions for the config.
	(create_permissions_omp): Handle permissions test_alert,
	validate_agent, validate_report_format and validate_scanner as part
	of "proxy" permissions. Correct check if related type is report.

	* src/html/classic/gsad.xsl (html-gsa-logo): Add indicator icons for
	create_permission_response, delete_permission_response and
	modify_permission_response in get_task, get_config_response,
	get_lsc_credential, get_agent, get_alert, get_filter, get_note,
	get_override, get_port_list, get_report_format, get_scanner,
	get_schedule, get_slave, get_tag.

	* src/html/classic/omp.xsl (lsc_credential [details], agent [details])
	(alert [details], filter [details], tag [details], html-config-table)
	(schedule [details], scanner [details], slave [details]): Add
	permissions form.
	(html-create-permissions-form): Add types from Configuration menu.
	(port_list [details], report_format [details]): Add permissions form.

2015-04-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (create_permissions_omp): Exclude reports and results
	from creation of "modify_..." permissions.

	* src/html/classic/omp.xsl (note [details], override [details]): Add
	permissions list window.
	(html-create-permission-form): Add resource types Note and Override
	to multi-permission form.

2015-04-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (create_permissions_omp): Add "proxy" permissions.

	* src/html/classic/omp.xsl (html-create-permission-form): Show option
	for "proxy" permissions.

2015-04-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (create_permissions_omp): Correct indentation.

2015-04-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-create-permission-form): Make
	multiple permissions dialog always visible. Allow user input of
	resource_type and resource_id if no related resources are given.
	Arrange the form more like the normal "New Permission" dialog.

2015-04-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (resource-permissions-window): Remove
	multiple permissions form, moved to "New Permission" page. Add icon to
	go to permissions list.
	(permission-subject-selection): New template.
	(html-create-permission-form): Move subject selection to new template.
	Add form for creating multiple permissions.

2015-04-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (create_permissions_omp): Remove leftover test output.

2015-04-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add a form to create permissions for the current Target and related
	resources (Port List and LSC Credentials).

	* src/gsad.c (init_validator): Add command "create_permissions" and
	parameters "related", "include_related".
	(params_append_mhd): Add hashtable parameter "related".
	(exec_omp_post): Add command "create_permissions".
	(params_append_mhd): Add hashtable parameter "related".

	* src/gsad_omp.h (create_permissions_omp): New function prototype.

	* src/gsad_omp.c (CHECK_OMPF_RET): New function-like macro.
	(create_permissions_omp): New function.

	* src/html/classic/omp.xsl (resource-permissions-window): Add form to
	create permissions for current and related resources.
	(target [details]): Add parameter "related" for the template
	resource-permissions-window.

2015-04-24  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (task [details], report, task)
	(result-details, result [result-row], report [section-list]): Add
	min_qod to links to other Task, Report or Result pages.

2015-04-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_permission): Get users with "get_users"
	permission, because Manager now allows a user to create resource
	permissions on these users.

2015-04-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_note, new_override): Add port checks.

2015-04-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (result [detailed]): Ensure the result-body prognostic
	arg is integer.

2015-04-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (scanner): Blank host and port for CVE
	scanner.

2015-04-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (scanner [details]): Grey clone icon for CVE
	scanner.  Mark host and port as N/A for CVE scanner.
	(scanner-icons): Hide key icons if keys are empty.

2015-04-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (result [result-row]): Use NVT/TYPE instead
	of CVE to determine if a result is from a CVE scan.  Get CVE details
	from NVT instead of CVE.
	(result [result-body]): Get CVE details from NVT.
	(result-detailed): Use NVT/TYPE instead of CVE.
	(report [prognostic_hosts]): Get CVE details from NVT.

2015-04-17  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (start_http_daemon, start_https_daemon): Use MHD_USE_IPv6
	instead of MHD_USE_DUAL_STACK with older libmicrohttpd versions.

2015-04-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Try make the result code clearer.

	* src/html/classic/omp.xsl (html-edit-task-form): Add comments to make
	it easier to find the parts.
	(result [result-headers]): Remove the row part, so it just generates the
	header.
	(result [result-row]): New template.  Body is the row generation from
	result-headers mode.
	(result-detailed): Generate the headers separately and add comments, so
	that it is clearer what is actually generated here.

2015-04-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Add CVE scanning.

	* src/gsad.c (init_validator): Add CVE ID to OID.  Add cve_scanner_id.

	* src/gsad_omp.c (create_task_omp, save_task_omp): Add CVE scanner case.

	* src/html/classic/omp.xsl (scanner-type-name): Add CVE scanner case.
	(task [details]): Make the config field optional.
	(new_task, html-edit-task-scanner-disabled, html-edit-task-form): Add
	CVE scanner case.
	(html-create-note-form, note [details], html-create-override-form)
	(html-edit-override-form, override [details]): Get the info_type value
	from the NVT.  Rename Port to Location.
	(result [result-headers], result-detailed): Add two comments.  Print
	result as prognostic result when there's a CVE element.

2015-04-16  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (gsad_address_init): Set address family to AF_INET6 in ANY
	case.
	(start_http_daemon, start_https_daemon): Use MHD_USE_DUAL_STACK instead
	of MHD_USE_IPv6.

2015-04-16  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (start_http_daemon, start_https_daemon): Adjust
	libmicrohttpd call to listen on IPv4 or IPv6 depending on address type.
	(gsad_address_set_port, gsad_address_init): New functions.
	(main): Refactor code to use gsad_address_set_port() and
	gsad_address_init() adequately.

2015-04-16  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_task): Correct manager response error message of
	the get_permissions request.

2015-04-16  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add a new permissions window to the Target details page and generally
	allow the "New Permission" and "Edit Permission" pages to go to a
	details page after submitting.

	* src/gsad_omp.c (get_one): Get and add permissions for the resource.

	* src/gsad.c (init_validator): Add "restrict_type" as alias of
	"resource_type".

	* src/html/classic/help.xsl (resource_permissions.html): New template.

	* src/html/classic/help.xsl (html-gsa-logo): Add indicators for
	Permission related responses to get_target page.

	* src/html/classic/omp.xsl (list-window-line-icons): Add parameters
	next_type and next_id used for going to a details page after an action.
	(task-permissions-window): New template. Content from previous version
	of resource-permission-window.
	(resource-permissions-window): Change to a permissions table using
	the same rows as the get_permissions page. Replace the form for
	granting permissions with a simple "New Permission" icon in the window
	header. Add resource type text and Help button to window header.
	(task [details]): Use task-permissions-window template instead of
	resource-permissions-window.
	(target [details]): Add resource permissions window.
	(html-create-permission-form): Hide permissions unrelated to a resource
	type if restrict_type parameter is given. Fill in resource ID if given
	via resource_id parameter. Add resource id parameter if given by
	next_id and next_type.
	(permission): Add template parameters next, next_type, next_id and
	pass them to list-window-line-icons.
	(html-edit-permission-form): Add resource id parameter if given by
	next_id and next_type.

2015-04-09  Sven Haardiek <sven.haardiek@greenbone.net>

	* gsa/src/html/classic/js/d3.v3.js: Add non-minified version of d3 for
	policy reason

2015-04-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-create-schedule-form)
	(html-edit-schedule-form): Make year range start from 2015.

2015-04-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (report-hosts-link): Prepend equals sign to
	host search phrase to make it exact.

2015-04-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (note-detailed): Grey edit and delete icons
	if user does not have permission.

2015-04-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_config_nvt): Get notes and overrides, for count
	links.

2015-04-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (simple_ompf): New function.
	(get_info): Get notes and overrides when getting a single NVT, for the
	count links.

	* src/html/classic/omp.xsl (nvt [details]): Adjust path position of
	notes and overrides, now that the NVT comes from GET_INFO.

2015-04-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (permission [details]): Skip the resource
	value when there is no resource.

2015-04-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (gsa:envelope-filter): Only add the space
	when it is needed.

2015-04-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (permission, permission [details]): Mark
	resource and subject unavailable if they are.

2015-04-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post branch version bump.

	* src/html/classic/help.xsl, CMakeLists.txt: Set version to 6.1+beta1.

2015-04-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post-release version bump.

	* CMakeLists.txt, src/html/classic/help.xsl: 6.0.2

2015-04-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Preparing the gsa 6.0.1 release.

	* CHANGES: Updated.

2015-04-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl: Use envelope-filter to get the filter param
	combined with the extra_filter param, in all places that were getting
	just the filter param.
	(gsa:envelope-filter): New function.

2015-04-01  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c, src/gsad_omp.c, src/gsad_base.c: Use g_free() and
	g_malloc0() instead of free(), calloc() and malloc().

2015-03-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (report [section-list]): Skip "Results view"
	for prognostic report, because there is no single report.

2015-03-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (report [section-link]): Add missing host URL
	params to prognostic case.
	(report [section-filter]): Get prognostic params from ENVELOPE, where
	they are available.

2015-03-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-create-user-form): Make LDAP line "odd"
	because the previous is "even".

2015-03-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-config-table): Add clone icon, to
	match other details pages.

2015-03-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-override-form): Convert values of
	"select-value" to text, because they will be compared to "value", which
	is text.

2015-03-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (omp): Add format string, because command may
	contain format specifiers, for example when saving an LDAP DN with
	MODIFY_AUTH.

2015-03-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_target_omp): Prepare the OMP command with
	xml_string_append, so that the args are escaped, especially ALIVE_TESTS,
	which may contain ampersands.

2015-03-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (start_http_daemon): Remove limit on connection timeout,
	because some operations take a long time, like getting very large
	reports.

2015-03-26  Matthew Mundell <matthew.mundell@greenbone.net>

	Allow access to the Create Permissions page even if the user has limited
	subject access.

	* src/gsad_omp.c (new_permission): Restrict requests to users, roles
	and groups that the user has modify_user permission on.

	* src/html/classic/omp.xsl (html-create-permission-form): Disable the
	subject dropdowns when the user may not access the associated type.
	(html-permissions-table): Enable the new icon if the user may access
	any one of the subject types.

2015-03-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (format_file_name): Set format_name to NULL if it's an
	empty string, because openvas_export_file_name does not handle empty
	strings.

2015-03-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/help.xsl (new_override.html): Add missing text for
	"NVT OID" and "Active" inputs. Add syntax info and examples for input
	fields besides the radio buttons. Fix table row coloring.

2015-03-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (user [edit]): If the user has Super Admin
	put it in a dummy dropdown above the others, instead of trying to set it
	on the user, which is not permitted.

2015-03-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (task [details], task): Revert the order of
	task_id and status keywords as the replace_task_id param will change
	the order again, putting the "and" in the wrong place.

2015-03-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl: Flush trailing whitespace.

2015-03-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Note permission icon in help.

	* src/html/classic/help.xsl (name-column): New template.
	(agents.html, lsc_credentials.html, alerts.html, port_lists.html)
	(report_formats.html, configs.html, schedules.html, scanners.html)
	(slaves.html, users.html, permissions.html, roles.html, filters.html)
	(filters.html, tags.html, targets.html): Use name-column, so that
	permission icon is included.
	(notes.html, overrides.html): Add permission icon.
	(tasks.html): Remove sentence about observation, the task may be
	writable.

2015-03-24  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/help.xsl (powerfilter.html): Add description of
	keywords "owner" and "permission".

2015-03-24  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_many, new_task, edit_task)
	(params_toggle_overrides, new_alert, get_alert, edit_alert, new_target)
	(edit_target, get_report, get_report_section, GET_TRASH_RESOURCE)
	(new_permission, edit_permission, process_bulk_omp): Remove keywords
	"permission=any" and "owner=any" from predefined filter terms.

	* src/html/classic/gsad.xsl (html-gsa-navigation): Remove keywords
	"permission=any" and "owner=any" from predefined filter terms for
	notes and overrides.

	* src/html/classic/omp.xsl (filter-criteria, filter-extra): Do not
	consider "permission" and "owner" keywords special.
	(filter-window-part): Remove input fields for owner and permission.
	(task [details], task): Swap order of task_id and status filters.
	Do not include "permission" and "owner" keywords in filter of reports,
	notes and overrides links.
	(nvt [details], html-reports-table): Do not include "permission" and
	"owner" keywords in filter terms of links.

2015-03-23  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/CMakeLists.txt: Make detection of thread library dynamic instead
	of using hardcoded linker flags.

2015-03-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Use port for port_manual so that the user
	can enter a full port string for notes and overrides.  Full strings are
	required to match the port.

2015-03-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (timezone-select): Check full timezone name
	too.

2015-03-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_permission_omp): Add filter to OMP for
	getting subject UUID, because the subject may be owned by anyone.

2015-03-17  Benoît Allard  <benoit.allard@greenbone.net>

	Post-release version bump.

	* CMakeLists.txt, src/html/classic/help.xsl: 6.0.1

2015-03-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (user): Show name without link when filter
	is unavailable.
	(user [details]): Mark roles and groups unavailable if they are.

2015-03-17  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 6.0.0 release.

	* CHANGES: Updated.

	* src/html/classic/help.xsl: Set version to 6.0.0.

	* CMakeLists.txt: Set version to 6.0.0. Switch version scheme.

2015-03-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (tagged_resource_link): Add resource_permission
	arg.  Print name without link if resource is unavailable.
	(tag): Pass permissions to tagged_resource_link.
	(tag [details]): Mark resource unavailable if it is.

2015-03-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Cater for the case where a user no longer has access to the filter of
	an alert.  And where a filter is used on an alert that the user may not
	access.

	* src/gsad_omp.c (new_alert, edit_alert): Add filter to GET_FILTERS, so
	that filters of other users are included.

	* src/html/classic/omp.xsl (alert): Show name without link when filter
	is unavailable.
	(alert [details]): Mark filters unavailable if they are.
	(filter [details]): If alert is not availabe mark it so.

2015-03-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Cater for the case where a user no longer has access to the credentials
	of a target.  And where a credential is used on a target that the user
	may not access.

	* src/gsad_omp.c (get_alert, edit_alert): Add filter to
	GET_REPORT_FORMATS, so that report formats of other users are included.

	* src/html/classic/omp.xsl (alert [details]): Mark report formats
	unavailable if they are.
	(report_format [details]): If alert is not availabe mark it so.

2015-03-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (report_format): Enable verify icon when the
	report format is global or the user may verify it, because this is what
	Manager accepts.

2015-03-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Cater for the case where a user no longer has access to the credentials
	of a target.  And where a credential is used on a target that the user
	may not access.

	* src/gsad_omp.c (new_target, edit_target): Add filter to
	GET_LSC_CREDETIALS, so that credentials of other users are included.

	* src/html/classic/omp.xsl (lsc_credential [details]): Mark targets
	unavailable if they are.
	(target): Print credential name without link if credential unavailable.
	(target [details]): If credential is not availabe mark it so.

2015-03-13  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/help.xsl (scanner-actions): Reorder actions help
	order to match current UI order.

2015-03-13  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/help.xsl (new_scanner.html, scanner_details.html):
	Detail help documentation.

2015-03-13  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/help.xsl (details-window-line-actions): Remove
	used_by part.
	(object-used-by, scanner-actions): New templates.
	(lsc_credential_details.html, alert_details.html)
	(port_list_details.html, report_format_details.html)
	(schedule_details.html, scanner_details.html, slave_details.html)
	(filter_details.html, config_details.html, target_details.html): Adjust
	to use new templates, and add missing details documentation.

2015-03-12  Matthew Mundell <matthew.mundell@greenbone.net>

	Cater for the case where a user no longer has access to the port lists of
	a target.  And where a port list is used on a target that the user may not
	access.

	* src/gsad_omp.c (new_target, edit_target): Add filter to
	GET_PORT_LISTS, so that port lists of other users are included.

	* src/html/classic/omp.xsl (target [details]): Mark port lists unavailable
	if they are.
	(port_list [details]): If target is not availabe mark it so.

2015-03-12  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/help.xsl, src/html/classic/omp.xsl: Rename scanners'
	Public Key to Certificate for accuracy.

2015-03-12  Matthew Mundell <matthew.mundell@greenbone.net>

	Simplify signal handler.

	* src/CMakeLists.txt: Add -lphtread to gsad.

	* src/gsad.c (termination_signal): New variable.
	(handle_signal_exit): Simply set flag.
	(main): Check signal exit flag in main loop.  Block all signals and use
	pselect to avoid race conditions.

2015-03-12  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (task [details]): Adjust to show Slave field
	only when slave feature is available.

2015-03-12  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c (register_signal_handlers): Add todo regarding signal
	handler registration.

2015-03-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_permission, edit_permission): Add filter so that
	all available items are included.

2015-03-11  Matthew Mundell <matthew.mundell@greenbone.net>

	Cater for the case where a user no longer has access to the scanners of
	a task.  And where a scanner is used on a task that the user may not
	access.

	* src/gsad_omp.c (new_task, edit_task): Add filter to GET_SCANNERS, so
	that scanners of other users are included.

	* src/html/classic/omp.xsl (task [details]): Mark scanners unavailable
	if they are.
	(scanner [details]): If task is not availabe mark it so.

2015-03-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_task, edit_task): Add filter to GET_CONFIGS, so
	that targets of other users are included.

2015-03-11  Matthew Mundell <matthew.mundell@greenbone.net>

	Cater for the case where a user no longer has access to the configs of
	a task.  And where a config is used on a task that the user may not
	access.

	* src/html/classic/omp.xsl (task [details]): Mark configs unavailable
	if they are.
	(html-config-table): If task is not availabe mark it so.

2015-03-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Cater for the case where a user no longer has access to the targets of a
	task.  And where a target is used on a task that the user may not
	access.

	* src/gsad_omp.c (new_task, edit_task): Add filter to GET_TARGETS, so
	that targets of other users are included.

	* src/html/classic/gsad.xsl (task [details]): Mark targets unavailable
	if they are.
	(target [details]): If task is not availabe mark it so.

2015-03-10  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (save_scanner_omp): Send command xml elements
	unconditionally.

2015-03-10  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (save_scanner_omp): Don't send ca_pub, key_pub and
	key_priv elements, when matching values aren't provided.

	* src/html/classic/omp.xsl (edit_task, edit_target, edit_scanner)
	(edit_slave, edit_report_format): Handle modify command response.

2015-03-09  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js (generate): Add percentage to
	bar tooltips.

2015-03-09  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js (generate): Add tooltips to
	all parts of the donut slices and to the legend entries.

2015-03-09  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/help.xsl (scanners.html): Improve help documentation.

2015-03-09  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (percentage_counts): Create
	copies of records so the original ones are not overwritten.

2015-03-09  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (verify_scanner_omp): Adjust to handle next page to
	return.

	* src/html/classic/gsad.xsl (html-gsa-logo): Add response indicator for
	verify scanner in scanner details page.

	* src/html/classic/omp.xsl (scanner [details]): Add extra scanner icons.
	(scanner-icons): Add next template argument, to specify next page.
	(scanner): Add argument in scanner-icons template call.

2015-03-09  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator, exec_omp_get): Handle download_ca_pub and
	download_key_pub commands.

	* src/gsad_omp.c (download_ca_pub, download_key_pub): New functions.

	* src/gsad_omp.h: Add functions prototypes.

	* src/html/classic/omp.xsl (html-scanners-table): Increase number of
	actions icons.
	(scanner-icons): New template, for verify scanner, Download CA Public
	Key and Download Public Key buttons.
	(scanner): Adjust to call scanner-icons template.

2015-03-09  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (report_format): Use may-op template to check
	for verify report format permission.

2015-03-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (format_file_name): Set variable to NULL directly,
	instead of passing a NULL entity to entity_text, which segfaults.

2015-03-06  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-part, tag [for_resource])
	(new_target.html, details-window-line-actions): Add missing details.
	(new_scanner.html): New page.

2015-03-05  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (scanner [details]): Adjust to properly
	handle openvas scanner case, improve message wording and add code
	comments.

2015-03-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Use the "OpenVAS Default" scanner in IT-Schwachstellenampel.

	* src/html/its/gsad.xsl: Update copyright year.
	(login_page, html-footer): Increase version to 1.2.2.

	* src/html/its/omp.xsl: Update copyright year.
	(task_controls): Select "OpenVAS Default" scanner by id.

2015-03-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/help.xsl (about.html): Increase copyright year to
	2015.

2015-03-02  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (start_http_daemon, start_https_daemon): Increase per ip
	connection limit from 5 to 15.

2015-02-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (filter-simple, filter-rest): Remove. No
	longer used with changes in filter-window-part.
	(filter-window-part): Merge form with top filter term input with
	expanded filter form. Remove now redundant expanded filter fields
	"Simple search terms" and "Additional filter commands".

2015-02-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_many): Set filt_id to -2 when filter is built
	from components so the filter is not overwritten with a default.

2015-02-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (filter-criteria, filter_extra): New
	templates.
	(filter-window-part): Move pagination, sorting, owner, permission and
	apply_overrides from main filter input field to a hidden field and
	static text.

	* src/gsad_omp.c (get_many): Add option to a extra keywords with
	filter_extra param.

	* src/gsad.c (init_validator): Add "filter_extra" as alias for
	"filter".

2015-02-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	In the expanded filter box move "owner" and "permission" keywords to
	new separate input fields.

	* src/gsad_omp.c (get_many): Add "owner" and "permission" keywords
	when building filter.

	* src/gsad.c (init_validator): Add "owner" and "permission" as aliases
	for "name".

	* src/html/classic/omp.xsl (filter-rest): Exclude keyword columns
	"owner" and "permission".
	(filter-window-part): Add input fields "Owner" and "Permission".

	* src/html/classic/po/de.xml (Filter Box): Add strings "Owner" and
	"Permission".

2015-02-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/gsad.xsl (html-footer): Updated year to 2015.

	* src/gsad.c (main): Updated year to 2015.

2015-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (tag_resource_types): Check GET_INFO instead
	of GET_NVTS now that GET_INFO is used to get the NVT.
	(get_info_response): Update call.
	(get_nvts): Remove get_nvts match, because GET_NVTS is no longer usd to
	get the NVT Details page.  Rename to nvt-details.
	(nvt-details): New template.  Was nvt-details.

2015-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (get_info_response): Call get_nvts directly.
	(nvt-details): Remove.  No longer used.

2015-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (nvt [details]): Remove preferences, because
	the Scan Config NVT Details used this template and adds its own
	preferences.
	(get_nvts): Move preferences back here.

2015-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	More conversion from GET_NVTS to GET_INFO.

	* src/html/classic/omp.xsl (get_nvts): Use get_info instead of get_nvts
	as the next page for the new note and override icons, and the icons in
	the user tags window
	(html-create-note-form, html-create-override-form): Add params for
	get_info case.
	(html-edit-note-form, html-edit-override-form): Remove get_nvts param.
	It's no longer possible to edit these from the NVT Details page.

2015-02-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (tagged_resource_link, cve-details)
	(html-create-note-form, html-edit-note-form, note [details])
	(html-create-override-form, html-edit-override-form, override [details])
	(result [result-body], report [closed_cves], report [errors]): Use
	GET_INFO instead of GET_NVTS to link to NVT Details page.

2015-02-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Use GET_INFO for the SecInfo NVT link.

	* src/html/classic/omp.xsl (get_info_nvt_lnk): Use GET_INFO.
	(nvt-details): Call get_nvts because it does the same thing.
	(nvt [details]): Add preferences.
	(get_nvts): Make it possible to call this from nvt-details too.
	Let nvt [details] do the preferences.

2015-02-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (start_http_daemon, start_https_daemon): New functions.
	Also set connection timeout and limit number of concurrent connections
	per IP
	(main): Refactor code to use new functions.

2015-02-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Add Anonymous XML check.

2015-02-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/its/gsad.xsl (current_page): New dummy template.

2015-02-12  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/classic/help.xsl: Fix typo.

2015-02-11  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* src/html/classic/help.xsl, CMakeLists.txt: Set version to 6.0+beta7.

2015-02-11  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 6.0+beta6 release.

	* CHANGES: Updated.

2015-02-11  Matthew Mundell <matthew.mundell@greenbone.net>

	Add schedule periods to task creation.

	* src/gsad_omp.c (CHECK): Wrap in "do" loop so that it can be used
	safely as a lone "if" body when the "if" has an "else".
	(create_task_omp): Add SCHEDULE_PERIODS to MODIFY_TASK.
	(save_task_omp): Check schedule_periods.

	* src/html/classic/omp.xsl (task [details]): Display period limit.

2015-02-11  Matthew Mundell <matthew.mundell@greenbone.net>

	Add display and editing of task schedule periods.

	* src/gsad.c (init_validator): Add schedule_periods.

	* src/gsad_omp.c (save_task_omp): Add SCHEDULE_PERIODS to MODIFY_TASK.

	* src/html/classic/omp.xsl (task [details]): Display period limit.
	(html-edit-task-schedule): Add "Once" checkbox on schedule field.
	(html-edit-task-name): Increase width so schedule field stays on one
	line.

2015-02-09  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-aggregate-chart): Add new data
	modifiers qod_type_counts and percentage_counts.
	(js-secinfo-top-visualization, dashboard [secinfo]): Add NVTs by QoD
	and QoD type.

	* src/html/classic/omp.xsl (gsa:field-name): Add "QoD" and "QoD type".
	(info/nvt, html-nvt-table): Add QoD column.
	(nvt [details]): Show section "Vulnerability Detection Method" if
	QoD data is present. Add QoD percentage.
	(result [result-headers], result): Get QoD percentage from element
	qod/value.

	* src/html/classic/js/gsa_graphics_base.js (field-name): Add "QoD" and
	"QoD type".
	(qod_type_counts, percentage_counts): New functions.

2015-02-06  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/classic/help.xsl: Fix more spelling issues.

2015-02-06  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/classic/help.xsl (my_settings.html): Fix spelling and
	whitespace issues.

2015-02-06  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/classic/help.xsl (my_settings.html): Fix outdated link to
	Schwachstellenampel information.

2015-02-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/help.xsl (glossary.html): Add entry for Quality of
	detection, including a reference to qod.html.
	(results.html): Add a reference to qod.html in the description of the
	QoD column.

2015-02-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add filtering of reports by minimum QoD.

	* src/gsad_omp.c (get_report): Handle parameter min_qod and set a
	default value of 70 if it is not given.

	* src/gsad.c (init_validator): Add parameters min_qod, apply_min_qod,
	esc_apply_min_qod and esc_min_qod.

	* src/html/classic/omp.xsl (report [results-pager]): Move common
	filter parameters to a variable. Add parameters apply_min_qod and
	min_qod.
	(report [filterbox]): Add checkbox and drop-down for min_qod filter
	similar to min_cvss_base.
	(report [summary]): Add hidden input for filter param esc_min_qod.

2015-02-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/help.xsl (contents.html): Added link to qod.
	(qod.html): New. A general page about qod.

2015-02-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (permission [details]): Only show new icon when
	user may create permissions.

2015-02-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (gsa:may-clone): Enable cloning of other
	users' resources.

2015-02-02  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (result [result-body]): Add "Solution type"
	to "Solution" section.

2015-01-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (result [result-headers])
	(result [result_body], html-results-table, result): Add "QoD" column.

	* src/html/classic/help.xsl (results.html): Add "QoD" column.

2015-01-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/help.xsl (solution-types): New template.
	(results.html, nvts.html): Add help for "Solution type" column and fix
	table row CSS classes.

2015-01-30  Matthew Mundell <matthew.mundell@greenbone.net>

	Cater for the case where a user no longer has access to the alerts
	and/or schedule of a task.  And where an alert or schedule is used on a
	task that the user may not access.

	* src/gsad_omp.c (new_task, edit_task): Add filter to GET_ALERTS and
	GET_SCHEDULES, so that alerts and schedules of other users are included.
	(get_report): Similarly, add filter.

	* src/html/classic/gsad.xsl (task-icons): Grey icon if schedule is
	unavailable.
	(task [details]): Mark alerts and schedules unavailble if they are.
	(alert [details], schedule [details]): If task is not availabe mark it
	so.

2015-01-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/gsad.xsl (html-gsa-navigation): Add owner clause to
	Notes and Overrides links.

2015-01-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (report [hosts]): Added Auth indicator
	icons upon success/failure for SMB and ESXi.

2015-01-26  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/wizard.xsl (quick-task-wizard, modify-task-wizard):
	Move date and time selection inputs outside the label element so
	values can be selected without holding the mouse button. Use
	"Create Schedule" as label for the radio button instead.

2015-01-25  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (report [hosts]): Added column "Auth" to
	host table with icon indicators upon success/failure of SSH authentication.

2015-01-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (nvt [details]): Move qod_type
	into section "Vulnerability Detection Method".

2015-01-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (nvt [details]): Add a link to
	the Results view filtering for the OID of this NVT.

2015-01-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (scanner [details]): Drop the "osp_"
	prefix from the parameter type.

2015-01-22  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (preference [details]): Output an osp boolean
	parameter's default value in string format.
	(scanner [details]): Output a table for the OSP Scanner's parameters.

2015-01-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (scanner [details]): Re-arranged the information
	into ins own section and condensed and niced the content.

2015-01-20  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Simplify check for pkg-config and make it consistent
	with the other modules.

2015-01-20  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Remove find_program for long obsolete
	libopenvas-config. It was removed before openvas-libraries 4.0.0.

2015-01-20  Michael Wiegand <michael.wiegand@greenbone.net>

	Make check for libgcrypt consistent with other library checks.

	* CMakeLists.txt: Raise SEND_ERROR instead of FATAL_ERROR if libgcrypt
	can not be found. Consequently, only call libgcrypt-config if
	libgcrypt was found. Move status message to more appropriate place.

	* INSTALL: Note libgcrypt as prerequisite.

2015-01-20  Michael Wiegand <michael.wiegand@greenbone.net>

	Simplify handling of library flags in CMakeLists.txt files, thereby
	removing the need for clumsy workarounds.

	* CMakeLists.txt: Remove redundant queries of library flags which were
	already retrieved by CMake. Remove unnecessary aggregation of flags.

	* src/CMakeLists.txt: Set include directories with include_directories
	instead of target properties. Remove quotes in target_link_libraries
	so that CMake lists get expanded correctly.

2015-01-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (scanner [details]): Show the fetched scanner
	description.

2015-01-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js (generate): Fix condition for
	considering a donut slice a full circle and make it a bit fuzzy to
	account for rounding errors.

2015-01-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (scanner [details]): Show the fetched scanner
	info.

2015-01-14  Matthew Mundell <matthew.mundell@greenbone.net>

	Add the alert error dialog and indicator icon on the "Report: Summary
	and Download" page.

	* src/gsad_omp.c (get_report): Put the GET_REPORTS alert response inside
	the GET_REPORTS_ALERT_RESPONSE element.  This was the XSL has the actual
	error.

	* src/html/classic/omp.xsl (get_reports_response [alert]): New template.
	Was get_reports_alert_response.
	(get_reports_alert_response): Remove.  Now get_reports_response.
	(get_report_summary_response, get_report): Apply alert case response, so
	that the error dialog show up.

	* src/html/classic/gsad.xsl
	(get_reports_response [response-idicator-alert]): New template.
	(html-gsa-logo): Apply indicator.

2015-01-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl: Use /envelope/current_page instead of
	/envelope/caller in forms and links, because after a post current_page
	is adjusted to take into account the "next" param, whereas caller is
	always the page from which the user requested the post.  In particular,
	after a create_task initiated from the "get_tasks" page, "caller" is
	"get_tasks", whereas "current_page" is the landing page, "get_task".

2015-01-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_one): Improve error messages.
	(get_task, get_config): Add NULL check on extra_xml and free entity in
	all cases, as in get_one.

2015-01-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Remove rules like "preference:", which are
	for the single-parameter versions of hashtable params.  These are no
	longer used, and they end up in the XML like <preference:> which causes
	syntax warnings.

2015-01-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_config_omp): Remove next check, as next is always
	NULL.

2015-01-12  Matthew Mundell <matthew.mundell@greenbone.net>

	Use "trend" instead of "trend:" for saving config families.

	* src/gsad.c (init_validator): Add "trend".

	* src/gsad_omp.c (save_config_omp): Use "trend".

	* src/html/classic/omp.xsl (edit_families): Replace "trend:" with "trend".

2015-01-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_alert): Get all report formats that user has
	permission to access.

2015-01-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl: Make sure that all forms have enctype set to
	"multipart/form-data", for consistency, and also because otherwise the
	page handlers get the parameters URL-escaped (at least with Firefox
	34.0.5).  This was preventing saving of report formats with spaces in
	their names, for example.

2015-01-12  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* src/html/classic/help.xsl, CMakeLists.txt: Set version to 6.0+beta6.

2015-01-12  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 6.0+beta5 release.

	* CHANGES: Updated.

2015-01-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add option to apply bulk actions to all filtered items.

	* src/gsad_omp.c (process_bulk_omp): Add cases for applying to all
	filtered items. Use original filter when exporting page contents.

	* src/gsad.c (init_validator): Make "bulk_select" alias of "number".

	* src/html/classic/omp.xsl (list-window): Add new option to bulk select
	all filtered items.
	(report, task, html-tasks-table, lsc_credential, agent, alert, filter)
	(tag, target, config, schedule, scanner, slave, info/cpe, info/cve)
	(info/nvt, info/ovaldef, info/cert_bund_adv, info/dfn_cert_adv)
	(info/allinfo, html-cpe-table, html-cve-table, html-nvt-table)
	(html-ovaldef-table, html-cert_bund_adv-table, html-dfn_cert_adv-table)
	(html-allinfo-table, note, override, group, permission, port_list)
	(report_format, html-reports-table, html-results-table, result, role)
	(user): Show checkboxes only if the parameter bulk_select equals 1.
	(process_bulk): Create hidden bulk_selected inputs from selection XML
	elements instead of copying parameters.

	* src/html/classic/po/de.xml: Add text for "all filtered" bulk actions.

2015-01-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (format_file_name): Get task and report format name
	for reports and resource name in case of other types for new params
	of openvas_export_file_name.
	(get_report): Put quotes around content_disposition file name.

	* src/gsad.c (init_validator): Add new placeholders %F and %N to
	details_fname, list_fname, report_fname.

	* src/html/classic/help.xsl (my_settings.html): Add new placeholders.

2015-01-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Right align form for choosing
	bulk selection type.

2014-12-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Replace toggle icon for
	bulk action mode (whole page or checkbox selection) with a dropdown
	form. Separate table footer with filter and page controls from
	table to allow this.

	* src/html/classic/po/de.xml: Replace text of switch icon with new
	dropdown text.

2014-12-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Add parameter no_bulk to
	hide bulk actions.
	(html-allinfo-table): Hide bulk actions here.

2014-12-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (export_many): Add special case for type "info".
	(process_bulk_omp): Check if info_type is given for type "info".

	* src/html/classic/omp.xsl (list-window): Add hidden info_type input
	and use correct path to id when type is "info".
	(info/cpe, info/cve, info/nvt, info/ovaldef, info/cert_bund_adv)
	(info/dfn_cert_adv, info/allinfo): Show checkboxes when if bulk_select
	is on.
	(html-cpe-table, html-cve-table, html-nvt-table, html-ovaldef-table)
	(html-cert_bund_adv-table, html-dfn_cert_adv-table)
	(html-allinfo-table): Set icon-count to 1 to show Actions column if
	bulk_select is on.

2014-12-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add current_user.

	* src/gsad_omp.c (save_user_omp): Only send NEW_NAME when login is
	given.

	* src/html/classic/omp.xsl (user [edit]): Skip name editing when editing
	current user.

2014-12-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (lsc_credential, agent, alert, filter)
	(target, config, schedule, scanner, slave, group, permission)
	(port_list, report_format, role, user): Show checkboxes when if
	bulk_select is on.

2014-12-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Make the bulk actions row
	a lighter grey.

2014-12-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Enable editing of user names.

	* src/gsad_omp.c (save_user_omp): Add NEW_NAME to MODIFY_USER.

	* src/html/classic/omp.xsl (user [edit]): Switch name to a text input.

2014-12-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (assets): Use new style page controls.

2014-12-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Add conceptual overview of permissions, and update predefined roles.

	* src/html/classic/help.xl (users.html): Replace predefined role
	description with link.
	(permissions.html): Link to conceptual overview.  Update columns.
	(new_permission.html): Update columns.  Add conceptual overview.
	Mention "low level" in first paragraph.
	(roles.html): Add new list of predefined roles.
	(glossary.html): Add permission.  Link to it in roles.

2014-12-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_many): Do not remember new filt_id if it is "0".

2014-12-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add bulk delete and export of page contents or checkbox selection
	for Scan Management and Tags.

	* src/gsad_omp.c (process_bulk_omp, bulk_delete_omp): New functions.

	* src/gsad_omp.h (process_bulk_omp, bulk_delete_omp): New prototypes.

	* src/gsad.c (init_validator): Add bulk_delete and process_bulk
	commands. Add parameters bulk_selected:name, bulk_selected:value,
	bulk_delete.x, bulk_export.x, bulk_delete.x, bulk_select.
	(params_append_mhd): Add case for bulk_selected.
	(exec_omp_post): Add case for bulk_delete command.
	(params_mhd_add): Add case for bulk_selected.
	(exec_omp_get): Add case for process_bulk command.

	* src/html/classic/omp.xsl (list-window): Add table row for bulk action
	icons. Either wrap table in a HTML form element for checkbox selections
	or build a form in the new bulk actions row that selects all items on
	the current page.
	(report, task): Replace action icons with checkbox if bulk_select is on.
	(html-tasks-table): Make overrides icon static if bulk_select is on.
	(tag, note, override): Replace action icons with checkbox if
	bulk_select is on.
	(html-reports-table): Make overrides icon static if bulk_select is on.
	(html-results-table): Make overrides icon static and add Actions column
	if bulk_select is on.
	(result): Add checkbox if bulk_select is on.
	(process_bulk): New template.

	* src/html/classic/po/de.xml: Add messages for bulk actions.

2014-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_role): Limit groups for Super dropdown to those
	owned by the current user.

2014-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Correct next page on Edit Role error.

	* src/gsad.c (init_validator): Add next_error.

	* src/gsad_omp.c (generate_page): New function.  Body from next_page.
	(next_page): Call generate_page.
	(next_page_error): New function.
	(create_permission_omp): Check for an error next page param before
	defaulting to New Permission.

	* src/html/classic/omp.xl (html-edit-role-form): Specify next page for
	error case in New Super Permission form, otherwise it goes to New
	Permission.

2014-12-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Add owner=any to users case, now that users
	have owners.

2014-12-16  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xl (preference [details])
	(preference [edit-details]): Handle osp_selection case.

2014-12-14  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (preference [edit-details]): Don't print the
	value for osp_file preferences as files may be huge.

2014-12-14  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (preference [edit-details]): Handle osp_file
	case.

2014-12-14  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (preferences [details])
	(preference [edit-details]): Rename osp_ovaldi_file to ovaldef_file for
	consistency.

2014-12-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad_omp.c (create_permission_omp): Don't create the dropped
	permission "resume_or_start_task" anymore.

2014-12-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (minor-details): Add owner.

2014-12-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_permission): Add filter, now that users have
	owners.

	* src/html/classic/omp.xsl (group, role, user): Add observer icon, now
	that owners are used.

2014-12-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (init_validator, exec_omp_post): Renamed
	resume_stopped_task to resume_task.

	* src/gsad_omp.c (resume_stopped_task_omp): Renamed to resume_task_omp.
	(create_permission_omp): Adjust to name change.
	(resume_task_omp): Renamed command string from "resume_stopped"
	to "resume".

	* src/gsad_omp.h: Adjust proto accordingly.

	* src/html/classic/gsad.xsl (template resume_stopped_task_response):
	Renamed to resume_task_response.
	(template html-gsa-logo): Adjust to name change.

	* src/html/classic/omp.xsl (task-icons, get_task, get_tasks): Adjust
	to name change.
	(resume_stopped_task_response): Renamed to resume_task_response.

	* src/html/classic/po/de.xml, src/html/classic/po/zh.xml: Update
	strings about resume tasks.

2014-12-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (report [result-header]): Add image param.
	(result [result-headers], result [result-body], html-results-table)
	(result): Add Solution type column.

2014-12-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (task [trash]): Add observer icon.

2014-12-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (GET_TRASH_RESOURCE): Get all trash that the user may
	view.

	* src/html/classic/omp.xsl (agent [trash], alert [trash])
	(filter [trash], tag [trash], target [trash], config [trash])
	(schedule [trash], scanner [trash], slave [trash], note [trash])
	(override [trash], group [trash], permission [trash], port list [trash])
	(report_format [trash], role [trash]): Add observer icon.

2014-12-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (permission): Add observer icon.

2014-12-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (new-user-role-select): Remove exclusion
	of Super Admin role, so that the caller can control this.
	(html-create-user-form): Exclude Super Admin explicitly.
	(user [edit]): Include Super Admin if the user is already a Super Admin.

2014-12-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (page_url): Replace the cmd param in the URL.  Also be
	more careful about what can come before the parameters.

2014-12-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (new_task): Use correct scanner type value.
	(html-edit-task-scanner-disabled): Add scanner_type value to the save
	form.

2014-12-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (save_task_omp): Revert 21088. Conditional is true as
	value 1 is for OSP Scanner type.

2014-12-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_task): Get all slaves that the user may read.

2014-12-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/img/clone_inactive.png: Make lighter so it's more
	like the others.

2014-12-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* CMakeLists.txt: Add new icon from last commit.

2014-12-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Enable mixing slaves and tasks with those of other users.

	* src/gsad_omp.c (edit_task): Get all slaves the user may read.

	* src/html/classic/omp.xsl (task-icons): Mark slave unavailable if user
	may not read it.
	(slave [details]): Mark task unavailable if user may not read it.

	* src/html/classic/img/details_inactive.png: New file.

2014-12-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_task_omp): Correct conditional.  Scanner of type
	"1" must use the given slave, host_ordering, etc.

2014-12-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (fill_empty_fields): Check
	the data type of empty fields and choose the filler accordingly.

2014-12-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add icons, a new list column and a donut chart for the solution_type
	tag of NVTs.

	* src/html/classic/graphics.xsl (js-secinfo-top-visualization)
	(dashboard [secinfo]): Add donut chart of NVTs by solution_type.

	* src/html/classic/omp.xsl (solution-icon): New template.
	(list-window): Add image parameter to column-name template calls.
	(column-name): New parameter image that replaces the column label text
	with an image.
	(info/nvt, html-nvt-table): Add new solution_type column.
	(nvt [details]): Add icon for solution_type.

	* src/html/classic/js/gsa_donut_chart.js (generate): Apply new
	fill_empty_fields function to data.

	* src/html/classic/js/gsa_graphics_base.js (fill_empty_fields): New
	function. Fills empty fields with "N/A" and moves records with empty
	x axis field to the end of the records list.

2014-12-02  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Explicitly ignore generated CPE icon and timezone
	dictionaries when creating a source package.

2014-12-01  Matthew Mundell <matthew.mundell@greenbone.net>

	Ensure that auto refresh goes to the current page when the previous page
	submitted a form.

	* src/gsad_base.h (credentials_t): Add current_page.

	* src/gsad.c (credentials_free): Free current_page.

	* src/gsad_omp.c (xsl_transform_omp): Add CURRENT_PAGE to ENVELOPE.
	(page_url, page_url_append_param): New functions.
	(next_page): Setup current_page in credentials according to "next"
	param.  This overrides the default, which is to use the caller URL.
	(get_one, get_task, get_config): Append ID to page_url when extracting
	ID from OMP CREATE response.

	* src/html/classic/gsad.xsl (autorefresh [html-header-meta]): Use
	CURRENT_PAGE instead of CALLER for the refresh URL.
	(current_page): New template.

2014-12-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-reports-table): Add "permission=any"
	and "owner=any" keywords to filter used by "Return to default filter
	view" icon.

2014-11-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (user): Add permissions test to delete icon,
	to match Details page.

2014-11-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* ChangeLog: Add missing entry.

2014-11-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_role): Correct filter field name.

2014-11-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_one): Check if extra_xml was given, to prevent
	segfaults when the database contains errors.

2014-11-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (user): Correct condition for greying the
	delete icon.

2014-11-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/wizard.xsl (modify-task-wizard): Change "next" param
	to "get_tasks".

2014-11-26  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/wizard.xsl (quick-first-scan-wizard): Pass default
	Port List, Alert, OpenVAS Scan Config, Credentials, OpenVAS Scanner and
	Slave from My Settings to wizard. Add a note about the use of these
	defaults.
	(quick-task-wizard): Pass default Port List and OpenVAS Scanner from
	My Settings. Add a note about the use of these defaults.

	* src/html/classic/po/de.xml: Add the notes about using the defaults.

2014-11-26  Matthew Mundell <matthew.mundell@greenbone.net>

	Add Super permissions support to Edit Permissions page.

	* src/gsad_omp.c (save_permission_omp): Add resource type to OMP.

	* src/html/classic/omp.xsl (html-edit-permission-form): Add Super,
	including optional resource type field.

2014-11-26  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (new_task): Don't show OSP task submenu if no
	OSP configs are available.

2014-11-26  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c: Remove #define _GNU_SOURCE and <time.h> include.
	Include <openvas/base/openvas_file.h> instead.
	(format_file_name): Use openvas_export_file_name from libraries to
	format the file name.

2014-11-26  Matthew Mundell <matthew.mundell@greenbone.net>

	Add creating of role/group/user Super permissions to New Permissions
	page.

	* src/gsad_omp.c (create_permission_omp): Allow "" as resource type.

	* src/html/classic/omp.xsl (gsa:permission-description): Add type name
	to Super description.
	(html-create-permission-form): Add Super, including optional resource
	type field.
	(html-edit-role-form): Switch to optional_resource_type.

2014-11-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a New Super Permission section on the Edit Role page.

	* src/gsad.c (init_validator): Add Super to permission.

	* src/gsad_omp.c (create_permission_omp): Handle resource_type.
	(edit_role): Get groups for dropdown.

	* src/html/classic/omp.xsl (html-edit-role-form): Add Super section.

2014-11-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/wizard.xsl (quick-task-wizard): Add timezone
	selector drop-down.

2014-11-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/wizard.xsl (modify-task-wizard): Use parameter
	"start_timezone" instead of "timezone" to set timezone of schedule.

2014-11-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (task-icons): Put back the special
	enable_stop case that Jan removed with the Pause feature.  This is handy
	when the task gets stuck on Stop Requested after an error.

2014-11-25  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (html-create-config-form): Don't show OSP
	scanners drop-down if it is empty.

2014-11-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/wizard.xsl (wizard-icon): Add "Modify Task Wizard"
	to menu.
	(modify-task-wizard, wizard/modify_task): New templates.
	(wizard_list): Add "Modify Task Wizard" to menu.

	* src/html/classic/po/de.xml: Add text of new Modify Task Wizard.

2014-11-24  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (alert [newtask], new-task-alert-select):
	New parameter select_id to pre-select an alert by id.
	(new_task): Select all alert_id_optional parameters and sort drop-downs
	using index of alert_id_optional. Use alert_id element in new_task
	to select the default Alert in the last drop-down.

2014-11-24  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add settings for default resource selections on the "New Task" and
	"New Target" pages.

	* src/gsad_omp.c (setting_get_value): Allow missing settings.
	(PARAM_OR_SETTING): New macro.
	(new_task, new_target): Get resource params or fall back to default
	resource settings and add them to the new_task / new_target element.
	(get_my_settings_omp, edit_my_settings): Get Alerts, Configs,
	Credentials, Filters, Port Lists, Scanners, Schedules, Slaves and
	Targets in one "commands" command. Adjust Error messages.
	(save_my_settings_omp): Save new default resources settings. Get
	Alerts, Configs, Credentials, Filters, Port Lists, Scanners, Schedules,
	Slaves and Targets in one "commands" command.

	* src/gsad.c (init_validator): Add settings_default:name and
	settings_default:value.
	(params_append_mhd, params_mhd_add): Add settings_default:.

	* src/html/classic/help.xsl (my_settings.html): Add new section about
	default resource settings.

	* src/html/classic/omp.xsl (get-settings-resource): New template.
	(get-settings-filter): Use get_filter_response in commands_response.
	(edit-settings-resource): New template.
	(edit-settings-filters): Use get_filter_response in commands_response.
	(new_task): Pre-select resources from new_task element in drop-downs.
	(lsc_credential [select], port_list [select]): Add select_id param to
	select an entry by id.
	(html-create-target-form): Pre-select resources from new_task element
	in drop-downs.
	(get_my_settings, edit_my_settings): Add default resource settings.

	* src/html/classic/wizard.xsl (quick-task-wizard): Pre-select resources
	based on settings.

2014-11-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* src/html/classic/help.xsl, CMakeLists.txt: Set version to 6.0+beta5.

2014-11-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 6.0+beta4 release.

	* CHANGES: Updated.

2014-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	Make delete and clone icons fit special restrictions on Super Admin.

	* src/html/classic/omp.xsl (list-window-line-icons): Make clone tooltip
	more generic.
	(details-header-icons): Add grey-clone flag.
	(user): Grey delete icon according to writable and in_use.  Grey clone
	icon if the user has the Super Admin role.
	(user [details]): Grey clone if Super Admin.

2014-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (new-user-role-select, html-create-user-form)
	(user [edit]): Remove Super Admin from role lists.

2014-11-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/help.xsl (reports.html): Removed note about "timezone"
	modifier as it was wrongly placed.
	(view_report.html): Added the note here and removed some void paragraphs.
	This section still needs a comprehesive update.

2014-11-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* tools/zone-append.in, tools/zone-prepend.in: Remove. Renamed to
	tools/zone-dict-append.in, tools/zone-dict-prepend.in.

	* tools/zone-dict-append.in, tools/zone-dict-prepend.in: New. Renamed
	files tools/zone-append.in, tools/zone-prepend.in.

2014-11-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/help.xsl (reports.html): Added note about "timezone"
	modifier.

2014-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (help [new_schedule.html])
	(help [my_settings.html]): Update Timezone for new dropdown selection.

2014-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (timezone-select): Use the given timezone for
	the fallback text box instead of the current timezone.  Use the name arg
	for the text box, instead of always 'text'.  Update the arg name to
	reflect this, and update all callers accordingly.

2014-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-create-schedule-form)
	(html-edit-schedule-form): Use dropdown for timezone.

2014-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (report [filterbox]): Add timezone field in
	expanded filtering.
	(timezone-select): New template.
	(edit_my_settings): Call timezone-select to do timezone dropdown.

2014-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (gsa:permission-description): Add Super.
	(role [details]): Prepend Super row in Permissions window if user has
	Super permission.

2014-11-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (setting_get_value): New function.
	(export_resource, export_many, get_report): Get file name setting
	using setting_get_value.
	(authenticate_omp): Get language and autorefresh setting using
	setting_get_value.

2014-11-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (task [details]): Add filter keywords
	"permission=any owner=any" to report list links.

2014-11-18  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (resource-permissions-window): Change the
	permission selection to "read" and "proxy" only.

2014-11-18  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_trash): Fix typo in GET_LSC_CREDENTIALS messages.

2014-11-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (report [summary]): Add timezone to dates,
	now that the timezone can be changed in the filter.

2014-11-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js (generate): Show long form
	of x value in tooltip if available.

	* src/html/classic/js/gsa_graphics_base.js (data_severity_level_counts):
	Add long form of severity classes.

2014-11-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_task): Use regex for name to select permissions.
	(create_permission_omp): Create get_tasks, modify_task, start_task,
	stop_task, resume_or_start_task and resume_stopped_task permissions
	if the permission name is "task_proxy".

	* src/html/classic/omp.xsl (resource-permissions-window): Add dropdown
	to select the type of permission, including a special "proxy" case
	for tasks that adds all permissions except delete.

	* src/html/classic/po/de.xml: Add / modify strings for new permission
	selection in Permission Window.

2014-11-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Use a dropdown for the timezone on the Edit User page.

	* CMakeLists.txt: Create and install timezone dictionary.

	* src/html/classic/omp.xsl (edit_my_settings): Use dropdown for
	timezone.

	* tools/generate-zone-dict.sh, tools/zone-append.in,
	tools/zone-prepend.in: New files.

2014-11-17  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* CMakeLists.txt: Check for and link against libopenvas_omp,
	libopenvas_base and libopenvas_misc libraries instead of the whole
	libopenvas package.

2014-11-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsa-style.css (.d3-tip): Reduce padding and center
	text.

	* src/html/classic/js/gsa_bar_chart.js (severity_bar_style): Remove
	console output. Change second "if" to "else if". Use the color halfway
	between class colors for mixed bars to improve contrast.
	(generate): Show x value (or its "~long" version if available) in the
	tooltip.

	* src/html/classic/js/gsa_graphics_base.js (data_severity_histogram):
	Add a special "~long" version of the bin column to the records that
	specifies the whole severity range of a row (e.g. "1.1 - 2.0").

2014-11-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (format_file_name): Consider format_state being -1
	in assertion.

2014-11-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsa-style.css: Add styles for icon menus.

	* src/html/classic/wizard.xsl (wizard-icon): Open a drop-down menu
	to select the wizard when hovering over the icon.

2014-11-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (init-d3charts): Correct max_low
	assignment.

	* src/html/classic/js/gsa_bar_chart.js (severity_bar_style): Adjust
	to corrected max_low and blend colors for bars that represent more
	than one severity level.

2014-11-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (format_file_name): Add string placeholder support for
	current, creation and modification time. Make modification date
	fallback work as described on the help page.

	* src/gsad.c (init_validator): Add %c, %m and %t as valid placeholders
	in details_fname, list_fname and report_fname.

	* src/html/classic/help.xsl (my_settings.html): Add descriptions of
	new placeholders.

2014-11-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (): Add #define _GNU_SOURCE and #include <time.h>.
	(format_file_name): Add credentials and resource_entity parameters.
	Add string placeholder support for current user name, creation and
	modification date. Rename file_date to now_date and free it before
	returning.
	(export_resource, export_many): Add new parameters to format_file_name
	call.
	(get_report): Close server connection after getting the file name
	setting in XML case. Add new parameters to format_file_name call.

	* src/gsad.c (init_validator): Add %C, %M and %u as valid placeholders
	in details_fname, list_fname and report_fname.

	* src/html/classic/help.xsl (my_settings.html): Add descriptions of
	new placeholders.

2014-11-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (create_target_omp): Free esxi_credentials_element
	after command has been generated.

2014-11-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsad.xsl (html-gsa-logo): Set height and width of
	logo img as some versions of Firefox do not always adjust the size
	correctly.

2014-11-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (svg_from_elem): Clone
	the SVG element and remove elements marked with the CSS class
	"remove_on_static".

	* src/html/classic/js/gsa_line_chart.js (generate): Add CSS class
	"remove_on_static" to tooltip elements.

2014-11-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js (generate)
	src/html/classic/js/gsa_bubble_chart.js (generate)
	src/html/classic/js/gsa_donut_chart.js (generate)
	src/html/classic/js/gsa_line_chart.js (generate): Clear mouse event
	listeners when chart is loaded.

2014-11-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Make formatting in tables and some chart tooltips data type specific.

	* src/html/classic/js/gsa_bar_chart.js (generate): Pass column info to
	csv_from_records and html_table_from_records.

	* src/html/classic/js/gsa_bubble_chart.js (tooltip_func): Replace
	hardcoded formatting of color values with format_data calls for all
	fields.
	(generate): Pass column info to csv_from_records and
	html_table_from_records.

	* src/html/classic/js/gsa_donut_chart.js (generate): Pass column info
	to csv_from_records and html_table_from_records.

	* src/html/classic/js/gsa_graphics_base.js (gsa.date_format)
	(gsa.datetime_format): New date format functions.
	(format_data, format_data_default): New functions.
	(csv_from_records, html_table_from_records): Apply format_data to
	the data values.

	* src/html/classic/js/gsa_line_chart.js (time_line): Change data type
	of t_field to "js_date" in column info.
	(mouse_moved): Replace hardcoded date formatting with format_data call.
	(generate): Pass column info to csv_from_records and
	html_table_from_records.

2014-11-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/st_workaround.png,
	src/html/classic/img/solution_type.png,
	src/html/classic/img/st_vendorfix.png,
	src/html/classic/img/st_willnotfix.png,
	src/html/classic/img/st_nonavailable.png
	src/html/classic/img/st_mitigate.png: New. Icons for Solution Type.

	* CMakeLists.txt: Install the new solution type icons.

2014-11-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add the time step to count fields (e.g. "NVTs / day") and correct
	legend placement.

	* src/html/classic/js/gsa_graphics_base.js (column_label): Delegate to
	label_generator function in column info or default_column_label.
	(default_column_label): New function with functionality from original
	column_label function.

	* src/html/classic/js/gsa_line_chart.js (time_line): Add custom column
	labeling function that adds the time step to count fields. Use updated
	column info when processing records.
	(generate): Correct width calculations for legend element placement.

2014-11-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js (mouse_moved, generate): Fix
	handling of cases with no records or a single one.

2014-11-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add tooltip box and sliding vertical bar to line charts.

	* src/html/classic/js/gsa_graphics_base.js (find_record_index): New
	function.

	* src/html/classic/js/gsa_line_chart.js (time_line): Remember the
	object used to round the time values.
	(mouse_exited, mouse_moved): New functions.
	(generate): Use d3 min and max functions to get the bounds of x, y and
	y2 values. Attach mouse listeners to the display's SVG element and add
	tooltip elements.

2014-11-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Apply patch provided by Michal Ambroz.

	* src/gsad.c (drop_priveleges): Call setgroups() before setgid().

2014-11-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js
	(detached_chart_resize_listener): Adjust to chart box width being 98%
	of window width.

2014-11-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (DataSource [request_data]):
	Check OMP response code before trying to extract data.

2014-11-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (export_results_omp): New function.

	* src/gsad_omp.h (export_results_omp): New function prototype.

	* src/gsad.c (init_validator, exec_omp_get): Add case for
	export_results command.

2014-11-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (export_resource): Remove special handling for the
	type "result" as results retrieved with the get_results OMP command
	are no longer nested inside a "results" element since trunk r20260.

2014-11-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add settings to modify the file name format of exported resource lists,
	resource details and reports.

	* src/gsad_omp.c (format_file_name): New function.
	(export_resource, export_many, get_report): Generate export file names
	based on format defined in a setting.
	(save_my_settings_omp): Add params for new settings
	"Details Export File Name", "List Export File Name" and
	"Report Export File Name".

	* src/gsad.c (init_validator): Add details_fname, list_fname and
	report_fname.

	* src/html/classic/help.xsl (my_settings.html): Add help for newly
	added settings.

	* src/html/classic/omp.xsl (get_my_settings, edit_my_settings): Add
	new settings new settings "Details Export File Name",
	"List Export File Name" and "Report Export File Name".

	* src/html/classic/po/de.xml: Add new setting names.

2014-11-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js (generate): Always use
	donut_full_top_path_d if number of slices <= 1.

2014-11-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Make charts use filter ids instead of copying filter terms. Add filter
	name to chart header. Limit width of chart box and cut off too long
	title text.

	* src/gsad_omp.c (get_aggregate_omp): Handle filt_id param.

	* src/html/classic/graphics.xsl (js-create-chart-box): Reduce default
	width by 2 px and add container_width.
	(js-aggregate-data-source): Add filt_id parameter.
	(js-aggregate-chart): Add filt_id parameter. Adjust title_total params.
	(js-scan-management-top-visualization, js-secinfo-top-visualization):
	Pass filter id to new charts.

	* src/html/classic/gsa-style.css (.chart-head): Add attributes to cut
	off overlong header text and show ellipsis if necessary.

	* src/html/classic/omp.xsl (get_aggregate): Set container_width of
	chart box to 98% and pass filter id to chart.

	* src/html/classic/js/gsa_bubble_chart.js (simple_bubble_data): Copy
	filter_info from original data object.

	* src/html/classic/js/gsa_graphics_base.js (create_chart_box): Add new
	container_width parameter.
	(DataSource [request_data]): Get filter info.
	(Display [select_filter]): Clear filter term parameter and set filt_id
	instead.
	(extract_filter_info): New function.
	(data_severity_histogram, data_severity_level_counts)
	(resource_type_counts): Copy filter_info from original data object.
	(title_total): Reduce parameters to title and count_field. Make the
	"(Loading...)" and "(Total: [...])" text static. Add filter name to
	title if one is available.

	* src/html/classic/js/gsa_line_chart.js (time_line): Copy filter_info
	from original data object.

2014-11-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (result [result-body]): Check the result's
	severity for the cases when the nvt's cvss is not available.

2014-11-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (result [result-body]): Improve check for
	nvt's oid value when adding details link.

2014-10-31  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (nvt [details]): Add subsection for the
	"solution_type" tag.

	* src/html/classic/po/de.xml: Add "Solution type" message.

2014-10-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js (time_line): Set time step to
	1 year if data set covers a period of more than 3650 days.

2014-10-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-secinfo-top-visualization): Show
	time line chart on all SecInfo list pages.
	(dashboard [secinfo]): Add time line charts for other SecInfo types.

2014-10-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js (generate): Position second
	legend element dynamically to ensure it does not overlap the first.

2014-10-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js (time_line): Skip records with
	non-numeric time values.

2014-10-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (gsa:field-name): New function. Replaces
	"created" with "creation time", "modified" with "modification time"
	and replaces underscores with spaces for other field names.

	* src/html/classic/graphics.xsl (js-aggregate-chart): Apply new
	gsa:field-name function to column names in selector_label and
	title_generator.

2014-10-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (init-d3charts): Get token from params
	instead of token element to keep special "guest" token.

	* src/html/classic/omp.xsl (get_aggregate): Set auto_load param of
	chart to 0 to avoid unnecessary request.

2014-10-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js
	(data_severity_level_counts): Sort levels in descending order by
	default and add parameter to sort in ascending order.

2014-10-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (save_target_omp): Remove redundant null check.

2014-10-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Remove stray colon.

2014-10-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-target-form): Use the port list's
	name from the port_list element.

2014-10-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (user_find): In simple cases return 0 directly instead of
	via ret.  In final "if" check if ret has already been set, otherwise the
	return of 3 is overwritten.

	* src/gsad_omp.c (get_report): In prognostic case free delta_states and
	set error, and add missing openvas_server_sendf_xml check.
	(save_user_omp): Remove duplicate assignment.

2014-10-15  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Linking against libgthread is required only when
	using GLib =< 2.30. Adjust checks and assignments in CMakeLists
	accordingly.

2014-10-14  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* src/html/classic/help.xsl, CMakeLists.txt: Set version to 6.0+beta4.

2014-10-14  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 6.0+beta3 release.

	* CHANGES: Updated.

2014-10-14  Benoît Allard  <benoit.allard@greenbone.net>

	revert r19245 (Older glib still need that call to g_thread_init)

	* src/CMakeLists.txt, src/gsad.c, CMakeLists.txt: Updated

2014-10-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js (data_transform): Set to
	time_line by default.
	(time_line): Use same interface as other data transformation functions.
	Re-aggregate all columns and try to determine appropriate method
	automatically. Choose filler for count and c_count automatically if
	none is set in the params.
	(generate): Remove extra call to time_line.

2014-10-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_line_chart.js (time_line): Make 1 month
	the largest time step.
	(generate): Do not call the "nice" function for the x axis.

2014-10-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Make charts DataSource extract data records and column info. Pass
	them bundled in a single object together with the XML. Adjust data
	transformation functions accordingly.

	* src/html/classic/js/gsa_bar_chart.js (generate): Use data bundle
	object instead of extracting records from XML and getting column_info
	directly from data_source.

	* src/html/classic/js/gsa_bubble_chart.js (tooltip_func): Use static
	"color_value" as column_info is transformed together with records.
	(generate): Use data bundle object instead of extracting records from
	XML and getting column_info directly from data_source.
	(simple_bubble_data): Adjust to transform whole data bundle, not only
	records.

	* src/html/classic/js/gsa_donut_chart.js (generate): Use data bundle
	object instead of extracting records from XML and getting column_info
	directly from data_source.

	* src/html/classic/js/gsa_graphics_base.js (DataSource [request_data]):
	Extract data records and column info here and bundle it in an object
	which is passed to generators instead of the XML.
	(gather_column_info): Remove. Replaced by extract_column_info.
	(extract_column_info): New function. Extracts the column info from
	the XML response instead of reconstructing it from parameters.
	(column_label, data_severity_histogram, data_severity_level_counts)
	(resource_type_counts, title_total): Adjust to new data object and
	column info syntax.

	* src/html/classic/js/gsa_line_chart.js (generate): Use data bundle
	object instead of extracting records from XML and getting column_info
	directly from data_source. Remove debug output for single record case.

2014-10-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (DataSource [request_data]):
	Gather column information when request finishes.
	(DataSource [column_info], gather_column_info, column_label): New
	functions.

	* src/html/classic/js/gsa_bar_chart.js (generate): Get column info and
	use it to generate table column headers.

	* src/html/classic/js/gsa_bubble_chart.js (generate): Get column info
	and use it to generate table column headers and bubble tooltips.

	* src/html/classic/js/gsa_donut_chart.js (generate): Get column info
	and use it to generate table column headers.

	* src/html/classic/js/gsa_line_chart.js (generate): Get column info
	and use it to generate table column headers.

2014-10-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/help.xsl (users.html): Add info for the roles
	"Info", "Guest" and "Monitor". Note that multiple and user-defined
	roles can be chosen. Change "Role" field to an optional "Roles" one.

2014-10-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* CMakeLists.txt: Set USE_LIBXSLT by default.

2014-10-02  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (html_table_from_records):
	Make headline a table row, make table use full window width and remove
	border around table.

2014-10-01  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (credentials_new, credentials_free): New functions.
	(exec_omp_post, request_handler): Refactor code to use
	credentials_new(), fix credentials memory leaks.

2014-10-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js
	src/html/classic/js/gsa_bubble_chart.js
	src/html/classic/js/gsa_donut_chart.js
	src/html/classic/js/gsa_line_chart.js: Add HTML table export menu item.

	* src/html/classic/js/gsa_graphics_base.js (resource_type_name): Add
	allinfo case.
	(html_table_from_records): New function.

2014-10-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js (generate)
	src/html/classic/js/gsa_bubble_chart.js (generate)
	src/html/classic/js/gsa_donut_chart.js (generate)
	src/html/classic/js/gsa_line_chart.js (generate): Dynamically generate
	CSV column names and make column selection fit the chart better.

2014-09-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js (generate): Change file names
	of exported CSV and SVG to "gsa_bubble_chart-[...]".

	* src/html/classic/js/gsa_donut_chart.js (generate): Change file name
	of exported CSV to "gsa_donut_chart-[...]".

	* src/html/classic/js/gsa_line_chart.js (generate): Change file name
	of exported CSV to "gsa_line_chart-[...]".

2014-09-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (gsa:escape-js): Add escaping for "<", ">"
	and "'". Use character code form for all escaped characters.

2014-09-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsa-style.css (.axis text): Split font styling so it
	does not override "font-style".

	* src/html/classic/js/gsa_graphics_base.js (field_name): New function.

	* src/html/classic/js/gsa_line_chart.js (LineChartGenerator): Enlarge
	top margin, add legend_elem variable.
	(generate): Add legend on top of chart. Make font of right y axis
	oblique.

2014-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Default to GET_SYSTEM_REPORTS before
	GET_MY_SETTINGS, because this is convenient for the Monitor role.

2014-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (full-report-export-form)
	(filtered-report-export-form): Add timezone to download form.

	* src/gsad_omp.c (get_report): Add timezone to GET_REPORTS request.

2014-09-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add charts to the Tasks page.

	* src/html/classic/graphics.xsl (js-scan-management-top-visualization):
	New template.

	* src/html/classic/omp.xsl (html-tasks-table): Add visualization.

2014-09-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl (tasks.html): Correct schedule example.

2014-09-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl (tasks.html): Note the extra filtering terms
	"schedule" and "next_due".

2014-09-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add second line to line charts so the NVTs chart shows both the new
	NVTs per time step and the cumulative amount.

	* src/html/classic/js/gsa_line_chart.js (LineChartGenerator): Increase
	right margin size. Add variables for second y axis. Make line generator
	test if y fields are defined.
	(time_line): Add parameters aggregate2, fill, fill2. Return empty data
	array if original was empty. Get data for second y axis and fill in
	missing values according to fill and fill2.
	(generate): Add second line and y axis. Handle missing values and data
	arrays containing only one point.

2014-09-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Process charts request parameter for all http get requests, not just
	OMP get commands.

	* src/gsad_omp.c (get_many): Do not set the charts setting here.

	* src/gsad.c (exec_omp_get): Try to get charts parameter and update
	setting accordingly.

2014-09-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (get_aggregate): Get displays array from
	gsa object.

2014-09-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Clean up various variables of chart JavaScript that are global, but
	should be local.

	* src/html/classic/graphics.xsl (init-d3charts): Put chart objects,
	gsa_token and severity_levels into a gsa base object.
	(js-aggregate-data-source, js-aggregate-chart)
	(js-secinfo-top-visualization, dashboard [secinfo]): Update references
	to objects now in the gsa object.

	* src/html/classic/js/gsa_bubble_chart.js (simple_bubble_data): Make
	the variable d local.

	* src/html/classic/js/gsa_donut_chart.js (relax_labels): Make variables
	local.

	* src/html/classic/js/gsa_graphics_base.js (): Create gsa object.
	(create_chart_box, Display, create_uri, capitalize)
	(data_severity_histogram, data_severity_level_counts)
	(resource_type_counts, wrap_text, title_total)
	(severity_colors_gradient): Update references to objects now in the gsa
	object and make various temporary variables local.

2014-09-24  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Reorganize generic chart functions, including moving them from chart
	type specific files to the more general gsa_graphics_base.js.

	* src/html/classic/js/gsa_bar_chart.js (title_static, title_total)
	(data_raw, data_severity_histogram): Remove. Moved to
	gsa_graphics_base.js.

	* src/html/classic/js/gsa_donut_chart.js (data_severity_level_counts):
	(resource_type_counts, severity_level_color_scale): Remove. Moved to
	gsa_graphics_base.js.

	* src/html/classic/js/gsa_graphics_base.js: Reorganize functions into
	different sections.
	(create_chart_box): Add 'and' in comment.
	(output_error, open_detached, fit_detached_window)
	(detached_chart_resize_listener): Relocate to section "Generic display
	helper functions".
	(data_raw, data_severity_histogram): Add. Moved from gsa_bar_chart.js.
	Add comments.
	(data_severity_level_counts, resource_type_counts)
	(severity_level_color_scale): Add. Moved from gsa_donut_chart.js.
	Add comments.

2014-09-24  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add basic line chart.

	* CMakeLists.txt: Install file src/html/classic/js/gsa_line_chart.js.

	* src/html/classic/graphics.xsl (init-d3charts): Load new file
	js/gsa_line_chart.js.
	(js-aggregate-chart): Add new case for line chart.
	(js-secinfo-top-visualization, dashboard [secinfo]): Add line chart for
	NVTs by creation time.

	* src/html/classic/js/gsa_line_chart.js: New JavaScript file.

2014-09-24  Michael Wiegand <michael.wiegand@greenbone.net>

	Bump required minimum version of openvas-libraries.

	* CMakeLists.txt: Bump required openvas-libraries version to 8.0.0 or
	later.

	* INSTALL: Update version of openvas-libraries dependency.

2014-09-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (preference [details, edit-details]): Handle
	osp_boolean preference type adequately.

2014-09-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (get_my_settings): Correct row backgrounds.

2014-09-23  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* src/html/classic/help.xsl, CMakeLists.txt: Set version to 6.0+beta3.

2014-09-23  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 6.0+beta2 release.

	* CHANGES: Updated.

2014-09-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/os_netgear.png: New.

	* src/html/classic/img/os_cyclades.png: Updated.

	* CMakeLists.txt: Install the two icons.

	* src/html/classic/os.xml: Added netgear.

2014-09-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl (glossary.html): Mention task alterable
	flag.
	(tasks.html): Add note about when Alterable Task field is present, for
	Edit Task help.

2014-09-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_report): Use "no_pagination" as value for
	apply_filter if it is not given.

	* src/html/classic/omp.xsl (report [section-filter]): Color text grey
	only if the filter is not applied at all.

2014-09-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl (new_task.html): Get row backgrounds right.

2014-09-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl (details-window-line-actions): Use type in
	alt instead of "Scanner".
	(task_details.html): Bring Task Details up to date.

2014-09-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Allow configuring a scanner for IT-Schwachstellenampel. Make config
	and scanner available after submitting forms.

	* doc/readme-its.txt: Extend note to also include the Scanner.

	* src/html/its/gsad.xsl (main_page_link): Add new parameter
	event_data:include_scanners.
	(charts, chart_preferences): New dummy templates.
	(html-footer): Increase version number to 1.2.

	* src/html/its/omp.xsl (task_controls): Try to get Config from
	event_data:config_id parameter if get_configs is not not available.
	Get scanner "ITS-Scanner" from get_scanners response or last
	event_data:scanner_id. Add warning if Scanner is not found.
	Pass event_data:config_id and event_data:scanner_id in every form.

2014-09-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* doc/readme-its.txt: Added not on special Scan Config
	and Report Format Plugin.

2014-09-18  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_report): Change possible values for apply_filter,
	allowing to only ignore the pagination info like the "first" and "rows"
	filter keywords.

	* src/gsad.c (init_validator): Make apply_filter a separate parameter
	name allowing the values "no", "no_pagination" and "full".

	* src/html/classic/omp.xsl (report [section-filter]): Add new default
	option to only ignore the pagination info and adjust existing selection
	items.

	* src/html/classic/po/de.xml: Update selection for apply_filter on
	report section pages.

2014-09-18  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add ESXi credentials to targets.

	* src/gsad_omp.c (create_target_omp, save_target_omp): Add ESXi
	credentials.

	* src/gsad.c (init_validator): Add lsc_esxi_credential_id as
	as alias for lsc_credential_id.

	* src/html/classic/help.xsl (new_target, targets.html): Add ESXi
	credentials.

	* src/html/classic/omp.xsl (html-create-target-form)
	(html-edit-target-form, html-targets-table, target, target [trash])
	(target [details], html-targets-trash-table): Add ESXi credentials.

	* src/html/classic/po/de.xml, src/html/classic/po/zh.xml: Change target
	column names.

2014-09-16  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/help.xsl, src/html/classic/omp.xsl: Use OSP Scanner
	name instead of OSP Ovaldi.

2014-09-16  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-target-form): Fix XPath
	expressions for get_target_response, which is no longer nested inside a
	commands_response element since the target_locator removal.

2014-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* ChangeLog: Add ChangeLog for last commit.

2014-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/gsad.xsl (html-gsa-navigation): In the Configuration
	menu round the bottom of the menu highlight when there is only one item.

2014-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (xsl_transform_omp, get_many): Pass token instead of
	username to set functions.

2014-09-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post, file_content_response)
	(request_handler): Check if guest_username is NULL before printing it.

2014-09-15  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/classic/po/de.xml: Fix spelling in German translation.

2014-09-12  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (user_add): Check guest_username value before usage to
	avoid segfault.

	* src/html/classic/omp.xsl (result [result-headers]): Don't leave
	result title empty in case no possible value is present.

2014-09-12  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (params_mhd_validate): Adjust to handle params with
	osp_pref_ prefix.

	* src/gsad_omp.c (save_osp_prefs): Correctly send all osp preferences.

	* src/html/classic/omp.xsl (edit-config-preferences [edit-details]):
	Handle preferences of osp_string type. Distinguish osp parameters with
	osp_pref_ prefix. Handle outputting of osp preferences values.

2014-09-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (user_find): Add more returns from authenticate_omp.
	(exec_omp_post, request_handler): Show login screen when automatic guest
	login fails.

2014-09-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (user_add): Set guest according to username.  This ensures
	that the user is marked as guest even when logged in with a password,
	which results in the session being used for generic guest links too.
	(user_find): Remove user->guest init.  Now done in user_add.

2014-09-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (struct user): Add guest flag.
	(user_add): Init guest flag.
	(user_find): When the special token is given and the guest user has an
	existing session in the browser, then use the existing session.  This
	prevents the generic guest links from logging the guest out on another
	tab, for example.

2014-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Default to dashboard in get_info case, to
	match the first item in the SecInfo menu.

	* src/gsad_omp.c (dashboard): Default dashboard name to SecInfo.

2014-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Allow users to have multiple simultaneous sessions, as long as the
	sessions are on different browsers.

	* src/gsad.c (user_add): Remove all previous users that have timed out.
	Always add a new user.
	(user_set_timezone, user_set_password, user_set_severity)
	(user_set_language, user_set_language_code, user_set_charts)
	(user_set_chart_pref, user_set_autorefresh): Change name arg to token.
	(exec_omp_post): Set user prefs in session by token instead of by name.

2014-09-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Remember last filt_id on each list page for the current session.

	* src/gsad_base.h (credentials_t): Add field last_filt_ids.

	* src/gsad_omp.c (get_many, get_report): Save type specific filt_id in
	current session data if it is given and retrieve it if neither filt_id
	nor filter is given.

	* src/gsad.c (user): Add field last_filt_ids.
	(user_add): Create last_filt_ids.
	(exec_omp_post, request_handler): Copy last_filt_id from user to
	credentials.

014-09-10 Michael Meyer <michael.meyer@greenbone.net>

	* src/html/classic/img/os_cyclades.png:
	New icon for cyclades.

	* src/html/classic/os.xml:
	Added cyclades.

2014-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Add automatic login of a specified user via a special token, and a
	"Login as a guest" link on the Login page.

	* src/gsad.c (guest_username, guest_password): New variables.
	(user_find): If the token is "guest" and --guest-username was given,
	then login as the guest user.
	(exec_omp_post, request_handler): Send guest username to XSL.  Handle
	new user_find return.
	(file_content_response): Send guest to XSL.
	(main): Add --guest-username and --guest-password.

	* src/html/classic/gsad.xsl (login_page): Display guest login link if
	configured.

2014-09-10  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (mhd_logger): Remove logger mutex locking as it is done in
	openvas_logging module now.

2014-09-09  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Make autorefresh interval a user setting that's automatically set
	by the refresh_interval parameter (e.g. from dropdown selections).

	* src/gsad_base.h (credentials_t): Add "autorefresh" field.
	(user_set_autorefresh): New function prototype.

	* src/gsad_omp.c (omp, ompf): New static function prototypes.
	(xsl_transform_omp): Save refresh_interval parameter in user settings.
	(authenticate_omp): Add autorefresh parameter and get "Auto-Refresh"
	setting.

	* src/gsad_omp.h (authenticate_omp): Add autorefresh parameter.

	* src/gsad.c (user): Add "autorefresh" field.
	(user_add): Add autorefresh parameter and set the autorefresh field
	of the user.
	(user_set_autorefresh): New function.
	(exec_omp_post, request_handler): Handle new autorefresh field of user
	and set autorefresh interval attribute in response to user setting.

	* src/html/classic/gsad.xsl (autorefresh): Add conditions for adding
	the refresh metadata.

2014-09-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (xsl_transform_omp): Exclude installer from PARAMS, as
	it may be binary.

2014-09-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-pager): Only activate the
	previous page button if the max rows parameter is > 0.

2014-09-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (report [section-list]): Add new item
	"Results view" linking to the get_results table.

	* src/html/classic/po/de.xml: Add new message "Results view" to
	context "Report Section".

2014-09-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (assets): Automatically submit overrides
	dropdown selection.
	(section-filter): Auto-submit filter dropdown selection.
	(get_system_reports_response): Auto-submit slave dropdown selection.

2014-09-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add clone icon to details pages.

	* src/html/classic/help.xsl (details-window-line-actions): Add section
	on clone icon.

	* src/html/classic/omp.xsl (gsa:may-clone): New function.
	(list-window-line-icons): Use new gsa:may-clone function to check if
	current user may clone the resource.
	(details-header-icons): Add clone icon.

2014-09-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (details-header-icons): Use gsa:may for New
	icon because gsa:may-op checks resource permissions.

2014-09-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsad.xsl (html-gsa-navigation): Add divider lines
	after Scan Management->Results, SecInfo Management->DFN-CERT and
	Administration->Roles.

2014-09-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/help.xsl (contents.html): Add link to Results page.
	(glossary.html): Add section "Result".
	(results.html): New template.

2014-09-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (result [result-headers]): Fix report and
	task related parameters and add missing ones for "Add Note" and
	"Add Override" buttons.

2014-09-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (preferences [details])
	(preference [edit-details]): Rename ovaldi_file to osp_ovaldi_file.
	Handle osp_integer preference type.

2014-09-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-create-note-form)
	(html-create-override-form, get_results_response, html-results-table):
	Change location of result elements from a results element inside the
	get_results_response element to directly inside get_results_response.

2014-09-04 Michael Meyer <michael.meyer@greenbone.net>

	* src/html/classic/os.xml:
	Added Cisco IOS XR.

2014-09-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (result [result-body]): Add section
	"Affected Software/OS" for showing the "affected" NVT tag.

	* src/html/classic/po/de.xml, src/html/classic/po/zh.xml: Add messages
	for the added "Affected Software/OS".

2014-09-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (get_nvts): Use "details" mode when
	applying templates to the NVT.

2014-09-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add autofp and override controls to results list page.

	* src/gsad_omp.c (get_many): Add apply_overrides and autofp keywords
	for results.
	(get_results): Add function call for toggling overrides.

	* src/html/classic/omp.xsl (filter-rest): Skip the keyword "autofp".
	(filter-window-part): Add autofp selection.
	(html-results-table): Add overrides toggle button to severity column.

2014-09-03  Michael Wiegand <michael.wiegand@greenbone.net>

	Make license of CMakeLists.txt files consistent.

	* doc/CMakeLists.txt: Change license from LGPLv2+ to GPLv2+.

2014-09-02  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_bubble_chart.js (BubbleChartGenerator): Round
	severity to one decimal place in tooltip.
	(BubbleChartGenerator [generate]): Save data_column in a variable.
	Fix nodes list generated for empty datasets and remove bubbles without
	any assigned data.

2014-09-02  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt, doc/gsad.8.xml, src/CMakeLists.txt, src/gsad_base.c,
	src/gsad_base.h, src/gsad.c, src/gsad_omp.c, src/gsad_omp.h,
	src/tracef.h, src/validator.c, src/validator.h,
	src/html/classic/graphics.xsl, src/html/classic/gsad.xsl,
	src/html/classic/gsa-style.css, src/html/classic/help_de.xsl,
	src/html/classic/help.xsl, src/html/classic/help_zh.xsl,
	src/html/classic/omp-doc.xsl, src/html/classic/omp.xsl,
	src/html/classic/os.xml, src/html/classic/po/de.xml,
	src/html/classic/po/zh.xml, src/html/classic/rnc.xsl,
	src/html/classic/wizard.xsl, src/html/classic/js/gsa_bar_chart.js,
	src/html/classic/js/gsa_bubble_chart.js,
	src/html/classic/js/gsa_donut_chart.js,
	src/html/classic/js/gsa_graphics_base.js, src/html/its/CMakeLists.txt,
	src/html/its/gsad.xsl, src/html/its/gsa-style.css,
	src/html/its/help.xsl, src/html/its/omp.xsl,
	tools/generate-cpe-icon-dict.sh: Ensure the GPLv2+ license notice uses
	the paragraph suggested by the Free Software Foundation.

2014-09-01  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (new_config): Query the list of scanners.
	(create_config_omp): Send uuid of scanner to create config from, when
	base config value is 0.
	(new_alert): Fix error message.

	* src/html/classic/omp.xsl (html-create-config-from): Add choice list of
	OSP scanners to create config from.

2014-09-01  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (nvt): Add details mode to template, to
	differentiate with info/nvt template.
	(nvt-details): Fix template name. Correctly call nvt template.
	(html-config-nvt-table): Correctly call nvt template.

2014-09-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add "NVTs by family" bubble charts.

	* CMakeLists.txt: Install src/html/classic/js/gsa_bubble_chart.js.

	* src/html/classic/graphics.xsl (init-d3charts): Add
	gsa_bubble_chart.js.
	(js-aggregate-data-source): Add data_column parameter for generic
	DataSource.
	(js-aggregate-chart): Add chart type option "bubbles".
	(js-secinfo-top-visualization, dashboard [secinfo]): Add bubble charts
	"NVTs by family".

	* src/html/classic/js/gsa_bubble_chart.js: New JavaScript file.

	* src/html/classic/js/gsa_graphics_base.js (severity_colors_gradient):
	New function.

2014-08-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post release version bump.

	* src/html/classic/help.xsl, CMakeLists.txt: Set version to 6.0+beta2.

2014-08-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Preparing the gsa 6.0+beta1 release.

	* CHANGES: Updated.

2014-08-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add overview table of all results to Scan Management.

	* src/gsad_omp.c (next_page): Add case for get_results.
	(get_results, get_results_omp): New functions.

	* src/gsad_omp.h (get_results_omp): New function prototype.

	* src/gsad.c (init_validator, exec_omp_get): Add command get_results.

	* src/html/classic/gsad.xsl (html-gsa-navigation): Add "Results" item
	to Scan Management menu.

	* src/html/classic/omp.xsl (get_results_response): Add case for
	table view of results.
	(html-results-table, result): New templates.

2014-08-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (result [result-body]): Handle ospd-ovaldi
	results with no attached oval definintions.

2014-08-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (task [details]): Use right element for
	alterable field.

2014-08-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/help_de.xsl, src/html/classic/po/de.xml: Remove
	remaining mentions of paused tasks.

2014-08-13  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* CMakeLists.txt: Remove reference to deleted files.

	* src/html/classic/help_de.xsl, src/html/classic/po/de.xml,
	src/html/classic/po/zh.xml, src/html/its/gsad.xsl, src/html/its/omp.xsl:
	Update for pause feature removal.

2014-08-13  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Finish removal of pause feature.

	* src/gsad.c (init_validator): Don't validate pause_task and
	resume_paused_task.
	(exec_omp_post): Remove paused and resume paused tasks handling.

	* src/gsad_omp.c (pause_task_omp, resume_paused_task_omp): Delete
	functions.

	* src/gsad_omp.h: Remove deleted functions prototypes.

	* src/html/classic/gsad.xsl (pause_task_response)
	(resume_paused_task_response): Remove templates.
	(html-gsa-logo): Don't apply removed templates.

	* src/html/classic/help.xsl (reports.html, tasks.html): Remove
	references to pause feature.

	* src/html/classic/omp.xsl (pause-icon): Remove template.
	(task-icons, report [report], get_task): Remove references and handling
	of pause feature.
	(pause_task_response, resume_paused_task_response): Remove templates.

2014-08-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_tag, save_tag_omp): Remove manager_connect.
	Session was not being used used, and was not being closed in
	save_tag_omp.
	(authenticate_omp): Close session, otherwise Manager process wait around
	for more input.

2014-08-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (result [result-headers]): Remove checking of
	description value in oval definitions' case as nvt oid value is set
	correctly now.
	(result [result-body]): Use the NVT's oid to check for oval definitions
	instead of the description's value.

2014-08-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (dfn_cert_adv-details): Split CVE elements
	in case they contain a list of CVEs, fix or filter out invalid CVE-IDs.

2014-08-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add help for CERT-Bund Advisories.

	* src/html/classic/help.xsl (contents.html): Add links to pages
	"CERT-Bund Advisories" and "CERT-Bund Advisory Details".
	(cert_bund_adv_details.html): New template.
	(glossary.html): Add section "CERT-Bund Advisory".
	(my_settings.html): Add section for "CERT-Bund filter".
	(cert_bund_advs.html): New template.

2014-08-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (cert_bund_adv-details): Add "Categories"
	section.

	* src/html/classic/po/de.xml: Add "Categories" string for CERT-Bund
	Advisories.

2014-08-06  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* README, doc/gsad.8, doc/gsad.8.xml, doc/gsad.html: Documentation
	update. OpenVAS Administrator is not used anymore.

2014-08-06  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (main): Refactor listening address and port code. Use
	values correctly in --redirect case.

2014-08-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add new SecInfo subtype CERT-Bund Advisory (CERT_BUND_ADV).

	* src/gsad_omp.c (get_info): Add CERT_BUND_ADV case.

	* src/gsad.c (init_validator): Add "cert_bund_adv" as accepted value to
	aggregate_type. Add "cert_bund_adv" and "CERT-Bund Advisory" as values
	to resource_type.

	* src/html/classic/graphics.xsl (js-secinfo-top-visualization): Add
	chart selections for cert_bund_adv.
	(dashboard): Add CERT-Bund chart selection options.

	* src/html/classic/gsad.xsl (html-gsa-navigation): Add SecInfo menu
	item "CERT-Bund Advisories".

	* src/html/classic/omp.xsl (gsa:type-name, gsa:type-name-plural)
	(tagged_resource_link, tag_resource_types): Add cases for cert_bund_adv.
	(ref_cert_list): Add CERT-Bund as accepted CERT type.
	(info/cert_bund_adv): New template.
	(get_info_allinfo_lnk): Add case for cert_bund_adv.
	(get_info_cert_bund_adv_lnk, html-cert_bund_adv-table): New templatey.
	(get_info_response): Add case for cert_bund_adv.
	(cve-details): Add CERT-Bund as accepted CERT type.
	(cert_bund_adv-details): New template.
	(get_my_settings, edit_my_settings): Add CERT-Bund Filter.

	* src/html/classic/js/gsa_graphics_base.js (resource_type_name)
	(resource_type_name_plural): Add cases for cert_bund_adv.

	* src/html/classic/po/de.xml: Add translations for new resource type
	"CERT-Bund Advisory" and make common strings available in new
	CERT-Bund Advisory contexts.

2014-08-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/help.xsl, src/html/classic/help_zh.xsl
	(new_target.html): Remove the description of target locators (LDAP).

2014-08-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Removed target locator feature from daemon.

	* src/gsad_omp.c (new_target): Removed retrieval of target locators.
	(create_target_omp): Removed handling of target locators.
	(edit_target): Remove retrieval of target locators.
	(save_target_omp):

	* src/gsad.c (init_validator): Drop target locator from explations in comment
	and dropped entry "target_locator".

2014-08-05  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (result [result-headers]): Handle osp
	result cases to output the vulnerability title correctly.

2014-08-05  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_report, authenticate_omp): Call
	openvas_server_sendf instead of openvas_server_send.

2014-08-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Removed target locator feature as this is not being fully
	supported by the backend anyway and a real solutions would
	now be based on different mechanisms.

	This patch takes care of the removal from the html part.

	* src/html/classic/omp.xsl (target_locator mode select): Removed.
	(html-create-target-form, html-edit-target-form): Removed handling of
	target_locator case.
	(new_target): Dropped parameter "target_sources" when calling
	html-create-target-form.

2014-08-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad_omp.c (omp, authenticate_omp, new_task, edit_alert,
	new_target, save_config_omp, save_config_family_omp, get_report,
	get_report, import_port_list_omp): Use openvas_server_sendf
	instead of openvas_server_send, which is to be removed eventually.

2014-08-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (result [result-body]): Handle special case
	of osp results with ovaldi definitions.

2014-08-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Get filters shared by other users too.

2014-08-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl: Add note about password field being
	optional when LDAP box is checked.

2014-07-31  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Make logging in GSAD thread-safe to solve crashing issues when many
	requests are received at the same time. A quick way to test for this is
	to use: nmap localhost -p 443 --script ssl-enum-ciphers.

	* src/gsad.c (logger_mutex): New variable.
	(mhd_logger): Initialize mutex variable if not done. Protect logging
	function call.

2014-07-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (wrap_text): Do not move
	a too long word to the next line if it is the only one in the line.

2014-07-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report, get_report_section): Get report formats
	that are owned by other users too, for the download dropdown.

2014-07-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Use UUIDs to identify chart preferences and keep them between sessions
	by sending them to manager on updates and retrieving them on login.

	* src/gsad_omp.c (print_chart_pref): Replace name parameter with id.
	(save_chart_preference_omp): Use id instead of name. Save preference
	in Manager database. Close response tags.
	(authenticate_omp): Add chart_prefs parameter and get the user's chart
	preferences.

	* src/gsad_omp.h (authenticate_omp): Add parameter for chart_prefs.

	* src/gsad.c (user_add): Add chart_prefs parameter and use it instead
	of creating the user's chart_prefs of here.
	(user_set_chart_pref): Change pref_name to pref_id.
	(init_validator): Change chart_preference_name to chart_preference_id.
	(exec_omp_post): Add chart_prefs parameter for authenticate_omp.
	Replace pref_name with pref_id.

	* src/html/classic/graphics.xsl (js-create-chart-box)
	(js-secinfo-top-visualization): Replace preference names with ids and
	rename variables and parameters accordingly.

	* src/html/classic/js/gsa_graphics_base.js (create_chart_box)
	(Display, Display [select_filter]): Replace preference names with ids
	and rename variables and parameters accordingly.
	(Display [select_pref_name]): Remove. Renamed to select_pref_id.
	(Display [filter_pref_name]): Remove. Renamed to filter_pref_id.
	(Display [select_pref_id]): New. Renamed select_pref_name.
	(Display [filter_pref_id]): New. Renamed filter_pref_name.
	(Display [select_chart_index]): Replace preference name with id. Rename
	variable accordingly and use new chart_preference_id GSA parameter.

2014-07-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl (config_editor_nvt.html): Mention that files
	must be UTF-8 encoded.

2014-07-29  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Dropping the "Pause" Feature from GUI.

	Pausing a task is a feature that keeps the scanner running but asks it
	to not launch any further tests. Thus memory is consumed while being
	paused.

	The pausing feature caused various sorts of problems while not adding
	real benefit (the "Stop"/"Resume" Feature already serves the needs
	well).

	- Multiple paused tasks can eat all memory and make OOM killer act.
	- Users seem to not understand the difference easily.
	- Controlling paused tasks on Sensors turned out to be error-prone.

	The only advantage of Pause vs. Stop is that Stop means to rescan
	all non-completed hosts while Pause continues fine-grained at the
	NVT level. For example, stopping a task with a single host means to
	do a full rescan when doing a "Resume". Stopping a scan of 200 hosts
	of which 100 are done and 20 in progress means to scan those 20 again
	and then the remaining 80. In practice this gain turned out to be of
	little use.

	This patch just removes opportunity to do a "Pause" via the GUI,
	while OMP still may allow it and this GUI still needs to handle "Pause"
	and "Pause Requested" Status.

	* src/html/classic/omp.xsl (task-icons): Remove the Stop icon as
	an always displayed (possibly greyed out) icon.
	In case of Status is "Running" now display the Stop icon instead
	of the Pause icon.
	(html-task-table): Reduce width of Actions column from 7 to 6 icons.

	* src/html/classic/help.xsl, src/html/classic/help_de.xsl,
	src/html/classic/help_zh.xsl (tasks.html):
	Remove the description of the Pause icon, but leave in the other
	Pause documentation because that is still possible to issue via OMP.

2014-07-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add "All SecInfo by type" chart. Improve donut chart legends with
	dynamic width, word wrap and more consistent font size in export
	version.

	* src/html/classic/graphics.xsl (js-aggregate-chart): Add data
	transform case for new chart template resource_type_counts.
	(js-secinfo-top-visualization, dashboard [secinfo]): Add chart
	"All SecInfo by type".

	* src/html/classic/js/gsa_donut_chart.js
	(DonutChartGenerator [generate]): Make legend width depend on chart
	display size. Add word wrap to legend.
	(resource_type_counts): New function.

	* src/html/classic/js/gsa_graphics_base.js (capitalize): Fix NVT and
	CVE cases.
	(resource_type_name, resource_type_name_plural, wrap_text): New
	functions.

2014-07-25  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Dropping remains for no more supported ADS and LDAP
	authorization. The only method supported is ldap_connect,
	which is the per-user ldap authentication.

	* src/html/classic/help.xsl, src/html/classic/help_zh.xsl (users.html):
	Removed description for LDAP(Authorizationn) and ADS.

	* src/gsad.c (init_validator): Removed ldap and ads from validator
	"group".

	* gsad_omp.c (save_auth_omp): Removed handlung for methods "ldap"
	and "ads".
	(save_auth_omp): Removed special handling for "ads" case.

	* src/html/classic/omp.xsl (group mode auth, describe_auth_response
	mode=show): Drop ads and ldap.

2014-07-25  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (preference [details])
	(preference [edit-details]): Adjust for handling
	ovaldi_file preference type.

2014-07-25  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (scanner [details]): Add table for tasks
	using this scanner object.

	* src/html/classic/help.xsl (details-window-line-actions): Add used_by
	parameter and documentation for objects table using the detailed object.
	(lsc_credential_details.hml, alert_details.html, port_list_details.html)
	(schedule_details.html, scanner_details.html, slave_details.html)
	(filter_details.html, target_details.html): Adjust
	details-window-line-actions template call and remove redundant code
	accordingly.

2014-07-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-aggregate-chart): Rename the chart
	for OVAL definitions by OVAL class to resolve conflict with chart by
	severity class.

2014-07-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add allinfo charts to SecInfo dashboard and the All SecInfo table page.

	* src/gsad.c (init_validator): Make aggregate_type separate from
	resource_type and allow "allinfo".

	* src/html/classic/graphics.xsl (dashboard [secinfo]): Add chart
	selections for allinfo.

	* src/html/classic/omp.xsl (gsa:type-name, gsa:type-name-plural): Add
	case for allinfo.
	(html-allinfo-table): Add chart boxes.

2014-07-24  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js (severity_bar_style)
	(data_severity_histogram [bin_func]): Make indentation more consistent
	with other JavaScript.

	* src/html/classic/js/gsa_graphics_base.js (Display [select_pref_name])
	(Display [filter_pref_name], Display [width], Display [height])
	(Display [refresh], Display [select_chart_index], Display [prev_chart])
	(Display [next_chart]): Make indentation more consistent with other
	JavaScript.

2014-07-24  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Replace predefined charts on SecInfo dashboard with four user defined
	ones, allowing a selection of charts and SecInfo filters.

	* src/gsad_omp.c (xsl_transform_omp): Always add chart preferences.
	(dashboard): Get filters for the SecInfo dashboard.

	* src/html/classic/graphics.xsl: Add EXSLT prefix. Remove XSLT variable
	chart_filter_days.
	(js-create-chart-box): Add parameter for filter preference.
	(js-aggregate-data-source): Remove options recent_info_by_class and
	recent_info_by_cvss for chart_template.
	(js-aggregate-chart): Remove chart titles for chart_template options
	recent_info_by_class and recent_info_by_cvss. Pass chart name to Chart
	constructor.
	(js-secinfo-top-visualization): Change automatic selection of charts to
	use chart names. Fix name typo of chart right-by-class. Pass value for
	request_data parameter of select_chart.
	(dashboard [secinfo]): Replace predefined charts with four user defined
	ones. Change automatic selection of charts to use chart names. Pass
	value for request_data parameter of select_chart.

	* src/html/classic/js/gsa_graphics_base.js (create_chart_box): Add
	parameter filter_pref_name.
	(Chart): Add p_chart_name parameter.
	(Chart [chart_name]): New function.
	(Display [create_chart_selector]): Select charts from list by name and
	pass new request_data parameter of select_chart.
	(Display [create_filter_selector], Display [add_filter])
	(Display [select_filter], Display [filter_pref_name]): New functions.
	(Display [select_chart]): Select charts by name instead of index and
	add parameter request_data.
	(Display [select_chart_index]): New function to select chart by index.
	Functionality from original select_chart with new request_data
	parameter.
	(Display [prev_chart], Display [next_chart]): Use new function
	select_chart_index.

2014-07-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/help.xsl (new_task.html, glossary.html): Update
	documentation.
	(details-window-line-actions, scanners.html, scanner_details.html): New
	templates.
	(slave_details.html, user_details.html, agent_details.html)
	(alert_details.html, schedule_details.html, permission_details)
	(role_details, filter_details.html, group_details.html)
	(note_details.html, override_details, lsc_credential_details.html)
	(port_list_details.html, report_format_details.html)
	(config_details.html, tag_details.html, target_details.html): Call
	details-window-line-actions template accordingly.

2014-07-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (preference-details): Handle osp_file special
	case too.

2014-07-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (save_scanner_omp): Send scanner certs values.

	* src/html/classic/omp.xsl (html-edit-scanner-form): Add fields to edit
	CA public key, public key and private key.

2014-07-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Validate ca_pub, key_pub and key_priv
	parameters.

	* src/gsad_omp.c (create_scanner_omp): Handle new fields parameters and
	send their values accordingly.

	* src/html/classic/omp.xml (html-create-scanner-form): Change default
	port value to 9391. Add fields for CA public key, public key and private
	key.

2014-07-18  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (gsa:escape-js): New function.
	(list-window): Use new function to escape caller.

	* src/html/classic/graphics.xsl (js-aggregate-data-source): Use new
	function to escape filter term.

2014-07-18  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (auto-refresh): Remove "10 Sec." option.
	Add options "2 Min." and "5 Min."

	* src/html/classic/po/de.xml, src/html/classic/po/zh.xml: Add "Min.".

2014-07-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (report [section-list]): Replace "Details"
	in "Task: Details" with task name.

2014-07-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-secinfo-top-visualization): Get
	filter term from get_info_response for consistency with filter box.

2014-07-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsa-style.css: Make area around chart menu arrow
	wider and change positioning of header text so it isn't narrowed by
	the wider area around the arrow.

	* src/html/classic/omp.xsl (get_aggregate): Add the filter term if
	one was given. Fit window to the size of the chart when opened via
	open_detached. Ensure chart is full size when reloading page.

	* src/html/classic/js/gsa_graphics_base.js (open_detached): Set
	variable to fit window to the size of the chart.
	(fit_detached_window): New function.
	(detached_chart_resize_listener): Add filter div to height calulation.

2014-07-16  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (host): Show OS name and CPE as text after
	the OS icon.
	(os-icon): Add paramter os-cpe.
	(report [os]): Add paramter os-cpe to OS icon to hide CPE.

2014-07-15  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (result [result-headers], report [hosts])
	(report [prognostic_hosts], report [closed_cves], report [ssl_certs]):
	Make host IPs links to the host details (asset management) page.

2014-07-15  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (os-icon): Add CPE ID to tooltip and link
	to CPE page.

2014-07-15  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (save_chart_preference_omp): Remove log message used
	for testing.

2014-07-15  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Save the user's chart selection for the current session.

	* src/gsad_base.h (credentials_t): Add chart_prefs field.

	* src/gsad_omp.c (print_chart_pref): New function.
	(xsl_transform_omp): Add chart preferences to XML.
	(save_chart_preference_omp): New function.

	* src/gsad_omp.h (save_chart_preference_omp): New function prototype.

	* src/gsad.c (user, user_add): Add chart_prefs field.
	(user_set_chart_pref): New function.
	(init_validator): Add command save_chart_preference and parameters
	chart_preference_name, chart_preference_value.
	(exec_omp_post): Assign char_prefs of user to credentials.
	Handle save_chart_preference command.
	(request_handler): Assign char_prefs of user to credentials.

	* src/html/classic/graphics.xsl (js-create-chart-box): Add parameter
	select_pref_name.
	(js-secinfo-top-visualization): Get chart indexes from chart
	preferences if they are available.

	* src/html/classic/gsad.xsl (chart_preferences): New template.

	* src/html/classic/js/gsa_graphics_base.js (create_chart_box): Add
	select_pref_name parameter.
	(Display): Post requests to set chart id for current display when
	selecting a different chart.

2014-07-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Make detached charts resizable.

	* src/html/classic/omp.xsl (get_aggregate): Add window resize listener.

	* src/html/classic/js/gsa_bar_chart.js (BarChartGenerator [generate]):
	Move x axis to correct position on update.

	* src/html/classic/js/gsa_graphics_base.js (Display [width])
	(Display [height], detached_chart_resize_listener): New functions.
	(open_detached): Increase height of new window.

2014-07-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js
	(BarChartGenerator [generate]): Add option for showing SVG in
	new window.

	* src/html/classic/js/gsa_donut_chart.js
	(DonutChartGenerator [generate]): Add option for showing SVG in
	new window and change save filename prefix to "gsa_donut_chart-".

	* src/html/classic/js/gsa_graphics_base.js (blob_img_window): New
	function.

2014-07-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Restructure charts to allow defining charts via URL and add option
	to show a detached chart in a popup window.

	* src/gsad_omp.c (get_aggregate_omp): Skip get_aggregate OMP call if
	xml parameter is missing or a zero value.

	* src/gsad.c (init_validator): Add parameters chart_type and
	chart_template.

	* src/html/classic/graphics.xsl (js-create-chart-box): Add a default
	container_id.
	(js-severity-chart, js-counts-chart): Remove.
	(js-aggregate-data-source, js-aggregate-chart): New functions.
	(js-secinfo-top-visualization, dashboard [secinfo]): Replace
	js-severity-chart and js-counts-chart with new js-aggregate-data-source
	and js-aggregate-chart.

	* src/html/classic/gsad.xsl (envelope): Hide logo, menu and footer for
	get_aggregate command.

	* src/html/classic/omp.xsl (get_aggregate): New template.
	(html-ovaldef-table): Remove extra charts, which are now handled in
	graphics.xsl to allow creating a detached view.

	* src/html/classic/js/gsa_bar_chart.js (BarChartGenerator): Replace
	display and data_src parameters with chart parameter. Add detach option
	to menu.

	* src/html/classic/js/gsa_donut_chart.js (DonutChartGenerator): Replace
	display and data_src parameters with chart parameter. Add detach option
	to menu.

	* src/html/classic/js/gsa_graphics_base.js (Chart): Add new parameters
	and properties chart_type and chart_template. Add new function
	detached_url.
	(DataSource): Add new params getter.
	(create_uri): Add no_xml parameter.
	(open_detached): New function.

2014-07-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js (svg_from_elem): Add title
	parameter to add a title text element to the exported SVG.

	* src/html/classic/js/gsa_bar_chart.js
	(BarChartGenerator [generate]): Add title to SVG export.

	* src/html/classic/js/gsa_donut_chart.js
	(DonutChartGenerator [generate]): Add title to SVG export.

2014-07-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_donut_chart.js
	(DonutChartGenerator [relax_labels]): Add var keyword to declaration.
	Fix horizontal distance calculation for collision detection.

2014-07-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsa-style.css: Enlarge area around dropdown arrow.

2014-07-09  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (fold-filter-icon): Get filter term from
	filters/term on summary page. Use correct title text on link.

2014-07-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (alert [details]): Display default format
	name when there is no 'verinice_server_report_format', which happens for
	existing Verinice alerts.

2014-07-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_alert): Get the report formats here so that they
	are available for the method details when caller is next_page.
	(get_alert_omp): Let get_alert get the report formats.

2014-07-07  Matthew Mundell <matthew.mundell@greenbone.net>

	Add report format option for Verinice alerts.

	* src/gsad_omp.c (append_alert_method_data): Add
	verinice_server_report_format.

	* src/html/classic/omp.xsl (html-create-alert-form)
	(html-edit-alert-form): Add report format to Verinice options.
	(alert [details]): Add Verinice report format.

2014-07-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-task-config-disabled): Add extra
	table column for alignment.
	(html-edit-task-scanner-disabled): Also show the scanner's type name.
	(html-edit-task-slave, html-edit-task-openvas-options): Remove
	distinguishing depending on whether the task is new or alterable or not.
	(html-edit-task-form): Adjust templates calls. Remove superfluous
	scanner type name.

2014-07-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic.omp.xsl (new_task, html-edit-task-form): Replace
	hard-coded values with template calls. Add current scanner type name in
	Edit Task page.

2014-07-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (struct user, struct gsad_connection_info),
	src/gsad_base.h (struct param): Reorder structures elements to reduce
	space loss due to struct memory alignment.

2014-07-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Fix sporadic segfault when using libxslt in multiple threads.

	* src/gsad_base.c (gsad_base_cleanup): New function.
	(xsl_transform_with_stylesheet): Move calls of xsltCleanupGlobals and
	xmlCleanupParser to new gsad_base_cleanup function.

	* src/gsad_base.h (gsad_base_cleanup): New function prototype.

	* src/gsad.c (gsad_cleanup): Call gsad_base_cleanup.

2014-07-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (task [details]): Improve layout for scanner
	specific options. Do not show scanner and related options for tasks of
	container type.
	(html-edit-task-scan-options): Remove text vertical alignment.

2014-07-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (tasks): Add the Scanner type
	and reflect structure (scanner-type related items) for
	scanner similar to "New Scanner" dialog. Could look nicer,
	but at least the structure is now visible.

2014-07-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (save_task_omp, save_container_task_omp): Use
	CHECK_PARAM for better parameters checking and error reporting.

	* src/html/classic/omp.xsl (html-edit-task-form): Call
	html-edit-task-scan-options template when editing container tasks too.
	(scanner [details]): Set default scanner_type parameter value to the
	current scanner type.

2014-07-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (html-create-target-form, target,
	html-edit-target-form): Form a slightly separated list for credentials
	to prepare adding more of them. Move up Alive Test as apropriate.

2014-07-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/graphics.xsl (js-secinfo-top-visualization): Label
	bar chart as "Severity by CVSS" and donut chart as "Severity by Class".

	* src/html/classic/js/gsa_bar_chart.js (data_severity_histogram):
	Include the values on the x label of each bin as the upper limit, e.g.
	"1.0" will still go into the "1" bin, not the "2" one.

	* src/html/classic/js/gsa_donut_chart.js
	(DonutChartGenerator [generate]): Fix coloring of slices. Improve
	compatibility of donuts that are not divided into slices. Show a
	transparent grey donut if the data set is empty. Move labels apart if
	they overlap.
	(DonutChartGenerator [relax_labels]): New function to reduce label
	overlap.
	(DonutChartGenerator [donut_full_top_path_d]): New function to create
	the top for a complete donut.

	* src/html/classic/js/gsa_graphics_base.js (Display [prev_chart]): Go
	to the last chart when currently at the first one.
	(Display [next_chart]): Go to the first chart when currently at the
	last one.

2014-07-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-task-form): Move scan options
	template call higher for consistency.

2014-07-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (task [details]): Reposition the task's
	propertities and show or hide different ones depending on the scanner
	and scan config type. Update code style.

2014-07-02  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-task-config): Do not handle
	disabled case.
	(html-edit-task-config-disabled, html-edit-task-scanner-disabled): New
	templates.
	(html-edit-task-slave, html-edit-task-openvas-options): Add new_task
	parameter.
	(html-edit-task-form): Adjust for better styling of non-alterable and
	non-new tasks.

2014-07-02  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (save_task_omp): Handle parameters depending on scanner
	type.
	(create_task_omp): Don't send slave id if no is specified.

	* src/html/classic/omp.xsl (new_task): Reorder openvas scanner options.
	Output style update.
	(html-edit-task-config): Add type and param_name template parameters.
	(html-edit-task-scanner): Add title, param_name and type template
	parameters.
	(html-edit-task-scan-options, html-edit-task-slave)
	(html-edit-task-openvas-options, html-edit-task-from): Update style to
	adjust for multi-scanner tasks.

2014-07-02  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-task-alert)
	(html-edit-task-scanner, html-edit-task-slave, html-edit-task-schedule)
	(html-edit-task-scan-options, html-edit-task-openvas-options)
	(html-edit-task-name, html-edit-task-comments): New templates.
	(html-edit-task-form): Call new templates.

2014-07-02  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-task-config)
	(html-edit-task-target): New templates.
	(html-edit-task-form): Call new templates.

2014-07-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Fix various i18n mistakes and add comments about placeholders.

	* src/html/classic/omp.xsl (list-window-line-icons): Fix i18n contexts
	and messages.
	(report [results], list-window): Add i18n for "Applied filter:"
	(group [details]): Add i18n for window title "Group Details".
	(get_report_summary_response): Add i18n for user tags window.
	(report [summary]): Fix i18n for "Slave" field.
	(html-create-role-form): Add i18n.
	(html-edit-role-form): Fix i18n for "New Permission" and
	"Create Permission".

	* src/html/classic/po/de.xml: Add comments on messages with placeholder
	ids. Add "None" for Severity and "Network Source Interface" for
	Reports. Fix "Scan 2 started" and add missing "No Overrides". Add
	"Create Role" and "Save Role".

	* src/html/classic/po/zh.xml: Add comments on messages with placeholder
	ids. Add "None" for Severity and "Network Source Interface" for
	Reports. Add "Create Role" and "Save Role".

2014-07-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Adding a feedback button option which is not active by default.
	It requires to be configured right in the omp.xsl for the time being,
	if desired so.
	Based on a patch by Timo Pollmeier.

	* src/html/classic/omp.xsl (feedback-icon): New template, but content
	commented out by default.
	(result_details): Added Feedback Icon via above template.

	* src/html/classic/po/de.xml: Added new strings and translation accordingly.

2014-07-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add donut charts as SecInfo visualizations and replace the unfiltered
	bar charts on the table pages with them.

	* CMakeLists.txt: Install new file.

	* src/html/classic/graphics.xsl (init-d3charts): Load new JavaScript
	file gsa_donut_chart.js.
	(js-severity-chart): Add option to show severity counts as donut chart.
	(js-secinfo-top-visualization): Replace unfiltered bar chart with
	donut chart.

	* src/html/classic/js/gsa_graphics_base.js (name): Remove. Renamed to
	display_name.
	(display_name): New. Renamed function "name".
	(Display [refresh]): New function.

	* src/html/classic/js/gsa_donut_chart.js: New file.

2014-07-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_bar_chart.js (data_severity_histogram): Count
	empty values as "N/A", not as 0.

2014-07-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (report [filterbox]): Fix check to show
	"Results per page" when viewing results page via get_report command.

2014-07-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (report [filterbox]): Allow filter box to be
	shown on report_section pages.
	(report [section-filter]): Show fold icon on summary page.
	(report [summary]): Add filterbox.

2014-07-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt: Install the feedback icon.

2014-06-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (create_task_omp): Remove default scanner value
	handling.

	* src/html/classic/omp.xsl (new_task, html-edit-task-form): Remove no
	scanner option choice.

2014-06-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (cvss_calculator): Accept "AU" for "Au" as well
	when splitting CVSS vector string into components.

2014-06-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (init_validator): Accept "AU" for "Au" as well for CVSS.

2014-06-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (list-window-line-icons): Add grey-clone arg.
	(permission): Grey out clone icon when permission is not writable, as
	these are the permissions of the predefined roles.

2014-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (get_my_settings): Put the abbreviated
	timezone name next to the full name, to make the connection clearer.

2014-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (task-icons, task [details]): Use short time
	format, because the timezone is the same as in the header.  This is
	consistent with the Created and Last Modified times, for example.
	(schedule, schedule [details]): Use the timezone abbreviation from OMP
	instead of using a numeric offset.

2014-06-23  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/js/gsa_graphics_base.js
	(Display [create_chart_selector]): Select new chart on change of
	select element instead of click on option for better browser support.
	Center selector elements vertically.

2014-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl (new_schedule.html): Add Timezone field.

2014-06-23  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (list-window): Do not add extra column to
	table footer's colspan if there are no action icons, which would break
	the table header layout in newer versions of Chromium.

2014-06-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Change chart selectors so charts can be selected for each display box
	individually. Remove the word "Filtered" from default chart titles.
	Remove charts that count OVAL definitions by status.

	* src/html/classic/graphics.xsl (js-create-chart-selector): Remove.
	(js-severity-chart, js-counts-chart): Remove the word "Filtered" from
	default chart titles. Add chart_label and add_to_display parameters.
	Add new parameters for chart creation.
	(js-secinfo-top-visualization): Replace shared chart selector with
	ones for individual chart boxes. Add parameters auto_load_left and
	auto_load_right.

	* src/html/classic/omp.xsl (html-ovaldef-table): Remove charts counting
	by status and adjust to chart selectors being for individual displays.

	* src/html/classic/js/gsa_graphics_base.js (create_chart_box): Remove
	commented test code.
	(create_chart_selector): Remove global function. Replaced with new
	function of Display.
	(Chart): Add property and accessors for icon and label. Add parameter
	to constructor for automatically adding to the display.
	(Display): Add name property and getter. New function
	create_chart_selector which creates a chart selector for the display.
	Add chart selection functions select_chart, prev_chart and next_chart.

2014-06-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (edit_lsc_credential): Apply
	modify_lsc_credential_response template.

2014-06-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl (new_lsc_credential.html): Change Mandatory
	column for Login to "yes".

2014-06-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (user [edit]): Remove colon from "Login Name"
	to match everywhere else.

2014-06-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (send_redirect_to_uri): Correctly calculate the redirect
	body's length.

2014-06-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Rewrite dashboard to make chart components like containers and
	generator functions more reusable. Add chart switcher to SecInfo pages.
	Add CSV and SVG export options to charts. Fix some escaping issues
	in get_aggregate filter.

	* CMakeLists.txt: Install new files
	src/html/classic/js/gsa_graphics_base.js and
	src/html/classic/img/charts/severity-bar-chart.png.

	* src/gsad_omp.c (get_aggregate_omp): Fix some escaping issues with
	the filter parameter.

	* src/html/classic/graphics.xsl (): Use exslt strings. Update copyright
	year.
	(init-d3charts): Load new file /js/gsa_graphics_base.js. Add global
	variable declarations and initializations.
	(js-create-chart-box, js-create-chart-selector): New templates for
	creating chart container and selector HTML.
	(severity-chart): Rename to to js-severity-chart.
	(js-severity-chart): New: Renamed severity-chart. Remove script tag and
	use reusable chart components.
	(counts-chart): Rename to js-counts-chart
	(js-counts-chart): New: Renamed counts-chart. Remove script tag and
	use reusable chart components.
	(js-secinfo-top-visualization): New template for creating the top
	charts for secinfo pages.
	(dashboard [secinfo]): Adjust to new templates and JS functions.

	* src/html/classic/gsa-style.css: Add menu style rules for id
	chart_list and subelements. Add rules for chart-foot class.
	Change size of chart axes and labels to 8pt.

	* src/html/classic/omp.xsl (list-window): Escape caller in scripts
	creating the charts bar.
	(html-cpe-table, html-cve-table, html-nvt-table, html-ovaldef-table)
	(html-dfn_cert_adv-table): Use new js-secinfo-top-visualization
	template to create charts.

	* src/html/classic/js/gsa_bar_chart.js (): Add copyright / license.
	(severity_bar_style): Add parameter to select field.
	(title_static): New function. Returns static title texts.
	(title_y_total): Rename to title_total.
	(title_total): New. Renamed title_y_total. Make field selectable and
	change parameter order.
	(data_severity_histogram): Add parameters for x and y fields.
	(gsa_bar_chart): Rename to BarChartGenerator.
	(BarChartGenerator): Renamed gsa_bar_chart. Adjust to reusable chart
	components: Calculate chart size from display size. Add callbacks
	"show_loading" and "generate" instead of managing Ajax request here.
	Add menu items for exporting CSV and SVG files to chart container.
	Add transitions.

	* src/html/classic/js/gsa_graphics_base.js: New file. Shared JavaScript
	for dashboard charts and chart switchers.

	* src/html/classic/img/charts/severity-bar-chart.png: New icon.

2014-06-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (new_task): Fix scanner type in openvas
	scanners list.

2014-06-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (scanner-type-name, scanner-type-list):
	Handle OpenVAS Scanner type case.
	(html-create-scanner-form): Set default parameter value for
	scanner-type-list template call.

2014-06-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* ChangeLog: Add missing entry for last commit yesterday.

2014-06-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/its/gsad.xsl (backend_operation, charts): Added empty match
	to silence the new objects.

2014-06-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (task-icons): In the Task Details case, grey
	the start icon when the task is active instead of hiding it.

2014-06-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (task-icons): Add show-start-when-scheduled
	param.
	(task [details]): Show start icon alongside scheduled icon, to give the
	user the option to manually start the task.

2014-06-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add email_list.  Validate "to_address" as
	a list of addresses.

2014-06-05  Matthew Mundell <matthew.mundell@greenbone.net>

	Add "Backend operation" in the page footer where it is available.  This
	is the time taken to get from the start of the page handler to the start
	of the XSL transform.

	* src/gsad_omp.h (credentials_t): Add cmd_start.

	* src/gsad.c (exec_omp_post, exec_omp_get): Record operation start time.

	* src/gsad_omp.c (xsl_transform_omp): Add BACKEND_OPERATION to ENVELOPE.

	* src/html/classic/gsad.xsl (html-footer): Add "Backend operation" text.
	(backend_operation): New template.

2014-06-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (new_task): Make the Scanner section
	a table of its own to make it look nicer and made the Scan Intensity
	less prominent.

2014-06-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/omp.xsl (new_task): Make the Scanner section
	the last part of the dialog.

2014-06-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (task [details]): Adjust displayed details
	for tasks using OSP configs.

2014-06-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Adjust new task page style for OSP Scanner case.

	* src/gsad.c (init_validator): Remove config_id_optional and
	scanner_id_optional. Add osp_config_id and osp_scanner_id.

	* src/gsad_omp.c (create_task_omp): Add choice button for Scanner type.
	Move specific options for each type to relevant section and keep common
	options outside.

2014-05-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* COPYING: Fixed some typos spotted by Timo Pollmeier.

2014-05-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (save_osp_prefs): New function.
	(save_config_omp): Save osp specific preferences when provided.

	* src/gsad.c (init_validator): Validate definitions_file argument.

	* src/html/classic/omp.xsl  (preference [edit-details]): Handle osp_file
	preference type.
	(preferences [edit-scanner-details]): Adjust column header for OSP
	config type.
	(html-config-table): Set form enctype.

2014-05-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* COPYING, COPYING.MIT, COPYING.BSD3: New.

2014-05-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* COPYING: Renamed to COPYING.GPL.

	* COPYING.GPL: New, former COPYING.

2014-05-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add SecInfo dashboard functionality.

	* CMakeLists.txt: Install new files src/html/classic/graphics.xsl,
	src/html/classic/js/d3.tip.min.js, src/html/classic/js/d3.v3.min.js,
	src/html/classic/js/gsa_bar_chart.js

	* src/gsad_base.h (credentials_t): Add charts field.
	(content_type): Add GSAD_CONTENT_TYPE_TEXT_JS.
	(user_set_charts): New function prototype.

	* src/gsad_omp.c (xsl_transform_omp): Add temporary "charts" setting
	to envelope.
	(get_many): Set temporary "charts" setting if parameter is present.
	(get_aggregate_omp, dashboard): New functions.

	* src/gsad_omp.h (get_aggregate_omp, dashboard): New prototypes.

	* src/gsad.c (user): Add charts field.
	(user_add): Initialise charts field.
	(user_set_charts): New function.
	(init_validator): Add commands dashboard and get_aggregate. Add
	parameters data_column, group_column, aggregate_type, charts,
	dashboard_name.
	(exec_omp_post): Get charts setting for credentials from user on login.
	(exec_omp_get): Add cases for dashboard and get_aggregate commands.
	(gsad_add_content_type_header, file_content_response):  Add cases for
	GSAD_CONTENT_TYPE_TEXT_JS.
	(request_handler): Allow js for all users. Get charts setting for
	credentials from user. Add temporary "charts" setting to envelope.

	* src/html/classic/graphics.xsl: New stylesheet for charts and
	other info graphics.

	* src/html/classic/gsa-style.css: Add styles for dashboard and charts.

	* src/html/classic/gsad.xsl (html-gsa-navigation): Add menu item
	"SecInfo Dashboard" if JavaScript is enabled. Include graphics.xsl.

	* src/html/classic/omp.xsl (gsa:type-name-plural): New function.
	(list-window, html-cpe-table, html-cve-table, html-nvt-table)
	(html-ovaldef-table, html-dfn_cert_adv-table): Add visualizations on
	top of table.

	* src/html/classic/js/d3.tip.min.js: New JavaScript, d3 tooltips
	library by Justin Palmer.

	* src/html/classic/js/d3.v3.min.js: New JavaScript, d3 (Data Driven
	Documents) library by Michael Bostock.

	* src/html/classic/js/gsa_bar_chart.js: New JavaScript for generating
	simple bar charts using d3.

2014-05-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Adding support for Chinese language (zh). The translation
	is a contribution by Winland Q. Yang.

	* src/html/classic/help_zh.xsl: New.

	* src/html/classic/po/zh.xml: New.

	* CMakeLists.txt: Install chinese (zh) translation file
	and help page.

	* src/CMakeLists.txt: Added check target for help_zh.

	* src/html/classic/gsad.xsl (i18n_po_path): Added zh
	as available language.

	* src/html/classic/omp.xsl (edit_my_settings): Added Chinese
	as language.

	* src/gsad.c (init_validator): Added Chinese as language.

	* src/gsad_base (set_language_code) Added Chinese as language.

2014-05-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/CMakeLists.txt: Added check target for help_de.

2014-05-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (result [result-headers])
	(result [result-body]): Adjust for results that don't have an associated
	NVT.

2014-05-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (new_task, edit_task): Get the scanners list.
	(create_task_omp, save_task_omp): Send the chosen scanner id
	accordingly.

	* src/gsad.c (init_validator): Validate scanner_id_optional parameter.

	* src/html/classic/omp.xsl (task [details]): Show the task's associated
	scanner.
	(new_task, html-edit-task-form): Add scanners choice list.

2014-05-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (html-config-table): Adjust output for
	OSP Ovaldi type configs.

2014-05-16  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (cvss_calculator): Automatically submit the
	"From Metrics" form via JavaScript if a dropdown selection has changed.

2014-05-15  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (edit_schedule): Apply template to handle
	modify_schedule response.

	* INSTALL: Add note on LibMicroHTTPD version.

2014-05-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/its/img/settings.png: Update the placeholder with real icon.

2014-05-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/its/gsad.xsl (login_page): Fixed typo.

2014-05-14  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Add --dh-params option for PFS support. Requires LibMicroHTTPD >= 0.9.35

	* src/gsad.c (main): Add --dh-params option. Add check for libmicrohttpd
	version when using MHD_OPTION_HTTPS_MEM_DHPARAMS option.
	* doc/gsad.8: Update documentation for new option.

2014-05-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/its/gsad.xsl (command_result_dialog): Use $msg instead of
	@status_text.
	(pw_warning_text): Reword text for default password case to also fit
	settings page.

	* src/html/its/omp.xsl (edit_my_settings): Add missing hidden fields
	for settings so they are not overwritten with empty strings.
	(get_my_settings): Put the message text a box div and shorten text
	to make it fit into one line.

2014-05-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (report_format [trash]): Add in_use check for
	delete icon.

2014-05-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (edit_agent): Apply modify_agent_response to
	properly show responses from manager.

2014-05-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add settings page and password warning to IT-Schwachstellenampel
	and change version number to 1.1.

	* src/html/its/CMakeLists.txt: Add installation of img/settings.png

	* src/html/its/img/settings.png: New image file.

	* src/html/its/omp.xsl (edit_my_settings, modify_setting_response)
	(get_my_settings, gsad_msg): New templates.

	* src/html/its/gsad.xsl (login_page): Change version number to 1.1
	(html-its-header): Add settings icon.
	(html-footer): Change version number to 1.1
	(command_result_dialog): Add messages for password change.
	(password_warning, pw_warning_text): New templates.

2014-05-06  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Remove Public key requirement from Credentials creation.

	* src/gsad.c (init_validator): Remove public_key argument validation.
	(create_lsc_credentials_omp): Don't send public_key argument value. Fix
	code style.

	* src/html/classic/omp.xsl (html-create-lsc-credential-form): Remove
	Pulibc Key file input field.

2014-05-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add warning if login password does not comply with password policy.

	* src/gsad_base.h (credentials_t): Add pw_warning field.

	* src/gsad_omp.c (xsl_transform_omp): Add password warning if one was
	returned at login.
	(authenticate_omp): Add pw_warning parameter and use new function
	omp_authenticate_info_ext.

	* src/gsad_omp.h (authenticate_omp): Add new parameter.

	* src/gsad.c (user): Add pw_warning field.
	(user_add): Add parameter pw_warning.
	(user_set_password): Reset password warning for user.
	(exec_omp_post, request_handler): Get password policy warnings.

	* src/html/classic/gsad.xsl (password_warning): New template.

	* src/html/classic/po/de.xml: Add password warning messages.

2014-04-30  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Validate delete_trash_scanner omp
	argument value.
	(exec_omp_post): Handle delete_trash_scanner omp post request.

	* src/gsad_omp.c (delete_trash_scanner_omp): New function.
	(get_trash): Get scanners in trash.

	* src/gsad_omp.h: Add new function prototype.

	* src/html/classic/omp.xsl (scanner [trash], html-scanners-trash-table):
	new tempaltes.
	(get_trash): Apply delete_scanner_response template. Show scanners in
	trash.

2014-04-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Add Scanners object.

	* src/gsad.c (init_validator): Add create_scanner, delete_scanner,
	edit_scanner, export_scanner, export_scanners, get_scanner,
	get_scanners, new_scanner, save_scanner, verify_scanner omp argument
	valid values. Add scanner and Scanner resource_type and
	optional_resource_type arguments valid values. Add scanner_id and
	scanner_type arguments.
	(exec_omp_post, exec_omp_get): Handle new requests for scanner object
	type.

	* src/gsad_omp.c (next_page): Handle get_scanner and get_scanners
	values.
	(get_scanners, get_scanners_omp, get_scanner, get_scanner_omp)
	(export_scanner_omp, export_scanners_omp, new_scanner, new_scanner_omp)
	(verify_scanner_omp, create_scanner_omp, delete_scanner_omp)
	(edit_scanner, edit_scanner_omp, save_scanner_omp): New functions.

	* src/gsad_omp.h: Add new functions prototypes.

	* src/html/classic/gsad.xsl (modify_scanner_response)
	(verify_scanner_response): New templates.
	(html-gsa-navigation): Add Scanners sub-menu entry.

	* src/html/classic/omp.xsl (scanner-type-name, scanner-type-list)
	(html-scanner-create-form, create_scanner_response, new_scanner)
	(delete_scanner_repsonse, modify_scanner_response, html-scanners-table)
	(html-edit-scanner-table, edit_scanner, scanner [details], get_scanner)
	(get_scanners, verify_scanner_response, scanner): New tempaltes.

2014-04-28  Michael Wiegand <michael.wiegand@greenbone.net>

	Post branch version bump.

	* src/html/classic/help.xsl, CMakeLists.txt: Set version to 6.0+beta1.

2014-04-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post release version bump.

	* src/html/classic/help.xsl, CMakeLists.txt: Set version to 5.0.1.

2014-04-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Preparing the gsa 5.0.0 release.

	* CHANGES: Updated.

	* CMakeLists.txt: Set version to 5.0.0. Switch version scheme.

	* src/html/classic/help.xsl: Updated version number.

2014-04-22  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (cpe-details): Remove redundant
	"Last Modified" item and Actions column in "Reported Vulnerabilities"
	list.

2014-04-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Add permission-style check for Trashcan menu item.

	* src/html/classic/omp.xsl (gsa:may-get-trash): New function.

	* src/html/classic/gsad.xsl (html-gsa-navigation): Only show the
	trashcan item if the user can get trash.

	* src/html/classic/help.xsl (trashcan-availability): New template.
	(trashcan.html): Add availability note.

2014-04-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Add more default landing pages between
	get_reports and get_my_settings.

	* src/gsad_omp.c (get_info): Default to NVTs if info_type is missing.

2014-04-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* README: Update usage.

2014-04-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c, src/gsad_base.c, src/gsad_omp.c, src/validator.c: Sort out
	Doxygen warnings.

2014-04-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_auth_omp): Go to get_users instead of edit_user
	on error, because that's the page the form is on.

	* src/html/classic/omp.xsl (get_users): Correct path of
	modify_auth_response.

2014-04-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (get_users): Move Authentication windows
	to underneath the Users window.

2014-04-15  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (main): Fix MHD_start_daemon arguments for
	MHD_OPTION_NOTIFY_COMPLETED in redirect case.

2014-04-15  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (send_redirect_header): Rename to send_redirect_to_uri. Use
	provided location directly.
	(send_redirect_to_urn): New function.
	(redirect_handler): Adjust renamed function call and call
	send_redirect_to_urn where adequate.

2014-04-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp-doc.xsl (changes): Restrict to changes in current
	version.

2014-04-14  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* CMakeLists.txt, src/CMakeLists.txt: Remove linking against gthread.

	* src/gsad.c: Remove useless include and initialization.

2014-04-10  Benoît Allard  <benoit.allard@greenbone.net>

	Post release version bump.

	* src/html/classic/help.xsl, CMakeLists.txt: 5.0+beta14

2014-04-10  Benoît Allard  <benoit.allard@greenbone.net>

	Prepare release of gsa 5.0+beta13 release (patch from Michael
	Wiegand)

	* CHANGES: Update

2014-04-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Final part of ITS.

	* CMakeLists.txt: Add handling of new face "its".

	* src/html/its/CMakeLists.txt: New. Installs face "its".

	* doc/readme-its.txt: New.

	* src/html/its/help.xsl: Fixed typo.

2014-04-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Next bunch for ITS.

	* src/html/its/img/details.png,
	src/html/its/img/tl_off_off_off.png,
	src/html/its/img/tl_on_off_off.png,
	src/html/its/img/tl_off_off_on.png,
	src/html/its/img/tl_off_on_off.png,
	src/html/its/img/tl_flash_off_off.gif,
	src/html/its/img/tl_flash_on_off.gif,
	src/html/its/img/tl_flash_flash_flash.gif,
	src/html/its/img/printer.png: New.

	* src/html/its/login/,
	src/html/its/login/login.html: New.

	* src/html/its/omp.xsl: New.

2014-04-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Next bunch for ITS.

	* src/html/its/img/greenbone-logo.png,
	src/html/its/img/datensicherheit_big.png,
	src/html/its/img/acs_logo.png, src/html/its/img/OpenVAS-logo.png,
	src/html/its/img/info_big.png, src/html/its/img/bsi_logo.png: New.

	* src/html/its/help.xsl: New.

2014-04-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/img/feedback.png: New.

2014-04-08  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Next bunch for ITS. The whole ITS was developed by
	Timo Pollmeier.

	* src/html/its/gsad.xsl: New.

	* src/html/its/img/callout_blue.gif,
	src/html/its/img/shutdown.png, src/html/its/img/info.png,
	src/html/its/img/its_logo.png, src/html/its/img/datensicherheit.png:
	New.

2014-04-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Rename "TCP Service Ping" to "TCP-ACK
	Service Ping".  Add "TCP-SYN Service Ping".

	* src/html/classic/omp.xsl (html-create-target-form)
	(html-edit-target-form): Rename "TCP Service Ping" to "TCP-ACK Service
	Ping".  Add "TCP-SYN Service Ping".

2014-04-08  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Starting to add an alternative face for GSA. It is
	called "IT-Schwachstellenampel" (ITS) which is a
	simplifed interface in German language only.
	The title in english would be "IT vulnerability traffic light".
	The ITS will not disturb the regular installation.
	Without explicit using --face=its when starting gsad it will
	not be available at all to a user.

	* src/html/its/, src/html/its/favicon.gif, src/html/its/img/,
	src/html/its/gsa-style.css: New.

2014-04-08  Matthew Mundell <matthew.mundell@greenbone.net>

	Make role permissions more consistent with others.

	* src/html/classic/omp.xsl (cababilities): New variable.
	(gsa:may-op): Test capabilities from variable, in case caller is in
	restricted context.
	(gsa:permission-description): Get name from param instead of element.
	(html-edit-role-form): In the New Permission dropdown skip permissions
	the user already has.  Add a name column to the Permissions table.
	(role [details]): Add name column to Permissions table.

2014-04-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* doc/i18n-howto.txt: Add notes about UTF-8 encoding and rephrase
	part about language code.

2014-04-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* doc/i18n-howto.txt: Update list of contexts. Add new section
	"Creating new GSA page translations". Add info on install directory
	for help.

2014-04-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/po/de.xml: Remove unused "Form" context.

2014-04-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (resource-permissions-window): Add Name
	column, and rename Permission column to Description.
	(html-create-permission-form, html-edit-permission-form): Add
	description alongside name.
	(html-permissions-table, permission): Add Description column.

2014-04-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_nvts, new_lsc_credential, new_agent, new_alert)
	(new_target, new_tag, new_config, new_slave, new_schedule)
	(new_report_format, new_group, new_port_list, new_role, new_user): Check
	extra_xml before appending, for consistency.

2014-04-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/wizard.xsl (quick-task-wizard): Rework English of
	two sentences slightly.

	* src/html/classic/po/de.xml: Adjust po sentences to match.

2014-04-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-role-form): Use permission
	description instead of name in New Permission dropdown.

2014-04-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/gsa-style.css (div.empty_top_button): New rule.
	Defines the empty spacer for last commit.

2014-04-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/gsad.xsl (html-gsa-navigation): When the user does
	not have access to a top level menu, display an empty spacer instead of
	skipping the menu.  This looks more uniform and keeps the menu positions
	consistent.

2014-04-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_task): Get only permissions specific to the task.

2014-04-02  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Remove "Observer" and "Observer Groups" from Create Task and Edit Task
	pages. Hide the "Everything" permission for the Admin role and remove
	limit on number of permissions.

	* src/gsad_omp.c (create_task_omp, edit_task, save_task_omp)
	(save_container_task_omp): Remove handling of observer and groups
	parameters, which are no longer used.
	(get_task): Adjust permissions filter to exclude "Everything"
	permission for the Admin role and get all filtered permissions.

	* src/gsad.c (init_validator): Remove "observers" parameter and adjust
	"users" which was an alias of this.

	* src/html/classic/omp.xsl (new_task, html-edit-task-form): Remove
	form elements for "Observer" and "Observer Groups".

2014-04-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Ensure that Edit Port List and Edit Role always return to the previous
	page.

	* src/gsad.c (init_validator): Add next_next.

	* src/html/classic/omp.xsl (html-edit-port-list-form)
	(html_edit_role_form): Pass the next param for the current page in the
	next_next param of the add and delete forms, because these forms are
	already using the next param to return to the current page.

2014-04-02  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-tags-trash-table): Change table header
	from "Resource ID" to "Resource Name".

2014-04-02  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/wizard.xsl (quick-task-wizard): Hide Email field
	and instructions if user cannot get or create alerts. Hide Slave
	field and instructions if user cannot get slaves.

2014-04-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/gsad.xsl (modify_role_response): New template.
	(html-gsa-logo): Match Save Role indicator for Edit Role page.

2014-04-01  Matthew Mundell <matthew.mundell@greenbone.net>

	Update Role help.

	* src/html/classic/help.xsl (roles.html): Enable trash, edit and clone
	icons.
	(contents.html): Add "New Role".
	(glossary.html): Add Role.
	(new_role.html): New template.

2014-04-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (tag_resource_types): Add role.
	(role [details]): Add tags window.

2014-04-01  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/omp.xsl (full-report-export-form)
	(filtered-report-export-form): Fix some logical mistakes.

2014-03-31  Matthew Mundell <matthew.mundell@greenbone.net>

	Add role editing.

	* src/gsad.c (init_validator, exec_omp_post): Add edit_role and
	save_role.

	* src/gsad_omp.c (next_page): Add edit_role.
	(edit_role, edit_role_omp, save_role_omp): New functions.

	* src/html/classic/gsad.xsl (html-gsa-logo): Match indicators for ops on
	edit_role page.

	* src/html/classic/omp.xsl (html-edit-role-form): Add i18n.  Add actual
	role fields, including permissions.
	(edit_role): Match op responses.
	(role, role [details], html-roles-table): Enable edit icon.

2014-03-31  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Replace the "Observer" fields on the task details page with a table
	with all permissions applying to the task.

	* src/gsad_omp.c (get_task): Add permissions for the task to response.
	(delete_permission_omp): Change get to NULL to allow setting the next
	page with the parameter "next".
	(create_permission_omp): Add selection of subject by subject_name
	parameter.

	* src/gsad_omp.c (init_validator): Add subject_name as alias for name.

	* src/html/classic/omp.xsl (resource-permissions-window): New template.
	(task [details]): Remove "Observer" and "Observer Group" fields.
	Add window with table of permissions.

	* src/html/classic/po/de.xml: Add messages for new permissions window.

2014-03-31  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Add logger for libmicrohttpd errors.

	* src/gsad.c (mhd_logger): New function.
	(main): Add MHD_OPTION_EXTERNAL_LOGGER option to MHD_start_daemon()
	calls.

2014-03-31  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Handle SIGPIPE as recommended by libmicrohttpd. Refactor other handlers.

	* src/gsad.c (handle_sigterm, handle_sighup, handle_sigint): Delete function.
	(handle_signal_exit, register_signal_handlers): New functions.
	(main): Call register_signal_handlers() function. Remove signal handlers
	registering code.

2014-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_one): Get permissions in role case, after adding
	the id from the CREATE response to the params, so that the permissions
	are there after creating a role.
	(get_role): Let get_one get permissions.

2014-03-28  Benoît Allard  <benoit.allard@greenbone.net>

	Post release verion bump.

	* CMakeLists.txt, src/html/classic/help.xsl: 5.0+beta13

2014-03-28  Benoît Allard  <benoit.allard@greenbone.net>

	Prepare release of gsa 5.0+beta12 release

	* CHANGES: Update

2014-03-28  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (send_redirect_header): Use the Host header from the client
	request to determine the Location response header value. Drop back to
	relative if not provided.

2014-03-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_role_omp): Use new style.

	* src/html/classic/omp.xsl (html-create-role-form): Add next and remove
	role params.

2014-03-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Complete deleting of roles.

	* src/gsad.c (init_validator, exec_omp_post): Add delete_trash_role.

	* src/gsad_omp.c (get_trash): Add roles.
	(delete_trash_role_omp): New function.

	* src/html/classic/gsad.xsl (delete_role_response): New template.
	(html-gsa-logo): Match delete indicators.

	* src/html/classic/omp.xsl (role): Enable trash icon.
	(role [details]): Enable new icon.
	(html-roles-table): Update icon count.
	(get_trash): Add roles.

2014-03-27  Benoît Allard  <benoit.allard@greenbone.net>

	* src/html/classic/help.xsl: Fix mispelling of 'beta12'

2014-03-26  Benoît Allard  <benoit.allard@greenbone.net>

	Post release version bump.

	* src/html/classic/help.xsl, CMakeLists.txt: 5.0+beta12

2014-03-26  Benoît Allard  <benoit.allard@greenbone.net>

	Prepare the 5.0+beta11 release.

	* CHANGES: Updated

2014-03-26  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (send_redirect_header): Provide the full url in the
	HTTP Location header when sending redirect responses.

2014-03-26  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/po/de.xml: Move "Orphan" to make it available in
	Tag table rows.

2014-03-26  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Adjust tags pages to new OMP syntax that uses "resource" instead of
	"attach" and "orphan" instead of "orphaned". Add markers for orphaned
	tags and resources in trash. Make tags trash more consistent with
	normal table.

	* src/gsad_omp.c (get_one, get_many, get_nvts, get_task): Filter by
	resource_type instead of attach_type when getting tag names.
	(new_tag, create_tag_omp, save_tag_omp): Use new "resource" OMP syntax
	for specifying resources instead of old the "attach" one and rename
	parameters accordingly.
	(get_report, get_result): Filter by resource_type instead of
	attach_type when getting tag names.

	* src/gsad.c (init_validator): Remove attach_type, rename attach_id
	to resource_id, add SecInfo types to resource_type.

	* src/html/classic/omp.xsl (user-tags-window-checked): Rename attach_id
	and attach_type to resource_id and resource_type.
	(tagged_resource_link): If the resource is in the trashcan, show name
	without link and with "in trashcan" message.
	(html-tags-table): Rename "Attach Type" and "Attach Name" to
	"Resource Type" and "Resource Name".
	(tag): Add "Orphan" to name if tag is orphaned. Use new OMP syntax for
	get_tags.
	(tag [details]): Apply new resource syntax and change "Attach" field
	labels to their "Resource" equivalents.
	(tag [trash]): Apply new resource syntax and show resource name with
	link instead of ID if possible.
	(tag_attach_types): Remove. Renamed to tag_resource_types.
	(tag_resource_types): New. Renamed tag_attach_types.
	(html-create-tag-form, html-edit-tag-form): Apply new resource syntax
	and change "Attach" field labels to their "Resource" equivalents.

	* src/html/classic/po/de.xml: Adjust label texts for tags.

2014-03-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-roles-table): Correct replacement typo.

2014-03-26  Matthew Mundell <matthew.mundell@greenbone.net>

	Add creating of roles, and basis for deleting and editing roles.

	* src/gsad.c (init_validator, exec_omp_post): Add role commands.

	* src/gsad_omp.c (new_role, new_role_omp, delete_role_omp)
	(create_role_omp): New function.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/classic/gsad.xsl (create_role_response): New template.
	(html-gsa-logo): Match Create Role indicator.

	* src/html/classic/omp.xsl (list-window): Enable new icon for roles.
	(html-create-role-form, new_role, html-edit-role-form, edit_role)
	(create_role_response, delete_role_response, modify_role_response): New
	templates.
	(role): Enable clone icon.

2014-03-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add Consider Alive to alive_tests.

	* src/html/classic/omp.xsl (html-create-target-form)
	(html-edit-target-form): Add Consider Alive to alive test.

2014-03-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_target_omp): Use xml_string_append for
	CREATE_TARGET so that ampersands in ALIVE_TESTS are escaped.

2014-03-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (wizard): Remove now obsolete check for error message
	indicating missing "init" mode.

2014-03-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (severity-bar): Add i18n for default title.
	(prognostic_hosts): Add i18n for table headers.

2014-03-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsa-style.css: Add styles for id wizard_list.

	* src/html/classic/wizard.xsl (quick-first-scan-wizard): Describe
	how to find Advanced Task Wizard (quick_task).
	(wizard/quick_first_scan): Replace static window title with wizard
	selection menu.
	(quick-task-wizard): Add i18n.
	(wizard/quick_task): Replace static window title with wizard
	selection menu.
	(wizard_list): New template: Menu to select wizards similar to the one
	for report sections.

	* src/html/classic/po/de.xml: Add translations for Advanced Task Wizard
	and new paragraph in Task Wizard.

2014-03-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (alert): Fix title text for filter link.
	(alert [details]): Add missing spaces before Email report format.
	(role [details]): Fix swapped i18n text and context.

2014-03-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (wizard): Try to get initial data for wizards
	by running the wizard in "init" mode.

	* src/html/classic/wizard.xsl: Update copyright and authors.
	(quick-task-wizard, wizard/quick_task): New templates.

2014-03-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch filters associated with alerts from "report" to "result".

	* src/gsad_omp.c (edit_alert): Put the extra_xml inside the EDIT_ALERT,
	like in the other pages.  Get result filters instead of report filters.

	* src/html/classic/gsad.xsl (html-gsa-logo): Add missing indicators.

	* src/html/classic/omp.xsl (edit_alert, edit_filter): Match modify
	responses.

2014-03-18  Benoît Allard  <benoit.allard@greenbone.net>

	Post-release version bump.

	* CMakeLists.txt, src/html/classic/help.xsl: Changed version to +beta11

2014-03-18  Benoît Allard  <benoit.allard@greenbone.net>

	Prepare the 5.0+beta10 release.

	* CHANGES: Updated

2014-03-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (task-icons): Check permission of the actual
	operation being used, for the resume icon.

2014-03-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/wizard.xsl: Add i18n contexts and missing i18n
	function calls. Remove extra whitespaces to ensure matching of i18n.

	* src/html/classic/po/de.xml: Adjust Task Wizard messages to new
	formatting and add "Start Scan" message. Fix a typo and missing commas.

2014-03-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsad.xsl (indicator, command_result_dialog): Add
	TODO comments.

	* src/html/classic/po/de.xml: Add TODO list and fix typo in translated
	"Ultimate Delete Requested" message.

2014-03-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (report [summary]): Skip Slave and Network
	Source Interface fields if we don't know what they were.

2014-03-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (report [summary]): Add Slave and Network
	Source Interface fields.

2014-03-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (assets): Add i18n.
	(host): Add i18n. Rename last column of Apps column to "CVEs" and
	add details parameter to links to ensure the list of CVEs is shown.
	(os-icon, report [assets])
	(get_reports_response/report/report [report-assets]): Add i18n.

	* src/html/classic/po/de.xml: Add translations for host pages.

2014-03-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (report [filterbox], report-image): Add i18n.
	(cvss_calculator): Add i18n for error message.

	* src/html/classic/po/de.xml: Add translations for Report Filter,
	Report Image and error message in CVSS calculator. Fix typo in
	Performance report error message.

2014-03-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (get-settings-filter)
	(list-window-line-icons, user-tags-window-checked, trend_meter, task)
	(alert, html-config-family-table, preference, html-config-nvt-table)
	(config [families], html-config-table, schedule [trash])
	(schedule [details], get_info_allinfo_action, note [trash])
	(observers-icon, html-reports-table, result [result-body], report [os])
	(report-help-icon, report [summary], role [details]): Add i18n for alt
	and title (tooltip) text.

	* src/html/classic/po/de.xml: Make clone related messages available
	in all views and add generic denial messages. Add messages for "Global"
	and "owned by". Add "Unknown" for report OS. Add "Product detection"
	messages.

2014-03-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (ref_cert_list, ref_xref_list, info/cpe)
	(info/cve, info/nvt, info/ovaldef, info/dfn_cert_adv, info/allinfo)
	(cve-details, cpe-details, nvt-details, ovaldef-details)
	(dfn_cert_adv-details): Add i18n.

	* src/html/classic/po/de.xml: Add translations for CVE, CPE,
	OVAL Definition, DFN-CERT Advisory and general SecInfo pages.

2014-03-12  Benoît Allard  <benoit.allard@greenbone.net>

	* doc/gsad.8: Fix issues raported by lintian.

2014-03-12  Benoît Allard  <benoit.allard@greenbone.net>

	Post release version bump.

	* CMakeLists.txt, src/html/classic/help.xsl: Set version to 5.0+beta10.

2014-03-12  Benoît Allard  <benoit.allard@greenbone.net>

	Preparing the gsa 5.0+beta9 release.

	* CHANGES: Updated.

2014-03-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (nvt-details, nvt, get_nvts): Add i18n.

	* src/html/classic/po/de.xml: Add translations for NVT pages.

2014-03-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (get_system_reports_response, get_trash)
	(get_my_settings, edit_my_settings, cvss_calculator): Add i18n.

	* src/html/classic/po/de.xml: Add translations for trashcan contents
	table, My Settings, Performance and CVSS Calculator pages. Add
	"year" and variants to "Time" context and Filter names as used in
	"My Settings" to resource types.

2014-03-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-part): Add i18n for
	"New Filter" icon alt text.
	(task [details]): Add i18n to "Import Report" window.
	(html-edit-target-form): Apply i18n only to displayed text in
	"Alive test" dropdown.
	(result-body): Change context of "Details" to "Window".
	(html-configs-trash-table, html-schedules-trash-table): Add i18n.
	(html-create-user-form): Add i18n for list icon tooltip.

	* src/html/classic/po/de.xml: Make "Details" strings available in
	"Window" context.

2013-03-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_config): Check if extra_xml is NULL before trying
	to parse it and before trying to free the entity.

2014-03-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (list-window-line-icons): Add i18n for
	trashcan and edit icon.
	(html-create-config-form, html-import-config-form)
	(html-config-family-table, preference, preference-details)
	(edit-config-preference, preferences, preferences-details)
	(preferences-edit-details, preferences [scanner])
	(preferences [edit-scanner-details], html-config-nvt-table)
	(edit-families-family, family, config [families], edit-families)
	(html-config-table, config, config [trash]): Add i18n and change
	"NVT's" to "NVTs" in text.

	* src/html/classic/po/de.xml: Add translations for scan config pages
	and some terms for generic trashcan and edit icons.

2014-03-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_my_settings_omp): Remove sentence about Back
	button, now that the input is preserved.

2014-03-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-create-filter-form)
	(html-edit-filter-form): Add missing type Role.

2014-03-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (params_mhd_add): Move comment up because it applies to
	the whole block.

2014-03-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (edit_my_settings): Improve alignment.

2014-03-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (edit_my_settings): Preserve User Interface
	Language too.

2014-03-06  Matthew Mundell <matthew.mundell@greenbone.net>

	Preserve user's input after error on Edit My Settings.

	* src/html/classic/omp.xsl (gsa:param-or): Check for hashtable params
	too.
	(edit_my_settings): Fill the fields with values from existing params if
	they are given.

	* src/gsad_omp.c (edit_my_settings): Get the filters, otherwise every
	caller needs to.
	(edit_my_settings_omp): Let edit_my_settings get the filters.

2014-03-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-feed-form, html-scap-form)
	(html-cert-form): Add i18n.

	* src/html/classic/po/de.xml: Add translations for feed sync pages.

2014-03-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (group [trash], group [details])
	(html-groups-trash-table, html-create-group-form, html-edit-group-form)
	(role [trash], role [details], html-roles-trash-table)
	(group [auth]): Add i18n.

	* src/html/classic/po/de.xml: Add translations for group and role pages.

2014-03-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-part): Auto-submit filter
	selection on selection in drop-down using JavaScript.
	(auto-refresh): Auto-submit refresh interval on selection in drop-down
	using JavaScript.

	* src/html/classic/help.xsl (javascript.html): Mention that some
	convenience features require JavaScript while main functions do not.

2014-03-06  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt, src/html/classic/help.xsl: Set version to 5.0+beta9.

2014-03-06  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 5.0+beta8 release.

	* CHANGES: Updated.

2014-03-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (toggle-tag-icon): Use correct text for
	enable icon tooltip.
	(new_task): Use i18n context "Task" for submit buttons and add missing
	i18n.
	(html-edit-task-form): Use i18n context "Task" for submit buttons.
	(alert [details]): Use correct i18n context for header text.
	(slave [details]): Add i18n for header text.
	(html-edit-port-list-form, html-edit-report-format-form): Use i18n
	context "Port List" and "Report Format" respectively.
	(user [edit], html-create-user-form): Add missing i18n.

	* src/html/classic/po/de.xml: Make translation of "Tasks using this
	Alert" more consistent with other "... using this ..." text.

2014-03-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (details-header-icons): Use correct context
	for disabled user delete button.
	(html-create-user-form, user, user [details], user [edit]): Add i18n.

	* src/html/classic/po/de.xml: Add translations for user pages.

2014-03-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (gsa:command-type-plural): New function.
	(gsa:permission-description): Add i18n and new cases for help,
	get_dependencies, get_version, modify_auth, describe_... and
	sync_... commands.
	(html-create-permission-form, permission, permission [details])
	(permission [trash], html-permissions-trash-table)
	(html-edit-permission-form): Add i18n.

	* src/html/classic/po/de.xml: Add context groups for "Type Plural",
	"Type Lower" and "Type Plural Lower". Add various dependent types to
	Type group. Add translations for permission pages, including new
	"Permission Description" context group.

2014-03-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_my_settings_omp): Get line width down.

2014-03-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_my_settings_omp): Return to Edit page with an
	error message, when authentication fails.

2014-03-05  Matthew Mundell <matthew.mundell@greenbone.net>

	Require the user's existing password when changing password in My
	Settings.

	* src/gsad.c (init_validator): Add old_password.

	* src/gsad_omp.c (save_my_settings_omp): Check old password before
	setting new password.

	* src/html/classic/omp.xsl (edit_my_settings): Add Old Password field
	and remove "Replace existing value with:" checkbox.

2014-03-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (gsa:type-name): Add special cases for
	nvt, cve, cpe, ovaldef, dfn_cert_adv and lsc_credential.
	(tag, tag [details], tag [trash], tag_attach_types)
	(html-create-tag-form, html-edit-tag-form, html-tags-trash-table): Add
	i18n.

	* src/html/classic/po/de.xml: Add translations for tag pages.

2014-03-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/gsad.xsl (html-gsa-navigation): Specify the filter
	for notes and overrides, so that it explicitly sorts by NVT.

2014-03-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (filter, filter [trash], filter [details])
	(html-filters-trash-table, html-create-filter-form)
	(html-edit-filter-form): Add i18n.

	* src/html/classic/po/de.xml: Add context group "Type" and translations
	for filter pages.

2014-03-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl (new_alert.html, new_target.html): Note
	availability of optional fields when commands are disabled.
	(new_task.html): Add Observer Groups field.  Note availability of
	optional fields when commands are disabled.

2014-03-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-create-agent-form)
	(html-edit-agent-form, agent, agent [trash], agent [details])
	(html-agents-trash-table): Add i18n.

	* src/html/classic/po/de.xml: Add translations for agent pages.

2014-03-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-create-slave-form)
	(html-edit-slave-form, slave [trash], slave [details])
	(html-slaves-trash-table): Add i18n.

	* src/html/classic/po/de.xml: Add translations for slave pages.

2014-03-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-create-report-format-form)
	(html-edit-report-format-form, report_format, report_format [trash])
	(param-edit, param-details, report_format [details])
	(html-report-formats-trash-table): Add i18n.

	* src/html/classic/po/de.xml: Add translations for report format pages.

2014-03-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-create-permission-form)
	(html-edit-permission-form): Only offer commands the user may use.  This
	hides disabled commands.

2014-03-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (result [result-body]): Check if tags are
	empty before adding section.

2014-03-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (result [result-body]): Remove newstyle nvt's
	checks.
	(gsa:newstyle-nvt): Remove function.

2014-03-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-create-alert-form)
	(html-edit-alert-form, alert, alert [trash], alert [details])
	(html-alerts-trash-table): Add i18n.

	* src/html/classic/po/de.xml: Add translations for alert pages.

2014-03-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (tag_attach_types): Only offer types that the
	user may GET, except when the type is selected.

	* src/gsad_omp.c (new_tag): Default attach_type to "" because the
	default now depends on the user's access rights.

2014-03-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-create-lsc-credential-form)
	(html-edit-lsc-credential-form, lsc-credential-download-icons)
	(lsc_credential [trash], lsc_credential [details])
	(html-lsc-credentials-trash-table): Add i18n.

	* src/html/classic/po/de.xml: Add translations for credentials pages.

2014-03-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-create-port-list-form)
	(port_list [trash], port_list [details], html-edit-port-list-form)
	(html-port-lists-trash-table): Add i18n.

	* src/html/classic/po/de.xml: Add translations for port list pages.

2014-02-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (task [trash]): Add i18n for "... must be
	restored first" tooltip.
	(schedule [details]): Add i18n for "Tasks using this Schedule".

	* src/html/classic/po/de.xml: Add "Tasks using this Schedule".

2014-02-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-create-target-form)
	(html-edit-target-form, target [trash], target [details])
	(html-targets-trash-table): Add i18n.

	* src/html/classic/po/de.xml: Add translations for target pages and
	some trashcan messages.

2014-02-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (target [details]): Move Alive Test out of
	credential check.

2014-02-28  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (result [details]): Fix report results list
	link. Add missing form parameters.

2014-02-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_system_reports_omp): Add command check for
	GET_SLAVES.

2014-02-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (get_system_reports_response): Make "Reports
	for slave" control depend on GET_SLAVES access.

2014-02-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (gsa:may): Check if user may run command at
	all.
	(toggle-tag-icon): Check command access.

2014-02-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl: Remove extra space at beginning of templates
	for consistency.  Put a space between key and template, so the template
	is easier to find.

2014-02-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (tag [details], html-create-tag-form)
	(html-edit-tag-form): Move comment up to match other pages.  Lowercase
	optional on Value.

2014-02-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_alert): Improve messages.
	(save_alert_omp, export_alert_omp): Correct spelling.

2014-02-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Show or hide details and list dialog elements according to the
	availability of commands.

	* src/html/classic/omp.xsl (task [details]): Check for command access
	for optional fields.
	(html-edit-alert-form): Adjust paths for new location from last commit.
	(alert): Check command access for link.
	(alert [trash]): Remove extra line.
	(alert [details], tagged_resource_link): Check for command access.
	(tag, tag [trash], target [trash]): Remove extra line.
	(html-edit-target-form): Remove duplicate input.
	(target, target [details], permission, permission [details]): Check
	command access for links.
	(role [details]): Check command access for Permissions section.
	(user): Check command access for links.

2014-02-27  Benoît Allard  <benoit.allard@greenbone.net>

	Post release version bump.

	* CMakeLists.txt, src/html/classic/help.xsl: 5.0+beta8

2014-02-27  Benoît Allard  <benoit.allard@greenbone.net>

	Preparing the 5.0+beta7 release.

	* CHANGES: Update

2014-02-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (task-icons): Add schedule name and due date
	to schedule icon tooltip.
	(task [details]): Change context of "Next due" text to "Task Window".

	* src/html/classic/po/de.xml: Move "Next due" strings to Task views
	contexts and remove extra colon.

2014-02-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (html-create-schedule-form)
	(html-edit-schedule-form): Add i18n.
	(interval-with-unit): Add missing spaces.
	(schedule, schedule [trash], schedule [details]): Add i18n.

	* src/html/classic/po/de.xml: Add translations for Schedules.

2014-02-26  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsad.xsl (i18n_language): Also try to get language
	from login_page.
	(login_page): Add i18n.

	* src/html/classic/po/de.xml: Add translations for login page.

2014-02-26  Matthew Mundell <matthew.mundell@greenbone.net>

	Show or hide edit dialog elements according to the availability of
	commands.

	* src/gsad_omp.c (get_many, edit_alert, edit_target): Only get resources
	if the relevant commands are available.

	* src/html/classic/omp.xsl (filter-window-part): Make fields depend on
	command access.
	(task [details]): Make import window depend on command access.
	(html-edit-task-form): Hide optional fields according to availability
	of commands.  Make import window depend on command access.
	(html-create-alert-form): Correct op checks.
	(html-edit-alert-form, html-edit-target-form): Hide optional fields
	according to availability of commands.
	(get_my_settings, edit_my_settings): Check for filter commands.

2014-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-create-target-form)
	(html-edit-target-form): Remove colon from Alive Test for consistency.

2014-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-create-target-form): Move Comment up
	to match other pages.

2014-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (new_task, html-create-user-form): Use --
	as option value, for consistency.

2014-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (main): Remove stray else that was hiding the Copyright
	line with --version and --debug-tls.

2014-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Show or hide dialog elements according to the availability of commands.

	* src/gsad_omp.c (new_target): Only get credentials, locators and
	port lists if the relevant commands are available.

	* src/html/classic/omp.xsl (restore-icon): Check if command available.
	(user-tags-window-checked): New function.  From user-tags-window.
	(user-tags-window): Check if command is available.
	(list-window): Check command for wizard icon.
	(new-task, html-create-alert-form, html-create-target-form)
	(html-create-user-form): Hide optional fields according to availability
	of commands.
	(task [trash], alert [trash], target [trash]): Explicitly check for
	restore command.

2014-02-25  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (send_redirect_header): Use body variable for html
	response.
	(request_handler): Reduce variables scopes.

	* src/gsad_base.h (preference_t, method_data_param): Remove unused
	structs.

	* src/gsad_omp.c (edit_resource, save_container_task_omp)
	(download_lsc_credential_omp, create_agent_omp, download_agent_omp)
	(new_agent_omp, save_alert_omp, save_target_omp, get_report)
	(send_settings_filters, save_my_settings_omp, export_omp_doc_omp):
	Reduce variables scopes and remove unused variables.
	(create_override_omp): Delete redundant else if branch.

2014-02-25  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (result [result-headers]): Add overrides
	control in severity column.

2014-02-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/classic/omp.xsl (result [details]): Remove apply overrides
	dropdown menu.

2014-02-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (list-window-line-icons): Add special
	permission case to clone icon check.
	(get_permission): Match create_permission_response too.

	* src/gsad_omp.c (clone_omp): If clone fails, go to associated GET page.

2014-02-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-part): Use FIELD from column
	definition if there is one, when generating "Sort by" dropdown.  This
	gets cases like "Trust (Last Verified)" working.

	* src/gsad.c (init_validator): Double sort_field length to accommodate
	"Confidentiality Impact".

2014-02-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (report [report]): Get task_id from envelope,
	instead of from the XML which selects a single task when all tasks were
	requested.

2014-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Allow "in use" targets to be modified.

	* src/gsad.c (init_validator): Add in_use.

	* src/gsad_omp.c (save_target_omp): Send stripped down request when the
	target is in use.

	* src/html/classic/omp.xsl (html-edit-target-form): When the target is
	in use disable some of the fields.

2014-02-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post release version bump.

	* src/html/classic/help.xsl, CMakeLists.txt: Increased version.

2014-02-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Preparing the 5.0+beta6 release.

	* CHANGES: Updated.

2014-02-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (html-edit-target-form): Move Comment up to
	match details page and other edit pages.

2014-02-14  Matthew Mundell <matthew.mundell@greenbone.net>

	Add Alive Test to Modify Target.

	* src/gsad_omp.c (save_target_omp): Send alive_tests too.

	* src/html/classic/omp.xsl (html-edit-target-form): Add Alive Test
	field.

2014-02-13  Matthew Mundell <matthew.mundell@greenbone.net>

	Add Alive Test to Create Target and Target Details.

	* src/gsad.c (init_validator): Add alive_tests.

	* src/gsad_omp.c (create_target_omp): Send alive_tests too.

	* src/html/classic/omp.xsl (html-create-target-form): Add Alive Test
	field.
	(target [details]): Show Alive Test.

2014-02-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (user_set_language_code): New function.
	(exec_omp_post): After save_my_settings_omp, when language is NULL,
	set the user's language from the credentials, because the browser value
	will have been set in the credentials.

	* src/gsad_omp.c (save_my_settings_omp): Actually set the language
	return.

2014-02-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/help.xsl (my_settings.html): Move "Jump to dialog" to
	icon.  Add User Interface Language.

2014-02-12  Matthew Mundell <matthew.mundell@greenbone.net>

	Add setting User Interface Language.

	* src/gsad.c (struct user, user_add): Add language.
	(user_set_language): New function.
	(init_validator): Add "lang".
	(gsad_connection_info): Correct comment.
	(exec_omp_post): Set language from authenticate_omp on user.  Set
	credentials language from user if present.  Set user language after
	save_my_settings.
	(request_handler): Check for user language before using Accept-Language.
	Remove Accept-Language lookup in help case because the language is
	available in the credentials.

	* src/gsad_base.c (set_language_code): New function.

	* src/gsad_base.h: Add header accordingly.

	* src/gsad_omp.c (save_my_settings_omp): Add User Interface Language.
	(authenticate_omp): Add language return.

	* src/gsad_base.h: Update headers accordingly.

	* src/html/classic/omp.xsl (get_my_settings, edit_my_settings): Add User
	Interface Language.

2014-02-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Use definition instead of "en".

2014-02-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post, file_content_response)
	(request_handler): Reformat overhanging parentheses.

2014-02-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* doc/i18n-howto.txt: Add section on the translation of help pages.

2014-02-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* CMakeLists.txt: Add installation of new html/classic/help_de.xsl.

	* src/html/classic/help.xsl (tasks.html): Update and clarify
	descriptions. Add "even" class to table rows to make hover
	effect consistent.

	* src/html/classic/help_de.xsl: New file. Translation of help.xsl
	to German (currently only covering Tasks table).

2014-02-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (list-window-line-icons, task)
	(note-detailed, override-detailed): Set blank i18n fallbacks for some
	affix strings that are not used for the default English text.

2014-02-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (request_handler): If possible, select the XSL file for
	help pages based on the Accept-Language HTTP header.

	* src/gsad_base.c (xsl_transform_with_stylesheet): New function.
	Renamed xsl_transform with additional parameter to select the
	stylesheet to apply.
	(xsl_transform): Delegate to xsl_transform_with_stylesheet.

	* src/gsad_base.h (xsl_transform_with_stylesheet): New function
	prototype.

	* src/html/classic/help.xsl: Include gsad.xsl.

	* src/html/classic/gsad.xsl: Remove help.xsl include.

2014-02-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/gsad.xsl (html-gsa-logo): Match CREATE_REPORT
	response, for container case.

	* src/html/classic/omp.xsl (new_task): Match CREATE_REPORT response, for
	container case.

2014-02-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-part): In "Sort by" dropdown
	test by field first, remove the single check from the multiple case, and
	for columns with headings append the heading to the dropdown item.
	(html-cve-table): Correct spelling.

2014-02-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (report [results]): Space "0 results" text
	and the errors page link using div and p elements.

2014-02-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (report [results]): Add i18n for "0 results"
	display and add a link to the errors page if there are no results, but
	there is at least one error message.

	* src/html/classic/po/de.xml: Add new messages.

2014-02-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (filter-simple): Include quotes if keyword
	was quoted.

2014-02-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/po/de.xml: Fix typos in text for alterable tasks and
	add missing comma in text for unknown CPE installation counts.

2014-02-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_my_settings_omp): Flush trailing space.

2014-02-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (SERVER_ERROR, exec_omp_post, exec_omp_get)
	(request_handler): Spell "occurred" right.

2014-02-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (gsa:cvss-risk-factor): Use 0.1 in Low test
	because 0.0 is already covered by None.

2014-02-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* doc/i18n-howto.txt: Add "Time" context.

	* src/html/classic/omp.xsl (minor-details, html-config-table): Replace
	capital "M" in "Last Modified" with lower case "m" for consistency.
	(get_info_cve_lnk, html-create-note-form, html-edit-note-form, note)
	(note [trash], note [details], html-notes-trash-table)
	(html-create-override-form, html-edit-override-form, override)
	(override [trash], override [details], html-overrides-trash-table)
	(note-detailed, override-detailedresult-details, section-filter)
	(report-hosts-link, report-ports-link, report [hosts], report [vulns])
	(report [apps], report [app-severity], download_ssl_cert)
	(report [errors], report [summary], html-tasks-trash-table): Apply i18n
	to notes and overrides and various other scan management elements.

	* src/html/classic/po/de.xml: Add Report filters, various generic terms,
	and terms related to results, notes and overrides.

2014-02-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (DEFAULT_GSAD_LANGUAGE): Set to "en" and clarify usage.

2014-02-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (DEFAULT_GSAD_LANGUAGE): New #define.
	(gsad_connection_info, free_resources): Add language component.
	(exec_omp_post): Copy language from con_info to credentials.
	(request_handler): Get language for POST as well as help and login page
	GET requests. Add i18n elements to login_page XML.

2014-02-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/help.xsl, src/html/classic/omp.xsl: Replace
	last occurances of term "threat" by "severity" all over the place.

2014-02-04  Benoît Allard  <benoit.allard@greenbone.net>

	* src/gsad.c (chroot_drop_privileges): chroot one level below the face
	  directory and chdir to it just after. This way, we don't need to
	  setup a full chroot environment for each face. The drawback is that
	  it could be possible to access another face from inside the chroot.
	  This is not considered as a vulnerability.

2014-02-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* doc/i18n-howto.txt: New file.

	* src/html/classic/gsad.xsl (gsa:i18n): Select i18n strings by context
	first, then by the actual string to reduce lookup time.
	(html-gsa-logo, html-gsa-navigation): Add now mandatory context
	parameter to gsa:i18n calls.

	* src/html/classic/omp.xsl: Add now mandatory context parameter to
	gsa:i18n calls.

	* src/html/classic/po/de.xml: Group strings by context for new string
	selection method. Move documentation and template to new howto file.

2014-01-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* INSTALL: Add section about static code analysis with CLang.

2014-01-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsad.xsl (gsa:i18n): Explicitly select text from
	elements.

	* src/html/classic/omp.xsl (gsa:date-diff): Mark for i18n.
	(list-window-line-icons): Update i18n for Export.
	(result-details-icon-img, task [details], report [report])
	(interval-with-unit, result-details, report [result-header])
	(report [result-headers], result [result-body], report [assets])
	(report [section-list], report [ports], report [vulns], report [os])
	(report [apps], report [prognostic_apps], full-report-export-form)
	(filtered-report-export-form, report [closed_cves], report [cves])
	(report [ssl_certs], report [summary]): Add new i18n for reports
	and schedule due dates.

	* src/html/classic/po/de.xml: Update "Export" strings and add
	translations Report Summary and Results page.

2014-01-28  Benoît Allard  <benoit.allard@greenbone.net>

	Post release version bump.

	* src/html/classic/help.xsl, CMakeLists.txt: Updated

2014-01-28  Benoît Allard  <benoit.allard@greenbone.net>

	Preparing the 5.0+beta5 release

	* CHANGES: Updated

2014-01-27  Benoît Allard  <benoit.allard@greenbone.net>

	Solve issues raised by the clang static analyser.

	* src/gsad_omp.c (xsl_transform_omp, save_my_settings_omp): Null
	pointer passed as an argument to a 'nonnull' parameter
	(edit_resource, edit_task, edit_alert, edit_tag, edit_target)
	(send_settings_filters): Function call argument is an uninitialized
	value
	(download_agent_omp): Dereference of null pointer

2014-01-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (report [section-list]): Rename
	"Report: Task Details" to "Task: Details"

2014-01-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/gsa-style (#report_section_list ul li ul)
	(#report_section_list ul li ul a): Increase width for longer titles.

	* src/html/classic/omp.xsl (gsa:report-section-title)
	(report-hosts-link): Change "Summary" to "Summary and Download".
	(report-help-icon): Remove redundant "(View Report)"
	(filtered-report-export-form, full-report-export-form): New templates,
	export forms from report [summary].
	(report-icons): Add report export form.
	(report [summary]): Use new templates for report export forms.

	* src/html/classic/po/de.xml (875): Adapt to changed report section
	titles.

2014-01-24  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/po/de.xml: Update copyright and authors.
	Reorganize strings into categories: Generic, interface element specific,
	resource type specific, special page specific, wizard. Add comments
	for categories and template for resource type string organization.
	Fix typos in "View list of all reports [...]", Note and Role strings.

2014-01-22  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add German translation for Tasks pages and several general strings of
	other resource types like common table headers, severity levels and
	tooltips of details page links.

	* src/html/classic/gsad.xsl (i18n_po_path): New global variable.
	(gsa:i18n): Add context and default parameters, remove use of
	normalize-space.
	(html-gsa-navigation): Remove gsa:i18n calls that would attempt
	translating items twice.

	* src/html/classic/omp.xsl (gsa:view_details_title): New function.
	(filter-window-part): Add i18n for "New [...] filter from current term"
	and field names.
	(edit-header-icons, severity-label, user-tags-window)
	(tag [for_resource], toggle-tag-icon): Add i18n marking.
	(assets, report [filterbox]): Add i18n marking for Apply button.
	(task-icons, task [details], trend_meter, status_bar): Add i18n marking.
	(list-window): Restructure Export i18n marking, add i18n of filter
	column names.
	(minor-details): Add i18n marking.
	(details-header-icons): Add and restructure i18n marking. Rewrite
	text for easier translation.
	(new_task): Add i18n marking.
	(report, last_report): Add i18n marking for Report / Task details and
	severity bar.
	(new_task, html-edit-task-form, task, html-tasks-table): Add i18n
	marking.
	(lsc_credential, agent, alert, filter, tag): Use view_details_title
	function.
	(column-name): Apply i18n to show column names, add i18n_context param.
	(target, config, schedule, slave, get_info_cpe_lnk, get_info_cve_lnk)
	(get_info_nvt_lnk, get_info_ovaldef_lnk, get_info_dfn_cert_adv_lnk)
	(note, override, override [details], group, permission, port_list)
	(report_format, host, result [result-headers], report [assets])
	(report [vulns], report [os], report [os-severity])
	(report [unknown-os-severity], report [app-severity], role, user): Use
	view_details_title function and apply i18n to severity bars.

	* src/html/classic/po/de.xml: Add "[...] Details" and "[...] Filter"
	strings. Update strings for export, new filter, details. Add general
	property names and values, severity levels, User Tags window strings,
	Task actions, properties and values. Add TODO comments for other
	resource types.

2014-01-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Also get details on Delta Summary page,
	because Manager only returns the counts when returning the results.

2014-01-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (highlight-diff): Decrease indent.
	(highlight-diff-line): Put the wrap indicator inside the line DIV,
	otherwise it makes an extra line.

2014-01-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Add owner keyword to report filter.

	* src/html/classic/omp.xsl (task): Add owner and permission keywords to
	Reports page links.

2014-01-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/help.xsl (my_settings.html): Add Tags filter.
	(new_tag.html): Fix paragraph saying "target" where it should be "tag".

2014-01-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (DEFAULT_GSAD_FACE): New #define
	(chroot_drop_privileges): chroot or chdir to a specified subdirectory.
	(main): Add command line parameter "--face" to allow selection of
	a custom user interface to serve.

2014-01-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (next_page): Add wizard_get case.

2014-01-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/gsad.xsl (html-gsa-logo): Match indicator icon for
	edit group error.

	* src/html/classic/omp.xsl (edit_group): Match modify_group_response for
	error case.

2014-01-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* CMakeLists.txt: Install verify_active.png.

	* src/html/classic/omp.xsl (report_format): Grey verify icon depending
	on permission.

	* src/html/classic/img/verify_inactive.png: New file.

2014-01-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (details-header-icons): Grey delete icon for
	current user.

2014-01-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (details-header-icons): Use delete icon for
	users.

2014-01-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (details-header-icons): Indent icons within
	DIV.

2014-01-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/classic/omp.xsl (details-header-icons): Make icons depend on
	user's capabilities too.

2014-01-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (chroot_drop_privileges): Change into classic dir.

	* CMakeLists.txt: Install classic files to subdir "classic".

2014-01-16  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/classic/omp.xsl (filter-window-pager): Fix total counts text
	in otherwise case.

2014-01-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Moving the entire html part into subdirectory "classic/"
	to eventually allow additional user interface in parallel.
	For the time being the install destination is still the same.

	* src/CMakeLists.txt, CMakeLists.txt: Adjusted paths.

	* src/html/*: Moved into src/html/classic/.

2014-01-16  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/po/de.xml: Add translations for main menu items, content
	pagination, filter section, trashcan and several common actions.

	* src/html/gsad.xsl (i18n_language): New global variable.
	(html-gsa-logo, html-gsa-navigation): Mark "Logged in as ...",
	JavaScript indicator and main menu item text for i18n.

	* src/html/omp.xsl (gsa:report-section-title, filter-window-pager)
	(filter-window-part, auto-refresh, list-window-line-icons)
	(trash-delete-icon, delete-icon, pause-icon, restore-icon, resume-icon)
	(start-icon, stop-icon, trashcan-icon, assets, report [results-pager])
	(fold-filter-icon-img, fold-filter-icon, result-overrides-icon-img)
	(task [details], list-window, new_task, report [report], task [trash])
	(lsc_credential [trash], alert [trash], filter [trash], tag [trash])
	(target [trash], config [trash], schedule [trash], slave [trash])
	(group [trash], permission [trash], port_list [trash])
	(html-edit-port-list-form, host, result-details)
	(report [section-filter], report-section-pager, report-icons)
	(role [trash], get_trash, user): Mark menu and common action text for
	i18n.

2014-01-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/classic/: New.

2014-01-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (gsa:newstyle-nvt, gsa:cvss-risk-factor): Correct
	indent.

2014-01-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c, src/html/omp.xsl, src/html/gsad.xsl,
	src/html/help.xsl: extend copyright year to 2014.

2014-01-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-scap-form, html-cert-form): Adjust message when
	migrating.

2014-01-13  Benoît Allard  <benoit.allard@greenbone.net>

	Post-release version bump to 5.0+beta5.

	* src/html/help.xsl, CMakeLists.txt: Updated

2013-01-13  Benoit Allard  <benoit.allard@greenbone.net>

	Preparing the gsa 5.0+beta4 release.

	* CHANGES: Updated.

2014-01-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-alert-form): Remove Delete Requested.
	This state only occurs when the task is deleted while running, so is of
	little value, and it might be expected to occur always when the task is
	deleted.
	(html-edit-alert-form): Only show Delete Requested option when the Alert
	already uses that option.

2014-01-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (report [section-link]): Add link_style and element
	parameters to allow creating the link around an element.
	(report-icons): Add scan status bar for normal scan reports, linking
	to report summary.

2014-01-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Skip results on Summary page.

2014-01-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (report [section-list]): Remove "Topology" item.

2013-12-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [ssl_certs]): Work with SSLInfo entries
	instead of SSLDetails and adjust code accordingly. This solves the bug
	of only one entry being present when the same ssl cert might be used on
	different ports on the same host.

2013-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (omp): Clear entity_return initially, as some callers
	expect it to be NULL on failure.

2013-12-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report-hosts-link): Filter by host with a plain
	filter term.  When results have full powerfilter it will be possible to
	filter by the host column.

2013-12-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host, report [assets], report-ports-link)
	(report [vulns]): Remove leading = from filter terms, for clarity.

2013-12-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (filter-window-pager, filter-window-part)
	(edit-header-icons, edit-settings-filters, list-window-line-icons)
	(report [results-pager], task-icons, task [details], list-window)
	(details-header-icons, report [report], task [trash])
	(lsc_credential [trash], alert [trash], filter [trash], tag [trash])
	(target [trash], html-config-table, config [trash], schedule [trash])
	(slave [trash], group [trash], permission [trash], port_list [trash])
	(html-edit-port-list-form, host, result-details)
	(report [section-filter], role [trash], get_system_reports_response)
	(user): Add tooltips to inactive icons and others like filter controls
	and the ones for updating the apply_overrides settings.

2013-12-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (drop_privileges): Correct error message.
	(chroot_drop_privileges): New function.  Chroot and drop according to
	args.
	(main): Add --drop option.  Do the chroot after initialising the MHD
	daemon, in order to bind to a privileged port.  Separate control of
	chroot and dropping privileges according to --chroot and --drop options,
	in case the user wants to reduce privileges using capabilites instead.

2013-12-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (main): Make do_chroot errors more detailed.

2013-12-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator): Add get_name as alias for name parameter.

	* src/gsad_omp.c (wizard_get): Get wizard name from get_name parameter
	to avoid conflicts with name in run_wizard_omp. Create response XML
	directly.

2013-12-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (params_mhd_add): Use strlen to determine size of value.

2013-12-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator): Add wizard_get command.
	(params_mhd_add): Handle hashtable parameters like event_data:hosts.
	(exec_omp_get): Add wizard_get command.

	* src/gsad_omp.c (wizard_get, wizard_get_omp): New functions.

	* src/gsad_omp.h (wizard_get_omp): New function prototype.

2013-12-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (gsa:permission-description): Check existence before
	string length in has-resource, for the Admin case.

2013-12-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (gsa:permission-description): Add cases for
	permissions on specific resources.  Update callers.

2013-12-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (gsa:permission-description): Use lowercase name
	param instead of name element.  Prevent leading space after contains
	test.  Add Everything.
	(role [details]): Display all command permissions when user has
	Everything.

2013-12-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (gsa:permission-description): Drop leading capital.
	(permission [details]): Add description field.
	(role [details]): Capitalise description.  Link to permission.

2013-12-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (gsa:permission-description): Add special case for
	info.

2013-12-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_role): Get role's permissions too.

	* src/html/omp.xsl (gsa:command-type, gsa:permission-description): New
	template.
	(role [details]): Add permissions section.

2013-12-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (next_page): Add case for wizard.
	(run_wizard_omp): Fix internal error message. Return to wizard page
	by default.
	(wizard_omp): Delegate request to function "wizard".
	(wizard): New function. Uses body from wizard_omp and includes extra
	XML like responses.

	* src/html/gsad.xsl (html-gsa-logo): Add run_wizard response indicator
	on wizard page.

	* src/html/wizard.xsl (quick-first-scan-wizard): Add "next" parameter
	to explicitly go to get_tasks page.

2013-12-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Correct user sort field.

2013-11-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (permission, permission [details]): Note when subject
	is in trashcan.

2013-11-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl: Remove id="tasks" from all DIVs.  This seems to be
	a copy and paste propogation.  There is no "tasks" in the css anyway.
	(get_trash): Correct name of tasks anchor.

2013-11-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (list-window-line-icons): Enable cloning of global
	resources.

2013-11-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (permission, permission [details]): Mark deleted
	resources with "Orphan".

2013-11-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (permission, permission [details]): Note when the
	resource is in the trashcan.

2013-11-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_one): Add details param so that Note/Override
	Details pages include all details.

2013-11-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (list-window-line-icons): Go to the details page
	after cloning, to match the other create operations.

2013-11-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (list-window-line-icons): Grey the clone icon when
	the resource is owned by someone else.

2013-11-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_my_settings, edit_my_settings): Add Permissions
	Filter.

2013-11-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-permission-form): Add filter param so that
	filter is preserved.

2013-11-22  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump to 5.0+beta4.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2013-11-22  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 5.0+beta3 release.

	* CHANGES: Updated.

2013-11-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_report): Send parameters host_search_phrase,
	host_levels, host_first_result, host_max_results to manager for
	prognostic reports.

2013-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* CMakeLists.txt (FILES): Add clone_inactive.png.

	* src/html/gsad.xsl (html-gsa-logo): Apply Create Permission indicator
	on Permissions page.

	* src/html/omp.xsl (list-window-line-icons): Grey out clone according to
	capabilities.

	* src/html/img/clone_inactive.png: New file.

2013-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Remove test from around
	My Settings, because there's always at least the timezone there.

2013-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Remove cmd from URL so that C code
	uses default according to user's capabilities.

	* src/html/omp.xsl (get_trash): Only display Empty Trashcan when user
	can do so.
	(get_my_settings): Only display edit icon when user can edit.  Hide most
	settings when GET_SETTINGS has been taken from user.

2013-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): If cmd is NULL before validation, then
	provide a command according to user's capabilities.

	* src/html/gsad.xsl (login_page): Remove the cmd param from the default
	URL, so that exec_omp_get can decide on a default.

2013-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Generate Scan Management menu
	from node set, so that the last column is always handled correctly,
	skipping the menu entirely if the menu would be empty.  Get token from a
	variable inside for-each.

2013-11-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_report): Get results filters for prognostic
	reports.

	* src/html/omp.xsl (report-icons): For prognostic reports add type
	parameter and replace report_id with host in list view link.

2013-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Generate Configuration menu
	from node set, so that the last column is always handled correctly,
	skipping the menu entirely if the menu would be empty.  Do i18n on
	Administration menu items.

2013-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Use gsa:may-op to do
	capability check.  Generate Administration menu from node set, so that
	the last column is always handled correctly, skipping the menu entirely
	if the menu would be empty.

2013-11-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* CMakeLists.txt: Bump minimum required libmicrohttpd version from 0.4.2
	to 0.9.0

	* INSTALL: Update libmicrohttpd version.

2013-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	Display icons in generic templates according to permissions.

	* src/html/omp.xsl (gsa:may, gsa:may-op): New functions.
	(list-window-line-icons, task-icons): Add gsa:may based permission
	checks.
	(task [details]): Remove observed variable because it is only used once
	and gsa:may should be used for the permissions instead.
	(list-window): Use gsa:may-op for new-icon flag.
	(html-permissions-table): Use gsa:may-op.

2013-11-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (gsa:join-capital, gsa:type-name): New functions.
	(get_trash): Generate Contents from node set, so that the row style can
	be calculated from the position, because some rows will be missing for
	some users.  Move the Credentials section up into alphabetical order.

2013-11-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_task): Add extra_xml arg.  Update all callers.
	(create_report_omp, create_task_omp): Pass response to new_task for
	error dialog.

	* src/html/gsad.xsl (html-gsa-logo): Apply indicator on New Task page.

	* src/html/omp.xsl (new_task): Apply create_task_response for error
	dialog.

2013-11-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-permissions-table): Make the new icon depend on
	capabilities, instead of on the role.

2013-11-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (main): Add --gnutls-priorities option with NORMAL as
	default value. Add MHD_OPTION_HTTPS_PRIORITIES to MHD_start_daemon calls
	accordingly.

	* doc/gsad.8: Add documentation for gnutls-priorities cli option.

2013-11-16  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Don't validate value 2 for hosts_allow
	and ifaces_allow.

	* src/gsad_omp.c (create_user_omp, save_user_omp): Remove special case
	handling of value 2 for hosts_allow and ifaces allow. Refactor code.

	* src/html/omp.xsl (html-create-user-form): Remove Allow All choice for
	interfaces and hosts access. Adjust default choices.
	(user): Remove output case for Allow All hosts and interfaces access.
	(user [edit]): Remove Allow All choice.

2013-11-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Add owner=any to default filter.

2013-11-15  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (assets): Add refresh icon tooltip.
	(report [assets]): Add tooltip for names in report column.

2013-11-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (verify_agent_response): New template.
	(get_agent): Match verify response.
	(html-create-permission-form): Exclude GET_VERSION from dropdown.  Use
	Create instead of Save in button text.
	(html-edit-permission-form): Exclude GET_VERSION from dropdown.

2013-11-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/last_inactive.png,
	src/html/img/first_inactive.png,
	src/html/img/previous_inactive.png,
	src/html/img/next_inactive.png: Updated placeholders with
	greyed out icons produced in the same way as the others.

2013-11-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (report [assets]): Lower abbreviation limit
	from 20 to 15 to make width fit better even for names with wide letters.
	The first 15 chars of a hostname usually is enough to distinguish.

2013-11-13  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-create-users-form, user [edit]): Update hosts
	and interface access choice strings to be more explicit.

	* src/html/help.xsl (users.html): Update documentation accordingly.

2013-11-13  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [assets]): Abbreviate hostname in IP column
	when its value is very long. Add hostname to the tooltip.

2013-11-12  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (host): Add tooltip to hosts list icon.

2013-11-12  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (assets): Add filter label for log results.
	(report [assets]): Add log results column.

2013-11-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (assets, report [assets]): Add tooltip to greyed out
	prognostic icon.

2013-11-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/help.xsl: Update documentation for users Host Access as it
	now supports the full syntax supported by Targets.

2013-11-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [results-pager]): Add vertical align to all
	IMG styles, so they align consistently.
	(report [results]): Add filter and page controls at bottom of list, like
	in the standard lists.

2013-11-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [results-pager]): Add grey arrow icons, as in
	other lists.

2013-11-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [errors]): Remove severity column.

2013-11-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [section-list]): Move Summary section title
	to the top of the menu.

2013-11-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (list-window): Use a single TD for the list footer,
	counting the number of columns for the colspan instead of using a fixed
	number.

2013-11-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (filter-window-pager): Grey out the icons on the edge
	pages, instead of removing them.

	* src/html/img/first_inactive.png, src/html/img/previous_inactive.png,
	src/html/img/next_inactive.png, src/html/img/last_inactive.png: New files.

	* CMakeLists.txt: Install new icons.

2013-11-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (list-window): Add pager controls at bottom of list.

2013-11-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_one, get_many, get_task, get_config)
	(get_config_family, get_config_nvt): Remove actions attribute.

2013-11-05  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/help.xsl (users.html): Update documentation for users
	interface access.

2013-11-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (list-window): Add new-icon arg.
	(html-permissions-table): For now only show new icon for Admins.  Other
	users can't get the lists of users, roles and groups anyway.

2013-11-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-user-form): Default role to User,
	because that is the usual case.

2013-11-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Apply create indicator on New
	Permission page.

2013-11-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (params_toggle_override): Replace the filt_id with 0
	instead of -2, otherwise Manager uses the default Tasks Filter value
	instead of the given filter.

2013-11-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Validate access_ifaces and ifaces_allow
	parameters.

	* src/gsad_omp.c (create_user_omp, save_user_omp): Send ifaces element
	with the appropriate allow attribute.

	* src/html/omp.xsl (html-create-user-form, user [edit]): Add
	fields to set allowed/denied network interface access.
	(user [details]): Output Interface Access.

2013-11-04  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/omp.xsl: Add missing ":".

2013-11-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (list-window): Add filt_id to refresh form so that
	the named filter is kept when the user changes the refresh.  Also remove
	the override param otherwise the filter term takes preference.  I think
	this is safe to do now that the overrides are controlled on a separate
	form.

2013-11-01  Matthew Mundell <matthew.mundell@greenbone.net>

	Use a string only version of the omp function when the argument is just
	a string, otherwise the format specifiers in the strings of complex
	commands like CREATE_CONFIG can cause errors.

	* src/gsad_omp.c (omp): Replace formatting args with a single string
	arg.  Update all callers.
	(ompf): New function.  Formatting version of omp.  Use in all callers
	that used "omp" with formatting.

2013-11-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (import_config_omp): Switch to new style with "next"
	param handling.
	(import_report_format_omp): Correct fallback URLs.

	* src/html/gsad.xsl (html-gsa-logo): Apply create indicator on New
	Config page.

	* src/html/omp.xsl (html-import-config-form): Add next param to import
	form.

2013-11-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/last.png, src/html/img/first.png: Replaced
	the placeholder with actual icons.

2013-10-31  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/alterable.png: Updated with new icon.

2013-10-31  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (gsa:type-many): Add "allinfo" as a type without
	plural s.
	(edit-header-icons, details-header-icons): Add optional cap-type-plural
	parameter for consistency with changes to list-window.
	(list-window): Handle subtypes and special plural cases like "info" or
	"DFN-CERT Advisories". Hide Actions column if icon-count is 0.
	(html-cpe-table, html-cve-table, html-nvt-table, html-ovaldef-table)
	(html-dfn_cert_adv-table, html-allinfo-table): Use list-window template.

2013-10-31  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (html-configs-table, html-port-lists-table): Use
	list-window template.

2013-10-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (shy-long-rest): Drop chunk size to 5.  Correct
	offset of next chunk.
	(shy-long-words): Drop chunk size to 5.  Correct offset of next chunk.
	Pass current word instead of whole string.  Add spaces between words.

2013-10-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (shy-long-rest, shy-long-words): New templates.
	(report [ssl_certs]): Fill long words with soft hyphens, instead of
	truncating at a length, because the differences in character sizes
	within the font makes the displayed length vary wildly.

2013-10-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (list-window, result [result-headers]): Remove column
	width special case left over from truncation.

	* src/html/gsa-style.css (.gbntable_name td div): Remove.  Was for
	truncation.

2013-10-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (short_timestamp_current): New template.
	(task [details]): Get correct date for current report.

2013-10-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (result [result-headers]): Apply result-header
	template to the Vulnerability and Host column to allow sorting.

2013-10-30  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/po/de.xml: Improve wording in German translation.

2013-10-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (gsa:has-long-word): New function.
	(task, target, result [result-headers]): Remove gbntable_name
	truncation.
	(report [ssl_certs]): Abbreviate the DN using XSL if the DN contains any
	long words.

2013-10-29  Matthew Mundell <matthew.mundell@greenbone.net>

	For Targets, Tasks, Report Results and Report SSL Certs make the first
	column a fixed width and truncate the contents with ellipsis if it
	reaches the width.

	* src/html/omp.xsl (list-window): Specify width if column is Name or DN.
	(task, target): Make the Name TDs a gbntable_name, and wrap the contents
	in a DIV.
	(result [result-headers]): Specify width of Vulnerability header TD.
	Make TD gbntable_name and add DIV.
	(report [ssl_certs]): Make TD gbntable_name and add DIV with tooltip.

	* src/html/gsa-style.css (.gbntable td): Remove word breaking.  Add
	ellipsis truncation.
	(.gbntable div): New rule.
	(.gbntablehead2 td): Remove word breaking.

2013-10-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (report [results-pager]): Add buttons to go to first
	and last page here as well.

2013-10-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (task): Swap report counts in Total column so
	the one used for sorting comes first.

2013-10-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* CMakeLists.txt: Install new images src/html/img/first.png and
	src/html/img/last.png.

	* src/html/omp.xsl (filter-window-pager): Add buttons to go to first
	and last page.

	* src/html/img/first.png, src/html/img/last.png: New image files.

2013-10-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsa-style.css (.gbntable td): New rule.  Breaks words in
	cells of standard tables.
	(.gbntablehead2 td): Prevent breaking words of headings.

2013-10-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (report [os]): Add empty CPE column for unknown OS.

2013-10-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (status_bar): Add title_suffix parameter.
	(task): Add link to the current report on the progress bar and add info
	about the link to the tooltip. Show number of both all and all finished
	reports with links to the get_reports pages in reports total column.

2013-10-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result [result-headers]): Remove truncation of
	long NVT names, because the browser wraps the column anyway.

2013-10-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Sort column reverse by default where it makes more sense.

	* src/html/omp.xsl (list-window): Pass sort-reverse through to
	column-name.
	(column-name): Add sort-reverse arg.
	(html-tasks-table, html-tags-table, html-schedules-table)
	(html-reports-table): Add specifier to columns that must be sorted
	reverse by default.
	(html-configs-table, html-cpe-table, html-cve-table, html-nvt-table)
	(html-ovaldef-table, html-dfn_cert_adv-table, html-allinfo-table)
	(html-port-lists-table): Add sort-reverse column-name arg to columns
	that must be sorted reverse by default.

2013-10-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (report [os]): Add column with CPE SecInfo links.

2013-10-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (report [cves]): Add links to the SecInfo pages of
	the CVEs.

2013-10-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (omp_success): NULL check entity.

2013-10-23  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator): Add parameter apply_filter.

	* src/gsad_omp.c (get_report): Use a special filter to get all results
	for pages except results and summary pagem unless apply_filter param is
	set to 1.

	* src/html/omp.xsl (report [fold-filter-icon])
	(report [result-details-icon]): Add apply_filter param to links, get
	filter term from filter param on pages that can modify the filter.
	(report [result-overrides-icon]): Add apply_filter param to links.
	(report [section-link]): Get filter term from filter param on pages
	that can modify the filter.
	(section-filter): On report_section pages (except results and summary)
	replace normal filter controls with controls to enable and disable
	current filter.

2013-10-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report-hosts-link): Prefix the host keyword with a
	column to make the filter more usual looking.

2013-10-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task [details]): Add colon to match other fields.

2013-10-22  Michael Meyer <michael.meyer@greenbone.net>

	* src/html/os.xml:
	Added cisco nx-os.

2013-10-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [section-list]): Remove report from path, and
	simplify condition.

2013-10-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task [details]): In the Reports field link to the
	current report if there is one.

2013-10-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/help.xsl (new_task.html, task_details.html): Update help
	documentation.

2013-10-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Validate source_iface parameter.
	(create_task_omp, save_task_omp): Handle source_iface parameter.

	* src/html/omp.xml (task [details]): Show network source interface
	value.
	(new_task, html-edit-task-form): Add field for network source interface.

2013-10-18  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (report [ports]): In severity column use "severity"
	instead of "cvss" element.

2013-10-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (result-body): Set padding of the table row wrapping
	the details boxes to zero and reduce height of dummy row by removing
	the line break.

2013-10-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad/gsa-style.css (note_box_box, override_box_box)
	(report_section): Add 4px padding.

	* src/html/omp.xsl (note-detailed, override-detailed): Remove
	positioning style attributes of buttons.

2013-10-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (delete_group_response): New template.
	(html-gsa-logo): Add more group indicator icons.

2013-10-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (edit_port_list): Match delete response for error
	dialog.

2013-10-16  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (send_settings_filters): Check for OMP failure
	responses and write the responses to the buffer.
	(save_my_settings_omp): Return to edit page instead of get page if
	any the OMP modify_setting commands failed. Make marking of sections
	for different settings with comments more consistent.

	* src/html/omp.xsl (edit_my_settings): Add error message box for
	modify_setting_response.

2013-10-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_task_omp): Add ALTERABLE to MODIFY_TASK if given.

	* src/html/omp.xsl (html-edit-task-form): Add Alterable Task field if
	the task is New.

2013-10-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_task): Send alterable flag through to manager.

	* src/html/omp.xsl (task [details], new_task): Add Alterable Task field.
	(html-edit-task-form): Remove alterable clone icon.

2013-10-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Build the default filter with the task ID
	when the task ID is given for the report case.  When a named filter is
	given add the task ID to the front of the filter.

	* src/html/omp.xsl (filter-window-part): Remove the filter param from
	the filter dropdown, otherwise it is used instead of the default in the
	-- case.
	(html-reports-table): Pass the task ID as extra param, so that get_many
	can ensure that it is in the filter.

2013-10-15  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (html-users-table): Use database field with same
	name for sorting "Roles" column.

2013-10-15  Matthew Mundell <matthew.mundell@greenbone.net>

	Make remaining Details window headings like others.

	* src/html/omp.xsl (tag [details]): Remove name heading to match other
	Details pages.  It's already in the name field.
	(get_nvts): Move page specific header icons slight to the right, as in
	other pages.
	(host): Move back link to list icon.

2013-10-15  Matthew Mundell <matthew.mundell@greenbone.net>

	Make Config window headings more like others.

	* src/html/omp.xsl (html-config-family-table): Drop Details from edit
	page name, as on Config page.  Move back link to list icon in header.
	Bold Family field.  Remove extra TD causing small empty column on right.
	(html-config-nvt-table): Drop Details from edit page name.  Move back
	link to icon.  Move Config field down to others.  Remove top Family
	field because there is one below.  Remove heading that duplicates window
	title.  Remove Details heading to match other pages.
	(nvt): Add Config field.

2013-10-14  Matthew Mundell <matthew.mundell@greenbone.net>

	Make Result Details window heading more like others.

	* src/gsad.c (init_validator): Add export_result to commands
	(exec_omp_get): Handle export_result.

	* src/gsad_omp.c (export_resource): Add special case for result
	location.
	(export_result_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/help.xsl (contents.html): Add Result Details item.
	(result_details.html): New template.

	* src/html/omp.xsl (result-details): Add help and export icons.  Move
	report link to header icon.  Add ID minor field.

2013-10-14  Matthew Mundell <matthew.mundell@greenbone.net>

	Add Alterable Tasks.

	* CMakeLists.txt: Install alterable PNG.

	* src/gsad.c (init_validator): Add alterable.

	* src/gsad_omp.c (clone_omp): Send alterable if given.

	* src/html/omp.xsl (task [details]): Add alterable indicator in header.
	(html-edit-task-form): Add alterable clone icon in header.  Allow config
	and target editing if alterable.
	(task): Add alterable indicator.  Add margin to observer indicator.
	Skip trend for alterable tasks.

	* src/html/img/alterable.png: New file.

2013-10-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task [details]): Remove overrides icon.

2013-10-12  Matthew Mundell <matthew.mundell@greenbone.net>

	Use omp and omp_success functions in all create handlers, so that the
	Create pages all go back to the New page when the OMP command fails.

	* src/gsad_omp.c (create_report_omp, create_lsc_credential_omp): Use omp
	function.
	(new_agent, new_agent_omp): Move up in file.
	(create_agent_omp): On failure go back to New page.
	(send_alert_event_data, send_alert_condition_data)
	(send_alert_method_data): Remove.
	(append_alert_event_data, append_alert_condition_data)
	(append_alert_method_data): New functions.
	(create_alert_omp, save_alert_omp, create_target_omp): Use omp function.
	(new_config, new_config_omp): Move up in file.
	(create_config_omp, create_group_omp, create_port_list_omp)
	(create_filter_omp): Use omp function.

2013-10-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (nvt): Remove nvt description handling code.

	* src/html/help.xsl (nvt_details.html): Update help documentation.

2013-10-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (result-headers): Show overrides icon only for
	active overrides.

2013-10-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/wizard.xsl (quick-first-scan-wizard): Remove the second
	New icon and shortened the text a little bit. The same icon
	twice looks a bit bold and confusing.

2013-10-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (note-detailed, override-detailed): Set position
	of buttons to 3 pixels away from bottom right corner.

2013-10-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (edit_my_settings): Remove extra TDs that were
	creating a small empty third column.

2013-10-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (html-create-note-form, html-edit-note-form)
	(html-create-override-form, html-edit-override-form, result-details):
	Add cellpadding and border attributes to table of result details to
	make spacing consistent with report results page.

2013-10-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [section-link]): Add class arg.
	(report [section-list]): Pass class in apps case, so that the highlight
	is rounded for prognostic reports.

2013-10-09  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (send_alert_condition_data): Change (threat) level
	to severity.

	* src/html/omp.xsl (html-create-alert-form, html-edit-alert-form)
	(alert, alert [trash]): Use severity instead of threat level in
	conditions.

2013-10-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (assets): Use arrow icons instead of text arrows in
	page control.

2013-10-08  Matthew Mundell <matthew.mundell@greenbone.net>

	Make the Details page follow the New page, in general.

	* src/gsad_omp.c (create_group_omp): On error serve New Group instead of
	next page.  Remove group_id check, now that it always goes to Details
	next.
	(get_user): Append extra_xml before DESCRIBE_AUTH response, so that
	get_one ID parsing works.

	* src/html/gsad.xsl (create_permission_response): New template.
	(html-gsa-logo): Add indicator icons for Create on Details pages.

	* src/html/omp.xsl (get_group): Match create_group_response.

2013-10-08  Matthew Mundell <matthew.mundell@greenbone.net>

	Make the Details page follow the New page, in general.

	* src/gsad_omp.c (create_alert_omp): On error serve New Alert instead of
	next page.

	* src/html/gsad.xsl (html-gsa-logo): Add indicator icons for Create on
	Details pages.

	* src/html/omp.xsl (get_alert): Match create_alert_response.
	(html-create-report-format-form): Add next param.

2013-10-08  Matthew Mundell <matthew.mundell@greenbone.net>

	Make the Details page follow the New page, in general.

	* src/gsad_omp.c (create_lsc_credential_omp): Use next_page.
	(new_target): Remove target_id handling, now that the next page is the
	Details of the created target.
	(create_target_omp, create_config_omp): Use next_page.
	(get_config): Check for ID in response, in case previous page was New
	Target.
	(get_note, get_override): Switch to get_one.  Drop commands arg.  Update
	callers.
	(create_port_list_omp): Use next_page.

	* src/html/gsad.xsl (html-gsa-logo): Add indicator icons for Create on
	Details pages.

	* src/html/omp.xsl (list-window, details-header-icon): Add next to New
	icon.
	(get_lsc_credentials, get_config_response): Match create response.
	(html-create-target-form): Remove target_id, now that the next page is
	Details for the new target.
	(get_note, get_override): Adjust paths for get_one.

2013-10-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_task): Check for ID like in get_one, until
	get_task is converted to use get_one.

2013-10-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (html-create-note-form, html-edit-note-form)
	(html-create-override-form, html-edit-override-form, note-detailed)
	(override-detailed, result-headers, section-filter): Pass details
	parameter to next page. Change link fragment ID to jump to the notes
	and overrides respectively.

2013-10-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_one): Look for an ID in a CREATE response in
	extra_xml if the ID param is missing.

	* src/html/omp.xsl (new_task, html-create-lsc-credential-form)
	(html-create-agent-form, html-create-alert-form)
	(html-create-filter-form, html-create-target-form)
	(html-create-config-form, html-create-schedule-form)
	(html-create-slave-form, html-create-group-form,
	(html-create-port-list-form, html-create-user-form): Add next param with
	Details page.  Add filter args if required.

2013-10-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (report [summary]): Add report ID at the top right
	for non-prognostic reports.

2013-10-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Move indicators for tag actions
	from get_report to get_report_summary_response.

	* src/html/omp.xsl (user-tags-window, tag [for_resource])
	(html-create-tag-form, html-edit-tag-form): Add new
	parameter for report_section.
	(get_report): Remove user tags window and tag-related response message
	boxes. Moved to get_report_summary_response.
	(get_report_summary_response): Add user tags window and tag-related
	response message boxes, moved from get_report. Remove test for report
	type.

2013-10-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/wizard.xsl (quick-first-scan-wizard): Make the icons links.
	Remove the details icons.  Add a New Target icon.

	* src/html/po.xsl: Update wizard text to match.

2013-10-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result [result-headers]): Move note and override
	presence icons into Vulnerability column.

2013-10-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result [result-headers]): Remove details-button arg
	and details icon.  Update callers.

2013-10-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report): Match filter box and table to other list
	windows.

2013-10-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/img/style/dropdown_arrow_green.png: Actually commit file.

2013-10-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* CMakeLists.txt: Install green arrow image.

	* src/html/gsa-style.css (report_section_list:hover): Switch to a single
	green arrow as background.

	* src/html/omp.xsl (report [section-list]): Remove pointy list item,
	because it makes the area too cluttered and covers some of the text.

	* src/html/img/style/dropdown_arrow_green.png: New file.

2013-10-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* CMakeLists.txt: Install src/html/img/style/dropdown_arrow.png and
	src/html/img/style/highlight_green.png.

	* src/html/gsa-style.css: Replace background of id section_list_first
	with a small downward arrow. Change background when mouse is hovering
	over the menu.

	* src/html/img/style/dropdown_arrow.png: New image file.

	* src/html/img/style/highlight_green.png: New image file.

2013-10-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [result-overrides-icon]): Separate the value
	of overrides for the link, because that must the inverse of the current
	value.

2013-10-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (report [section-list]): Do not hide menu item of
	currently selected report section.

2013-10-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (host): Add section "Host Identification".

2013-10-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (list-window-line-icons): Remove param that was for
	the details icon.

2013-10-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Remove more redundant get_tasks override params.

	* src/html/omp.xsl (html-edit-task-form): Replace overrides param with
	filter params in Add Report form.
	(task): Remove extra override param from icons call, now that the
	default and filters cover this.

	* src/html/gsad.xsl (html-gsa-logo, error_dialog, login_page): Remove
	overrides param from get_tasks URL, now that the default is the required
	value.

	* src/html/help.xsl (tasks.html): Remove overrides param from URL.

2013-10-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Ensure the overrides state is preserved across actions on the Tasks
	page.

	* src/gsad_omp.c (get_many): Make the default task filter apply
	overrides, to prevent having to specify the default via the extra
	"overrides" param.
	(edit_task): Default overrides to 1, like everywhere.

	* src/html/gsad.xsl (html-gsa-navigation): Removed extra overide param
	from Tasks page links, now that the default matches the requirement.

	* src/html/omp.xsl (html-edit-task-form): Remove the overrides param
	from the form entirely, because it is always available, either via the
	default or in the filter.

2013-10-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (list-window): Remove overrides icons.  Allow before
	and after html for column headings.
	(html-tasks-table, html-reports-table): Add overrides icon in Severity
	heading.

2013-10-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (gsa:column-filter-name): Replace ' ' too.
	(filter-window-part, list-window): Replace text format argument headings
	with node format argument columns.  Update all callers.

2013-10-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl: Remove END comments now that everything is in a
	section with a BEGIN.

2013-10-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl: Add section headers for templates at end of file.
	(commands_response): Move up into Generic section.
	(new-task-alert-select, new-task-group-select, new-task): Move up into
	Tasks section.
	(new_target): Move up into Targets section.

2013-10-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl: Add Raw Info end comment.
	(gsa:build-levels, gsa:join, gsa:alert-in-trash)
	(gsa:table-row-class, gsa:date-diff, gsa:report-host-has-os)
	(gsa:host-has-unknown-os, gsa:report-section-title): Move up into
	function section.
	(severity-bar, severity-label, build-levels): Move up to separate Tags
	Views into their own section.
	(html-task-table): Move down into tasks section, making Reports and
	Tasks sections separate from the Named Templates section.
	(gsad_msg): Move up for same reason.

2013-10-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl: Make header comment more regular.  Move Generic
	Management section up in file so that it comes before most of its
	users.

2013-10-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task [details]): Add refresh param to override form.

2013-09-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result-overrides-icon-img)
	(report [result-overrides-icon]): New templates.
	(result [result-headers]): Add overrides icon in Severity column.

2013-09-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [all]): Call report-icons instead of
	report-help-icons.
	(report-icons): New template.
	(report-help-icon): Make style more like other header icons.

2013-09-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsa-style.css (#report_section_list [.last]): New rule.

	* src/html/omp.xsl (report [section-list]): Skip Task Details link for
	prognostic reports.

2013-09-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [section-list]): Add Task Details item.

2013-09-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Add Low and Log to levels default.

2013-09-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (list-window): Add missing refresh param to override
	icon form.

2013-09-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (filter-window-part, report [section-filter]): Make
	filter input slightly shorter, to stop the icons from wrapping.

2013-09-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (filter-window-part): Add missing braces around
	Xpath.

2013-09-30  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump to 5.0+beta3.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2013-09-30  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 5.0+beta2 release.

	* CHANGES: Updated.

2013-09-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/gsa-style.css (td p): New rule.

	* src/html/omp.xsl (nvt): Apply structured-text template to script tags.

2013-09-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Add new note and override buttons on the New Note page.

	* src/gsad_omp.c (new_note, new_override): Add NVT and NEXT to XML in
	simple case.

	* src/html/omp.xsl (get_nvts): Add new note and override buttons.
	(html-create-note-form, html-create-override-form): In the simple case
	if the NVT ID was given then use it in the NVT field.

2013-09-24  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (html-reports-table): Add column names for sorting
	by severity level counts.

2013-09-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Validate hosts_ordering parameter.

	* src/gsad_omp.c (create_task_omp, save_task_omp): Send hosts_ordering
	parameter value.

	* src/html/omp.xsl (new_task, html-edit-task-form): Add hosts ordering
	multi-choice options.
	(task [details]): Output hosts ordering value.

2013-09-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (reports.html, tasks.html): Replace "Jump to dialog"
	by a list icon in the title bar to be consistent witjh other help dialogs.

2013-09-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-reports-table): Add sorting to default-filter,
	else name is used.

2013-09-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (preferences [edit-scanner-details]): Adjust colspan
	for new column.

2013-09-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (preferences [edit-scanner-details]): Add Default
	column to match what's in table.

2013-09-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_alert): Get report formats and filters here
	instead of in new_alert_omp, because they're always needed on the New
	Alert page, however it was reached.
	(new_alert_omp): Remove OMP calls.

2013-09-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_alert_omp): Change type in GET_FILTERS, to match
	recent type rename.

	* src/html/omp.xsl (html-create-alert-form): Rename field to try match
	filter type.

2013-09-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_alert, new_alert_omp): Move up in file.
	(create_alert_omp): On error stay on the New Alert page, instead of
	returning to the Alerts page.

2013-09-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/help.xsl (hosts_note): Update documentation for IPv6 ranges.
	(new_target.html, target_details.html, targets.html): Update to document
	Targets' new options.

2013-09-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl: Make spacing at end of single tags consistent.

2013-09-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (reports.html): New template.

2013-09-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report): Restrict the Task column width, to prevent
	the Date column from getting too small.

2013-09-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report): Move status to dedicated column, using
	status bar instead of text.
	(html-reports-table): Add Status column.

2013-09-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (html-reports-table): Add sorting by severity column.

2013-09-17  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Validate reverse_lookup_only and
	reverse_lookup_unify parameters.
	* src/gsad_omp.c (create_target_omp, save_target_omp): Handle
	reverse_lookup_only and reverse_lookup_unify parameters.

	* src/html/omp.xsl (html-create-target-form, html-edit-target-form): Add
	reverse lookup options.
	(target [details]): Output reverse lookup values.

2013-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report_format [details]): Correct typo.

2013-09-16  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Validate exclude_hosts parameter.

	* src/gsad_omp.c (create_target_omp, save_target_omp): Send targets
	exclude_hosts parameter too.

	* src/html/omp.xsl (html-create-target-form, html-edit-target-form): Add
	exclude hosts input field.
	(target [details]): Output exclude hosts value too.

2013-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (gsa:actions-width): New function.
	(list-window): Use gsa:actions-width.
	(user-tags-window, preferences, html-configs-table)
	(html-port-lists-table, result [result-headers], report [assets])
	(report [ssl-certs]): Specify Actions width in icons.

2013-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (icon-width, trash-actions-width): New variables.
	Use in all trash tables for Actions columns.
	(list-window): Use icon-width.

2013-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (list-window): Add icon-count arg, which governs the
	width of the Actions column.  Update all callers with counts.

2013-09-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (contents.html): Remove Settings.
	(settings.html): Remove.  Settings were removed with Administrator.

2013-09-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsa-style.css (#gb_menu li.section_start): New rule.

	* src/html/gsad.xsl (html-gsa-navigation): Group items in Configuration
	menu more logically, separating groups with lines.

2013-09-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (preference-details): Select the config, else only
	the default is displayed on the Scan Config Details page.
	(preferences [scanner]): Add default column.

2013-09-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Add overlay div to each of
	the top menu buttons.

	* src/html/gsa-style.css: Add rules for the menu to overlay a green
	version of the first menu item when the mouse hovers over the top of the
	menu.  This is a hint that clicking the top button will select the first
	item on the menu.

2013-09-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/gsa-style.css (div.label_high, div.label_medium)
	(div.label_low, div.label_log, div.label_none): Use same background
	colors and gradients as severity bars.

2013-09-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp-doc.xsl (change, changes): New templates.

	* src/html/omp.xsl (protocol): Add Compatbility Changes section.

2013-09-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Default report sorting to date.

	* src/html/omp.xsl (html-reports-table): Use date as filter column too.

2013-09-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-reports-table): Rename Name to Date.

2013-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_result_page): Make static like others.

2013-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (list-window): Separate the refresh icon and the
	overrides icon into two forms, otherwise clicking on refresh toggles
	the overrides.

2013-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task [details], report, task, permission): Encode
	filters for URL.

2013-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (gsad_init, gsad_cleanup): Remove void for consistency.

2013-09-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (result-headers): Show original severity level in
	tooltip of severity bar.

2013-09-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (get_many): Indent OMP printf with a space.  Move details
	flag out of printf and make it only present for reports, because some
	types link SecInfo rely on the default to work properly.

2013-09-09  Matthew Mundell <matthew.mundell@greenbone.net>

	Make the links to the reports of a task use the default filter, but with
	the task.

	* src/gsad.c (init_validator): Add replace_task_id.

	* src/gsad_omp.c (get_many): Add filter_replace to OMP GET command.

	* src/html/omp.xsl (filter-window-part): Pass filter in filter selection
	form, so that the replace has access to the task_id.
	(task [details], task): Add replace_task_id and filt_id args to report
	links, so that current task is used and so that default filter is used.
	(html-reports-table): Add replace_task_id, so that it is passed around
	in the table links.

2013-09-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (params_toggle_overrides): New function.
	(get_tasks): Toggle overrides with params_toggle_overrides.
	(get_reports): Toggle overrides like get_tasks does.

2013-09-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_section): Remove shadowing declaration.
	Clean up indenting.

2013-09-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Add Reports page indicator icons.

2013-09-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_section): Call get_report directly, in
	order to pass in extra_xml, so the indicator icon and error message
	works.

2013-09-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task [details]): In count links sort reverse by
	date.
	(report): Order the element report name elements like it is done in the
	other tables.  In particular, remove the margin style so that the status
	is flush under the name, like the comment is in other tables.

2013-09-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (print-node): Print attributes too.

2013-09-05  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch to "result" from "report" for report result filter type and
	setting.

	* src/gsad_omp.c (get_report): Switch filter type for rename.

	* src/html/omp.xsl (html-create-filter-form, html-edit-filter-form): Add
	result to types.
	(report [section-filter]): Switch creat_filter type to result.
	(get_my_settings, edit_my_settings): Add Results Filter.

2013-09-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Remove indent from Report in
	menu.

2013-09-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (filter-window-part): Show named filter controls for
	reports too.

	* src/gsad_omp.c (get_many): Prepend "report_" to "filt_id" in OMP for
	reports, otherwise the filter is applied to the results.

2013-09-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Add debug param which can be added to display params and XML.

	* src/gsad.c (init_validator): Add debug.

	* src/html/gsad.xsl (print-node): New template.
	(html-footer): Print params and XML if debug given.

	* src/html/omp.xsl (gsa:token): New template.
	(task): Use gsa:token for token.

2013-09-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Add default filter for reports which sorts
	reverse by date.

	* src/html/omp.xsl (task): In report count link correct overrides
	element and sort reverse by date.

2013-09-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Move the Task Details report lists to a new page, Reports.

	* src/gsad.c (exec_omp_get): Make get_reports a regular commands.

	* src/gsad_omp.c (next_page): Add get_reports.
	(get_many): Add task_id to the built filter, if there is one.
	Explicitly ask for 0 details.  Prefix report_ on the filter if the
	type is reports, otherwise the fitler applies to the report results.
	(get_task): Remove filter building and GET_REPORTS call.
	(get_reports, get_reports_omp): New functions.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/gsad.xsl (html-gsa-navigation): Add Reports under Tasks in
	Scan Management.

	* src/html/omp.xsl (filter-rest): Exclude task_id too.
	(filter-window-part): Add Task field if task_id is present.
	(task [details]): Add refresh forms.  Add links and last report to
	Reports field.  Remove report list window.
	(short_timestamp_last): Check last instead of first.
	(report): Get delta from envelope.  Add task column.  Grey delta when
	showing all tasks.  Make the icons return to Reports page.
	(task): Adjust details link for new page.  Link report count to new
	Reports page.
	(list-window): Get overrides from filters so it works for reports too.
	Put refresh controls on Reports page too, including override control.
	(html-reports-table, get_reports): New template.

2013-09-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (html-tasks-table, task): Remove column "First".
	Make "Severity" heading no longer a sub-column of "Reports". Add
	tooltips for entries in columns "Total" and "Last". Use standard font
	size for these columns.

2013-09-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/img/high.png, src/html/img/high_big.png,
	src/html/img/false_positive.png, src/html/img/log.png
	src/html/img/low.png, src/html/img/low_big.png,
	src/html/img/medium.png, src/html/img/medium_big.png,
	src/html/img/none_big.png: Delete. Obsoleted by HTML labels and
	severity bars.

	* CMakeLists.txt: Remove installation of obsolete threat level images.

2013-09-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Replace threat/severity level images with HTML/CSS styled text boxes.

	* src/html/gsa-style.css (div.label_high, div.label_medium)
	(div.label_low, div.label_log, div.label_none): New class styles.

	* src/html/omp.xsl (severity-label): New template.
	(assets, report [filterbox], task [details], host, report [assets])
	(get_reports_response/report/report [report-assets], report [hosts])
	(report [summary]): Replace threat/severity level images with
	severity-label template.
	(column-name): Apply severity-label template when the column label is
	a severity level.

	* src/html/help.xsl (hosts.html, task_details.html): Replace
	threat/severity level images with severity-label template.

2013-08-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (override [details], override-detailed): Calculate
	threat level from severity and new threat level from new_severity.
	(result [result-headers]): Calculate threat and new threat level from
	corresponding severity elements. Show N/A for missing severity.
	Use severity to determine parameters for new override links.
	(report [os-severity]): Calculate threat and new threat level from
	corresponding severity elements.

2013-08-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (html-edit-override-form): Swap severity number and
	level text in dropdown text.
	(override-detailed): Swap severity number and level text in
	"Overridden from [...] to [...]" text.

2013-08-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (new_note, create_note_omp, edit_note, save_note_omp):
	Replace threat with severity.

	* src/html/omp.xsl (html-create-note-form, html-edit-note-form)
	(note [details]): Replace threat with severity.
	(result [result-headers]): Pass severity to new_note instead of threat.

2013-08-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Add indicator for
	modify_note_response and modify_override_response on their respective
	edit pages.

	* src/html/omp.xsl (new_note): Apply template for modify_note_response.
	(new_override): Apply template for modify_override_response.

2013-08-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Set the password after save_user_omp, if
	it changed.

	* src/gsad_omp.c (save_user_omp): Add password return arg.

	* src/gsad_omp.h: Update header accordingly.

2013-08-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_task): Remove the result filter, now that Manager
	overrides this when a report filter is given.  This way the result
	filtering has the same apply_overrides value as the reports filtering.

	* src/html/omp.xsl (task): Add back the filter param to the details link
	using the apply_override value from the current task filter.

2013-08-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_task): Default apply_overrides to 1 like
	everywhere.  Get the default filter from the params in the case filter
	where the filter is missing.

	* src/html/omp.xsl (task [details]): Add special task filters to
	list-window extra_params.
	(report): Add filter params to compare and delete icons.
	(task): Remove filter param as get_task now has a default for this.

2013-08-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (new_override, create_override, save_override_omp):
	Replace threat with severity.

	* src/html/omp.xsl (html-create-override-form, html-edit-override-form)
	(override [override]): Replace threat with severity.
	(result [result-headers]): Use severity when creating new a override
	instead of threat.

2013-08-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task [details]): Drop elements from Severity and
	Scan Result in list-window headings, to prevent them from being links.
	(column-name): When the heading element is empty then just put the text,
	without the link.

2013-08-27  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (html-overrides-table): Sort table column "From"
	using DB column "severity".

2013-08-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task [details]): Pass default filter to list-window
	to preserve task_id in filter of list button.
	(list-window): Add default filter arg.

2013-08-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task [details]): Use image names in headings.
	(list-window): Add missing extra_params to column-name calls.
	(column-name): If the heading is an image name, use the image instead
	of text.

2013-08-26  Matthew Mundell <matthew.mundell@greenbone.net>

	Add filtering of reports on the Task Details page.

	* src/gsad.c (init_validator): Add get_reports to commands.  Add task
	filter params.
	(exec_omp_get): Make get_reports an alias for get_task.

	* src/gsad_omp.c (get_task): Remove original_overrides hack.  Build
	filter if requested.  Use the given filter for get_reports instead of
	a fixed filter, and add a result filter.

	* src/html/omp.xsl (filter-window-part): Skip the new and named filter
	controls for reports.
	(task [details]): Pass the separate task filter to details-header-icons
	else the report filter is used.  Use list-window to produce the reports
	window.
	(report): Use boolean and and integer for the observed check.
	(task): For the details link, pass the task filter and filt_id in
	special params, and use the filter param to specify an initial filtering
	for the reports.
	(list-window): Add and extra_params arg and add it to all links.  Skip
	export and refresh controls for reports.
	(details-header-icons): Add filter params so caller can specify them.

2013-08-26  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (result-cvss-risk-factor): New function.
	(report, last_report): Hide severity score if it is negative and show
	level as in "threat" element in severity bar tooltip.
	(override [override], override [details]): Show CVSS instead of threat
	if it is Alarm, hide severity score if it is negative, use new function
	for severity bar tooltip.
	(result [result-headers], report [vulns], report [os-severity])
	(report [unknown-os-severity], report [app-severity], report [errors]):
	Hide severity if it is negative, use new function for level and adjust
	severity bar tooltip.

2013-08-22  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (report, last_report): Remove commented out code
	for result count based threat icon.

2013-08-22  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (check_modify_config): Remove unused function and line
	parameters.
	(save_config_omp, save_config_family_omp, save_config_nvt_omp): Adjust
	check_modify_config call.
	(get_result): Remove unused first_results, max_results, levels,
	search_phrase, notes, overrides, min_cvss_base, results_hosts_only,
	sort_field, sort_order, delta_report_id, delta_states parameters.
	(get_result_omp, get_result_page): Adjust get_result call.
	(get_system_report_omp): Remove unused content_disposition parameter.

	* src/gsad_omp.h: Adjust headers accordingly.

	* src/gsad.c (request_handler): Adjust get_system_report_omp call.

2013-08-22  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/help.xsl (my_settings.html): Add severity_class anchor.
	(task_details.html, tasks.html): Replace threat icons with severity
	bars and update text accordingly.

2013-08-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_task): Add filter with apply_overrides to
	GET_REPORTS, so that overrides are applied to results too.

	* src/html/omp.xsl (report): Use the filtered instead of the full counts
	because

2013-08-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_task): Get reports with a separate GET_REPORTS
	command.

	* src/html/omp.xsl (task [details]): Select reports from GET_REPORTS
	response.
	(report): Adjust paths now that the report has moved in the XML.

2013-08-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (note, override, html-notes-table)
	(html-overrides-table): Add link to resource details page with tooltip
	ontext values. Move text to first column.

2013-08-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (user, group, role, target, port_list)
	(lsc_credential, config, alert, tag, filter, schedule, report_format)
	(slave, agent, permission, get_info_cpe_lnk, get_info_cve_lnk)
	(get_info_ovaldef_lnk, get_info_dfn_cert_adv_lnk): Add tooltip for view
	resource details links.
	(get_info_nvt_lnk): Remove tooltip parameter. Fix tooltip.
	(info/nvt): Adjust get_info_nvt_lnk call.

2013-08-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (info/allinfo): Extract summary tag from extra info
	for new style nvts.

2013-08-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/help.xsl (permissions.html, new_permission.html)
	(permission_details.html, roles.html, role_details.html): New templates.
	(contents.html): Add permissions and roles help pages links.

	* src/html/omp.xsl (details-header-icons): Add nonew parameter to
	disable new resource button.
	(html-permissions-table, html-permissions-table-trash): Fix column
	names.
	(role [details]): Add nonew parameter to details-header-icons template
	call.

2013-08-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (list-window-line-actions): Add notrashcan parameter
	to disable move to trashcan action help. Remove Details action help.

	* src/html/help.xsl (hosts.html, agents.html, lsc_credentials.html)
	(report_formats.html, users.html, tasks.html, cpes.html, cves.html)
	(nvts.html, ovaldefs.html, dfn_cert_advs.html, allinfo.thml): Update
	help documentation.

2013-08-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (list-window-line-icons, info/cpe, info/cve)
	(info/nvt, info/ovaldef, info/dfn_cert_adv, info/allinfo): Remove
	details button.
	(html-cpe-table, html-cve-table, html-nvt-table, html-ovaldef-table)
	(html-dfn_cert_adv-table, html-allinfo-table): Remove actions column as
	it has no actions left.

2013-08-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [report], report [assets]): Remove details
	icon. Make first column values clickable, linking to details page.

2013-08-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_many): Revert change for get_filters command to
	also get filters with no types as manager correctly handles this case
	now.

2013-08-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_many): Use only the specified type for
	get_filters command.

2013-08-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* INSTALL: Updated reference system from Debian 6 to 7.

2013-08-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_base.c (FAIL_HTML): New define.
	(xsl_transform): Return fail page HTML on error, instead of NULL.
	Callers assume this happens, which led to segfaults on error.

2013-08-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (html-create-override-form, html-edit-override-form)
	(override [details]): Rename "Threat" sections to "Severity", label
	"Alarm" severity level as "> 0.0" and use "Alarm" type when creating
	overrides for overrides with severity > 0.0.

	* src/html/help.xsl (new_override.html): Describe new Severity elements.

2013-08-09  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt: Install the recently added icons.

2013-08-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (list-window): Replace override dropdown with image
	in header form.

	* src/html/img/overrides_disabled.png,
	src/html/img/overrides_enabled.png: New files.

2013-08-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Include sort elements when building filter.

	* src/html/omp.xsl (gsa:column-filter-name): New template.
	(filter-simple, filter-rest): Exclude sort columns.
	(filter-window-part): Add headings arg.  Use for sort field.
	(list-window, html-configs-table, html-cpe-table, html-cve-table)
	(html-nvt-table, html-ovaldef-table, html-dfn_cert_adv-table)
	(html-allinfo-table, html-port-lists-table): Pass in column headings.

2013-08-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Separate simple search terms and more
	complex filter terms when building the filter.

	* src/html/omp.xsl (filter-simple): New template.
	(filter-rest): Only include complex terms.  Only add relation when
	there's a column.
	(filter-window-part): For filter expand icon include extra params and
	get the type with type-many, so that SecInfo works.  Separate simple
	search term from complex ones in expanded filter.  Rename "The rest".

2013-08-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task): Display the first report even when it is the
	same as the last report, so that it is clear that the columns are sorted
	correctly when sorting by First.

2013-08-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (filter-window-part): Clear any selected filter in
	the expanded filtering form.

2013-08-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (filter-window-part): Add fold icon.  Make expanded
	section depend on filterbox param.

2013-08-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [section-filter]): Fix filter creation form's
	inputs.

2013-08-07  Matthew Mundell <matthew.mundell@greenbone.net>

	Add expanded filter controls to GET pages.

	* src/gsad.c (init_validator): Add build_filter.

	* src/gsad_omp.c (get_many): If build_filter flag is given then contruct
	filter from other params.
	(get_tasks): Skip filter hacking when build_filter is given.

	* src/html/omp.xsl (filter-rest): New template.
	(filter-window-part): Add expanded filter controls.

2013-08-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (trend_meter): Use the terms "severity" and
	"vulnerability" instead of "threat" in alt and title text.

	* src/html/help.xsl (tasks.html): Update description of trend meter.

2013-08-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (sorting): New template.  Call alongside all calls
	to template "filtering".
	(tasks.html): Remove old sorting section.

2013-08-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/gsa-style.css (#small_inline_form select)
	(#small_inline_form input): Set vertical-align property to top.

2013-08-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Remove "New Task" menu item.

	* src/html/help.xsl (contents.html): Remove entry for "New Task" menu
	item.

	* src/html/wizard.xsl (quick-first-scan-wizard): Add short instructions
	how to create a new task.

	* src/html/po/de.xml: Add German translation of new wizard text.

2013-08-05  Matthew Mundell <matthew.mundell@greenbone.net>

	Make the help icons on the Edit pages land in the right place.

	* src/html/gsad.xsl: Add gsa to element prefixes so that imported files
	can use each other's functions.

	* src/html/help.xsl: Add gsa namespace.
	(list-window-line-actions): Add anchor for links from Edit pages.

	* src/html/omp.xsl: Add gsa to element prefixes.
	(gsa:type-string): New function.
	(edit-header-icons): Add underscore to anchor name, for consistency.

2013-08-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (resource_action): Remove task specific parameter name.

2013-08-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_slave, new_slave_omp): Move up in file.
	(create_slave_omp): Switch to new style, so that next page is New Slave
	on error.

	* src/html/gsad.xsl (html-gsa-logo): Apply indicator icon on New Slave.

2013-08-02  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator): Add "Alarm" to valid threat values.

2013-08-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-gsa-logo): Add indicator icon on Overrides page
	for New Override.

2013-08-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (ovaldef-details, dfn_cert_adv-details): Remove bold
	from minor details ID so that they match the other pages.

2013-08-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): By default sort users by role.

2013-07-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_info_response): Add case for all errors except
	for the database missing one, otherwise a permission error looks like
	one of the database is missing.

2013-07-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (html-edit-permission-form): Access subject info directly
	under SUBJECT, now that it is available there.

2013-07-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add parentheses to comment chars.

2013-07-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator): Fix regexp for severity. Add
	severity_optional. Make new_severity alias of severity_optional. Add
	custom_severity, new_severity_list.

	* src/gsad_omp.c (create_override_omp, edit_override_omp): No longer
	send new_threat. Add selection between listed and text field
	new_severity.

	* src/html/omp.xsl (html-create-override-form, html-edit-override-form):
	Replace new_threat fields with list of presets for new_severity
	and radio buttons to choose between list and text field.

2013-07-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Apply trashcan indicator icons.

2013-07-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_schedule_omp): Switch to new style so that
	get_schedule is used for the next page, otherwise the filter bar is
	completely empty.

2013-07-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-schedule-form): Add filtering params.

2013-07-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (group [auth]): Add filter params so filtering is
	preserved on next page.

2013-07-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (user [edit]): Add filter params so filtering is
	preserved on next page.

2013-07-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_users): Apply create_filter_response for error
	dialog.

	* src/html/gsad.xsl (html-gsa-logo): Apply indicator icon.

2013-07-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_task): Match operation responses, for error
	messages.

	* src/html/gsad.xsl (html-gsa-logo): Match indicator icons on Task
	Details page.

2013-07-26  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (result-headers [result-headers]): In severity bar
	tooltip check if severity changed instead of threat level, additionally
	show original severity if it was overridden and get threat level from
	threat element.

2013-07-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* INSTALL: Reorder PKG_CONFIG_PATH export, in case another openvas
	installation is already in existing PKG_CONFIG_PATH.

2013-07-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_task_omp, save_task_omp)
	(save_container_task_omp, create_user_omp, save_user_omp): Also check
	params inside "+" button cases, so that the error message shows up when
	there are param errors.

2013-07-15  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (create_report_omp): replace "%" with "%%" in imported
	report XML to avoid misinterpretation as format placeholders by
	g_markup_vprintf_escaped in omp function.

2013-07-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Use "severity" instead of "type" as sort
	field.

2013-07-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xml (override-detailed): Add new severity score to
	"from ... to ..." text.

2013-07-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result [result-headers]): Use "severity" as the sort
	field instead of type, to match the header name.

2013-07-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result [result-headers]): Use "location" as the sort
	field instead of port, to match the header name.

2013-07-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/gsad_omp.c (save_override_omp): Add command parameter
	"new_severity".

	* src/html/omp.xml (html-edit-override-form): Add "New Severity"
	input.

2013-07-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator): Add "severity" and alias "new_severity",
	based on "min_cvss_base" but also accepting integer values.

	* src/html/gsad_omp.c (create_override_omp): Add command parameter
	"new_severity".

	* src/html/omp.xml (html-create-override-form): Add "New Severity"
	input.

2013-07-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report): Flush trailing whitespace.
	(get_trash): Correct spelling.

2013-07-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (powerfilter.html): Describe regex options.

2013-07-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (override [override], override [details]): Use
	bar for new_severity if it is > 0.0 instead of new_threat.
	(html-overrides-table): Use new_severity for sorting by "To" column.

2013-07-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* ChangeLog: Add close paren.

2013-07-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (CHECK_PARAM): Name variable more consistently.  Line
	up indenting.  Add space after function name.

2013-07-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_trash): Add space after functions.  Remove
	comments because it's pretty obvious what's happening.

2013-07-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_alert_omp): Check that comment is valid.

2013-07-09  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (html-tasks-table, task [details]): Rename "Threat"
	to "Severity".
	(report [report], last_report): Replace threat icon with severity bar.

2013-07-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (get_nvts): Show resource not found message when nvt
	is not found instead of empty ui box.

2013-07-05  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator): Add "dynamic_severity" as alias for
	"boolean".

	* src/gsad_omp.c (save_my_settings_omp): Add saving of setting
	"Dynamic Severity".

	* src/html/omp.xsl (get_my_settings, edit_my_settings): Add the
	"Dynamic Severity" setting.

2013-07-04  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (result [result-headers]): Get severity from
	severity element instead of NVT's cvss_base.
	(result [result-body]): Add NVT version at scan time if available.
	(report [vulns], report [os-severity], report [unknown-os-severity])
	(report [app-severity], report [errors]): Get severity from severity
	element instead of NVT's cvss_base.

2013-07-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/gsa-style.css (result_header, result_section_top): Add
	background color.
	(result_section): New class.
	(result_header_right, result_header_left): Remove.

	* src/html/omp.xsl (report [results]): Reduce cell spacing for results
	tables.
	(result [result-headers]): Add check and apply result header class.
	Remove inner table in result header cells and adjust to display
	correctly.

2013-07-02  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [ports]): Rename Threat to Severity. Update
	severity bar to use cvss value accordingly.

2013-07-01  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (save_task_omp, create_lsc_credential_omp)
	(save_lsc_creential_omp, save_agent_omp, save_alert_omp)
	(create_target_omp, create_tag_omp, save_tag_omp, save_target_omp)
	(save_config_omp, create_note_omp, create_override_omp, save_slave_omp)
	(save_report_format_omp): Remove associated CHECK macro and use
	CHECK_PARAM macro instead. Reorganize code so that parameter checking
	comes before new connection to manager is made.
	(edit_config): New function
	(edit_config_omp): Call edit_config.

	* src/html/omp.xsl (get_config_response): Match gsad_msg.

2013-07-01  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (CHECK_PARAM): New macro.
	(create_group_omp, save_group_omp, create_permission_omp)
	(save_permission_omp, create_port_list_omp, create_port_range_omp)
	(save_port_list_omp, save_port_range_omp, create_filter_omp)
	(save_filter_omp, save_user_omp): Refactor code. Remove associated CHECK
	macros. Use CHECK_PARAM. Reorganize code for certain functions so that
	parameter checking happens before creating a new connection to manager.

2013-07-01  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (GET_TRASH_RESOURCE): New macro.
	(get_trash): Refactor and clean code.

2013-07-01  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [ports]): Adapt port and iana name printing
	for old port results values.

2013-07-01  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* (report [apps]): Rename inaccurate_hosts to no_cpe_detail_hosts
	and rephrase text for hosts with CPEs in inventory but without matching
	CPE details. Change matching criteria for hosts so details must have
	correct name and value at the same time.

2013-07-01  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump to 5.0+beta2.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2013-07-01  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 5.0+beta1 release.

	* CHANGES: Updated.

	* CMakeLists.txt: Raise openvas-libraries dependency to 7.0.0.

	* INSTALL: Update dependencies.

2013-06-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Add a space for clarity.
	(get_tasks): Set "filt_id" to -2, otherwise this is missed in get_many
	because we are setting "filter" manually.

2013-06-26  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Make SVN revision in version string available again
	for out-of-source build.

2013-06-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result [result-headers]): Correct column name.

2013-06-25  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (gsa:cvss-risk-factor): Check for None threat first
	in nist/bsi case.

2013-06-25  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (result [result-header]): Don't apply
	cvss-risk-factor as extra text for severity bar when threat of result is
	Log.

2013-06-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [result-header]): Add delta and prognostic
	cases.

2013-06-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_trash): Get Groups background right in Contents.

2013-06-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result [result-headers]): Only use sorting links when
	the expand icon is present.  This keeps the links off pages like Result
	Details and Add Note.

2013-06-24  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (report [topology]): Remove forced levels filter.

2013-06-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Replace sorting section above filter with sorting via Severity and
	Location column headings.  Still uses "type" and "port" in the filter.

	* src/html/omp.xsl (report [sorting]): Remove.
	(report [results]): Remove old sorting control.
	(report [result-header]): New template.  Prints a header.
	(result [result-header]): Change mode to result-headers.  Apply new
	result-header template to produce Severity and Location headers with
	links.
	(result-detailed): Update result mode.

2013-06-24  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (user-tags-window): Shorten overly long window
	titles (> 80 characters).

2013-06-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Add delete_trash_group command.
	(exec_omp_post): Handle delete_trash_group command.

	* src/gsad_omp.c (get_trash): Get groups too.
	(delete_trash_group_omp): New function.

	* src/html/omp.xsl (get_trash): Apply delete_group_response. Add table
	for groups in trash and trash groups content entry.

2013-06-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/cpe/a:snort:snort.png, src/html/img/cpe/a:sourcefire.png,
	src/html/img/cpe/a:typo3:typo3.png, src/html/img/cpe/a:google.png,
	src/html/img/cpe/a:drupal:drupal.png,
	src/html/img/cpe/a:gnu.png, src/html/img/cpe/a:otrs:otrs.png,
	src/html/img/cpe/a:wordpress:wordpress.png: New.

	CMakeLists.txt: Install new icons.

2013-06-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (get_system_reports_response): Add
	command_result_dialog for error message.

2013-06-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Move "last" to end column.

2013-06-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (init_validator): Add apostrophe to info_id validator.

	* src/html/omp.xsl (cve-details, ovaldef-details): Decode CPEs in links.

2013-06-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (info/allinfo, html-allinfo-table): Add severity
	column.

2013-06-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (cpe-details): Add row with (maximum) severity bar.

2013-06-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (cpe-details): Change plain-text CVEs to links
	to the CVEs' details pages in "Reported vulnerabilites".
	(cve-details): Change plain-text CPEs to links to the CPEs' details
	pages in "Vulnerable products".

2013-06-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (html-dfn_cert_adv-table): Use correct get_info type
	in Severity/Max CVSS column.

	* src/html/help.xsl (dfn_cert_advs.html): Replace "definition" with
	"advisory" in paragraph on severity.

2013-06-20  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (html-config-family-table): Rename table header
	"CVSS" to "Severity" and remove centering.
	(info/cpe, info/nvt, info/cve, info/ovaldef, info/dfn_cert_adv): Resize
	severity bar and show empty bar with "N/A" for missing severity.
	(html-cpe-table, html-ovaldef-table, html-dfn_cert_adv-table): Rename
	table header "Max CVSS" to "Severity", including filter column.
	(cpe-details): Rename "CVSS" to "Severity" in reported vulnerabilities
	table header.
	(ovaldef-details, dfn_cert_adv-details): Rename "Maximum CVSS" to
	"Severity" and show empty "N/A" bar if no CVSS is available.
	(nvt): Show empty "N/A" bar if no CVSS is available.

	* src/html/help.xsl (config_editor_nvt_families.html)
	(config_family_details.html, cpes.html, nvts.html, ovaldefs.html)
	(dfn_cert_advs.html): Update columns renamed to "Severity".

2013-06-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Add permission term to note filter check.
	Make the check cover overrides too.

	* src/html/gsad.xsl (html-gsa-navigation): Add permission term to notes
	filter so that observed resources are included.  Add overrides filter so
	that sorting is by NVT instead of name.

	* src/html/omp.xsl (task [details], nvt): Add permission term to filter
	so that observed resources are included.

2013-06-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (create_report_omp, create_task_omp):
	Prepare commands in extra string to avoid unwanted markup escaping.
	(create_agent_omp): Remove superfluous curly braces.
	Prepare command in extra string to avoid unwanted markup escaping.

2013-06-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (create_report_omp, create_task_omp, create_agent_omp):
	Change to new style.

2013-06-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/help.xsl (config_editor_nvt_families.html)
	(config_nvt_details.html): Update documentation to reflect NVT risk
	factor removal.

	* src/html/omp.xsl (risk_factor): Remove template.
	(html-config-familiy-table): Remove NVT Risk column.

2013-06-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (cve-details): Use abbreviation "S" for
	"SINGLE_INSTANCE" in CVSS vector.

2013-06-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* CMakeLists.txt: Remove install of pre-generated cpe-icons.xml,
	run generator script and install generated file instead.

	* cpe-icons.xml: Removed, now generated automatically.

	* tools/cpe-icon-dict-append.in, tools/cpe-icon-dict-prepend.in: New
	input files for generate-cpe-icon-dict.sh.

	* tools/generate-cpe-icon-dict.sh: New script to generate cpe-icons.xml.

2013-06-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (info/cve): When no CVSS is provided, create severity
	bar with N/A text.
	(html-cve-table): Change CVSS to Severity.
	(cve-details): Make cvss vector link to cvss calculator. Display empty
	severity bar when no CVSS is provided.
	(host): Float severity bar to the left.

	* src/html/gsa-style.css: Remove float from progressbar_box class.

2013-06-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-nvt-table): Rename CVSS column to Severity.
	Adapt name used for sorting.

2013-06-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (lsc_credential, agent, alert, filter, tag, config)
	(schedule, slave, note, port_list, report_format): Add observers icon.

2013-06-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (permission): Add missing @.
	(permission [details], permission [trash])
	(html-edit-permission-form): Access resource info directly under
	RESOURCE, now that it is available there.

2013-06-17  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (nvt): Remove nvt risk factor. Make the base vector
	link to the cvss calculator.

2013-06-17  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* CMakeLists.txt: Install cpe-icons.xml. Install app icons in base
	img directory instead of img/login. Install new img/cpe/other.png.

	* src/html/cpe-icons.xml: New CPE icon dictionary used in
	src/html/omp.xsl.

	* src/html/omp.xsl (get_info_cpe_lnk): Add CPE icon and options to
	hide it (no_icon, hide_other_icon).
	(cve-details): Add CPE icons in Vulnerable Products section.
	(cpe-details): Add CPE icon in front of name. Hide name field entirely
	if no name is found.
	(result [result-body]): Add hide_other_icon to cpe link.
	(cpe-icon): New template. Adds an icon for a given CPE.

	* src/html/img/other.png: New icon.

2013-06-17  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [cves]): Change NVT Severity column name.

2013-06-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (import_report_format_omp): Switch to new style so that
	filtering is preserved.

	* src/html/omp.xsl (html-create-report-format-form)
	(html-edit-report-format-form): Add missing filter params.

2013-06-17  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Validate cves value for report_section
	parameter.

	* src/html/omp.xsl (gsa:report-section-title, report [section-list]):
	Add CVEs section.
	(get_report_cves_response, report [cves]): New templates.

2013-06-17  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (gsa:risk-factor-max-cvss): Determine max cvss value
	based also on user set severity class.

2013-06-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (target, override [override]): Add observers icon.
	(observers-icon): New template.

2013-06-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Enable display of observed resources for
	all types.

2013-06-14  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [ssl_certs]): Remove substring call.

2013-06-14  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Add download in report SSL Certificate.

	* src/gsad.c (init_validator): Validate download_ssl_cert command and
	ssl_cert parameter.
	(exec_omp_get): Handle download_ssl_cert command.

	* src/gsad_omp.c (download_ssl_cert): New function.

	* src/gsad_omp.h: Add download_ssl_cert prototype.

	* src/html/omp.xsl (report [ssl_certs]): Add actions column. Call
	download ssl cert button.
	(download_ssl_cert): New template.

2013-06-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/gsad_omp.c (get_nvts): Add extra_xml parameter and include
	the extra_xml in the response. Update header accordingly.
	(next_page): Add response as extra_xml for get_nvts.
	(get_nvts_omp): Add extra_xml parameter.
	(edit_tag): Move extra_xml element inside the edit_tag element.

	* src/html/gsad.xsl (html-gsa-logo): Add response indicator for edit_tag
	and use new ones for get_nvts.

	* src/html/omp.xsl (user-tags-window): Insert anchor user_tags only
	if a successful tag operation response is found.
	(get_task, get_lsc_credential, get_agent, get_alert, get_filter)
	(get_target, get_config_response, get_schedule, get_slave)
	(get_nvts, get_note, get_override, get_group, get_permission)
	(get_port_list, get_report_format, get_report, get_result)
	(get_user): Add delete_tag_response, create_tag_response and
	modify_tag_response template calls.

2013-06-13  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [ssl_certs]): Add DN column. Remove domain
	names. Extract issuer value instead of hostnames. Sort table rows by
	DN value. Iterate over host details' SSLDetails instead of SSLInfo.

2013-06-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (permission): Get NAME and id directly from RESOURCE.

2013-06-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (preference_details, preferences-details):
	Add column "Default value". Rename column "Value" to "Current Value"
	and hide it if no config is given.
	(edit-config-preference [edit-details], edit-config-preferences):
	Add column "Default value". Rename column "Value" to "New Value".
	(nvt): Removed preferences section, moved to get_nvts.
	(get_nvts): Add preferences section.

2013-06-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_nvts): Add preferences param to get_nvts command.

	* src/html/omp.xsl (nvt): Add NVT preferences on get_nvts page.

2013-06-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (create_override, create_note): Validate port value
	when entered manually. Don't validate values coming from results dialog.

2013-06-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (ssl_certs_time): New template.
	(report [ssl_certs]): Correctly format outputted not valid before and
	not valid after values.

2013-06-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Accept ssl_certs value for
	report_section parameter.

	* src/html/omp.xsl (get_report_ssl_certs_response, report [ssl_certs]):
	New template.
	(gsa:report-section-title): Add ssl certificates section title.
	(report [section-list]): Add ssl certificates report section.

2013-06-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Add response indicators for
	get_trash/delete_tag_response, new_tag/create_tag_response,
	new_tag/gsad_msg.

	* src/html/omp.xsl (get_tags): Add template call: modify_tag_response.
	(get_tag): Add template calls: delete_tag_response, modify_tag_response,
	create_tag_response.
	(delete_tag_response): New template.

2013-06-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_permission_omp): Remove RESOURCE/TYPE from
	MODIFY_PERMISSION.

	* src/html/omp.xsl (html-edit-permission-form): Remove Resource Type
	field.  Given by permission name now.

2013-06-10  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (dfn_cert_adv-details): Fix condition for displaying
	summary as missing.

2013-06-10  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl: Rename xslt keys kReportPorts, kVulnsHosts,
	kReportVulns, kReportOs, kReportApps, kReportProgApps to match common
	variable naming style.

2013-06-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_permission_omp): Remove RESOURCE/TYPE from
	CREATE_PERMISSION.

	* src/html/omp.xsl (html-create-permission-form): Get the names from the
	help response.  Add a role radio to the subject field.  Remove Resource
	Type field.

2013-06-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Loosen permission validation.

	* src/html/omp.xsl (html-edit-permission-form): Get the names from the
	help response.  Add a role radio to the subject field.

2013-06-06  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (result [result-header]): Adjust prognostic variable
	check to work correctly when no value is passed.

2013-06-06  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (result [details]): Adjust result linking for delta
	results. Fix used filter term. Style update.

2013-06-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (user [details]): Call minor-details, so that UUID
	and times appear.

2013-06-06  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [fold-filter-icon]): Use filter value from
	returned report response instead of user provided parameter.
	(report [result-details-icon]): Fix link title. Use report's filter
	term instead of user provided parameter.
	(result [result-body]): Add result_section for different lines part in
	delta report.
	(report [filterbox]): Remove term. Adjust filter parameter.

2013-06-05  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [section-link]): Remove name argument. Add
	count argument. Determine name from section title, type and count.
	(report [section-list]): Adjust section-link calls adequately.

2013-06-05  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [fold-filter-icon])
	(report [result-details-icon): Handle delta report cases.
	(report [results]): Add report section list for delta reports.
	(gsa:report-section-title): Add section list entries for delta reports.
	(report [section-link], report [section-list]): Add cases for delta
	reports.
	(report [section-filter]): Check for delta report type with report
	element attribute instead of child element.

2013-06-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [result-pager], report [section-links]): Use
	full result count for total value.
	(result [result-header]): Hide empty actions column in prognostic report
	case.
	(report [prognostic_apps]): Iterate over apps from results to show only
	apps that has a higher than zero severity.

2013-06-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_alerts): Match delete_alert_response too.
	(describe_cert_response): Correct operation name.

2013-06-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_task): Get delta report from delta_report_id
	instead of report_id, becase delta_id might be passed by other actions
	like Delete.

	* src/html/omp.xsl (report): Send delta report in delta_report_id.

2013-06-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [fold-filter-icon], report [filterbox])
	(report [result-details-icon, host): Use pos value from envelope params
	rather than returned in host detail.
	(gsa:report-section-title, report [section-link], report [section-list])
	(report [section-filter]): Adjust to include report hosts section for
	prognostic case.
	(get_report_hosts_response): Handle prognostic report case.
	(report [prognostic_hosts]): New template.
	(report [prognostic_apps]): Fix total. Iterate over apps from host
	details rather than results to include apps with 0 occurences.

2013-06-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [section-link], report [result-details-icon])
	(report [fold-filter-icon]): Use host value from params in prognostic
	case.

2013-06-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [section-list], gsa:report-section-title):
	Allow Applications for prognostic reports.
	(get_report_apps_response): Add call for prognostic_apps template.
	(report [apps]): Fix typo in used key name.
	(report [prognostic_apps]): New template.

2013-05-31  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Validate port_manual parameter as a
	number.

	* src/gsad_omp.c (create_note_omp, create_override_omp): Clean code.
	Validate parameters accordingly.

2013-05-30  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_report_section): Add check for report type.

	* src/html/omp.xsl (report [results-filter]): Remove template.
	(report [section-filter]): Clean code. Add support for prognostic
	report. Adapt for Report results case.
	(report [results]): Adequately Call report section-filter instead of
	removed results-fiter.
	(gsa:report-section-title): Add prognostic results and summary.
	(report [section-link): Add type parameter. Output adequate report
	section link depending on report type.
	(report [section-link]): Adjust for prognostic report.
	(get_report_summary_response): Add prognostic report summary.
	(report [summary]): Adjust for prognostic report.

2013-05-30  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (gsa:report-section-title): New function.
	(report [results], report [summary], report [hosts], report [ports])
	(report [vulns], report [os], report [errors], report [topology])
	(report [closed_cves], report [apps]): Remove unneeded title parameter
	from section-list template call.
	(report [section-list]): Determine title and section names with
	report-section-title function call.

2013-05-30  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [filterbox]): Adjust for prognostic reports.
	Remove dead code and add necessary parameters.
	(report [result-body]): Refactor code.
	(report [results-filter]): New template.
	(result-detailed): Fix result-body template call.

2013-05-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (fold-filter-icon-img): New template.
	(report [fold-filter-icon]): Update to correctly support prognostic
	report type.
	(report [results-details-icon]): Match title depending on current
	details mode.
	(report [results]): Apply fold-filter-icon on child report.

2013-05-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (results-details-icon-img): New template.
	(report [results-details-icon]): Update to correctly support prognostic
	report type.
	(report [results]): Add check for report type before calling
	report section-list.

2013-05-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/gsa-style.css: Update report_section_list style.

	* src/html/omp.xsl (report [section-list]): Add total counts for the
	report sections list entries.

2013-05-28  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/gsa-style.css: Add css for section_list_first id.

	* src/html/omp.xsl (report [section-list]): Set first entry as
	section_list_first.
	(report [topology): Update for new section-list template.

2013-05-28  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/gsa-style.css: Add style for report_section_list ID.

	* src/html/omp.xsl (results-pager): Refactor code to use
	report-section-pager.
	(report [results], report [hosts], report [ports], report [vulns])
	(report [os], report [apps], report [closed_cves], report [errors])
	(report [summary]): Update for section-list
	(report [section-list]): Update code to fit in upper window part.
	(report-section-pager): Add start and filtered parameters.
	(report-help-icon): Update style.

2013-05-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator): Add "topology" as valid value for
	"report_section".

	* src/gsad_omp.c (get_report_section): Add report formats to response
	if report_section param is "topology".

	* src/html/omp.xsl (report [section-list]): Add Topology entry.
	(report-section-pager): Hide "total:" if param is missing/empty.
	(get_report_topology_response, report [topology]): New templates to
	show network topology graph for a report.
	(report-image): New template to embed a get_report as an image.

2013-05-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [section-list]): Migrate report section menu
	to use the same style as the gsa navigation menu.

	* src/html/gsa-style.xsl: Remove css styles for report section lists.

2013-05-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/help.xsl (severity-settings-name, severity-settings-list):
	Update severity classes names to match those in documentation.

2013-05-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (my_settings.html): Improved documentation for Severity

2013-05-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/help.xsl (my_settings.html): Add documentation for Severity
	class.

2013-05-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (host, result [result-header], report [vulns])
	(report [os-severity], report [unknown-os-severity])
	(report [app-severity], report [errors]): Use cvss-risk-factor to match
	the provided cvss' severity level depending on user severity class
	setting instead of using fixed threat values.

2013-05-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/cpe, src/html/img/cpe/a:apache:http_server.png,
	src/html/img/cpe/a:postgresql:postgresql.png,
	src/html/img/cpe/a:openbsd:openssh.png,
	src/html/img/cpe/a:mysql:mysql.png, src/html/img/cpe/a:php:php.png:
	New.

	* CMakeLists.txt: Install new app icons.

2013-05-24  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (report [summary]): Removed third line with filtered
	results of current page. This does not make sense here anymore because
	results are not visible on this page. Also, it is rarely used
	and finally with the new filter features it is possible to limit
	the number of results already directly via the powerfilter.
	Simplified the naming of the filtered report.

2013-05-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (cvss-risk-factor): Apply ranges based on user
	severity settings.

2013-05-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (user_set_severity): New function.
	(exec_omp_post): Set user severity class after saving omp settings.

	* src/gsad_omp.c (save_my_settings_omp): Add severity parameter.

	* src/gsad_omp.h: Adjust header accordingly.

	* src/html/omp.xsl (severity): New template.

2013-05-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (struct user): Add severity variable.
	(user_add): Add severity class parameter. Set user severity.
	(exec_omp_post, request_handler): Ditto.

	* src/gsad_base.h (struct credentials_t): Add severity variable.

	* src/gsad_omp.c (xsl_transform_omp): Send user severity class within
	envelope.
	(authenticate_omp): Add parameter for severity class. Adjust
	omp_authenticate_info call.

	* src/gsad_omp.h: Adjust authenticate_omp prototype.

2013-05-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (edit_port_list): Match operation responses.
	(modify_port_list_response): New template.

	* src/html/gsad.xsl (html-gsa-logo): Apply icons for Edit Port List.

2013-05-23  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (report [apps]): Add filter parameters to result
	links to ensure that detection log entries aren't hidden when
	navigating to next results page.

2013-05-23  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (report [apps]): Add links from occurence counts to
	results containing the application CPEs.

2013-05-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Validate severity_class parameter too.

	* src/gsad_omp.c (save_my_settings_omp): Send severity class value.

	* src/html/omp.xsl (severity-settings-list, severity-settings-name): New
	templates.
	(get_my_settings, edit_my_settings): Add row for Severity Class setting.
	(edit_my_settings): Readjust table rows classes.

2013-05-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [hosts], report [ports], report [vulns])
	(report [os], report [apps], report [closed_cves], report [errors]): Use
	count element instead of total attribute.

2013-05-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [errors]): Add nvt severity bar.

2013-05-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [errors]): Use errors total value. Count
	number of errors in current error set.

2013-05-22  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/gsa-style.css: Add styling for report section list and links.

	* src/html/omp.xsl (report [results], report [hosts], report [ports])
	(report [vulns], report [os], report [apps], report [vulns])
	(report [summary], report [errors], report [closed_cves]): Use
	section-list instead of section-selector.
	(report [section-selector]): Remove template.
	(report [section-link], report [section-list]): New templates.
	(report [apps]): Refactor code to use report-section-pager.

2013-05-22  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [vulns]): Count vuln hosts value based on
	both host and nvt oid values.

2013-05-22  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (create_permission_omp): Remove set but unused
	users variable.

2013-05-22  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (info/dfn_cert_adv, html-dfn_cert_adv-table): Add
	max_cvss column.
	(dfn_cert_adv-details): Add max_cvss entry.

	* src/html/help.xsl (dfn_cert_advs.html): Add text for max_cvss.

2013-05-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_permission_omp): Correct comment.

2013-05-21  Matthew Mundell <matthew.mundell@greenbone.net>

	Add New Permission page.

	* src/gsad.c (init_validator, exec_omp_post, exec_omp_get): Add
	permission creating commands.

	* src/gsad_omp.c (new_permission, new_permission_omp): New functions.
	(CHECK): New macro.
	(create_permission_omp): New function.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/omp.xsl (list-window): Enable new icon on Permissions page.
	(create_permission_response, html-create-permission-form)
	(new_permission): New templates.

2013-05-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.c (report [section-selector]): Add Error Messages entry.
	(get_report_errors_response, report [errors]): New templates.

	* src/gsad.c (init_validator): validate Error Message report_section
	value.

2013-05-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator): Add "apps" to values for report_section.

	* src/html/omp.c (report [section-selector]): Add option for Apps.
	(get_report_apps_response, report [apps]): New templates for apps
	detected in a report.
	(report [app-severity]): New severity bar template for apps.

2013-05-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (cve-details): Fix table class.
	(report [closed_cves]): Add NVT Severity column. Add hostname to host
	column when available. Split CVEs provided by the same NVT entry over
	multiple columns.

2013-05-21  Michael Wiegand <michael.wiegand@greenbone.net>

	* gsad.c (file_content_response): Free result of xsl_transform
	consistently once it is no longer needed.
	(main): Free GOptionContext after use.

2013-05-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (report [unknown-os-severity], report [os-severity]):
	Removed CVSS, use just "None". This makes the appearance nicer. Before
	it is shown as "0(None)".

2013-05-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (next_page): Add get_permission.

2013-05-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (permission [details]): Remove login from subject
	link, as users have IDs now.

2013-05-20  Matthew Mundell <matthew.mundell@greenbone.net>

	Add permission editing.

	* src/gsad.c (init_validator): Add permission edit commands and rules.
	(exec_omp_get): Add permission edit commands.

	* src/gsad_omp.c (edit_permission, edit_permission_omp): New functions.
	(CHECK): New macro.
	(save_permission_omp): New function.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/gsad.xsl (modify_permission_response): New template.
	(html-gsa-logo): Match permission edit indicator icons.

	* src/html/omp.xsl (permission): Enable edit icon.
	(modify_permission_response, html-edit-permission-form)
	(edit_permission): New template.

2013-05-20  Michael Wiegand <michael.wiegand@greenbone.net>

	Make sure gsad is properly linked to libgcrypt.

	* CMakeLists.txt: Add libgcrypt detection and retrieve linker and
	compiler flags using libgcrypt-config.

	* src/CMakeLists.txt: Use detected flags when compiling and linking
	the gsad binary.

2013-05-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (host): Merge threat and cvss columns as severity
	column. Use severity bar for highest severity value in prognosis column.

2013-05-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report-section-pager): New template.
	(report [hosts], report [ports], report [vulns], report [os])
	(report [closed_cves]): Refactor code to use new template.

2013-05-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/os.xml: Add entries for Greenbone OS versions 2.0, 2.1 and
	2.2.

2013-05-17  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (gsa:host-has-unknown-os): New function.
	(report [os]): Add "Unknown" Operating System to regroup hosts with no
	OS. Adjust table layout and make necessary filtered and total counting
	changes. Refactor code.
	(unknown-os-severity): New template.
	(os-severity): Add default severity-bar for Operating Systems with no
	results.

2013-05-17  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [filterbox]): Fix Overrides checkbox check.
	(gsa:report-host-has-os): Check by cpe instead of txt.
	(os-icon): Add img-style and os-name parameters.
	(report [os]): Remove Icon column. Add icon in first column.
	Fix number of Occurences count for hosts with similar details but
	different best os. Print threat in severity bar.

2013-05-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_feed_omp, get_scap_omp, get_cert_omp)
	(sync_feed_omp, sync_scap_omp, sync_cert_omp): Remove tracing, for
	consistency.

2013-05-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_lsc_credential_omp): Correct cmd in backurls.

2013-05-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_target_omp): Call next_page instead of calling
	handlers manually.

2013-05-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_task_omp, save_lsc_credential_omp)
	(save_agent_omp, toggle_tag_omp): Replace error message with default next
	page, in case the user crafts the URL by hand.

2013-05-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_port_range_omp, save_port_list)
	(save_user_omp): Add default next page in case the user crafts the URL
	by hand.
	(save_filter_omp): Call next_page instead of calling handlers manually.

2013-05-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_slave_omp, save_report_format_omp)
	(save_group_omp): Add default next page in case the user crafts the URL
	by hand.

2013-05-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_config_family_omp): Add missing param checks.

2013-05-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_tag_omp, save_tag_omp): Group CHECKs together,
	like it's done in all the other functions.

2013-05-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_alert, save_alert_omp, clone_omp): Add a default
	for next, in case the user crafts the URL by hand.

2013-05-16  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (gsa:report-host-has-os): New function.
	(report [os]): Add OS Severity bar.
	(report [os-severity]): New template.

2013-05-16  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [vulns]): Sort vulnerabilities by threat
	descendingly and link number of vulnerability occurences to their
	matching results.

2013-05-16  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Allow Operating Systems report section.

	* src/html/omp.xsl (report [section-selector]): Add OS section.
	(report [vulns]): Fix column name.
	(get_report_os_response, report [os]): New templates.

2013-05-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/disable.png, src/html/img/enable.png: Updated.

2013-05-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (dowload_agent_omp, send_alert_method_data): Clean
	indenting.

2013-05-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (next_page): Pass params instead of oid to get_nvts, so
	that parameter checking is done.
	(get_nvts): Replace oid param with params param.  Get OID from params
	and check that it.
	(get_nvts_omp): Remove OID check and update call.

2013-05-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (REQUIRE): Remove.  Out of use.
	(get_report_section): Add default for report_section, in case user
	crafts URL by hand.  Inline REQUIRE, as it is only used here.

2013-05-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_filter_omp): Set valid field in filt_id param
	so that it ends up in the XML, so that the icons on the GET pages have
	the right filtering in their URLs.

2013-05-15  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Allow vulns report section.

	* src/html/omp.xsl (report [section-selector]): Add Vulnerabilities
	section.
	(get_report_vulns_response, report [vulns]): New templates.

2013-05-15  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* CMakeLists.txt: Install new disable / enable icons.

	* src/html/img/disable.png, src/html/img/enable.png: New preliminary
	icons for disable / enable actions.

	* src/html/omp.xsl (toggle-tag-icon): Change enable and disable
	icon file names.

	* src/html/help.xsl (list-window-line-actions):  Change enable and
	disable icon file names.

2013-05-15  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/gsa-style.css: Add css classes result_header_right and
	result_header_left.

	* src/html/omp.xsl (report [result-pager], report [hosts])
	(report [ports], report [closed_cves]): Output content elements count
	consistently across different report sections.
	(result-header): Add left and right border lines when outputing result
	details.
	(result-body): Add space at the end of result details to make separation
	between different results clearer.

2013-05-15  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [hosts], report [ports])
	(report [closed_cves]): Change count to output "0 - 0" instead of "0"
	when there are no elements.

2013-05-15  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (info/ovaldef): Add columns CVEs and Max CVSS and
	adjust title row width accordingly.
	(html-ovaldef-table): Add column headers CVEs and Max CVSS.
	(ovaldef-details): Add items "Referenced CVEs" and "Maximum CVSS".

	* src/html/help.xsl (ovaldefs.html): Add columns CVEs and Max CVSS.

2013-05-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_my_settings): Adjust row background for new row.

2013-05-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_my_settings, edit_my_settings): Add Roles Filter.

2013-05-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_my_settings, edit_my_settings): Capitalise
	"filter" in setting names, to match names used in OMP.

2013-05-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_user): Get roles for dropdown.

	* src/html/omp.xsl (user [edit]): Get roles from OMP.  Add + button for
	multiple roles.

2013-05-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_user_omp): Use user ID instead of name to
	identify user in MODIFY_USER.

2013-05-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_container_task_omp): Free format.

2013-05-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task [details], html-edit-task-form): Correct help
	links.

	* src/html/help.xsl (task_details.html): Remove tasksummary anchor.  Add
	Import Report section.
	(config_details.html, config_editor.html): Correct text about task
	details link.

2013-05-13  Timo Pollmeier  <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (save_container_task_omp): Add elements for observer
	groups and groups plus button.

2013-05-13  Timo Pollmeier  <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (edit_my_settings): Select correct setting from
	get_settings_response for CVE filter.

2013-05-13  Timo Pollmeier  <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (get_tags_response, get_settings_response): New
	empty templates.

2013-05-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (user-tags-window): Add spacing before tags window,
	at least to match spacing on Task Details page.  Capitalise text in
	tooltip, to match other cases.

	* src/html/help.xsl (user-tags.html): Switch to new icon.

2013-05-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (list-window): Match rowspan check for Actions header
	to the check used for the other headers, so that the bottom of the
	Actions header lines up with the others.

2013-05-10  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (result [result-header]): Always use severity-bar for
	consistency.

2013-05-10  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_report): Set error to 1 in XML report plugin too.

2013-05-10  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [hosts], report [closed_cves]): Add table
	rows classes.

2013-05-10  Timo Pollmeier  <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator): Make parentheses and "&amp;" valid for
	info_id.

	* src/html/omp.xsl (get_info_cpe_lnk): Escape ampersands as &amp; in and
	encode parameters info_name and info_id.
	(cpe-details): Get NVD ID from nvd_id element instead of id attribute.

2013-05-10  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [hosts], report [ports])
	(report [closed_cves]): Show current count of objects even when zero.

	* src/html/gsa-style.css: Remove margin and padding from results
	overrides and notes for consistency with other table elements.

2013-05-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (user): Add filter params to delete icon.

2013-05-09  Matthew Mundell <matthew.mundell@greenbone.net>

	Enable multiple roles per user.

	* src/gsad.c (init_validator): Add roles rules.
	(params_append_mhd): Add role_id_optional collection case.

	* src/gsad_omp.c (new_user): Get roles for dropdown.
	(create_user_omp, save_user_omp): Add role + button handling.  Cater for
	multiple roles per user.

	* src/html/omp.xsl (role [newuser], new-user-role-select): New
	templates.
	(html-create-user-form): Get roles from XML.  Add + button.
	(html-users-table, user [details]): Make role headings plural.

2013-05-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task): Add observer roles to tooltip.
	(html-users-table): Switch to list-window, so that the filter dialog
	appears.

2013-05-09  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [hosts], report [ports])
	(report [closed_cves]): Only output filtered values range when there is
	at least one value.

2013-05-09  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_many): Replace g_strcasecmp call as it is
	deprecated and gives compiler warning.

2013-05-08  Matthew Mundell <matthew.mundell@greenbone.net>

	Add exporting of roles.

	* src/gsad.c (init_validator, exec_omp_get): Add export commands.

	* src/gsad_omp.c (export_role_omp, export_roles_omp): New functions.

	* src/gsad_omp.h: Add headers accordingly.

2013-05-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (user, user [details]): Link role to Role Details.

2013-05-08  Matthew Mundell <matthew.mundell@greenbone.net>

	Add Roles and Role Details pages.

	* src/gsad.c (init_validator): Add roles commands.  Add roles to types.
	Add role_id.
	(exec_omp_get): Add roles commands.

	* src/gsad_omp.c (next_page): Add new roles pages.
	(get_role, get_role_omp, get_roles, get_roles_omp): New functions.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/gsad.xsl (html-gsa-logo): Add create_filter response icon for
	get_roles page.
	(html-gsa-navigation): Add Roles menu item.
	(role): Add envelope to because the standard macros expect the role
	template to be for the list window row.

	* src/html/omp.xsl (list-window): Skip new icon for roles, for now.
	(roles, role, role [trash], role [details], html-roles-trash-table)
	(html-roles-table, get_role, get_roles): New templates.

2013-05-08  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (report): Use fold/unfold icons for
	expanding/collapsing result details.

2013-05-08  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (report): Make range title consistent although static here
	in order to have a consistent appearance with the results section.

2013-05-08  Timo Pollmeier  <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (get_report): Hide User Tags on Hosts page.

2013-05-08  Timo Pollmeier  <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (result[result-header], result[result-body]): Move
	result Tags from result-header to result-body.

2013-05-08  Timo Pollmeier  <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_one, get_many, get_nvts, get_task, get_report)
	(get_result, get_note, get_override): Add distinct tag names on
	details pages.

	* src/html/help.xsl (contents.html): Add entry for User Tags list.
	(user-tags.html): New template for User Tags list help on details pages.

	* src/html/omp.xsl (user-tags-window): Add parameter tag_names.
	Change "Add Tag" alt text of window top icon to "New Tag".
	Change help reference to new user-tags.html. Add mini form for adding
	tags.
	(task [details], cve-details, cpe-details, ovaldef-details)
	(dfn_cert_adv-details, get_nvts, note [details], override [details])
	(get_report, result-details): Add tag_names parameter to
	user-tags-window call.

2013-05-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (send_settings_filters): Encode values before sending
	them.
	(save_my_settings_omp): Remove double free calls.

2013-05-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [hosts], report [ports])
	(report [closed_cves]): Add count of filtered and total number next to
	page header.
	(report [closed_cves]): Loop directly over closed cve details.

2013-05-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/gsa-style.css: Remove unused actionbar class. Add
	result_section and result_section_top classes.

	* src/html/omp.xsl (result [result-body]): Style updates. Add div
	elements with adequate classes around result sections. Adjust html code
	adequately.

2013-05-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (show-details-icon): Rename to result-details-icon.
	Rename icons tooltips.
	(report [results]): Adjust section-selector wrapper. Remove
	show-details-icon template call. Add whitespace after powerfilter.
	(gsa:table-row-class): No class when position below zero.
	(result-header): Add collapse-details-button parameter. Add collapse
	details icon in vulnerability column header. Fix Actions column width.
	Add alternating background colour for second row. Link to result details
	from vulnerability name. Rearrange notes and overrides buttons for
	consistency.
	(result-detailed): Add collapse-details-button and result-body
	parameters.
	(report [report-sections]: Rename to section-selector. Include wrapper
	html code in template to remove duplicate code by caller.
	(report [hosts], report [ports], report [closed_cves])
	(report [summary]): Remove report-sections wrapper code.
	(report [details]): Adjust result-detailed template call.

2013-05-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [filterbox]): Add details hidden parameter.

2013-05-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [fold-filter-icon])
	(report [show-details-icon], report [results]): Reduce left and right
	margins on various elements by one pixel.

2013-05-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [show-details-icon]): New template.
	(report [result-header]): Add first-row parameter.
	(report-summary-sorting-link): Rename template to report [sorting-link].
	Adjust code accordingly.
	(report-summary-sorting): Rename template to report [sorting]. Adjust
	code accordingly.
	(report [fold-filter-icon]): Fix links.
	(report [results]): Adjust changed templates calls. Add outer details
	table for report details.
	(result [result-detailed]): Add show-header parameter. Check details and
	cmd parameter for result details outputing.
	(report [details]): Output all report results in a single table instead
	of per-host tables.

2013-05-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [fold-filter-icon]): New template.
	(report [filterbox]): Refactor code into fold-filter-icon template.
	(report [results]): Call fold-filter-icon template. Move down report
	filterbox.

2013-05-07  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/fold.png, src/html/img/unfold.png: Improved versions
	of the icons.

2013-05-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/fold.png, src/html/img/unfold.png: New.

	* CMakeLists.txt: Install the two new icons.

	* src/html/omp.xsl (report): Use the new icons instead of the
	temporary ones.

2013-05-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (get_result): Make task_id optional, add "details"
	parameter to OMP command.

	* src/html/omp.c (tagged_resource_link): Remove extra case for result.
	(result-details): Add alternative values for task_id, task_name in case
	they are (null), getting the data directly from the result element.
	Add variables report_id, report_result_id, set to parameters with same
	name from envelope if available. Use report_id element and id attribute
	from result otherwise.

2013-05-06  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Validate filterbox parameter.

	* src/html/omp.xsl (report [filterbox]): New template. Refactored code
	from report results template. Add fold/unfold filterbox code.
	(report [results]): Refactor code. Apply filterbox template.
	(report [section-filter]): Remove default section value.

2013-05-06  Matthew Mundell <matthew.mundell@greenbone.net>

	Remove leftover OAP files.

	* CMakeLists.txt (FILES): Remove oap.xsl.

	* src/CMakeLists.txt: Remove OAP files.

	* src/gsad_oap.c, src/gsad_oap.h: Remove.

2013-05-06  Matthew Mundell <matthew.mundell@greenbone.net>

	Remove remains of OAP support.

	* src/gsad.c (DEFAULT_OPENVAS_ADMINISTRATOR_PORT): Remove.
	(init_validator): Remove settings commands.
	(ELSE_OAP): Remove.
	(exec_omp_post, exec_omp_get): Remove settings commands.
	(request_handler): Remove /oap support.
	(main): Remove --alisten and --aport.  Remove OAP init.

	* src/html/gsad.xsl: Remove oap.xsl include.
	(html-gsa-logo): Remove settings indicator icons.
	(html-gsa-navigation): Switch URLs to omp.  Remove Settings item.

	* src/html/omp.xsl (describe_feed_response, html-feed-form)
	(sync_feed_response, describe_scap_response, html-scap-form)
	(sync_scap_response, describe_cert_response, html-cert-form)
	(sync_cert_response): New templates.  From oap.xsl.

	* src/html/oap.xsl: Remove.

2013-05-06  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (result-header): Add filtering option to show
	results overrides.

2013-05-06  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (result-header): Remove gbntable2 class from second
	row.

2013-05-06  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-create-note-form, html-edit-note-form)
	(html-create-override-form, html-edit-override-form, result [details])
	(report [details]): Remove result-detailed template div wrapper.
	(result-header): Use css classes instead of inline styling.
	(result-body): Remove issue_box_box divs.

	* src/html/gsa-style.css: Remove unused issue_box_* css classes. Keep
	top border for note and override boxes.

2013-05-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host): Add missing app variable.

2013-05-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator): Add "result" to
	attach_type, resource_type, optional_resource_type.

	* src/html/omp.xsl (user_tag_list): New template for inline listing of
	user tags.
	(tagged_resource_link): Don't link to results.
	(tag_attach_types): Add option "Result".
	(get_report): Add user tags window.
	(note-detailed): Replace hardcoded user tags list with template call.
	(override-detailed, result [result-header]): Add tags list.

2013-05-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report-hosts-link, report-ports-link): New
	templates.
	(report [hosts]): Fix ports number count. Refactor code in new
	templates.

2013-05-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (gsa:date-diff): New function.
	(report [summary]): Remove order by results row. Add scan duration row.

2013-05-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (result [result-header]): Add hostname next to IP
	address when available.

2013-05-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Describe and sync feeds via OMP instead of OAP.

	* src/gsad.c (exec_omp_post): Switch commands to OMP.

	* src/gsad_oap.c (get_feed_oap, get_scap_oap, get_cert_oap)
	(sync_feed_oap, sync_scap_oap, sync_cert_oap): Remove.  Replaced by OMP
	equivalents.

	* src/gsad_omp.c (get_feed_omp, get_scap_omp, get_cert_omp)
	(sync_feed_omp, sync_scap_omp, sync_cert_omp): Remove.  OMP equivalents
	of remove OAP versions.

	* src/gsad_oap.h, src/gsad_omp.h: Update headers accordingly.

2013-05-02  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report [result-pager]): New template.
	(html-report-details): Rename for consistency into report [results].
	Refactor code into report result-pager template.
	(get_reports_response): Call report [results] template.

2013-05-02  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Fix port parameter regex to allow
	returned port names values.

2013-05-02  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl: Clean code. Replace code to calculate table row
	class in all templates with gsa:table-row-class.

2013-05-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Make hosts_opt max length 2000 like
	hosts.  80 was much too short.

	* src/html/omp.xsl (html-create-user-form, user [edit]): Make length
	2000 to match validator.

2013-05-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_resource, edit_task): Add default for parameter
	"next", in case user crafts URL by hand.
	(save_container_task_omp): Remove old sort params.  Add default for
	"next".
	(get_task): Remove duplicate task_id check.
	(create_tag_omp): Remove NULL check on params.  This is already done in
	the CHECK macro calls.
	(edit_target, save_target_omp): Add default for "next".

2013-05-02  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c: Add get_report_section header.
	(next_page): Handle get_report_section case.
	(get_report_section): Add argument for extra_xml.
	(get_report_section_omp): Adapt for get_report_section interface change.

	* src/html/omp.xsl (report [section-filter]): Fix create filter form
	parameters.

2013-05-02  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report-section-filter): Match report as
	section-filter mode. Remove report parameter.
	(report [hosts], report [ports], report [closed_cves])
	(report [summary]): Adjust section-filter template call.

2013-05-02  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (user-tags-window): Change Icon for "Add Tag" to
	"new.png".

2013-05-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_result): Make the command params optional, in case
	the user crafts the URL by hand.

2013-04-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (user_find): Add token bad or missing return.
	(request_handler): For GET requests, serve the login page when the token
	is bad or missing.

2013-04-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-user-form): Correct name in comment.
	(user [edit]): Add dummy input to force Save button to be default.

2013-04-30  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-create-note-form, html-edit-note-form)
	(html-create-override-form, html-edit-override-form, result [details])
	(get_reports_response/report/report [details]): Add div and table around
	result-detailed call.
	(result [result-header]): Don't fix table cells sizes.
	(result [result-body]): Include content as part of global result table
	and adjust accordingly.
	(result-detailed [detailed]): Let caller adjust surrounding div and table.

	* src/html/gsa-style.css: Add issue_box_all, remove issue_box_head and
	clean issue_box_box classes.

2013-04-30  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (result [result-header]): Remove extra line break.

2013-04-30  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (result [result-body]): New template.
	(result-detailed [details]): Refactor code into result-body template.

	* src/html/gsa-style.css: Remove unused .issue_box_head a. Tweak coloring.

2013-04-30  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (save_alert_omp): Don't send next element.

2013-04-30  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (tagged_resource_link, tag, tag [details]): Rename
	  res_type to resource_type,res_id to resource_id, res_name to
	  resource_name for consistency.

2013-04-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Set rows in filter for GET_FILTERS to get
	all rows, otherwise Rows Per Page is used.

2013-04-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [summary]): Add a "Scan initiated" field and
	highlight this instead of "Scan started" because this is what the Tasks
	and Task Details page are using.  This is the time that the report was
	created in the database.  The scan will start later.  Theoretically with
	scheduling the scan could start much later, like days later.

2013-04-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (result-header): Style update. Fix width for table
	columns and align actions to the left.

2013-04-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (tag [details], note-detailed): Remove quotes around
	tag values to match filter syntax.

2013-04-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (get_my_settings): Fix class attributes of table rows
	for alternating background colors

2013-04-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (new_tag, edit_tag): Remove passthrough of next page
	and filter parameters.

	* src/html/omp.xsl (user-tags-window): Rename act_type to resource_type,
	act_type to resource_subtype, act_id to resource_id, act_next to next.
	Add default values for resource_id, next and user_tags.
	(tag mode=for_resource): Rename act_type to resource_type,
	act_type to resource_subtype, act_id to resource_id, act_next to next.
	(task mode=details, lsc_credential mode=details, agent mode=details)
	(alert mode=details, filter mode=details, target mode=details)
	(html-config-table, schedule mode=details, slave mode=details)
	(cve-details, cpe-details, ovaldef-details, dfn_cert_adv-details)
	(get_nvts, note mode=details, override mode=details, group mode=details)
	(permission mode=details, port_list mode=details)
	(report_format mode=details, user mode=details): Adjust to new
	user-tags-window parameters and remove parameters covered by new
	defaults.
	(html-create-tag-form, html-edit-tag-form): Get filter and next page
	parameters from /envelope/params.

2013-04-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/help.xsl (contents.html): Add items for tags (Tags, New Tag,
	Tag Details)

2013-04-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (result-header): New template.
	(result-detailed): Refactor code into result-header.

2013-04-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (cvss-threat, threat-max-cvss): Rename to
	cvss-risk-factor and risk-factor-max-cvss. Adapt values to match CR-42
	names and values.
	(severity-bar): Call cvss-risk-factor template. Match None threat value.
	(report [ports]): Match critical threat case too. Call
	risk-factor-max-cvss template.

2013-04-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/help.xsl (powerfilter.html): Add special keyword "tag" and
	two examples.

2013-04-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_report_section): Refactor code. Always use
	get_reports function instead of sending get_reports command.

	* src/html/omp.xsl (result-detailed [result, detailed]): Remove unused
	variable.
	(report [hosts], report [ports]): New templates.
	(get_report_hosts_response, get_report_ports_response): Move body to new
	report templates and apply them.
	(report [closed_cves]): Use one table for all hosts.

2013-04-26  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (result-detailed [result, detailed]): Use CVSS
	value only for severity bar.

2013-04-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_user): Remove init of extra that was clearing
	existing value.
	(save_user_omp): Set the source to "file" for the classic case.

2013-04-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Clear the credentials when allocating, at
	least so that the new language field is initialised.

2013-04-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator, exec_omp_post): Add command toggle_tag.

	* src/gsad_omp.c (toggle_tag_omp): New function for changing only the
	"active" status of a tag.

	* src/gsad_omp.h (toggle_tag_omp): New function prototype.

	* src/html/omp.xsl (user-tags-window): Remove width limit of actions
	column.
	(tag mode=for_resource, tag): Add toggle button.
	(tag_toggle_button): New template for disabling and enabling tags.

	* src/html/help.xsl (list-window-line-actions, tags.html): Add enabling
	and disabling of tags to actions.

2013-04-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator): Make attach_id accept empty values.

	* src/gsad_omp.c (new_tag): Change default attach_id to empty string.

	* src/html/help.xsl (new_tag.html): Change to make attach ID optional
	but require an existing ID if not empty.

	* src/html/omp.xsl (tag): Hide ID in brackets if it is empty.
	(html-create-tag-form): Add "(optional)" to "Attach to ID".
	(create_tag_response): New template.
	(edit_tag): Add apply_templates for modify_tag_response.
	(html-edit-tag-form): Add "(optional)" to "Attach to ID".

2013-04-24  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add table of user tags to most resource types. Output tags on notes in
	reports.

	* src/gsad.c (init_validator): Add NVT as resource_type and
	optional_resource_type. Add parameters next_id, next_type, next_subtype.

	* src/gsad_omp.c (): Add header for get_config, get_nvts.
	(next_page): Add handling of get_config, get_filter, get_nvts,
	get_target as values for parameter next.
	(new_tag): Add handling of parameter tag_name. Add handling of
	parameters next_type, next_subtype, next_id to get back to details pages
	after creating a new tag.
	(edit_tag): Add handling of parameters next_type, next_subtype, next_id
	to get back to details pages after editing a tag. Rename filtering
	limits element "tags" to "limits".
	(get_config): Add parameter extra_xml and include it in the response.
	(get_config_omp, edit_config_omp, save_config_omp): Adapt to new
	get_config parameter extra_xml

	* src/html/gsad.xsl (html-gsa-logo): Add tag action indicators (create,
	delete, edit) to details pages: get_task, get_config,
	get_lsc_credential, get_agent, get_alert, get_filter, get_group,
	get_info, get_note, get_nvts, get_override, get_permission,
	get_port_list, get_report, get_report_format, get_result, get_schedule,
	get_slave, get_target, get_user.

	* src/html/omp.xsl (user-tags-window, tag mode=for_resource): New
	templates for user tags sub-window.
	(task mode=details, lsc_credential mode=details, agent mode=details)
	(alert mode=details, filter mode=details, target mode=details)
	(html-config-table, schedule mode=details, slave mode=details)
	(cve-details, cpe-details, ovaldef-details, dfn_cert_adv-details)
	(get_nvts, note mode=details, override mode=details, group mode=details)
	(permission mode=details, port_list mode=details)
	(report_format mode=details, user mode=details): Add user tags window.
	(html-create-tag-form, html-edit-tag-form): Adjust to new next page
	parameters new page.
	(note-detailed): Output tags on notes in reports.
	(get_trash): Fix swapped anchors for tags and targets.

2013-04-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/po/de.xml: Shorted xml tag names from msgid to id
	and mststr to str.

	* src/html/gsad.xsl (gsa:i18n): Use shorter names in po file.

2013-04-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-report-details): Remove Closed CVEs table as it
	is now in its own section.

2013-04-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Add closed_cves value to report_section.

	* src/gsad_omp.c (get_report_section): Handle closed_cves report section
	case.

	* src/html/omp.xsl (html-report-details, report [summary])
	(get_report_hosts_response, get_report_ports_response): Use
	report-help-icon.
	(report-sections): Add closed cves choice.
	(report-help-icon, get_report_closed_cves_response)
	(report [closed_cves]): New templates.

2013-04-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Remove show_closed_cves parameter.

	* src/gsad_omp.c (get_report, get_result, get_result_omp)
	(get_result_page, new_note, new_override): Remove show_closed_cves
	parameter.

	* src/html/omp.xsl (report-summary-sorting-link, html-report-details)
	(report [summary]): Remove show_closed_cves parameter from urls and
	forms.
	(html-report-details): Remove show closed cves label.

2013-04-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (exec_omp_post): Handle alert_report with
	get_report_section_omp.

	* src/gsad_omp.c (get_report_section): Change variable name section to
	report_section.

	* src/html/omp.xsl (get_report_summary_response): Add report_section
	parameter to alert report forms.

2013-04-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Add results value to report_section.

	* src/gsad_omp.c (get_report_section): Make results the default section.
	Handle summary section.

	* src/html/omp.xsl (html-report-details): Remove summary section.
	(get_report_summary_response, report [summary]): New templates.
	(report-sections): Add and make default, the results section.

2013-04-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsad.xsl (gsa:i18n): Use normalize-space() for string comparison.

	* src/html/wizard.xsl: Mark string for i18n.

	* src/html/po/de.xml: Added translations for wizard.

2013-04-22  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_report): Remove dead code. Add error parameter to
	notify caller when an error occured. Let caller XSL transform the
	result.
	(get_report_omp): XSL transform result is no error occured.
	(next_page): Adapt get_report call.

2013-04-22  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c (gsad_init): Pass NULL to gcry_check_version to disable
	the internal version check of libgcrypt.

2013-04-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt: Install de.po.

2013-04-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Starting I18N support (Internationzation).

	* src/html/po: New. Direcory for translation files.

	* src/html/po/de.xml: New. Initial german translations.
	This initial set covers just a few strings.

	* src/html/gsad.xsl (gsa:i18n): New. Translates a string
	into the language of the browser prefrence. Only german
	supported in this initial version.
	Also applying this function to a couple of strings.

	* src/html/omp.xsl: Apply i18n to a single string for
	demonstration.

2013-04-20  Matthew Mundell <matthew.mundell@greenbone.net>

	Pass Accept-Language header to XSL in ENVELOPE/I18N.

	* src/gsad.c (request_handler): Add Accept-language to credentials.

	* src/gsad_base.c (credentials_t): Add language.

	* src/gsad_omp.c (xsl_transform_omp): Add I18N to ENVELOPE.

	* src/html/gsad.xsl (i18n): New template.

2013-04-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (get_report_ports_response): Add empty severity bar
	in no-threat case.

2013-04-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (severity-bar): Rename text prameter to extra_text
	for clarification. Don't add parenthesizes so that caller can define
	output format. Let notext define whether cvss is outputted or not.
	(result-detailed [result, detailed]): Add parenthesizes around threat.
	(get_report_ports_response): Add port threat value as extra text for
	severity bar.

2013-04-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (html-config-family-table): Take care that for
	prognostic report there is also a colored cvss bar.

2013-04-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report-summary-sorting)
	(report-summary-sorting-link): New templates.
	(html-report-details): Use newly added templates. Move filtering section
	into the Report Results window. Fix typo getting filter_id instead of
	filter from envelope.

2013-04-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (gsa:threat-max-cvss, gsa:table-row-class): New
	functions.
	(severity-bar): Add notext parameter.
	(get_report_ports_response): Change table style to output number of port
	related hosts only. Output threat as a colorized bar. Skip "general"
	ports.

2013-04-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-task-form): Select existing target and
	config in dropdowns.

2013-04-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (host-distance): New template.
	(get_report_hosts_response): Add Ports, Apps and Distance columns.
	Add adequate per-host and per-threat links for all table cells.
	(report [assets], get_report_hosts_response): Use host-distance
	template.

2013-04-17  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-report-details): Change title wording from
	Filtered to Report:. Remove security issues per host header. Remove back
	to summary link.

2013-04-17  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (get_report_hosts_response): Remove unneeded link for
	all levels case.

2013-04-17  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_report_page): Remove unused function.
	(get_report_section): Send filter and filt_id as part of get_report
	command.

	* src/html/omp.xsl (gsa:threat-color): New function.
	(html-report-details): Add filter and filt_id parameters to report
	section form.
	(report-section-filter): New template.
	(get_report_hosts_response, get_report_ports_response): Add filter and
	filt_id parameters to report section form. Add filter box.
	(get_report_ports_response): Add IANA column to ports table. Use
	adequate background color for threat column. Fix filter by host link.

2013-04-17  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (result-detailed): Take care that for prognostic
	report there is also a colored cvss bar.

2013-04-16  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (tagged_resource_link): New template for a
	arbitrary resource link.
	(html-tags-table): Change attach_id to attach_name in heading.
	(tag): Show name of attach resource instead of ID if available and
	link to resource.
	(tag mode=details): Add name with link to attach resource and
	"orphaned" row to tag details page.

	* src/html/help.xsl (tags.html, tag_details.html): Change description
	of table contents according to include new attach resource name and
	orphaned status.

2013-04-16  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (get_report_ports_response): Use a single table of
	ports rows with all hosts/threats matching them.

2013-04-16  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Add ports value to report_section
	parameter.

	* src/gsad_omp.c: Remove unused macro REQUIRE_PARAM
	(get_report_hosts): Rename into get_report_sections. Refactor code to be
	usable by requests for different report sections.
	(get_report_hosts_omp): Remove function.
	(get_report_section_omp): Call get_report_section.

	* src/gsad_omp.h: Remove get_report_hosts_omp declaration.

	* src/html/omp.xsl (report-sections): Add report ports entry.
	(get_report_ports_response): New template.
	(get_reports_response/report/report [details]): Remove host ports
	summary.

2013-04-15  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add Tags table, Tag details, Create Tag, Edit tag pages.

	* src/gsad.c (init_validator): Add commands create_tag, delete_tag,
	delete_trash_tag, edit_tag, export_tag, export_tags, get_tag, get_tags,
	new_tag, save_tag. Add parameter types attach_id, attach_type.
	Add Tag to parameter types resource_type and optional_resource_type.
	Add parameter types tag_id, tag_name, tag_value.
	(exec_omp_post): Add create_tag, delete_tag, delete_trash_tag, save_tag.
	(exec_omp_get): Add else if cases for new_tag, edit_tag, export_tag,
	export_tags, get_tag, get_tags.

	* src/gsad_omp.c (get_tag, get_tags): New function prototypes.
	(next_page): Add cases for get_tag, get_tags.
	(CHECK): new #define for checking tag creation parameters.
	(new_tag, new_tag_omp, create_tag): New functions for creating tags.
	(delete_tag_omp, delete_trash_tag_omp): New functions for deleting tags.
	(CHECK): new #define for checking tag editing parameters.
	(edit_tag, edit_tag_omp, save_tag_omp): New functions for editing tags.
	(export_tag_omp, export_tags_omp): New functions for exporting tags.
	(get_tag, get_tag_omp, get_tags, get_tags_omp): New functions to get
	information about tags.
	(get_trash): Add getting tags from trashcan.

	* src/gsad_omp.h (create_tag_omp, delete_tag_omp, delete_trash_tag_omp)
	(edit_tag_omp, export_tags_omp, export_tag_omp, get_tag_omp)
	(get_tags_omp, new_tag_omp, save_tag_omp): New function prototypes.

	* src/html/gsad.xsl (create_tag_response, delete_tag_response)
	(modify_tag_response): New indicator templates.
	(html-gsa-logo): Add tag response indicators for get_tag, get_tags
	and gsad_message.
	(html-gsa-navigation): Add Tags item to Configuration menu.

	* src/html/help.xsl (glossary.html): Add entry "Tag".
	(new_tag.html, tag_details.html, tags.html): New help pages for tag
	management functions.

	* src/html/omp.xsl (html-create-filter-form): Add option "Tag" to filter
	type selection.
	(get_tags, html-tags-table, tag): New templates for Tags table.
	(get_tag, tag mode=details): New templates for Tag details.
	(tag mode=trash): New template for Tags in trashcan.
	(tag_attach_types): New template for selection of attached resource
	types.
	(new_tag, html-create-tag-form): New templates for creation of new Tags.
	(edit_tag, html-edit-tag-form, modify_tag_response): New templates for
	editing tags.
	(html-tags-trash-table): New template for Tags trash table.
	(get_trash): Add response indicator and section for Tags.
	(get_my_settings): Add tags filter.

2013-04-15  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report-sections): New template.
	(html-report-details, get_report_hosts_response): Add dropdown menu to
	select report section. Remove overrides dropdown menu. Style update.

	* src/gsad.c (init_validator): Add get_report_section and remove
	get_report_hosts commands. Add report_section parameter.
	(exec_omp_get): Handle get_report_section. Remove get_report_hosts
	handler.

	* src/gsad_omp.c (get_report_section_omp): New function.

	* src/gsad_omp.h: Add get_report_section_omp header.

2013-04-15  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (get_report_hosts_response): Link total
	vulnerabilities values back to report summary with appropriate filter.

2013-04-15  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (get_report_hosts_response): Right align
	values in vulns columns. Change page title.

2013-04-15  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-report-details): Link to task directly on its
	name, instead of top right corner.

2013-04-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/tag.png: New.

	* CMakeLists.txt: Install new icon.

2013-04-12  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Add cmd value get_report_hosts.
	(exec_omp_get): Handle get_report_hosts command.
	(get_report_hosts, get_report_hosts_omp): New functions.

	* src/gsad_omp.h: Add get_report_hosts_omp prototype.

	* src/html/omp.xsl (html-report-details): Add button for Report Hosts.
	Don't apply report overview template.
	(get_report_hosts): New template for Report Hosts page.
	(get_reports_response/report/report [overview]): Remove template as
	duplicate.

2013-04-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (nvt, cve-details, cpe-details): Use CVSS bar instead
	of plain CVSS value.

2013-04-11  Matthew Mundell <matthew.mundell@greenbone.net>

	Allow editing of task config and target when the task is New.

	* src/gsad_omp.c (edit_task): Set filter when getting targets and
	configs, otherwise the defaults may cause too few rows.
	(save_task_omp): Add config and target to OMP request.

	* src/html/omp.xsl (html-edit-task-form): Enable config and target
	editing when the task is New.

2013-04-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (cvss_calculator, host): Use CVSS bar instead of plain CVSS value.

2013-04-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (filter-window-part): Set the value of the -- option
	in the filter dropdown to "--".  The is to differentiate it from the link
	in the menu.

	* src/gsad_omp.c (get_many): Check for a filt_id of "--", and use the
	system filter instead.

2013-04-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (severity-bar): Make threat parameter default to
	cvss-threat return value and title parameter to threat's value.
	(info/nvt, info/cpe, info/cve): Remove unneeded
	severity-bar argument values.

2013-04-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (cvss_calculator): Fix a typo.

2013-04-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/help.xsl (cvss_calculator.html): Fix typo.

	* src/html/omp.xsl (cvss-threat): New function. Returns cvss threat
	name for a given cvss score value.
	(severity-bar): Add scale parameter to adjust size of the bar.
	(info/cpe): Use cvss-threat function.
	(info/nvt, info/cve): Show a severity bar for the CVSS value.
	(cvss_calculator): Fix error message typo and result cell spacing.

2013-04-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (severity-bar): Add colons in subtitles. Align
	calculation results and detail invalid vector error message.

	* src/html/help.xsl (cvss_calculator.html): Add icon to Link to CVSS
	Calculator. Make example CVSS Vector an actual link to the calculator.

2013-04-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (severity-bar): Add text parameter to add text
	between parenthesizes.
	(info/cpe): Output max cvss value as a severity bar instead of simple
	text.
	(result-detailed): Add threat value as text argument for severity-bar
	call.

2013-04-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (cvss_calculator): Send back cvss metrics separately
	when a user uses a cvss vector.

	* src/html/help.xsl (cvss_calculator.html): Fix typo.

	* src/html/omp.xsl (cvss_calculator): Update page presentation for
	consistent positioning and size of metrics' dropdown menus. Remove table
	rows highlighting and fix error message.

2013-04-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (filter-window-part): Append a space to the filter
	string, to make it more convenient to add terms.

2013-04-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Use new style for modifying auth settings, so that next page works.

	* src/gsad.c (init_validator, exec_omp_post): Rename modify_auth to
	save_auth.

	* src/gsad_omp.c (save_auth_omp): New function.  Was modify_auth_omp.
	Rework to use new style.
	(modify_auth_omp): Remove.  Now save_auth_omp.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/gsad.xsl (modify_auth_response [response-indicator]): Rename
	from Save to Modify.
	(html-gsa-logo): Update save_auth indicator location.

	* src/html/omp.xsl (group [auth]): Rename modify_auth to save_auth.
	Add next to Save form.
	(modify_auth_response [show]): Rename Modify to Save.

2013-04-10  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (cvss_calculator): Check and return proper value when
	a bad cvss vector is provided.

	* src/html/omp.xsl (cvss_calculator): Add hidden input to distinguish
	between from metrics and from vector forms.

2013-04-10  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/help.xsl (contents.html): Add link to cvss calculator help
	page.
	(cvss_calculator.html): New template.

	* src/html/omp.xsl (cvss_calculator): Update presentation of the page.
	Add full names for metrics and their values.

2013-04-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Modify auth info via OMP instead of OAP.

	* src/gsad.c (exec_omp_post): Switch modify_auth to OMP.

	* src/gsad_oap.c (modify_auth_omp): Remove.  Replaced by OMP equivalent.

	* src/gsad_omp.c (modify_auth_omp): New function.  OMP equivalent of
	removed OAP version.

	* src/gsad_oap.h, src/gsad_omp.h: Update headers accordingly.

	* src/html/oap.xsl (group [auth], describe_auth_response)
	(modify_auth_response [show], describe_auth_response [show]): Remove.
	Now in omp.xsl.

	* src/html/oap.xsl (group [auth], describe_auth_response)
	(modify_auth_response [show], describe_auth_response [show]): New
	templates.  From oap.xsl.

2013-04-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_oap.c (get_settings_oap): Correct error messages.

2013-04-09  Matthew Mundell <matthew.mundell@greenbone.net>

	Move user XSL from oap.xsl to omp.xsl now that it's handled by OMP.

	* src/html/oap.xsl (group [newuser], new-user-group-select)
	(html-create-user-form, html-users-table, create_user_response)
	(new_user, delete_user_response, modify_user_response, user)
	(user [details], user [edit], edit_user, get_user, get_users): Remove.
	Now in omp.xsl.

	* src/html/omp.xsl (group [newuser], new-user-group-select)
	(html-create-user-form, html-users-table, create_user_response)
	(new_user, delete_user_response, modify_user_response, user)
	(user [details], user [edit], edit_user, get_user, get_users): New
	templates.  From oap.xsl.

2013-04-09  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Add CVSS Score calculator.

	* src/gsad.c (init_validator): Add cvss_calculator command. Add cvss_*
	parameters.
	(exec_omp_get): Handle cvss_calculator command.

	* src/gsad_omp.c: Include openvas/base/cvss.h
	(cvss_calculator): New function.

	* src/gsad_omp.h: Add cvss_calculator header.

	* src/html/gsad.xsl (html-gsa-navigation): Add CVSS Calculator Extras
	submenu entry.

	* src/html/omp.xsl (cvss_calculator): New template.

2013-04-09  Matthew Mundell <matthew.mundell@greenbone.net>

	Add groups to Edit User page.

	* src/gsad_omp.c (edit_resource): Append extra_xml inside the page
	element, as advertised in doc.
	(edit_user): Get groups for dropdown.
	(save_user_omp): Add + button handling.  Add groups to command.

	* src/html/gsad.xsl (html-gsa-logo): Add modify_user indicator on
	edit_user page for error indicator.

	* src/html/oap.xsl (user [edit]): Add Groups field.
	(edit_user): Match modify_user_response for error message.

2013-04-09  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad_omp.c (create_schedule_omp): Add timezone parameter.

	* src/html/omp.xsl (html-create-schedule-form): Add timezone field.

2013-04-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (gsa:date-tz): Add case for negative timezones.  If
	there's a problem return 'ERROR' instead of UTC.

2013-04-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Removing any support of IE6. This browser is highly unsecure for
	any purpose and supporting would encorage use of a unsecure
	browser for a security application.

	Meanwhile this browser should really not be used anywhere
	so even from convenience point of view the support of IE6
	is not necessary anymore.

	Basically the removal means to revert r7415.

	* src/html/gsad.xsl (html-head): Removed IE6 exception.

	* src/html/login/login.html: Removed IE6 exception.

	* src/html/gsa-style.css (.gsa-logo-header): Removed.

	* CMakeLists.txt: Removed handling of IE6fixes.css.

	* src/html/IE6fixes.css: Removed.

2013-04-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/oap.xsl (user [details]): Enable edit and export icons.
	(user [edit]): Switch to standard icons.  Remove old-style Users link.

2013-04-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_user, get_users, edit_user): Get DESCRIBE_AUTH
	response too, like the OAP version did.
	(get_users_omp): Remove comment about DESCRIBE_AUTH.

	* src/html/oap.xsl (get_users): Match auth templates, equivalent to the
	OAP version.

2013-04-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_user): Add DESCRIBE_AUTH call like Administrator
	version had.

	* src/html/oap.xsl (html-create-user-form): Use even for LDAP field.

2013-04-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Move user operation indicator icons
	into Manager section, updating paths.

2013-04-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (save_user_omp): Remove next variable as it is set but
	not used.

2013-04-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_user_omp): Update to newer style so that the
	generation of the following page is done by the appropriate handler
	instead of being done manually.  This also corrects the XSL error that
	was occuring on the Users page after creating the user.

2013-04-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/oap.xsl: Remove extra extension prefixes from last commit.

2013-04-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/oap.xsl: Add str prefix to stylesheet.

2013-04-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (result-detailed): Fixed width of Severity column
	to harmonize with the new colored bar.

2013-04-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Delete and edit users via OMP instead of OAP.  Add exporting of users.
	Make the user pages more like the other pages.

	* src/gsad.c (exec_omp_get): Switch save_user to OMP.

	* src/gsad_oap.c (save_user_oap): Remove.  Replaced by OMP equivalent.

	* src/gsad_omp.c (edit_resource): Split param check in two for better
	messages.
	(CHECK): New macro.
	(save_user_omp): New function.  OMP equivalent of removed OAP version.

	* src/gsad_oap.h, src/gsad_omp.h: Update headers accordingly.

	* src/html/oap.xsl (user [edit]): Add next and user_id params.

2013-04-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Delete and edit users via OMP instead of OAP.  Add exporting of users.
	Make the user pages more like the other pages.

	* src/gsad.c (init_validator): Add export commands.  Add new resource
	types and user_id.
	(exec_omp_get): Switch delete_user and edit_user to OMP.  Add user
	export commands.

	* src/gsad_oap.c (delete_user_oap, edit_user_oap): Remove.  Replaced by
	OMP equivalents.

	* src/gsad_omp.c (next_page): Add get_user and get_users.
	(get_one): Make error message slightly more specific.
	(delete_user_omp): New function.  OMP equivalent of removed OAP version.
	(get_user, get_users): New functions.
	(get_user_omp, get_users_omp): Let the generic functions do the work
	via get_user and get_users.
	(edit_user, edit_user_omp): New functions.  OMP equivalent of removed
	OAP versions.
	(export_user_omp, export_users_omp): New functions.

	* src/gsad_oap.h, src/gsad_omp.h: Update headers accordingly.

	* src/html/oap.xsl (html-users-table): Add export icon in heading.
	(user): Make name column a link.  Use id instead of name in delete icon.
	Add standard icons.
	(get_users_response): Remove.
	(get_user): Update for path changes.  Match delete and modify for error
	messages.
	(get_users): New template.

	* src/html/omp.xsl (list-window-line-icons): Add a notrash param so that
	the user page can use the delete icon instead of the trash icon until
	users have trashcan capability.

2013-04-02  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (severity-bar): New template.
	(result-detailed): Use colored progress bars to showcase a result's
	severity instead of coloring all the columns headers.

2013-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/oap.xsl (html-create-user-form): Add boolean to tests to get
	them working.  Remove radio checks that should have been on first option
	only.

2013-03-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (nvt, result-detailed): Add conditionals to
	drop sections where content is equal to "N/A".

2013-03-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Move New User to dedicated page.  Bring User Details closer to new
	style.

	* src/gsad.c (init_validator, exec_omp_get): Add new_user.

	* src/gsad_omp.c (new_user, new_user_omp): New function.
	(get_users_omp): Remove GET_GROUPS call.  Now in new_user.
	(create_user_omp): Call new_user_omp as next page in + case.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/help.xsl (configure_users.html): Remove.  Now in new pages.
	(users.html, user_details.html, new_user.html): New pages.
	(contents.html): Add new pages.

	* src/html/oap.xsl (html-create-user-form): Update help location.  Add
	User List icon.  Get groups from new location.
	(html-users-table): Update help location.  Add New User icon.
	(new_user): New template.
	(user [details]): Make closer to new style.  Update help location.
	(get_users_response): Remove New User form from Users page.
	(group [auth]): Update help locations.

2013-03-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/oap.xsl (html-create-user-form): Get field values from
	envelope when plus button was pressed.

2013-03-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Create users via OMP instead of OAP.  At the same time add groups to the
	create_user page.

	* src/gsad.c (exec_omp_get): Switch create_user to OMP.

	* src/gsad_oap.c (create_user_oap): Remove.  Replaced by OMP equivalent.

	* src/gsad_omp.c (get_users_omp): Correct message.  Get groups too for
	dropdown.
	(create_user_omp): New functions.  OMP equivalent of the removed OAP
	version, which also creates the user in the db and adds the user to
	any given groups.

	* src/gsad_oap.h, src/gsad_omp.h: Update headers accordingly.

	* src/html/oap.xsl (group [newuser], new-user-group-select): New
	templates.
	(html-create-user-form): Add groups field.
	(get_users_response): Match create_user_response too.

2013-03-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add back rule "role", which is required

2013-03-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add back rule "role", which is required
	for creating users, and was removed at some point.

2013-03-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/oap.xsl (html-users-table, user): Add Groups column.
	(user): Add groups field.

2013-03-26  Matthew Mundell <matthew.mundell@greenbone.net>

	Get users via OMP instead of OAP.

	* src/gsad.c (exec_omp_get): Switch get_user and get_users to OMP.

	* src/gsad_oap.c (get_user_oap, get_users_oap): Remove.  Replaced by OMP
	equivalents.

	* src/gsad_omp.c (get_user_omp, get_users_omp): New functions.  OMP
	equivalents of the removed OAP versions.

	* src/gsad_oap.h, src/gsad_omp.h: Update headers accordingly.

2013-03-26  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (filter-window-part): Set max size for filters
	selection box so that long filter names don't push filter dialog
	elements to a second row.

2013-03-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-permissions-trash-table)
	(html-permissions-table): Rename SType column to Subject Type.

2013-03-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (gsa:capitalise, gsa:upper-case): New functions.
	(permission [details]): Neaten fields.  Add link to subject field.

2013-03-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (contents.html): Add groups.
	(glossary.html): Add group.
	(group_details.html, groups.html, new_group.html): New templates.

2013-03-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/help.xsl (ovaldefs.html): Change column title from
	"Def. class" to "class".

	* src/html/omp.xsl (info/ovaldef): Change "def_class" to "class".
	Change "xml_file" to "file".
	(html-ovaldef-table): Change column header title from
	"Def. class" to "class" and OMP element from "def_class" to "class".
	(ovaldef_details): Change xml_file to file, shorten text to "File".

2013-03-23  Matthew Mundell <matthew.mundell@greenbone.net>

	Add permissions to trashcan.

	* src/gsad.c (init_validator, exec_omp_post): Add
	delete_trash_permission.

	* src/gsad_omp.c (get_trash): Get permissions trash too.
	(delete_trash_permission_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (permission [trash])
	(html-permissions-trash-table): New template.
	(get_trash): Add permissions section.

2013-03-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_info_response): Indent condition more logically.

2013-03-23  Matthew Mundell <matthew.mundell@greenbone.net>

	ChangeLog: Keep entries for file as a single block.

2013-03-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (info/ovaldef): Add XML file to Name column.
	(ovaldef-details): Show actual ID (with suffix) in ID field.
	Show XML file name.

	* src/html/help.xsl (ovaldefs.html): Add help text about XML file name.

2013-03-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Select SecInfo using info_id instead of name in tables.

	* src/gsad.c (init_validator): Change regexp for info_id to accept
	alphanumeric characters and .:\/~

	* src/html/omp.xsl (info/cpe, info/cve, info/ovaldef)
	(info/dfn_cert_adv, info_allinfo): Change details links for OVAL
	definitions to use info_id instead of info_name.
	(get_info_allinfo_action): Add parameter for ID, change link to use ID.
	(get_info_allinfo_lnk, get_info_cpe_lnk, get_info_cve_lnk)
	(get_info_ovaldef_lnk, get_info_dfn_cert_adv_lnk): Add optional
	parameter for ID, change link to selection by ID if it is passed.
	(html-cpe-table, html-cve-table, html-ovaldef-table)
	(html-dfn_cert_adv-table, html-allinfo-table): Hide filter for
	selections by name and ID.
	(get_info_response): Show table view if more than one item is selected
	by name. Show details view if an item is selected by ID.

2013-03-20  Matthew Mundell <matthew.mundell@greenbone.net>

	Implement group editing.

	* src/gsad.c (init_validator, exec_omp_post, exec_omp_get): Add
	save_group and edit_group.

	* src/gsad_omp.c (edit_group, edit_group_omp): New functions.
	(CHECK): New define.
	(save_group_omp): New function.

	* src/html/omp.xsl (html-edit-group-form): Add actual fields.
	(get_group, get_groups): Match MODIFY_GROUP response for error case.

	* src/html/gsad.xsl (modify_group_response): New template.
	(html-gsa-logo): Apply MODIFY_GROUP indicator icons.

2013-03-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-filter-form, html-edit-filter-form): Add
	permission to available types.

2013-03-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (list-window): Skip new icon for permissions.
	(permission): Remove edit icon from actions.

2013-03-19  Matthew Mundell <matthew.mundell@greenbone.net>

	Add Permissions page.

	* src/gsad.c (init_validator): Add new pages.  Add permission to
	resource types.  Add permission_id.
	(exec_omp_post, exec_omp_get): Add new pages.

	* src/gsad_omp.c (next_page): Add get_permissions.
	(get_permission, get_permission_omp, get_permissions)
	(get_permissions_omp, delete_permission_omp, export_permission_omp)
	(export_permissions_omp): New functions.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/gsad.xsl (delete_permission_response): New template.
	(html-gsa-logo): Apply delete_permission_response indicator.
	(html-gsa-navigation): Add Permissions to configuration menu.

	* src/html/omp.xsl (gsa:join): New function.
	(task): Display observer groups in observer icon too.
	(delete_permission_response, permission, permission [details])
	(get_permission, html-permissions-table, get_permissions): New
	templates.

2013-03-19  Matthew Mundell <matthew.mundell@greenbone.net>

	Add observer groups to New Task.

	* src/gsad_omp.c (new_task): Get groups for dropdown.
	(create_task_omp): Add group "+" button handling.  Add groups to OBSERVERS
	in CREATE_TASK.

	* src/html/omp.xsl (new_task): Add observer groups field.

2013-03-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Add observer groups to task details and task edit.

	* src/gsad.c (init_validator): Remove "groups".  Add group observer
	rules.
	(params_append_mhd): Add group_id_optional case.

	* src/gsad_omp.c (edit_task): Get groups too.  Add groups param to XML.
	(save_task_omp): Add group "+" button handling.  Add groups to OBSERVERS
	in MODIFY_TASK.  Prepare command format string beforehand, otherwise XML
	alerts and observer groups are escaped.

	* src/html/omp.xsl (task [details]): Add observer groups.
	(group [newtask], new-task-group-select): New templates.
	(html-edit-task-form): Add observer groups field.

2013-03-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt: Increased dependency to gnutls from 2.2 to 2.8.
	Increased dependency to openvas-libraries from 5.0.0 to 6.0.0.

2013-03-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Further prepare for tabular pageable results view.

	* src/html/omp.xsl (result-detailed): Moved all information from
	the former colored box into the tabular elements. Added host.

2013-03-15  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/help.xsl (hosts_note): New named template ("Note on Hosts").
	(new_target.html): Replace "Note on Hosts" text with template call for
	including the text.
	(targets.html): Add hosts_note template call.

2013-03-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (result-detailed): In Product Detection Result
	rename "Details" to "Log".
	Move links to NVT details from colored header down to vulnerability
	detection method. In case CVSS == 0, call it Log Method.

2013-03-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (result-detailed): Made Summary and Detection Result
	sub-boxes of their own. Moved Icons up into the colored bar.

2013-03-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl: URI encode filter strings in GET links, as they may
	contain special characters like +.

2013-03-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many, get_tasks): Add permission and owner terms
	to task default filters.

2013-03-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (info/dfn_cert_adv, html-dfn_cert_adv-table): Add
	"Created" column.

	* src/html/help.xsl (dfn_cert_advs.html): Add help for "Created" column.

2013-03-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (info/ovaldef): Use shorter date format "date".
	(html-ovaldef-table): Shorten "Definition class" to "Def. class".

	* src/html/help.xsl (ovaldefs.html): Add missing "Def. class".

2013-03-12  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/help.xsl (contents.html, glossary.html, ovaldefs.html): Fix
	typos.

2013-03-12  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (info/allinfo): Restyle to add extra information.

2013-03-11  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (info/ovaldef, html-ovaldef-table): Remove
	"deprecated" column, add "status" column in its place.

	* src/html/help.xsl (ovaldefs.html): Remove text for "deprecated",
	add text for "status".

2013-03-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Add default filter setting for All SecInfo page.

	* src/html/omp.xsl (get_my_settings.html, edit_my_settings.html): Add
	All SecInfo filter setting.

	* src/html/help.xsl (my_settings.html): Update documentation.

2013-03-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Update help documentation to reflect All SecInfo changes.

	* src/html/help.xsl (allinfo.html): New template.
	(contents.html): Add link to All SecInfo help page.

2013-03-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (info/nvt, get_info_nvt_lnk): Use filter term and id
	returned in response instead of envelope params.

2013-03-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Add search All SecInfo feature.

	* src/html/omp.xsl (info/allinfo, get_info_allinfo_action)
	(get_info_allinfo_lnk, html-allinfo-table): New templates.
	(get_info_response): Add allinfo info_type handling.

	* src/gsad_omp.c (get_info): Validate info_type for allinfo and ALLINFO
	values.

	* src/html/gsad.xsl (html-gsa-navigation): Add All SecInfo submenu.

2013-03-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (nvt): Renamed tag detection to vuldetect,
	made section titles case-consistent.

2013-03-07  Timo Pollmeier  <timo.pollmeier@greenbone.net>

	* src/html/help.xsl (ovaldefs.html): Change help for table rows
	(see below).

	* src/html/omp.xsl (html-ovaldef-table, info/ovaldef): Remove column
	"Title", add columns "Created", "Modified". Add title subrow similar to
	descriptions of CVEs.

2013-03-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (newstyle-nvt): New function.
	(result-detailed): Check if nvt has newstyle tags and output results
	accordingly.

2013-03-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/gsad.xsl, src/html/help.xsl: Open www.greenbone.net and
	www.openvas.org hyperlinks in new tab.

2013-03-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (get-nvt-tag): New function.
	(result-detailed): Replace multiple for loop iterations with get-nvt-tag
	calls.

2013-03-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (result-detailed): Moved insight, solution,
	detection method into sub-boxes of their own.
	Moved product detection result into a box of its own.
	Renamed tag "detection" to "vuldetect", because "detection"
	is already used by detection scripts.

2013-03-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (structured-text): New. Very simple
	version that only can do paragraphs.
	(result-detailed): Moved insight into a sub-box of its own
	and use structured text formatting.

2013-03-06  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (result-detailed): Output summary, insight, impact
	and solution nvt tags when result is empty. Add result subtitle with
	vulnerability detected or scan result content.

2013-03-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Add basic user groups.

	* src/gsad.c (init_validator): Add group commands.  Add group validators
	and add group to type names.
	(exec_omp_post, exec_omp_get): Add group commands.

	* src/gsad_omp.c (next_page): Add group pages.
	(get_group, get_group_omp, get_groups, get_groups_omp, new_group)
	(new_group_omp, delete_group_omp): New functions.
	(CHECK): New define.
	(create_group_omp, export_group_omp, export_groups_omp): New functions.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/gsad.xsl (create_group_response): New template.
	(html-gsa-logo): Match response for indicator icon.
	(html-gsa-navigation): Add Groups menu item.

	* src/html/oap.xsl (group): Make mode "auth" because the generic macros
	expect "group" for the Group table.
	(describe_auth): Match "group" in "auth" mode.

	* src/html/omp.xsl (groups, create_group_response)
	(delete_group_response, modify_group_response, group, group [trash])
	(group [details], html-groups-trash-table, html-groups-table)
	(html-create-group-form, new_group, html-edit-group-form, edit_group)
	(get_group, get_groups): New templates.

2013-03-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (nvt): Skip summary in NOSUMMARY case.

2013-03-02  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (nvt): Skip description in NODESC case.

2013-03-02  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (nvt): Add sections for summary and detection tags.

2013-03-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post branch version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2013-02-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_info): Validate info_type in capital letters
	format.

2013-02-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (cpe-details): Add details parameter to CVEs details
	link.

2013-02-26  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_info): Return error message when an invalid
	info_type is provided. Update documentation and error messages.

2013-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (prognostic-description): Move into template section.

2013-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (prognostic-description): New template.
	(result-detailed): For prognostic results, produce the description with
	prognostic-description so that the browser does paragraph wrapping.

2013-02-22  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump to 4.0+beta6.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2013-02-22  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 4.0+beta5 release.

	* CHANGES: Updated.

2013-02-22  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/gsad.xsl (html-footer), src/html/help.xsl (about.html),
	src/gsad.c (main): Extend copyright notice to include 2013.

2013-02-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_report): Don't apply default filter when result
	filtering form is applied.

2013-02-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (ref_xref_list): Add special display case for URL
	cross-references.

2013-02-20  Michael Wiegand <michael.wiegand@greenbone.net>

	Move "-Werror" flag to the "Debug" build type.

	* CMakeLists.txt: Move "-Werror" from CMAKE_C_FLAGS to
	CMAKE_C_FLAGS_DEBUG to keep it out of the "Release" build type.

2013-02-20  Timo Pollmeier  <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (nvt): Hide description section completely when
	no description is found.

2013-02-20  Timo Pollmeier  <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (cve-details): Hide CERT section completely when
	no advisory references are found.

2013-02-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (xsl_transform_omp): Leave param xml_file out of the
	envelope because it can be very big when importing reports, which can
	cause problems for the XSL transform.

2013-02-19  Werner Koch  <wk@gnupg.org>

	* src/gsad.c (send_redirect_header): Send a small body.

2013-02-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-report-details): Use new next and previous
	icons for filtered results.

2013-02-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_report): Check if a filter is already applied when
	setting the default filt_id value.

2013-02-19  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (get_my_settings, edit_my_settings): Add Report
	Filter.

	* src/gsad_omp.c (get_report): Default filt_id value to -2 for more
	consistency.

2013-02-19  Werner Koch  <wk@gnupg.org>

	* src/gsad.c (main): Add option --debug-tls.
	(my_gnutls_log_func): New.
	(main): Print library version numbers with --version if debug-tls
	is also used.

2013-02-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (cve-details): Change to hide empty sections if
	no CVE data is found. Change to show "CVSS: None" if only CVSS data is
	missing.
	(cpe-details): Change to hide "Reported vulnerabilities" when CPE is not
	found.
	(ovaldef-details): Change to hide empty sections if no ovaldef data is
	found and show an info message instead. Add h1 tag to
	"Repository history: None".
	(dfn_cert_adv-details): Change to hide empty sections if no advisory
	data is found and show an info message instead.

2013-02-19  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (result-detailed): Fix conditions for references
	boxes to appear.

2013-02-18  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (ref_cert_list, nvt, result-detailed): Add support
	for warning elements in CERT advisory lists.

2013-02-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Clear credentials on allocation so that
	params is NULL when exec_omp_get fails with bogus command name.

2013-02-15  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (nvt): Change to hide empty sections completely.

2013-02-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (dfn_cert_adv-details): Change to make more
	consistent with other details pages. Get name (advisory ID) from
	raw data.

2013-02-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (ovaldef-details): Change to make more consistent
	with other details pages.

2013-02-14  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (ref_xref_list): Change text "Other:" to appear
	in same line as first xref entry.
	(nvt): Move references to new "References" table.
	Move "CVSS base", "Risk factor" and tag "cvss_base_vector" to new table
	"Vulnerability scoring".
	Move script tags "affected", "insight", "impact", "solution" to new
	sections "Affected software/OS", "Vulnerability insight", "Impact" and
	"Solution" respectively.

2013-02-13  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/help.xsl (glossary.html): Add reference to "About DFN-CERT"
	in dfn_cert_advs.html.
	(dfn_cert_advs.html): Add section "About DFN-CERT".
	Fix broken link to glossary.

2013-02-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/wizard.xsl (wizard): Skip wizard if role is Observer.

2013-02-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (nvt): Display each nvt reference in a new line.

2013-02-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/gsa-style.css (tbody.odd, tbody.odd:hover, tbody.even:hover):
	New classes for grouped table rows.

	* src/html/omp.xsl (info/cve): Add descriptions truncated to about 250
	characters to CVEs table.

2013-02-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_oap.c (get_cert_oap): Add a space.

2013-02-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/help.xsl (scap_management.html): Fix "Jump to dialog" link.

	* src/html/oap.xsl (html-scap-form): Fix select for sync_not_available
	error message.

2013-02-06  Michael Wiegand <michael.wiegand@greenbone.net>

	* doc/CMakeLists.txt: Prevent superfluous creation of "doc/generated/"
	directory inside the source tree.

2013-02-06  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/gsad.c (init_validator, exec_omp_get): Add OAP commands
	get_cert and sync_cert.

	* src/gsad_oap.c, src/gsad_oap.h (get_cert_oap): New function to get
	CERT feed info.
	(sync_cert_oap): New function to run CERT sync.

	* src/html/gsad.xsl (sync_cert_response): New template for indicator.
	(html-gsa-logo): Add indicator for CERT sync.
	(html-gsa-navigation): Add entry for CERT sync in Administrator menu.

	* src/html/help.xsl (contents.html): Add entry "CERT Feed Management".
	(cert_management.html): New template, help for CERT Feed Management.

	* src/html/oap.xsl (html-scap-form): Fix select in error message (was
	"feed/..." instead of "scap/...").
	(describe_cert_response, html-cert-form, sync_cert_response): New
	templates for CERT feed management.

2013-02-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (info/cpe, info/cve): Add filt_id to details links.
	(get_info_cpe_lnk, get_info_cve_lnk): Add filt_id.
	(cve-details, cpe-details): Add filt_id to list icon.

2013-02-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (cve-details): Remove bold from minor ID.  Add colons
	to field names.  Add Name field.  Move CWE ID across to standard fields.
	(cpe-details): Add colons to field names.

2013-02-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (notes.html, overrides.html): Note extra filtering
	fields.

2013-02-01  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/help.xsl (glossary.html): Add description for slaves.

2013-01-31  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a flag param "xml", that can be added to any GET URL to request that
	the XML is returned instead of the HTML.

	* src/gsad_omp.c (xsl_transform_omp): Just return XML if xml flag is
	present.

	* src/gsad.c (init_validator): Add param xml.
	(request_handler): Make the content type XML when the xml flag is set
	and a page is returned from exec_omp_get.

2013-01-31  Matthew Mundell <matthew.mundell@greenbone.net>

	Add downloading of OMP doc in all three formats.

	* src/gsad.c (init_validator): Add export_omp_doc and protocol_format.
	(exec_omp_get): Add export_omp_doc.

	* src/gsad_omp.c (export_omp_doc_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (protocol): Add export icon with selector.

2013-01-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (contents.html): Add Protocol Documentation section
	under Miscellaneous.

2013-01-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (help): Indent at right level.

2013-01-31  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a help page that describes the OMP protocol, much like the HTML
	format response of the OMP HELP command.

	* CMakeLists.txt: Add new files.

	* src/CMakeLists.txt (rnc-xsl-syntax, omp-doc-xsl-syntax): New targets.

	* src/gsad.c (init_validator, exec_omp_get): Add get_protocol_doc.

	* src/gsad_omp.c (get_protocol_doc): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp-doc.xsl, src/html/rnc.xsl: New files.  These are copies
	of HTML.xsl and rnc.xsl from openvas-manager/src/schema_formats/HTML.
	If they are to remain the same as the originals then they should be
	linked in SVN somehow, but their use depends how the GSA docs will
	evolve.

	* src/html/omp.xsl (protocol, get_protocol_doc): New templates.

2013-01-30  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp (export_many): Add current date to exported file name.

2013-01-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_task): Use filter to set overrides, because
	apply_overrides GET_TASKS param is currently out of action.

2013-01-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task [details]): Add filter params and original
	override value to refresh form.
	(task): Add override to name link, to match details icon.

	* src/gsad.c (init_validator): Add original_overrides.

	* src/gsad_omp.c (get_task): When the refresh form has changed the
	overrides state, then adjust the filter string and remove any named
	filter.

2013-01-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/help.xsl (cpes.html, cves.html, ovaldefs.html)
	(dfn_cert_advs.html): Change help text and anchor for SCAP / CERT
	database warning to one for general SecInfo database warning.
	(nvts.html): Add help text for SecInfo database warning.

	* src/html/omp.xsl (html-cpe-table, html-cpe-table, html-ovaldef-table)
	(html-dfn_cert_adv-table): Change SCAP / CERT database warning to
	general SecInfo database warning. Change help link to new anchor.
	(html-nvt-table): Add SecInfo database warning.

2013-01-29  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Change help for SecInfo to be more consistent, mostly with details
	pages, filtering and availability. Fix spelling mistakes. Remove now
	unused anchors. Add new text for OVALDEF, DFN-CERT and CERT references.

	* src/html/help.xsl (contents.html): Add details items for CPE, OVALDEF,
	DFN_CERT_ADV.
	(cpe.html): Remove. Now cpe_details.html.
	(cpe_details.html): New template. Was cpe.html.
	Remove superfluous anchor.
	(cve_details.html): Add availability template call. Remove superfluous
	anchor. Change headings from h2 to h1 and from h3 to h2.
	Change "an CVE" to "a CVE".
	(ovaldef.html): Remove. Now ovaldef_details.html.
	(ovaldef_details.html): New template. Was ovaldef.html. Remove
	superfluous anchor. Change "a" to "an". Add text for Affected, Criteria,
	References and Repository history.
	(dfn_cert_adv.html): Remove. Now dfn_cert_adv_details.html.
	(dfn_cert_adv_details.html): New template. Was dfn_cert_adv.html.
	Remove superfluous anchor. Add help text for link and referenced CVEs.
	(cpes.html): Remove superfluous anchor. Change link to details.
	Remove old details section. Add filtering template call.
	(cves.html): Remove superfluous anchor. Change link to details.
	Add mention of CERT in details description. Remove old details section.
	(nvt_details.html): Remove superfluous anchor. Add availability template
	call. Change h2 to h1. Change "an" to "a". Change "CVEs" to list of
	different refence types. Add mention of CERT links.
	(ovaldefs.html): Remove superfluous anchor and blank lines. Change
	details link. Add filtering template call.
	(dfn_cert_advs.html): Remove superfluous anchor. Change details link.
	Add filtering template call.

	* src/html/omp.xsl (cpe-details, ovaldef-details, dfn_cert_adv-details):
	Change help links.

2013-01-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_info_response): When a info_name is given, then
	always go to the details page.  This allows the details page to handle
	cases like NVTs referencing CVEs before the CVEs are published.  Also
	call nvt-details instead of doing the page directly.
	(cve-details): If the CVE is missing, add a note and minimize the CVSS
	section.
	(nvt-details): New template.

2013-01-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl: Change URL in xmlns:dfncert from "https:" to "http:"

2013-01-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_info_response, cve-details, get_nvts): Update
	help page names.

	* src/html/help.xsl (contents.html): Add SecInfo details pages.  Order
	SecInfo like in menu.  Remove SecInfo Lookup.  Adjust indenting.
	(cve.html): Remove.  Now cve_details.html.
	(cve_details.html): New template.  Was cve.html.
	(nvts.html): Move down in file.  Expand.  Remove NVT Details section.
	(browse_infosec.html): Remove.  Feature removed.
	(cpes.html): Make heading plural.
	(cves.html): Make heading plural.  Remove excessive BR spacing.  Correct
	typo.  Add filtering.
	(nvt_details.html): New template.
	(ovaldefs.html): Remove excessive BR spacing.  Match column header to
	page.

2013-01-28  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp (get_many): Check if filt_id was already provided when
	setting default filter.

2013-01-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-cpe-table, html-cve-table, html-nvt-table)
	(html-ovaldef-table): Make heading plural to match other list pages.

	* src/html/gsad.xsl (html-gsa-navigation): Make SecInfo items plural to
	match other list pages.

2013-01-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Make everything besides CVE sorted reverse
	by Created, so that DFN-CERT gets it too.

2013-01-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Add special case filter defaults for CVEs
	and OVALs.

2013-01-28  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (user_add): Revert mutex unlocking change as the caller is
	responsible for unlocking.

2013-01-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (user_add): Unlock user mutex before returning.

2013-01-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (gsad_init): Check for glib version when calling
	g_thread_init and g_mutex_new as these are deprecated since glib 2.31
	and were causing build failures on systems running new versions.

2013-01-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (list-window, html-configs-table, html-cpe-table,
	html-cve-table, html-nvt-table, html-ovaldef-table,
	html-dfn_cert_adv-table, html-port-lists-table): Adjust tooltip string.

2013-01-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Sort NVTs by date descending by default.

2013-01-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Reorder Secinfo menu.

2013-01-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (nvt): Add minor details.

2013-01-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl: Fix changes accidentally reverted.

2013-01-25  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add relevant DFN-CERTs to NVT details and scan results.

	* src/html/omp.xsl (ref_cert_list): Add. New template for showing
	CERT list in scan results.
	(nvt): Add CERT list.
	(result-detailed): Add CERT lists.

2013-01-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_many): Handle default filters for notes and tasks
	when setting filt_id.

2013-01-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_many): Defualt filt_id to -2 when no filter is
	provided.

2013-01-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/gsad.xsl: Don't include dialog.xsl.

2013-01-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/CMakeLists.txt: Remove dialog.xsl.

2013-01-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Remove old SecInfo Management browse page.

	* CMakeLists.txt (FILES): Remove dialog.xsl.

	* src/gsad.c (request_handler): Remove dialog special case.  All users
	have been converted to new style filtering pages.

	* src/html/gsad.xsl (html-gsa-navigation): Link SecInfo item to CVEs.
	Remove Lookup NVT subitem.

	* src/html/dialog.xsl: Remove.  Now out of use.

2013-01-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Respect filter params when verifying report format.

	* src/gsad_omp.c (verify_report_format_omp): Convert to new style.

	* src/html/gsad.xsl (html-gsa-logo): Adjust indicator path accordingly.

	* src/html/omp.xsl (report_format): Make verify icon filter param like
	other icons.
	(get_report_formats): Match verify_report_format_response for error
	message.

2013-01-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* ChangeLog: Cleanup paths in last two entries.

2013-01-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (agent, report_format): Use new verify icon.

2013-01-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Add indicators for filters
	created from GET pages.

	* src/html/omp.xsl (get_tasks, get_alerts, get_targets)
	(get_configs_response, get_schedules, get_slaves, get_notes)
	(get_overrides, get_port_lists, get_report_formats): Match
	create_filter_response for error message.

2013-01-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c: Add headers for all get functions called by the _omp
	interface functions.
	(next_page): Always call the local get function, and pass it the
	response.  This way the XML gets the response for error messages.
	(get_target, get_targets, get_schedule, get_report_format)
	(get_report_formats, get_port_list, get_port_lists): Make static like
	others.

2013-01-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-cpe-table, html-cve-table, html-nvt-table)
	(html-ovaldef-table, html-dfn_cert_adv-table): Add list icon that
	reverts to default filter.

2013-01-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Round corner of last entry.

2013-01-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (list-window, html-configs-table)
	(html-port-lists-table): Add list icon that reverts to default filter.

2013-01-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (new_target.html): Remove netmask from IPv6 example.
	Adjust sentence about replacing IPv6 netmasks.

2013-01-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (configure_users.html): Improved help text on
	per-user authentication.

2013-01-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_base.c (param_free): Free values with params_free.

2013-01-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c: Include openvas_file header from base libraries.
	(gsad_init): Use openvas_file_check_is_dir.
	(check_is_dir): Remove duplicate function.

2013-01-23  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (edit-settings-filter): Change parameter name from
	type to uuid.
	(edit_my_settings): Use fixed uuid values instead of setting filter
	name.

	* src/gsad_omp.c (send_settings_filter): Use setting id instead of name.

2013-01-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (host): Add colon for IPv6.

2013-01-22  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (edit-settings-filter, get_my_settings)
	(edit_my_settings): Change naming style for settings filters.

2013-01-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Remove commands_response from
	get_tasks paths.

	* src/html/omp.xsl (get_tasks): Replace commands_response with responses
	for the commands, as they are now done directly.

2013-01-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task-icons, status_bar): Add Ultimate delete states.

2013-01-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_system_reports_response, get_system_reports): If
	the command fails in the slave case then show a helpful message instead
	of the error dialog.

2013-01-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (delete_filter_omp): When the filt_id is the filter
	being removed, then clear filt_id to prevent an error message.

2013-01-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (html-dfn_cert_adv-table): Change sort column
	"cve_refs" in table head to "cves".

2013-01-21  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (cve-details): Add table of CERT advisories
	referencing the current CVE.

2013-01-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/help.xsl (my_settings.html): Update documentation to reflect
	addition of per-resource default filters.

2013-01-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (my_settings.html): Describe more settings.

2013-01-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (xsl_transform_omp): Check the value instead of the
	value_size of the param, so that zero-length params are added too.

	* src/html/omp.xsl (gsa:param-or): Check that the param exists instead
	of checking its length, so that zero-length fields are passed to the
	resulting page too.

2013-01-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (get_my_settings): Remove Actions column as it is
	always empty.

2013-01-21  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/help.xsl: Some clarifications about recommended
	authentication mechanism for ldap/ads.

2013-01-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report_format): Remove extra filter url parameter.

2013-01-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add enable_stop.

	* src/html/omp.xsl (task-icons): Enable the stop icon when the
	enable_stop param is 1, whatever state the task is in.

2013-01-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (start-icon, agent, report_format): Add filter and
	filt_id parameters in links to keep filter consistency between actions.
	(report_format): Use list-window-line-icons template.

2013-01-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (download_agent_omp): Set default name with uuid and
	format for agent package when no filename is available.

2013-01-18  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (info/dfn_cert_adv): Change num_cves to cve_refs.
	(html-dfn_cert_adv-table): Change name "num_cves" to "cve_refs".

2013-01-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Handle actions response and indicator for various resource types.

	* src/html/omp.xsl (modify_agent_response, modify_alert_response)
	(modify_port_list_response, modify_schedule_response)
	(modify_slave_response): New templates.
	(html-gsa-logo): Apply templates for various resource actions responses.

2013-01-18  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (html-dfn_cert_adv-table): Change column head
	"#CVEs" to "CVEs".

2013-01-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (note, override): Increased visible string length
	of NVT name in column "NVT" from 35 to 70. This is not critical
	because the NVT names to not contain overlong words (or at least
	we can control it). The worst thing that could happen is
	that the row grows in height.

2013-01-17  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/verify.png: New.

	* CMakeLists.txt: Install new icon.

2013-01-17  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (get_my_settings, edit_my_settings): Replace SecInfo
	filter entry with specific entries for cpe, cve, nvt, ovaldef and
	dfn_cert_adv.

2013-01-17  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_info): Remove hardcoded filter value for CVE info
	type.

	* src/html/omp.xsl (html-cve-table): Fix typo in html tag id.

2013-01-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (gsa:param-or): Get the params out of the top-level
	params instead of looking in the collection _params.

2013-01-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (info/cpe, info/cve, info/ovaldef)
	(info/dfn_cert_adv): Remove action column centering to match other
	lists.

2013-01-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-note-form)
	(html-create-override-form): Correct envelope param name in list link.

2013-01-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Add NVT to SecInfo menu.

	* src/html/omp.xsl (info/nvt, get_info_nvt_lnk, html-nvt-table): New
	templates.
	(get_info_response): Add NVT table.
	(get_nvts): Add list icon.

2013-01-16  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (edit-settings-filter): Remove plural s for types.
	(get_my_settings): Show SecInfo filter.
	(edit_my_settings): Add SecInfo filter dropdown menu. Use plural form
	for types for consistency.

2013-01-16  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Update copyright dates and authors in heading comments of various files.

	* src/html/gsad.xsl: Update heading comment.

	* src/html/help.xsl: Update heading comment.

	* src/html/omp.xsl: Update heading comment.

2013-01-16  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Add views for DFN-CERT. Minor fixes in OVAL help and details view.

	* src/html/gsad.xsl: Add DFN-CERT Advisories item to SecInfo menu

	* src/html/help.xsl: Add help for DFN-CERT Advisories.
	Change OVAL help saying CVE where it should be OVAL Definitions.

	* src/html/omp.xsl: New templates for DFN-CERT advisory table and
	details views.
	Change linking of CVEs and CPEs in OVAL Definition Details to use
	use get_info_cve_lnk and get_info_cpe_lnk for consistency.

2013-01-15  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-edit-filter-form): Add Credential and Slave
	filter types.
	(get_my_settings): Show credentials and slaves filters. Adapt table rows
	class and add missing table cells. Remove reports filter.
	(edit_my_settings): Edit credentials and slaves filters. Remove reports
	filter. Fix typo in edit-settings-filters template of Report Formats.

2013-01-15  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-create-filter-form): Add Credential and Slave
	filter types.

2013-01-15  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Add per-resource default filters.

	* src/gsad.c (init_validator): Add settings_filter validators.
	(params_append_mhd): Add settings_filter parameter.

	* src/gsad_omp.c (get_my_settings_omp, edit_my_settings_omp): Get
	filters too.
	(send_settings_filter): New function.
	(save_my_settings_omp): Save settings filters. Get filters before
	returning get settings page.

	* src/html/omp.xsl (get-settings-filter, edit-settings-filters): New
	templates.
	(edit_my_sttings): Add ability to set per-resource default filters.
	(get_my_settings): Show resource filters.

2013-01-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Use the max_results param to check if
	the notes and result_hosts_only params where unchecked, because these
	two params default to 1.

2013-01-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_tasks): Add the overrides when the filter is
	missing, so that the initial page respects the overrides param.

2013-01-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task): Add filter args to report count link.

2013-01-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (old-html-tasks-table): Remove.  Replaced by
	list-window version.

2013-01-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task): Add filt_id param to name link.

	* src/html/wizard.xsl (quick-first-scan-wizard): Add filter args to
	run_wizard form.

2013-01-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (edit-header-icons): Add filt_id param to links.

2013-01-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (send_alert_method_data): Check email notice type
	before sending report formats to not clutter the DB with unneeded data.

2013-01-11  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-create-alert-form, html-edit-alert-form): Use a
	drop-down list for syslog and SNMP.
	(html-edit-alert-form): Fix class values for certain table rows.

	* src/gsad_omp.c (create_alert_omp, edit_alert_omp): Remove the syslog
	special case.

2013-01-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (cve-details, cpe-details, ovaldef-details): Get
	filter from envelope now that manager strips it out.

2013-01-10  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Add Alert event, condition, method and filter editing support.

	* src/gsad_omp.c (send_alert_method_data): Check for notice name too
	when sending method data.
	(edit_alert): Get report filters and report formats too.
	(save_alert): Send event, condition, method and filter too.
	(test_alert): Fix error message links.

	* src/html/omp.xsl (radio-button, modify_alert_repsonse): New template.
	(html-edit-alert-form): Add event, method, data and filter editing
	fields.
	(edit_alert): Send get_report_formats_response and get_filters_response
	as parameters to html-edit-alert-form.
	(get_alert, get_alerts): Apply modify_alert_response.

2013-01-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* ChangeLog: Clean up entry.

2013-01-09  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (edit-header-icons): New template.
	(html-edit-lsc-credential-form, html-edit-agent-form)
	(html-edit-alert-form, html-edit-filter-form, html-edit-target-form)
	(html-config-table, html-edit-schedule-form, html-edit-slave-form)
	(html-edit-note-form, html-edit-override-form)
	(html-edit-report-format-form): Use edit-header-icons template.
	(edit_my_settings): Add header button to my settings.

2013-01-09  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Check alert data for matching event/condition/method before sending it
	which reduces bloat in DB.

	* src/gsad_omp.c (send_alert_condition_data): New function.
	(send_alert_data): Check matching event is selected before sending data.
	Rename function into send_alert_event_data to stay consistent with other
	functions.
	(send_alert_method_data): Check matching method is selected before
	sending data. Fix coding style.
	(create_alert_omp): Use adequate alert data sending functions.

2013-01-08  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (ovaldef-details): Remove <a href=...> tags for
	external references.

2013-01-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (next_page): Handle get_alert, get_agent,
	get_lsc_credential, get_port_list, get_schedule and get_slave cases.
	(get_alert): Style fix.
	(html-edit-lsc-credential-form, html-edit-port-list-form): Use next
	parameter from enevelope instead of presetting one.

2013-01-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Add save_alert validator.
	(exec_omp_get): Add save_alert handler.

	* src/gsad_omp.c (save_alert_omp): New function.

	* src/gsad_omp.h: Add save_alert_omp header.

2013-01-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Add edit_alert validator.
	(exec_omp_get): Add edit_alert handler.

	* src/gsad_omp.c (edit_alert, edit_alert_omp): New functions.

	* src/gsad_omp.h: Add edit_alert_omp header.

	* src/html/omp.xsl (html-edit-alert-form, edit_alert): New templates.
	(alert): Show edit icon in alert actions.
	(alert [details]): Show edit icon in alert details header.

	* src/html/help.xsl (alerts.html): Show Alert edit help documentation.

2013-01-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (lsc_credential): Output comment between brackets if
	available.

2013-01-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (edit_lsc_credential): Use edit_resource.
	(save_lsc_credential_omp): Refactor to use omp wrapper.

	* src/html/omp.xsl (html-edit-lsc-credential-form): Set next parameter
	to get_lsc_credentials. Remove unneeded sort_order and sort_field
	form parameters.

2013-01-08  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-configs-table): Use filtered variable for
	exported scan configs icon count.
	(html-config-table): Add details and edit header icons. Add meta config
	details.

2013-01-08  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (cve-details): Added base vector for easier
	use and comparison of CVSS details.

2013-01-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): For the report page case, when the
	filt_id and filter params are both missing, then add a filter param
	that matches the filter in the get_reports_response.  This ensures that
	the filter is always available as a param for things like the note
	icons, even after the "Result Filtering" Apply button.

2013-01-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (alert [trash]): Drop the link to the filter details
	when the filter is in the trashcan.
	(filter [trash]): Remove link to details from name.

2013-01-07  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* src/html/omp.xsl (ovaldef-details): Change various labels.
	Remove version and source file from right float div.
	Replace "Basic data" with title of OVAL definition.
	Change "Deprecated" item to only be visible when value exists.
	Change "Affected" to support mulitple "affected" tags and only appear
	when tags exist.
	Add views for criteria, references and history.

2013-01-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (filter [trash]): Grey delete icon when filter is in
	use.
	(get_trash): Match delete_filter_response in case of error.

2013-01-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_alert_omp): Restrict filter type via filter param.

2013-01-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (column-name): Reset to first page when sorting by
	column.

2013-01-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Add export credential.

	* src/gsad_omp.c: Rename export_lsc_credential_omp function into
	download_lsc_credential for consistency. Add export_lsc_credential_omp
	function.

	* src/gsad_omp.h: Modify export_lsc_credential_omp. Add
	download_lsc_credential_omp headers.

	* src/gsad.c (init_validator): Add download_lsc_credential validator.
	(exec_omp_get): Add export_lsc_credential handler. Rename old one into
	download_lsc_credential.

	* src/html/omp.xsl (lsc-credential-download-icons): Update for
	credential download actions.
	(lsc_credential, lsc_credential [details]): Remove noexport from
	action template calls.

2013-01-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (param-details [details]): Remove empty and unused
	Actions column.
	(html-edit-port-list-form): Set adequate next parameter.

2013-01-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_port_list): Set details attribute instead of
	ranges attribute for get_one call.

	* src/html/help.xsl (port_list_details.html): Update port list details
	help documentation.

	* src/html/omp.xsl (port_list [details]): Match style of other resource
	details and remove duplicate functionality with edit page.

2013-01-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Add Edit Port List functionality.

	* src/gsad_omp.c (edit_port_list, edit_port_list_omp)
	(save_port_list_omp): New functions.
	(next_page): Handle edit_port_list next parameter.
	(create_port_range_omp): Update to use omp and next_page functions.
	(delete_port_range_omp): Use edit_port_list as next page.
	(delete_resource): Update documentation.

	* src/gsad_omp.h: Add edit_port_list and save_port_list headers.

	* src/gsad.c (init_validator): Add edit_port_list and save_port_list
	validators.
	(exec_omp_post): Add save_port_list handler.
	(exec_omp_get): Add edit_port_list handler.

	* src/html/help.xsl (port_lists.html): Remove noedit parameter from
	list-window-line-actions template call.

	* src/html/omp.xsl (port_list): Remove noedit parameter from
	list-window-line-icons and details-header-icons template calls.
	(html-edit-port-list-form, edit_port_list): New templates.

2013-01-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_agent): Remove details attribute.

2013-01-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Add edit agent feature.

	* src/gsad_omp.c (edit_agent, save_agent): New functions.

	* src/gsad_omp.h: Add edit_agent and save_agent headers.

	* src/gsad.c (init_validator): Add edit_agent and
	save_agent validators.
	(exec_omp_post): Handle save_agent request.
	(exec_omp_get): Handle save_agent request.

	* src/html/omp.xsl (html-edit-agent-form, edit_agent): New templates.
	(agent): Remove noedit from list-window-line-icons template call.

	* src/html/help.xsl (agents.html): Remove noedit parameter from
	list-window-line-actions template call.

2013-01-03  Timo Pollmeier <timo.pollmeier@greenbone.net>

	* ChangeLog: Remove trailing whitespaces in last entry.

	* src/html/omp.xsl (ovaldef-details): Add display of source file.
	Change details view, which uses raw data from xml file now.
	Add list of affected systems.
	(): Add declaration of OVAL namespaces.

2013-01-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (report_format): Clone Report Format action.

	* src/html/help.xsl (report_formats.html): Remove noclone parameter from
	list-window-line-icons call to add Clone Report Format to help
	documentation.

2012-12-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Changed labels of OVAL Definitions to be more consistent and
	understandable.

	* src/html/gsad.xsl: Change menu to spell "OVAL Definitions"
	with capital "D".

	* src/html/help.xsl: Change various instances of "OVALDEF" etc. to
	"OVAL Definition".

	* src/html/omp.xsl: Change various instances of "OVALDEF" etc. to
	"OVAL Definition".

2013-01-02  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c: Add get_port_lists static header.
	(next_page): Add get_port_lists handler.

	* src/html/help.xsl (port_lists.html): Remove noclone parameter
	from list-window-line-actions call.

	* src/html/omp.xsl (port_list): Remove noclone parameter from
	list-window-line-icons call.

2013-01-01  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (alert [details]): Output None when the alert has no
	filter attached.

2013-01-01  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c: Add get_alerts static header.
	(next_page): Add get_alerts handler.

2013-01-01  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/help.xsl (alerts.html): Remove noclone parameter
	from list-window-line-actions call.

	* src/html/omp.xsl (alert): Remove noclone parameter from
	list-window-line-icons call.

2012-12-31  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/help.xsl (configs.html): Remove noclone parameter
	from list-window-line-actions call.

	* src/html/omp.xsl (html-config-family-table, html-config-nvt-table):
	Update help documentation icon's title.
	(config): Remove noclone parameter from list-window-line-icons
	call. Change cap-type parameter value to Scan Config.

	* src/gsad_omp.c: Add get_configs static header.
	(next_page): Add get_configs case handler.

2012-12-31  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (openvas_validator_add): Add lsc_credential and Credential
	as valid resource_type and optional_resource_type.

	* src/gsad_omp.c: Add get_lsc_credentials header.
	(next_page): Add get_lsc_credentials handler.

	* src/html/omp.xsl (lsc_credential): Remove noclone parameter from
	list-window-line-icons call.

	* src/html/help.xsl (lsc_credentials.html): Remove noclone parameter
	from list-window-line-actions call.

2012-12-28  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (agent): Remove noclone parameter from
	list-window-line-icons call.

	* src/html/help.xsl (agents.html): Remove noclone parameter from
	list-window-line-actions call.

2012-12-28  Timo Pollmeier <timo.pollmeier@greenbone.net>

	Added OVAL defintion tables, details and help and small fixes
	for links in table footnotes (info_type was missing).

	* src/html/gsad.xsl: Add OVAL definitions item to SecInfo menu

	* src/html/help.xsl: Add help for OVAL definitions:
	Add OVAL definitions entries to contents.html and glossary.html
	New templates: ovaldef.html (OVALDEF details),
	ovaldefs.html (OVALDEF table)

	* src/html/omp.xsl: New templates for OVAL definitions:
	info/ovaldef get_info_ovaldef_lnk html-ovaldef-table ovaldef-details
	Change template get_info_response to recognize OVAL definitions
	Change templates info/cpe info/cve to include info_type in footnote
	link.

2012-12-28  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (details-header-icons): Add cap-type parameter.
	(task [details], lsc_credential [details], agent [details])
	(alert [details], filter [details], target [details], config [details])
	(schedule [details], slave [details], note [details])
	(override [details], port_list [details]): Add cap-type value to
	list-window-line-icons template call.

2012-12-28  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (list-window-line-icons): Add cap-type parameter.
	(task, lsc_credential, agent, alert, filter, target, config, schedule)
	(slave, note, override, port_list): Add cap-type value to
	list-window-line-icons template call.

2012-12-28  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl, src/html/help.xsl: Rename LSC Credential to
	Credential.

2012-12-28  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Help documentation update for Scan Configs.

	* src/html/help.xsl (configs.html, new_config.html): New templates.
	(configure_scanconfigs.html): Remove template.
	(scanconfig_details.html, scanconfig_family_details.html)
	(scanconfig_nvt_details.html, scanconfig_editor.html)
	(scanconfig_editor_nvt_families.html, scanconfig_editor_nvt.html):
	Update documentation pages links. Replace scanconfig with config in
	links to keep consistency with the rest of the documentation.
	(contents.html, glossary.html, task_details.html): Update links to scan
	configuration help pages.

	* src/html/omp.xsl (html-import-config-form, html-config-family-table)
	(html-config-nvt-table, html-config-table): Update documentation links.

2012-12-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-configs-table): Adapt name parameter values for
	column-name template calls.

2012-12-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp (get_config): Set tasks attribute to one.

2012-12-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-configs-table): Pass config to
	filter-window-pager type parameter.

2012-12-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (list-window): Use cap-type parameter instead of type
	parameter for new resource link title.

2012-12-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-create-lsc-credential-form): Fix credentials
	list link.

2012-12-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (export_resource, export_many): Add export flag to OMP
	because at least configs needs this.

2012-12-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (hosts.html): Link to prognostic report in glossary.
	(glossary.html): Add prognostic report entry.
	(view_report.html): Link to prognostic report in glossary.

2012-12-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (agents.html): Clean up sentence slightly.

2012-12-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (glossary.html): Flesh out agent description.  Text
	from Jan.

2012-12-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-port-lists-table): Replace count_all, count_tcp
	and count_udp by total, tcp and udp as arguments for column-name
	template.

2012-12-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/wizard.xsl (wizard): Make visibility depend on full count
	instead of filtered count.

2012-12-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (export_config_omp): Use export_resource.

2012-12-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-port-lists-table): Fix filter-window-pager
	call.

2012-12-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (config): Add link to config details page on config
	name. Use list-window-line-actions template.

2012-12-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-create-config-form): Adapt header icons to new
	style.
	(new_config): New template.
	(html-configs-table): Add filter window, header icons and table sorting
	links.
	(get_configs_response): Remove config creation and importing tables.
	(get_lsc_credentials_response): Fix typo.

2012-12-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (new_config, new_config_omp, export_configs_omp): New
	functions.
	(export_slave_omp, export_slaves_omp): Style fix.

	* src/gsad_omp.h: Add headers accordingly.
	(export_report_formats_omp): Flush trailing whitespace.

	* src/gsad.c (init_validator): Add new_config and export_configs
	commands.
	(exec_omp_get): Add new_config and export_configs handlers.

2012-12-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (delete_trash_config_omp, delete_config_omp)
	(delete_trash_task_omp, delete_trash_lsc_credentials_omp): Use
	delete_resource function.
	(get_configs): New function.
	(get_configs_omp): Use get_configs function.

2012-12-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (xsl_transform_omp): Add children params in a fixed
	named entity instead of using the name of the child param.  This is
	safer because child param names can have names with weird characters
	like colons and brackets.

	* src/html/omp.xsl (gsa:param-or, html-edit-task-form, new_task): Expect
	child params entities to have fixed names.

2012-12-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-cpe-table, html-cve-table)
	(html-port-lists-table): Add full count to pager.

2012-12-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl: Add full-count to all list-window calls.

2012-12-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (filter-window-pager): Add full_count param.  Display
	as total in pager.
	(html-tasks-table): Pass full count to list-window.
	(list-window): Add full_count arg and pass to filter-window-pager.

2012-12-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-port-lists-table): Add column-name template
	calls for Total, TCP and UDP columns.

2012-12-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/help.xsl (lsc_credentials.html): Add Credentials elements
	information table.

2012-12-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Update help documentation.
	New templates for LSC Credentials. Fix outdated links.

	* src/html/help.xsl (list-window-line-actions): Add noexport argument to
	disable outputing help documentation for export button.
	(lsc_credentials.html, new_lsc_credential.html)
	(lsc_credential_details.html): New templates.
	(configure_credentials.html): Remove template.
	(contents.html): Add links to new help pages.
	(new_target.html): Update documentation links for LSC
	Credentials and Port Lists.
	(view_report.html): Update documentation link for Report Formats.

	* src/html/omp.xsl (html-create-lsc-credential-form)
	(html-create-port-list-form, html-import-port-list-form): Update header
	icons links.

2012-12-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (get_lsc_credential): Update template call for
	get_lsc_credentials_response.

2012-12-20  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-lsc-credentials-table): Use correct argument
	for filtered-count.

	* src/gsad_omp.c (delete_lsc_credential_omp): Use delete_resource
	function.
	(get_lsc_credential): Use get_one function.
	(get_lsc_credentials): Use get_many function. Change commands argument
	name to extra_xml.

2012-12-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_tasks): Move the get_tasks_response to follow
	the others, otherwise the error dialogs end up under the table.
	(new_task): Add filter args to container case.

2012-12-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (new_task): Update Wizard and New icons to new style.
	Get overrides value from envelope.

	* src/html/wizard.xsl (wizard-icon): Add filter params.
	(quick_first_scan): Add filter params.  Remove overrides param.

2012-12-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_task_omp): Remove apply_overrides variable
	which is handled by get_tasks now.

	* src/html/omp.xsl (new_task): Add filter params.  Skip the overrides
	param if there is a filt_id, because the overrides param changes the
	filter on the get_tasks page.

2012-12-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (details-header-icon): Add missing filt_id param to
	New icon.

2012-12-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task-icons): New template.
	(task [details], task): Use task-icons in both cases.  This brings
	missing filter params to the details case.

2012-12-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (resource_action): Add missing terminator from last
	commit.

2012-12-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (resource_action): Get success before freeing entity.

2012-12-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-task-form, new_task): Add extra hidden
	Create Task button before "+" button to force Create Task to be the
	default.

2012-12-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Add apply_overrides to default task filter.

2012-12-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (error_window): New template.

	* src/html/help.xsl (hosts.html, cpes.html, cves.html): Add section for
	SCAP warning.

	* src/html/omp.xsl (assets, html-cpe-table, html-cve-table): Show
	warning when SCAP db is missing.
	(host): Show warning and grey prognostic icon when SCAP db is missing.

2012-12-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Add export_lsc_credentials and
	new_lsc_credential commands.

	* src/gsad_omp.c (export_lsc_credentials_omp, new_lsc_credential)
	(new_lsc_credential_omp): New functions.

	* src/gsad_omp.h: Add header accrodingly.

	* src/html/omp.xsl (list-window-line-icons): Add noexport parameter to
	disable adding export icon.
	(lsc-credential-download-icons): New template.
	(lsc_credentials, lsc_credentials [details]): Use
	lsc-credential-download-icons
	(lsc_credentials [details]): Use details-header-icons and minor-details
	(lsc_credential): Set noexport parameter for list-window-line-icons
	template call.
	(get_lsc_credential_response): Remove
	html-create-lsc-credential-form template call. Add gsad_msg and
	delete_lsc_credentials_response template calls.
	(details-header-icons): Add noexport parameter to disable adding export
	icon.

2012-12-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_alert_omp): Get Report Formats to use for
	displaying Report Format name.

	* src/html/omp.xsl (html-create-alert-form, new_alert): Remove
	lsc-credentials parameter.

2012-12-18  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (new_alert_omp): Get Report Formats and Filter Reports.

2012-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (assets): Make the overall prognosis icon available
	only when SCAP data is available.

2012-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (alert [details]): Add Verinice details.

2012-12-17  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (new_lsc_credential): New template.
	(html-lsc-credentials-table): Use list-window table.
	(html-edit-lsc-credential-form): Add icons for list page, details page
	and change help page link.
	(lsc_credential): Add link to details page on credentials names. Use
	list-window-line-icons template.
	(agent): Use list-window-line-icons template.

2012-12-17  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (auto-refresh): New template.
	(old-html-tasks-table, list-window, html-port-lists-table): Use
	auto-refresh.
	(html-targets-table): Use list-window.

2012-12-17  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-port-lists-table): Use column-name template
	to make Name column sortable.

2012-12-17  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (contents.html): Add missing closing ul tag.

2012-12-14  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/help.xsl (contents.html): Update alerts documentation links.

2012-12-14  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Update Alerts help documentation to reflect latest changes.

	* src/html/help.xsl (new_alerts.html, alerts.html)
	(alert_details.html): New templates.
	(configure_alert.html): Remove template.

2012-12-14  Matthew Mundell <matthew.mundell@greenbone.net>

	Carry fields over with the Edit Task "+" submit.

	* src/gsad_omp.c (save_task_omp): Go to Edit Task page if "+" button is
	pressed.

	* src/html/omp.xsl (html-edit-task-form): If there a values for the
	fields in the ENVELOPE from the "+" then use those instead of the task
	values.

2012-12-14  Matthew Mundell <matthew.mundell@greenbone.net>

	Rename the "+" on New Task from "submit" to "submit_plus".  This is
	because IE apparently sends only one submit parameter when there are
	two submit inputs with the same name.

	* src/gsad.c (init_validator): Rename submit to submit_plus.

	* src/gsad_omp.c (create_task_omp): Expect + in submit_plus param.

	* src/html/omp.xsl (new_task): Rename + submit button to submit_plus.

2012-12-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (xsl_transform_omp): Add the collection parameters like
	"alert_id_optional:0" to ENVELOPE/PARAMS too.

	* src/html/omp.xsl (new_task): Carry all fields with the New Task "+"
	submit.

2012-12-14  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-port-lists-table): Add filter-window-pager
	template.

2012-12-13  Matthew Mundell <matthew.mundell@greenbone.net>

	Carry text fields with the New Task + submit.

	* src/html/omp.xsl (gsa:html-attribute-quote, gsa:param-or): New
	functions.
	(new_task): Wrap text field values in param-or calls.

2012-12-13  Matthew Mundell <matthew.mundell@greenbone.net>

	Make the New Task + submit actually add an alert.

	* src/gsad_omp.c (create_task_omp): Increment the alerts parameter for
	the + submit.

	* src/html/omp.xsl (new_task): Add alerts param for + submit.

2012-12-13  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch to submit button for adding alerts on the New Task page.  This
	still loses the user's input, but is done via the form instead of a
	second link.

	* src/gsad.c (init_validator): Add submit.

	* src/gsad_omp.c (create_task_omp): If submit is + then serve New Task
	page.

	* src/html/omp.xsl (new_task): Replace + link with submit button.

2012-12-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-task-form): Skip the overrides param if
	there is a filt_id, because the overrides param changes the filter on
	the get_tasks page.

2012-12-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_config_nvt_omp): Declare the password iterator
	locally otherwise it messes up the outer param iterator.  Rename this
	password iterator and the file iterator, instead of shadowing the outer
	one.

2012-12-13  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (delete_alert_omp): Correct passed get function.

2012-12-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Add actions to OMP GET for task observers.

2012-12-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-task-form, task): Add filter params to and
	remove overrides params from task icons.
	(gsa:alert-in-trash): New function.
	(task [trash]): Use gsa:alert-in-trash for restore check, because there
	are multiple alerts now.
	(list-window): For the refresh in the header, get the filter from
	FILTERS/TERM and remove the filt_id param.  This keeps the existing
	filtering but drops the actual named filter, otherwise the new
	apply_override could conflict with the filter.

2012-12-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_tasks): Prepend apply_overrides to the filter
	according to the overrides request param.

	* src/html/omp.xsl (list-window-line-icons): Add extra-params-details.
	(task): Pass overrides in extra-params-details.
	(list-window): Enable overrides control for Tasks page.

2012-12-12  Hani Benhabiles  <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-create-alert-form): Update help link. Add
	Alerts list link.
	(new_alert): New template.
	(html-alerts-table): Use list-window.
	(alert): Link alert names to their details page. Use
	list-window-line-icons, detail-headers-icons and minor-details templates.
	(get_alerts): Remove html-create-alert-form call.

2012-12-12  Hani Benhabiles  <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (new_alert_omp): New function. Correct typo in
	changelog.

2012-12-12  Hani Benhabiles  <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (new_alert, export_alert_omp, export_alerts_omp):
	New functions.

	* src/gsad_omp.h: Add headers accordingly.

	* src/gsad.c (init_validator, exec_omp_get): Add new_alert, export_alert
	and export_alerts command.

2012-12-12  Hani Benhabiles  <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (delete_alert_omp, delete_trash_alert_omp): Use
	delete_resource.
	(get_alert): New function. Use get_one.
	(get_alert_omp): Use get_alert.
	(get_alerts_omp): Use get_many.
	(get_alerts_xml): Remove unused function.

2012-12-12  Hani Benhabiles  <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (export_target_omp, export_note_omp)
	(export_override_omp): Use export_resource.

2012-12-12  Hani Benhabiles  <hani.benhabiles@greenbone.net>

	Add alerts information in Report Formats details page.

	* src/gsad_omp.c (get_report_format): Add alerts attribute in get_one
	request.

	* src/html/omp.xsl (report_format [details]): Add Alerts using this
	Report Format table.

2012-12-12  Matthew Mundell <matthew.mundell@greenbone.net>

	Add the refresh input to the headers of the new-style get pages.

	* src/gsad_omp.c (xsl_transform_omp): Add AUTOREFRESH to ENVELOPE.

	* src/html/gsad.xsl (autorefresh): Get the URL from the ENVELOPE instead
	of always using get_tasks.

	* src/html/omp.xsl (list-window): Add the refresh input that was
	previously on the tasks page.

2012-12-12  Hani Benhabiles  <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (export_report_format_omp): Use export_resource.

2012-12-11  Hani Benhabiles  <hani.benhabiles@greenbone.net>

	Update help documentation for Port Lists.

	* src/html/help.xsl (port_lists.html, new_port_list.html)
	(port_list_details.html): New templates. Use various templates and
	content from configure_port_lists.html.
	(configure_port_lists.html): Removed.
	(report_formats.html): Fix typo.

2012-12-11  Hani Benhabiles  <hani.benhabiles@greenbone.net>

	* src/gsd_omp.c (get_port_list): Send targets and ranges attributes
	instead of details.

2012-12-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/wizard.xsl (wizard-icon, wizard): Let page element determine
	visibility.

2012-12-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_base.c (params_add): Ensure that name and value are always
	strings.

	* src/html/omp.xsl (details-header-icon): Remove extra ampersand from
	New link.

2012-12-11  Hani Benhabiles  <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (details-header-icons): Add noedit parameter.
	(port_list [details]): Fix type parameter and use noedit parameter
	for details-header-icons template call.

2012-12-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_many): Get the Wizard Rows setting too.

	* src/html/omp.xsl (list-window): Call wizard-icon and wizard.

	* src/html/wizard.xsl (wizard-icon, wizard): New templates.

2012-12-10  Hani Benhabiles  <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_port_list): Use get_one function. Rename commands
	parameter to extra_xml for consistency.
	(get_port_lists): New function.
	(get_port_lists_omp): Use get_port_lists function.
	(delete_port_list_omp, delete_trash_port_list_omp)
	(delete_port_range_omp): Use delete_resource adequately.

2012-12-10  Hani Benhabiles  <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (port_list [details]): Use details-header-icon and
	minor-details templates.

	* src/gsad_omp.c (export_port_list_omp): Remove trailing whitespace.

2012-12-10  Hani Benhabiles  <hani.benhabiles@greenbone.net>

	Add Port Lists exporting.

	* src/gsad_omp.c (export_port_lists_omp): New function.
	(export_port_list_omp): Use export_resource.

	* src/gsad_omp.h: Add header accordingly.

	* src/gsad.c (init_validator, exec_omp_get): Add export_port_lists
	command.

2012-12-10  Hani Benhabiles  <hani.benhabiles@greenbone.net>

	Add New Port List page.

	* src/gsad_omp.c (new_port_list, new_port_list_omp): New functions.

	* src/gsad_omp.h: Add header accordingly.

	* src/gsad.c (init_validator, exec_omp_get): Add new_port command.

	* src/html/omp.xsl (html-create-port_list-table): Rename to
	html-create-port-list-table to follow the same naming style.
	(get_port_lists): Remove port list create and import template calls.
	(new_port_list): New template.

2012-12-10  Hani Benhabiles  <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (list-window-line-icons): Add support for noclone and
	noedit parameters to disable edit and clone icons.
	(html-port-lists-table): Use filter-window-pager and
	list-window-line-icons template. Add various links.

2012-12-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-tasks-table): Correct replace typo.

2012-12-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (list-window): Remove anchor from top row of
	multi-row heading.

2012-12-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-tasks-table): Call through to list-window.
	(old-html-tasks-table): New template.  Body from html-tasks-table.
	(list-window): Extend the header generation for headers over multiple
	rows, as in Tasks header.

2012-12-07  Matthew Mundell <matthew.mundell@greenbone.net>

	Only pass parameters into the XML in the ENVELOPE if their values are
	valid UTF8.

	* src/gsad_base.h (struct param): Add valid_utf8.

	* src/gsad.c (params_mhd_validate_values): Init valid_utf8 in params.
	When param is valid run g_utf8_validate on value to set valid_utf8.

	* src/gsad_omp.c (xsl_transform_omp): Only print param in ENVELOPE if
	param value is valid utf8.

	* src/gsad_base.c (params_add): Clear valid_utf8.

2012-12-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-task-table): Remove.  Now html-tasks-table.
	(html-tasks-table): New template.  Was html-task-table.  Add pager and
	filter window.
	(task): Make name a link to the task details.
	(get_tasks_response): Update html-task-table call.
	(list-window-line-icons, details-header-icons): Flush trailing
	whitespace.

	* src/gsad_omp.c (get_many): Add marker for get_settings.
	(get_tasks): Call get_many.

2012-12-06  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/help.xsl (list-window-line-actions): Add noclone and noedit
	parameters to be able to omit clone and edit information.
	(agents.html): Use the new form of list-window-line-actions.
	(report_formats.html): Use noclone for list-window-line-actions
	template. Add Verify Report Format information.

2012-12-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/next.png, src/html/img/previous.png: New.

	* CMakeLists.txt: Install the new icons.

	* src/html/omp.xsl (filter-window-pager): Use new Icons for
	Next/Previous as a replacement for "<<" and ">>".

2012-12-06  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Update Report Formats help documentation.

	* src/html/help.xsl (configure_report_formats.html): Renamed to
	report_formats. Updated the content to match the new style.
	(new_report_format, report_format_details): New templates.
	(contents.html): Updated links to Report Formats help documentation.

2012-12-06  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (details-header-icons, list-window-line-icons):
	Replace space by underscore for type-lower variable in order to allow
	the use of multiple words types such as Report Formats without breaking
	links.

2012-12-05  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Add Export Report Formats.

	* src/gsad_omp.c (export_report_formats_omp): New function.

	* src/gsad_omp.h: Add header accrodingly.

	* src/gsad.c (init_validator, exec_omp_get): Add export_report_formats
	command. Fix indentation.

2012-12-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_report_formats): Correct typo.  Flush trailing
	space.

2012-12-05  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (details-header-icons): Check writable value when
	displaying edit and delete icons.
	(get_report_format): Call report_format template in details mode.

2012-12-05  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (new_note): Revert previous change to take into
	account task_id and result_id values.

2012-12-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (new_schedule): Default First Time fields to current
	time.

2012-12-04  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (next_page): Add handlers for get_report_format and
	get_report_formats.
	(check_modify_report_format): Remove unused function.
	(save_report_format_omp): Refactor to leverage omp, next_page and
	omp_success functions.

2012-12-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-target-form): Add missing filt_id arg to
	header icons and remove old max and first args.
	(html-edit-note-form, html-edit-override-form): Add list icon in header.

2012-12-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (delete_agent_omp, delete_trash_agent_omp)
	(delete_trash_report_format_omp, delete_trash_slave_omp)
	(delete_report_format_omp, edit_report_format): Code refactoring to
	leverage delete_resource and edit_resource.

2012-12-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator, exec_omp_get): Added new_report_format
	command.

	* src/gsad_omp.c, src/gsad_omp.h (get_report_format)
	(get_report_format_omp, get_report_formats, get_report_formats_omp):
	Refactored to leverage get_one and get_many functions.
	(new_report_format, new_report_format_omp): New functions.
	(save_report_format_omp): Adapt for get_report_format and
	get_report_formats.

2012-12-03  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Update Report formats management.

	* src/html/omp.xsl (html-report-formats-table): Use list-window.
	(html-import-report-format-form): Renamed to
	html-create-report-format-form.
	(html-import-report-format-form, html-edit-report-format-form): Updated
	title and links to follow the new style.
	(report_format [details]): Use details-header-icons and minor-details.
	Update various links.
	(new_report_format): New template.
	(get_report_formats): Update to match new style.

2012-11-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Updated help documentation for Agents object.

	* src/html/help.xsl (list-window-line-actions): Output the resource type
	for export header.
	(configure_agents.html): Removed template.
	(agent_details.html, agents.html, new_agent.html [help]): New templates.
	Using the same style of documentation as other resources using the new
	GET style object management.
	(contents.html, glossary.html): Updated with new links and information.

2012-11-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (save_slave_omp): Refactored code to use omp function.

2012-11-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator, exec_omp_get): Added new_agent command.

	* src/gsad_omp.c (new_agent_omp, new_agent): New functions.

	* src/html/omp.xsl (agent): Added get agent details action.

2012-11-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (agent): Added action entry for agent exporting.
	(agent [details], get_agent): New templates.

2012-11-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.h, src/gsad_omp.c (export_agents_omp, export_agent_omp)
	(get_agent, get_agent_omp): New functions.
	(export_many): Sends details attribute with a value of One.

2012-11-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-create-agent-form, agent, get_agents_response):
	Adapted for new GET style.
	(new_agent): New template.
	(html-agents-table): Refactored to use list-window template.

2012-11-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c, src/gsad_omp.c, src/gsad_omp.h (get_agent_omp): Renamed to
	download_agent_omp. Adequated GSA command renamed from get_agent to
	download_agent.

2012-11-29  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-edit-schedule-form): Add a dropdown option
	containing the first time's year when it is out of the range 2012-2017.

2012-11-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-schedule-form)
	(html-edit-schedule-form): Replace number dropdowns in duration and
	period with text input fields.  Update "first time" year range to
	2012-2017.

2012-11-28  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (save_task_omp): Removed sort_field and sort_order.

2012-11-28  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (save_task_omp): Removed sort_field and sort_order.

2012-11-28  Hani Benhabiles <hani.benhabiles@greenbone.net>

	Updated Slaves management documentation to reflect the new object
	management style and features.

	* src/html/help.xsl (configure_slaves.html): Template removed.
	(slave_details.html, slaves.html, new_slave.html): New templates.

2012-11-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Separate token missing and token bad
	messages.

2012-11-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (slave [details]): Refactored code to use shared
	templates details-header-icons and minor-details.

2012-11-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Split default report check
	per report type, to make it easier to patch for custom report formats.

2012-11-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.h, src/gsad_omp.c (save_slave_omp): New function.

	* src/gsad.c (init_validator, exec_omp_post): Added edit_slave and
	save_slave values.

	* src/html/omp.xsl (modify_slave_response, html-edit-slave-form)
	(edit_slave): New templates.
	(html-edit-schedule-form): Fixed help link.

2012-11-27  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Added export_slave and export_slaves
	values. Added slave to possible values of resource_type and
	optional_resource_type.
	(export_omp_get): Added handlers for export_slave and export_slaves
	commands.

	* src/gsad_omp.c (next_page): Added handler for get_slaves value.

2012-11-26  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-slaves-table): Refactored code to use
	list-window.
	(create_slave_response): Added links to each slave details page in the
	list.
	(slave): Refactored code to use list-window-line-icons.
	(get_slaves): Added code to test for 4xx and 5xx status responses.

2012-11-26  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (export_filter_omp): Fixed documentation.

2012-11-26  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (edit_slave, edit_slave_omp, export_slave_omp)
	(export_slaves_omp): New functions.

2012-11-26  Henri Doreau <henri.doreau@greenbone.net>

	* src/gsad_omp.c (save_task_omp, save_container_task_omp): Removed
	set-but-unused variables to get rid of the corresponding GCC warning.

2012-11-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_lsc_credential_omp, delete_alert_omp)
	(test_alert_omp, new_target_omp, create_target_omp, get_targets_omp)
	(save_target_omp, get_my_settings, edit_my_settings, save_my_settings)
	(new_filter, create_filter_omp): Close connection after use.

	* src/gsad_oap.c (edit_user_oap, get_user_oap, get_users_oap)
	(get_feed_oap, get_scan_oap, sync_feed_oap, sync_scap_oap)
	(get_settings_oap): Close connection after use.

2012-11-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (delete_schedule_omp, delete_trash_schedule_omp)
	(delete_target_omp, delete_trash_target_omp): Refactored to use
	delete_resource accordingly.

2012-11-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_slave, get_slaves): New functions.
	(delete_slave_omp): Now uses delete_resource.
	(get_slave_omp): Now uses get_slave.
	(get_slaves_omp): Now uses get_slaves.

2012-11-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-create-slave-form): Added link to slaves list.
	Updated to link to new style help documentation.

2012-11-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (new_slave): New template.

2012-11-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (exec_omp_get, init_validator): Added new_slave command.

2012-11-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c, src/gsad_omp.h (new_slave, new_slave_omp): New
	functions.

2012-11-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (new_schedule): Updated link to new schedule help
	page.

2012-11-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/gsad.xsl (login_page): Added autofocus on username field to
	automatically select it at page load and improve user experience.

2012-11-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (new_schedule): Added delete_schedule_response
	commands_response.

2012-11-24  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/omp.xsl (html-create-schedule-form): Added button to show
	list of schedules

2012-11-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (omp): Close connection afterwards.

2012-11-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-task-table): Remove tracing from last commit.

2012-11-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-task-table): Convert $wizard-rows to number
	before doing comparison with task count.

2012-11-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-filter-form, html-edit-filter-form): Add
	Note and Override to types.

2012-11-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/help.xsl (schedule_details.html, schedules.html)
	(new_schedule.html, contents.html): Updated to reflect the new Schedules
	object management.

2012-11-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/gsad.xsl (new_schedule): New template.
	(html-schedules-table): Cleaned code. Now calls list-window.
	(schedule): Each schedule now links to its details page. Now calls
	list-window-line-icons.
	(schedule [details]): Refactored code to use details-header-icons and
	minor-details.
	(get_schedules): Code cleanup and refactoring.

2012-11-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c, src/gsad_omp.h (new_schedule_omp, export_schedule_omp)
	(export_schedules_omp): New functions.

	* src/gsad_omp.c (get_schedules, get_schedule, new_schedule): New
	functions.
	(get_schedule_omp): Now calls get_schedule.
	(get_schedules_omp): Now calls get_schedules.

2012-11-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (new_note): Code cleaned.

2012-11-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	New schedule object management implementation.

	* src/gsad.c (exec_omp_get): new commands: export_schedule and
	export_schedules. Also checks for new_schedule command now.
	(init_validator): Added export_schedule and export_schedules commands.

2012-11-21  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/gsad.xsl (sync_scap_response): Added SCAP Synchronization
	template for response indicator.

2012-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_tasks): Match create_task_response, for cloning.

2012-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-task-table): Widen actions column.
	(task): Make start icon margins consistent.  Introduce standard icons.

2012-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (contents.html): Add New Task.  Rename Reports to
	Task Details and Reports.
	(reports.html): Remove.  Now task_details.html.
	(task_details.html): New template.  Was reports.html.  Update jump
	link.  Rename header.

2012-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator, exec_omp_get): Add export_task and
	export_tasks.

	* src/gsad_omp.c (export_task, export_tasks): New functions.

	* src/gsad_omp.h: Add headers accordingly.

2012-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task [details]): Rename Task Summary to Task
	Details.  Introduce new style icons.

2012-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_tasks_args): Remove.  Merged into only caller.
	(get_tasks): Add get_task_args body.  Remove commands arg.  Callers all
	now do this themselves.

2012-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (run_wizard_omp): Run the OMP directly, and use
	next_page.

	* src/html/gsad.xsl (html-gsa-logo): Adjust indicator path accordingly.

2012-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_container_task_omp): Run the OMP directly, and
	use next_page.

2012-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	Separate get_task handling from get_tasks, and simplify some of the
	tasks page handlers.

	* src/gsad.c (init_validator, exec_omp_get): Add get_task.
	(exec_omp_post): Remove get_tasks, which is in exec_omp_get.

	* src/gsad_omp.c (omp_success, omp): Move up in file.
	(next_page): Add get_task.
	(resource_action): New function.
	(create_report_omp): Combine cases.  Use next_page instead of get_task
	function.
	(delete_task_omp, delete_report_omp): Switch to delete_resource.
	(CHECK): New macro.
	(save_task_omp): Use omp and next_page.
	(save_container_task_omp): Add get_task calls temporarily.
	(stop_task_omp, pause_task_omp, resume_paused_task_omp)
	(resume_stopped_task_omp, start_task_omp): Switch to resource_action.
	(get_info): Adjust formatting.
	(get_tasks_args): Remove task_id arg and case.
	(get_task): New function.  Like get_tasks_args task_id case.
	(get_task_omp): New function.
	(run_wizard_omp): Adjust get_tasks_arg call.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/gsad.xsl (html-gsa-logo): Adjust indicator paths accordingly.

	* src/html/omp.xsl: Replace all get_tasks links that have task_ids with
	get_task links.
	(html-report-table): Remove, now task.
	(task [details]): New template.  Was html-report-table.  Adjust paths
	to be like other details templates.
	(report): Add next to delete icon.
	(get_tasks_response): Remove single task case.
	(get_task): New template.
	(get_tasks): Match delete_task_response.

2012-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_my_settings): Make Wizard Rows odd.

2012-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add missing separators to last commit.

2012-11-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add pretty names to types.

	* src/html/omp.xsl (html-create-filter-form)
	(html-edit-filter-form): Expect pretty type names.

2012-11-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (quick-first-scan-wizard): Correct text about when
	the wizard appears.

2012-11-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_task_omp): Get the tasks with get_tasks instead
	of by hand.

	* src/html/gsad.xsl (html-gsa-logo): Adjust indicator path accordingly.

2012-11-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_target): Request tasks, so that "Tasks using this
	Target" show up.

2012-11-15  Benhabiles Hani <hani.benhabiles@greenbone.net>

	* src/gsad_omp.c (get_target): Removed old code. Now uses get_one().

2012-11-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/wizard.xsl (quick-first-scan-wizard): Set refresh_interval to
	30.

2012-11-15  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/help.xsl (list-window-line-actions): Fixed icone for Clone
	action.

2012-11-15  Andre Heinecke <aheinecke@intevation.de>

	* src/gsad_omp.c (get_info): Fix coding style.

2012-11-15  Andre Heinecke <andre.heinecke@greenbone.net>

	* src/gsad_omp.c (get_info): Set a default filter for CVE

2012-11-15  Andre Heinecke <andre.heinecke@greenbone.net>

	* src/html/omp.xsl (cve-details): Add gb_window classes. Add list icon.
	Change style of the upper right information to be in line with the rest.

2012-11-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (host): Use a filter instead of multiple
	parameters in the Last Report link.  Within the filter use the new
	exact term syntax for the IP, so that the filter matches only that
	single IP.

2012-11-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [assets]): Use a filter instead of multiple
	parameters in the Last Report link.  Within the filter use the new
	exact term syntax for the IP, so that the filter matches only that
	single IP.

2012-11-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (powerfilter.html): Add example for exact term.
	Clarify what the substring term example will match.

2012-11-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (powerfilter.html): Add empty and N/A example and
	syntax.

2012-11-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (powerfilter.html): Add Date Format section.

2012-11-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (powerfilter.html): Improve text slightly.

2012-11-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Remove duplicate
	delete_report_format response indicator.

2012-11-13  Andre Heinecke <andre.heinecke@greenbone.net>

	Add CVE Browse mode.

	* src/html/gsad.xsl (html-gsa-navigation): Add CVE entry in SecInfo Menu.

	* src/html/help.xsl (contents.html): Add link to cves.html help page.
	(cves.html): New. Help Page for CVE browser.
	(cve.html): Updated to reflect that cve is no longer obtained by lookup.
	(glossary.html): Add short entry about CVSS.

	* src/html/omp.xsl (info/cve): New. Table contents of CVE Table.
	(get_info_cve_lnk): Add details parameter.
	(html-cve-table): New. The main CVE browse table.
	(get_info_response): Use the new templates for CVE.
	(cve-details): Updated to work with new get_info structure.

	* src/html/dialog.xsl (browse_infosec.html): Remove CVE Lookup.

2012-11-12  Matthew Mundell <matthew.mundell@greenbone.net>

	Use the next_page facility when importing reports.  In the process this
	ensures that the observers are included in the Tasks page following the
	import; thanks to Felix Wolfsteller for spotting this.

	* src/html/omp.xsl (html-report-table, html-edit-task-form)
	(new_task): Add next arg to create_report form.
	(get_tasks): Match create_report_response.

	* src/html/gsad.xsl (html-gsa-logo): Adjust create_report indicator
	path.

	* src/gsad_omp.c (next_page): Add get_tasks.
	(create_report_omp): For the second case, let next_page handle the next
	page, instead of doing the GET_TASKS OMP by hand.
	(get_tasks_args): New function.  Body from get_tasks.  Adjust all
	get_tasks callers to call this instead.
	(get_tasks): Reduce params to match similar functions.  Call through to
	get_tasks_args.
	(get_tasks_omp): Just call get_tasks.

2012-11-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* ChangeLog: Fixed formatting issues from last updates.

2012-11-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/html/oap.xsl: Added describe_scap_response, html-scap-response and
	sync_scap_response templates.

	* src/html/help.xsl: Added scap_management.html template.

	* src/html/gsad.xsl: Added SCAP Feed submenu.

2012-11-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (init_validator): Added entries for get_scap and sync_scap.
	(exec_omp_post): Added entry for sync_scap.
	(exec_omp_get): Added entry for get_scap.

	* src/gsad_oap.h: Added get_scap_oap and sync_scap_oap.

	* src/gsad_oap.c: Added get_scap_oap and sync_scap_oap.

2012-11-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (content_type_from_format_string): Small documentation fix
	in r14449.

2012-11-07  Hani Benhabiles <hani.benhabiles@greenbone.net>

	* src/gsad.c (token_user): Fixed return value when a bad token is
	provided.

2012-11-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-override-form): Add fragment to
	save_override form action so that position stays on result.  Add
	filter params.  Reduce the number of pass-through params, getting them
	from the envelope instead of the current context.

2012-11-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (contents.html): Add Overrides subpages.
	(new_override.html, override_details.html): New templates.
	(overrides.html): Add list icon link.  Match to new style.

2012-11-06  Matthew Mundell <matthew.mundell@greenbone.net>

	Make the New Override page function "standalone", so it works from the
	New Override icon on the Overrides page.

	* src/gsad.c (init_validator): Add params for manual override field
	entry.

	* src/gsad_omp.c (new_override): New function.  Body from
	new_override_omp.  Add extra_xml arg.  Remove param checks because there
	might just the new style filter params.  Add a new case for the
	standalone New Override page, which gets the tasks.
	(new_override_omp): Call through to new_override.
	(create_override_omp): Add param check gaurds.  Check if override params
	have been entered in the manual params.  Call the CREATE_OVERRIDE
	directly instead letting the handler for the next page do it.  Choose
	next page more automatically.

	* src/html/omp.xsl (html-create-override-form): Add new filter params to
	form.  Get next from envelope so any caller can specify it.  Correct
	name of task_id param.  Add missing apply_overrides param.  Add cases
	for manual entry of fields, for standalone page.  Make Associated Result
	sectional conditional.  Add list icon.  Update help link.
	(new_override): Match create_override_response too.
	(result-detailed): Add apply_overrides and next to New Override links.

2012-11-06  Matthew Mundell <matthew.mundell@greenbone.net>

	Add trashcan feature to overrides.

	* src/gsad.c (init_validator, exec_omp_post): Add delete_trash_override.

	* src/gsad_omp.c (delete_trash_override_omp): New function.
	(get_trash): Get trash overrides too.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/gsad.xsl (html-gsa-logo): Update indicator paths and add
	missing cases.

	* src/html/omp.xsl (override [trash], html-overrides-trash-table): New
	templates.
	(override-detailed-delete-params): Remove.
	(override-detailed): Replace delete icon with trashcan.  Add clone icon.
	Update icon and Report links.
	(get_trash): Add overrides.

2012-11-06  Matthew Mundell <matthew.mundell@greenbone.net>

	Add filtering to overrides.

	* src/gsad.c (init_validator): Add override to resource types.
	Add export_overrides.
	(exec_omp_get): Add export_overrides.

	* src/gsad_omp.c (next_page): Add overrides commands.
	(export_overrides_omp): New function.
	(get_overrides, delete_override_omp, edit_override_omp): Switch to
	generic function.  Adjust callers.
	(get_override): Add extra_xml arg and override_id check.  Adjust
	callers.
	(edit_override): New function.
	(save_override_omp): Use omp and next_page conveniences.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (html-report-table, nvt): Replace overrides section
	with link to overrides.
	(override): Use list-window-line-icons.
	(override [nvt-details]): Remove.
	(override [details]): Use details-header-icons and minor-details.
	(html-overrides-table): Call list-window.
	(get_overrides): Apply like the other commands.

2012-11-05  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump to 4.0+beta5.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2012-11-05  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 4.0+beta4 release.

	* CHANGES: Updated.

2012-11-02  Andre Heinecke <aheinecke@intevation.de>

	* src/html/omp.xsl (html-create-alert-form): Replace verinice.PRO ip /
	port by url. Consistently use the name verinice.PRO.

2012-11-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (html-create-note-form, html-create-override-form):
	Added a clearifying hint what is meant with the Result UUID.

2012-11-02  Michael Wiegand <michael.wiegand@greenbone.net>

	* CHANGES: Prepared for the next beta release.

2012-11-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (info/cpe): Change String for NULL from
	"Not Available" to the shorter "N/A".

2012-11-01  Michael Wiegand <michael.wiegand@greenbone.net>

	* INSTALL: Update reference system section and prerequisites, update
	instructions to use out-of-source building, add missing target.

2012-11-01  Michael Wiegand <michael.wiegand@greenbone.net>

	Update targets for out-of-source builds.

	* doc/CMakeLists.txt: Update commands and targets to work with
	out-of-source builds.

	* doc/Doxyfile.in: Updated to work with out-of-source builds,
	harmonized with other modules.

	* doc/Doxyfile_full.in: Harmonized with Doxyfile.in.

	* src/CMakeLists.txt: Ensure that the target "splint", "rats",
	"flawfinder", "etags" and "ctags" work with out-of-source builds.

2012-11-01  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/omp.xsl (html-create-alert-form): Add support for creating
	a verinice .PRO server connector alert.

2012-10-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_note_omp): Remove next var as next is now done
	via next_page.

2012-10-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-schedule-form): Correct help link.

	* src/html/help.xsl (configure_schedules.html): Add Edit Schedule
	action.

2012-10-30  Matthew Mundell <matthew.mundell@greenbone.net>

	Add editing of schedules.

	* src/gsad.c (init_validator, exec_omp_get, exec_omp_post): Add
	edit_schedule and save_schedule.  Add timezone validator.

	* src/gsad_omp.c (next_page): Add get_schedules.
	(edit_schedule, edit_schedule_omp, save_schedule_omp): New functions.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/omp.xsl (html-schedule-table)
	(html-schedules-trash-table): Remove unit.  Units are in the column.
	(modify_schedule_response, schedule-select-options)
	(html-edit-schedule-form, edit_schedule): New templates.
	(schedule): Add edit icon.

2012-10-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (schedule): Update next_time check and format
	next_time like the other cases.

2012-10-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (schedule [details]): Match field names to Schedules
	page columns.  If the schedule is over just put a - for Next Time.

2012-10-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (gsa:date-tz, gsa:long-time-tz): New functions.
	(html-report-table, schedule, schedule [details]): Append timezone to
	schedule times.  Add timezone field to Schedule Details.

	* src/html/help.xsl (configure_schedules.html): Add timezone.

2012-10-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* ChangeLog: End every sentence with a full stop.

2012-10-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (powerfilter.html): Simplify first sentence.
	Describe usual default.  Add example with new special columns.  Add
	subsection for Column Keywords, with info about possible column names.
	Add subsection for Special Keywords, with new ones.

	* src/html/omp.xml (filter-window-part, html-report-details): Add help
	link alongside filter field.

2012-10-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_task): Default to 1 alert instead of 2.

2012-10-25  Andre Heinecke <aheinecke@intevation.de>

	* src/html/omp.xsl (get_info_response): Show cpe-table also when no
	cpe's are found. Handle scap DB not loaded.

2012-10-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_agents_response, get_filters, get_targets): Add
	fail status dialog.

2012-10-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/wizard.xsl (quick-first-scan-wizard): Specify UUID for
	setting, else it just gets the first one.

2012-10-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-alert-form): Make the filter ID for "--"
	"0" so that it validates.

2012-10-19  Andre Heinecke <aheinecke@intevation.de>

	* src/html/omp.xsl (wrap): Add linebreak to the default marker.

2012-10-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Pass details flag with getting the
	"assets" report for a single host.

2012-10-18  Andre Heinecke <aheinecke@intevation.de>

	Do not jump to filter page after adding a filter for CPE.

	* src/gsad_omp.c (get_info): Renamed get_info_omp to get_info.
	(get_info_omp): New.  Wrapper around get_info without extra_xml.
	(next_page): Call get_info for get_info next.
	* src/gsad_omp.h: Add header accordingly.
	* src/html/omp.xsl (filter-window-pager): Add extra_params to new filter
	form.

2012-10-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (openvas_append_xml): Remove.  Now xml_string_append in
	libraries.  Update all calls to new name.

2012-10-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Renamed menu item "Lookup".

	* src/html/dialog.xsl (browse_infosec.html): Removed entry field for CPE because this
	is handled in the new CPE management.

	* src/html/help.xsl: Moved details on CPE elements to glossary.

2012-10-15  Andre Heinecke <aheinecke@intevation.de>

	Add CPE Overview table with filtering

	* src/gsad_omp.c (get_many): Add extra_attribs parameter. Handle non
	countable type info. Update callers.
	(get_info): Removed.
	(get_info_omp): Call get_many with the appropiate extra_attribs

	* src/gsad.c (init_validator): Add validators for info_id and details,
	allow filters of type info.

	* src/html/omp.xsl: Include exslt common.
	(gsa:date): New. Convert ISO date to just the date without time.
	(gsa:type-many): New. Get the plural form of a type.
	(filter-window-pager): Add optional extra_params parameter to include in
	generated links.
	(filter-window-part): Add optional extra_params parameter to add as hidden
	form fields. Expects a node-set.
	(wrap, wrap-line): Add params width and marker to specifiy the width
	and symbol used for breaking a line.
	(column-name): Add extra_params parameter to include in generated links.
	(info/cpe): New. Generate table rows for CPE table.
	(get_info_cpe_lnk): Wrap the text part of the link.
	(html-cpe-table): New. Generate an overview table for CPE.
	(get_info_response, cve-details): Handle new response style.
	(cpe-details): Expand with new information. Update Style.
	(html-create-filter-form, html-edit-filter-form): Allow filters of type
	info.

	* src/html/gsad.xsl (html-gsa-navigation): Add link to CPE.

	* src/html/help.xsl (contents.html): Remove misplaced links to CPE and
	CVE. Add link to cpes doc.
	(cpe.html): Expand and update documentation of CPE Details page.
	(cpes.html): New. Document CPE overview table.

	* src/html/dialog.xsl (browse_infosec.html): Add details parameter to
	lookup requests.

2012-10-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-filter-form)
	(html-create-target-form): Add filters to list icon link.
	(html-create-note-form): Add list icon.
	(html-targets-table): Add filter to New Target link.

2012-10-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (list-window-line-actions): New template.
	(contents.html): Add Notes subpages.
	(filters.html): Use template for filtering section.
	(new_note.html, note_details.html): New template.
	(notes.html): Add list icon link.  Match to new style.

	* src/html/omp.xsl (html-create-note-form): Update help link.

2012-10-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (note [nvt-details]): Remove.  NVT Details just has
	link to notes now.

2012-10-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host): Remove extra opening xsl:if.

2012-10-11  Matthew Mundell <matthew.mundell@greenbone.net>

	Clear out more of old filter param handling.

	* src/gsad.c (init_validator): Add report_result_id.

	* src/html/gsad.xsl (html-gsa-logo): Apply missing note response
	indicators.

	* src/html/omp.xsl (html-report-details, html-create-note-form)
	(html-edit-note-form, note-detailed, result-details)
	(result-detailed): Remove old filter params, making sure that new params
	and the overrides flag are always included.  Also add param
	report_result_id for the Result Details page because in some cases the
	result to return to on the report is different from the result being
	viewed on the details page.
	(get_delta_result): Apply responses from note operations.

2012-10-11 Michael Meyer <michael.meyer@greenbone.net>

	* src/html/omp.xsl (host):
	 Added MAC address, IP, Interface name of all interfaces to be
	 displayed in the hardware section.

2012-10-09  Matthew Mundell <matthew.mundell@greenbone.net>

	Clear out most of old filter param handling in notes.

	* src/gsad_omp.c (next_page): Add get_note.
	(clone_omp): Improve comments slightly.
	(get_result): Remove old filter params.
	(get_note): Add extra_xml arg.  Update caller.
	(edit_note): New function.  Body from edit_note_omp.  Add extra_xml arg.
	Remove old filter params.  Remove checks of params for following pages,
	the pages can do those checks.
	(edit_note_omp): Call through to edit_note.
	(save_note_omp): Remove old filter params.  Remove Task and NVT page
	cases.  Replace per-page cases with a single case that lets next_page
	sort out the next page.

	* src/html/omp.xsl (list-window-line-icons, html-create-note-form)
	(html-edit-note-form, note-detailed, result-details)
	(result-detailed): Remove old filter params, ensuring that the
	overrides and autofp flags are still passed around.  Get more params
	from /envelope/params.
	(note-detailed-delete-params): Remove.  Was for old filter params.

2012-10-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_result_page): Remove attempt at sorting.  Covered
	by Manager now.

	* src/html/gsad.xsl (html-gsa-navigation): Add filter to notes link so
	that sorting is by nvt.  This is required because the name column in
	notes is replaced by the NVT column.  If sorting is by the default,
	name, then clicking on NVT will "switch to" NVT, leaving the sorting
	the same on the first click.

	* src/html/omp.xsl (html-report-table, nvt): Ditto.

	* src/html/help.xsl (notes.html): Ditto.

2012-10-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (trashcan-icon): Add fragment arg.
	(html-edit-note-form, note-detailed, result [details]): Add result-id
	fragment to note icons, so that the view stays on the current result
	after the operation.

2012-10-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-note-form): Bold the NVT field and make
	the value a link, to match the edit page.  Hide the Associated Result
	section for the standalone page.

2012-10-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (host): Added MAC address to be displayed in the
	hardware section if there was one identified.
	Patch developed by Michael Meyer.

2012-10-06  Matthew Mundell <matthew.mundell@greenbone.net>

	Make the New Note page function "standalone", so it works from the New
	Note list on the Notes page.

	* src/gsad.c (init_validator): Add params for manual note field entry.

	* src/gsad_omp.c (new_note): New function.  Body from new_note_omp.  Add
	extra_xml arg.  Remove param checks because there might just the new
	style filter params.  Add a new case for the standalone New Note page,
	which gets the tasks.
	(new_note_omp): Call through to new_note.
	(omp_success, omp): New functions.
	(create_note_omp): Add param check gaurds.  Check if note params have
	been entered in the manual params.  Call the CREATE_NOTE directly
	instead letting the handler for the next page do it.  Choose next page
	more automatically.

	* src/html/omp.xsl (list-window): Add missing filt_id param to link.
	(html-create-note-form): Add new filter params to form.  Get next from
	envelope so any caller can specify it.  Correct name of task_id param.
	Add missing apply_overrides param.  Add cases for manual entry of
	fields, for standalone page.
	(new_note): Match create_note_response too.
	(result-detailed): Add apply_overrides and next to New Note links.

2012-10-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (delete_resource): Pick the next page if "get" is NULL.
	(delete_note_omp): Let delete_resource decide on the next page.

2012-10-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Add trashcan feature to notes.

	* src/gsad.c (init_validator, exec_omp_post): Add delete_trash_notes.

	* src/gsad_omp.c (next_page): Add get_result case.
	(get_report_page): New function.
	(get_result): Add extra_xml arg.  Update callers.
	(get_result_page): New function.  Suitable for delete_resource callback.
	(delete_note_omp): Pick callback according to next param.
	(delete_trash_note_omp): New function.
	(get_trash): Get trash notes too.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/gsad.xsl (html-gsa-logo): Update indicator paths and add
	missing cases.

	* src/html/omp.xsl (note [trash], html-notes-trash-table): New
	templates.
	(note-detailed): Replace delete icon with trashcan.  Add clone icon.
	Update icon and Report links.
	(get_trash): Add notes.

2012-10-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (export_targets_omp, export_notes_omp)
	(export_filters_omp): Correct type arg.

2012-10-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (nvt): Replace note list with a link to the notes
	page in the summary.

2012-10-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table): Replace the note list with a
	link to the notes page in the summary.

2012-10-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Update the note list icons and note details page to the new style.

	* src/gsad.c (init_validator, exec_omp_get): Add export_filters and
	export_notes.

	* src/gsad_omp.c (export_many): New function.  Body from export_targets.
	(export_targets): Call through to export_many.
	(export_notes_omp, export_filters_omp): New functions.
	(delete_note_omp): Correct type.
	(save_note_omp): Get the get_notes case working.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/omp.xsl (gsa:lower-case): New function.
	(list-window-line-icons, minor-details, details-header-icons): New
	templates.
	(list-window): Correct typo in Applied filter link.
	(filter, target, note): Call list-window-line-icons instead of doing
	them by hand.
	(filter [details], target [details], note [details]): Call
	details-header-icons and minor-details instead of doing them by hand.
	(html-edit-filter-form): Correct name and value of Filter ID param.
	(html-edit-target-form, html-edit-note-form): Add missing filter params.

2012-10-01  Matthew Mundell <matthew.mundell@greenbone.net>

	Add filtering to notes.

	* src/gsad.c (init_validator): Add note to resource types.

	* src/gsad_omp.c (next_page): New function.
	(delete_resource): Move up in file.
	(clone_omp, create_filter_omp): Let next_page decide which page is next,
	adding get_notes to previous options.
	(get_notes, delete_note_omp): Switch to generic function.  Adjust
	callers.

	* src/html/omp.xsl (html-notes-table): Call list-window.
	(get_notes): Apply like the other commands.

2012-09-26  Andre Heinecke <aheinecke@intevation.de>

	* src/html/help.xsl (contents.html): Change placement of SecInfo
	Management to be between Asset Management and Configuration.

	* src/html/gsad.xsl (html-gsa-navigation): Change placement of SecInfo
	Management to be between Asset Management and Configuration.

2012-09-26  Andre Heinecke <aheinecke@intevation.de>

	Make SecInfo Management the seventh top level menu item.

	* src/html/dialog.xsl (browse_infosec.html): Rename
	"Security Information Management" to "Lookup".

	* src/html/gsa-style.css (#gb_menu ul li a): Switch to new button width
	128px and adapt background position.

	* src/html/gsa-style.css (#gb_menu ul .first_button a)
	(#gb_menu ul .last_button a): Set width to 130px. Add > a to overwrite
	width only for the first link in the element.

	* src/html/gsa-style.css (#gb_menu ul li ul, #gb_menu ul li ul a)
	(#gb_menu ul li ul a): Expand submenu by 5px to avoid asymetric look with
	the new menu width.

	* src/html/gsa-style.css (#gb_menu ul li:hover a)
	(#gb_menu ul .last_button:hover a): Adopt background position.

	* src/html/help.xsl (browse_infosec.html): Rename from "Security Information
	Browser" to "Security Information Lookup".

	* src/html/help.xsl (contents.html): Move SecInfo Management to the top
	level of the contents index.

	* src/html/gsad.xsl (html-gsa-navigation): Move SecInfo from Extras to the
	top level.

	* style/top_menu_buttons.png:  First button and last button now
	have a width of 130px the other buttons are 128px.

2012-09-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (feed_management.html): Reword side effects to be
	clear that sometimes it can take a while.

2012-09-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_base.c (gsad_message): Add GSA version to error message.

2012-09-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (new_task.html): Add Observer, Asset Management and
	Scan Intensity columns.
	(tasks.html): Describe task comment and name column icons.

2012-09-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_trash): Get Contents backgrounds right.

2012-09-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsa-style.css (#list ul): Increase left margin so that sub
	items are easier to make out.

	* src/html/help.xsl (filtering): New template.  From filtering.html.
	(configure_alerts.html): Add filtering section.
	(contents.html): Add filtering subpages.
	(filters.html): Move filtering section out to template.

2012-09-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (contents.html, glossary.html): Add filters.
	(filter_details.html, filters.html, new_filter.html): New templates.

2012-09-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add filt_id to Report Summary
	refresh icon, so that the selected filter is kept.  Add overrides to new
	filter control forms so that the current "Apply overrides" state is
	used.

2012-09-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Correct some defaults, so the "--" filter
	uses the same values as the initial filtering.

2012-09-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (filter): Remove old first and max URL params.

2012-09-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): In prognostic case check if
	GET_REPORT_FORMATS is enabled before calling, and get the filters for
	the dropdown.

2012-09-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_one): Add extra_attribs arg.
	(get_filter): Pass alerts="1" for GET_FILTER.

	* src/html/omp.xsl (filter [details]): Add list of Alerts that use the
	filter.

2012-09-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (file_content_response, request_handler): Free
	MHD_create_response_from_data return.

2012-09-13  Matthew Mundell <matthew.mundell@greenbone.net>

	Adjust for explicit Alert filters in OMP.

	* src/gsad_omp.c (create_alert_omp): Add filter.

	* src/html/omp.xsl (html-create-alert-form): Pass filter as explicit
	request param.
	(alert [trash]): Expect filter in explicit OMP element.  Make restore
	icon depend on whether filter is in trashcan.
	(alert [details]): Expect filter in explicit OMP element.
	(delete_filter_response): New template.
	(filter): Make trashcan icon depend on in_use instead of writable.

2012-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (attach_sid): Free tz.

	* src/validator.c (openvas_validator_alias): Remove leaky g_strdup.

2012-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-alert-form, alert [details]): Make filter
	a field of it's own, instead of a subfield of the mail case.
	(html-alerts-table, alert, alert [trash], html-alerts-trash-table): Add
	a filter column.

2012-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Add extra_xml arg.  Update callers.
	(create_filter_omp): If the CREATE_FILTER fails then choose the next
	page according to the "next" param.  Remove done todo.  Pass response
	into get_report for success indicator.

	* src/html/gsad.xsl (html-gsa-logo): Add indicator for creating a filter
	in a report.

	* src/html/omp.xsl (get_report): Apply create_filter_response for error
	dialog.

2012-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Use right path for MODIFY_TARGET
	response indicator.  Add indicator for details page.

2012-09-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Add report filtering to email alerts.

	* src/gsad_omp.c (create_alert_omp, delete_alert_omp, get_alerts_omp)
	(test_alert_omp): Call through to get_alerts instead of getting alerts
	and more in each.
	(get_alerts): New function.  Body from get_alerts_omp.  Get filters too.
	(get_alert_omp): Get filters too.

	* src/html/gsad.xsl (html-gsa-logo): Update delete_alert_response patch.

	* src/html/omp.xsl (html-create-alert-form): Add report filter field.
	(alert [details]): Display report filter for email alerts.
	(get_alerts): Pass filters to html-create-alert-form.

2012-09-06  Matthew Mundell <matthew.mundell@greenbone.net>

	Add new-style filtering to report page.

	* src/gsad.c (init_validator): Add reports to resource types.

	* src/gsad_omp.c (get_report): Add new-style filtering to GET_REPORTS
	call.  Get filters for filter switching dropdown.
	(create_filter_omp): Add the created filter to the params, so the next
	page uses the new filter.  Add get_report to next options.

	* src/html/omp.xsl (html-report-details): Add new-style filtering
	controls.
	(html-create-filter-form): Add report to resource types.
	(html-edit-filter-form): Increase term field width.  Add report to
	resource types.

2012-09-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Add first class filters.

	* src/gsad.c (init_validator): Add filter commands and params.
	(exec_omp_post, exec_omp_post): Add filter commands.

	* src/gsad_omp.c (get_one, edit_resource, export_resource): New
	functions.  Generic page handlers.
	(get_many): Add filt_id to OMP GET.  Get the filters too.
	(clone_omp): Add get_filters.
	(get_config, get_config_family, get_config_nvt): Correct backurl.
	(get_trash): Get sort field from "params" instead of dedicated args.
	Update many callers.  Get filters too.
	(get_filter, get_filter_omp, get_filters, get_filters_omp, new_filter)
	(create_filter_omp, delete_resource, delete_trash_filter_omp)
	(delete_filter_omp, edit_filter, edit_filter_omp, export_filter_omp)
	(new_filter_omp, save_filter_omp): New functions.
	(CHECK): New define.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/gsad.xsl (create_filter_response, delete_filter_response)
	(modify_filter_response): New templates.
	(html-gsa-logo): Apply indicator icons.
	(html-gsa-navigation): Add filters.

	* src/html/omp.xsl (filter-window-part): Remove Reset button.  Add create
	field, switcher dropdown and list icon.
	(list-window, filters, create_filter_response, modify_filter_response)
	(filter, filter [trash], filter [details], html-filters-trash-table)
	(html-filters-table, html-create-filter-form, new_filter)
	(html-edit-filter-form, edit_filter, get_filter, get_filters): New
	templates.
	(column-name): Adjust for calling within for-each.
	(get_trash): Add filters.

2012-08-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (error_dialog): For the backurl link, check for
	the case where the token is the only parameter.

2012-08-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (SID_COOKIE_NAME): New define.  Rename cookie to be more
	unique.
	(struct gsad_connection_info): Remove quotes for name change.
	(attach_sid, remove_side, request_handler): Get name of SID cookie from
	define.

2012-08-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-task-table): Add refresh_interval and
	overrides to sorting links.

2012-08-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a Task Wizard page.  Add wizard and list icons to the New Task page.

	* src/gsad_base.h (params_t): Move up in file.
	(credentials_t): Add params.

	* src/gsad.c (exec_omp_post, exec_omp_get): Store request params in
	credentials.

	* src/gsad_omp.c (openvas_append_xml): Move up in file.
	(xsl_transform_omp): Pass all valid request params to XSL in ENVELOPE.
	(run_wizard_omp): Use separate variable for wizard params.  Get refresh
	interval from param.

	* src/html/gsad.xsl (params): New template.

	* src/html/help.xsl (tasks.html): Rename wizard.  Make wizard section
	suitable for dedicated wizard page.

	* src/html/omp.xsl (html-task-table): Add missing refresh_interval arg
	to links.  Remove apply-overrides param from template call.
	(new_task): Add wizard and list icons.  Add missing refresh_interval arg
	to link.

	* src/html/wizard.xsl (quick-first-scan-wizard): Remove apply-overrides
	arg as this is in ENVELOPE now.
	(wizard/quick_first_scan): New template.  Dedicated wizard page.

2012-08-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/oap.xsl, src/html/help.xsl: Replaced "consequences" by
	"side effects" for the sake of a more apropriate term.

2012-08-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a dedicated quick start wizard page.

	* CMakeLists.txt: Install wizard.xsl.

	* src/gsad.c (init_validator, exec_omp_get): Add wizard.

	* src/gsad_omp.c (wizard_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/gsad.xsl: Incluse wizard.xsl.

	* src/html/omp.xsl (html-task-table): Link wizard icon to new wizard
	page.  Replace wizard code with call to wizard template.

	* src/html/wizard.xsl: New file.  For wizards.  Move quick start wizard
	here.  Also display the actual 'Wizard Rows' value in the text instead
	of 10.

2012-08-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-task-table): Use "icon" for buttons, because
	that's what they're called in the help.

	* src/html/help.xsl (tasks.html): Add section about wizard.

2012-08-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-gsa-logo): Update path for run_wizard response
	indicator.

2012-08-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (run_wizard_omp): Escape param name and value for XML.

2012-08-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add force_wizard.

	* src/gsad_omp.c (get_tasks): Add params arg.  Adjust all callers.  Get
	Wizard Rows preference.  Pass force_wizard down to XML.
	(save_my_settings): Save Wizard Rows too.

	* src/html/omp.xsl (html-task-table): Add wizard icon.  Make wizard
	visibility depend on Wizard Rows and force_wizard.
	(get_my_settings, edit_my_settings): Add Wizard Rows.

2012-08-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (run_wizard_omp): Expect params in generic form.

	* src/html/omp.xsl (html-task-table): Send param in generic form.

2012-08-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-task-table): Improve English slightly.

2012-08-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (verify_report_format_omp): Let get_tasks do the
	command so the response comes out in the XML.

	* src/html/omp.xsl (get_tasks): Apply run_wizard_response.

2012-08-14  Matthew Mundell <matthew.mundell@greenbone.net>

	Add Immediate Scan wizard.  Based on patch by Jan-Oliver Wagner.

	* CMakeLists.txt: Install enchantress.

	* src/gsad.c (init_validator, exec_omp_post): Add run_wizard.

	* src/gsad_omp.c (run_wizard_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/gsad.xsl (run_wizard_response): New template.
	(html-gsa-logo): Apply run_wizard response indicator icon.

	* src/html/omp.xsl (html-task-table): Add wizard under table.
	(run_wizard_response): New template.

2012-08-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (openvas_append_xml): New function.
	(get_report, get_result, new_note_omp, edit_note_omp, new_override_omp)
	(edit_override_omp): Escape XML containing search phrase before sending.

2012-08-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (get_report): Send the GET_REPORTS OMP with the XML version
	of the send function so that the search phrase is escaped.

2012-08-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/enchantress.png: New.

2012-08-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Add a fallback to the help case for when
	the help XSL transform fails.

2012-08-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (cve-details): Sort Vulnerable Products by Name.

2012-08-01  Matthew Mundell <matthew.mundell@greenbone.net>

	Enable the user to add or edit a task with any number of alerts.

	* src/gsad.c (init_validator): Remove alert_id_optional_2.  Add alerts
	and the hashtable version of alert_id_optional.
	(params_append_mhd): Add alert_id_optional to hashtable params.

	* src/gsad_omp.c (new_task, edit_task): Send number of alerts down to
	XSL.
	(create_task_omp, save_task_omp): Handle any number of alerts, instead
	of just two.

	* src/html/omp.xsl (html-edit-task-form): Show every alert, with link for
	adding more.
	(new-task-alert-select): New template.
	(new_task): Show two alerts, and a link for adding more.

2012-07-31  Matthew Mundell <matthew.mundell@greenbone.net>

	Add control of second alert to tasks.

	* src/gsad.c (init_validator): Add alert_id_optional_2 and alert_id_2.

	* src/gsad_omp.c (create_task_omp, save_task_omp): Pass second alert to
	manager.

	* src/html/omp.xsl (html-report-table): Display all alerts.
	(html-edit-task-form, new_task): Add second alert option.

2012-07-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Add the new "Add results to Asset Management" task preference.

	* src/gsad.c (init_validator): Add in_assets.

	* src/gsad_omp.c (create_task_omp, save_task_omp)
	(save_container_task_omp): Add in_assets to task preferences in OMP
	command.

	* src/html/omp.xsl (html-report-table, html-edit-task-form, new_task): Add
	in_assets fields.

2012-07-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (get_many): If the filter is empty then add "row=-2", so that
	Rows Per Page rows are returned, because Manager now returns all rows.

2012-07-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add summary.

	* src/gsad_omp.c (save_report_format_omp): Get summary from "summary"
	instead of "comment", to all quotations in the summary.

	* src/html/omp.xsl (html-edit-report-format-form): Rename field to
	"summary".

2012-07-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (tasks.html): Added hint that paused scans will have
	impact on overall performance.

2012-07-09  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad_omp.c (create_target_omp): Remove assigned but unused
	variable to address compiler warning.

2012-07-09  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Print a more useful message if both libxslt and the
	xsltproc binary cannot be found instead of failing silently.

2012-07-02  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/help.xsl: Fix a few typos in the help texts.

2012-06-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Bring agents up to date with the GET filtering changes.

	* src/gsad_omp.c (create_agent_omp, delete_agent_omp): Use the get_agents
	function to get agents, so that the new filtering is right.

	* src/html/gsad.xsl (verify_agent_response): New template.
	(html-gsa-logo): Add missing agent responses.

	* src/html/omp.xsl (html-agents-table): Generate columns with column-name.
	(column-name): Take type as an argument so that any type can use this.
	Remove old max and first params.

2012-06-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Add back Alerts which Jan
	removed in r13634 on 2012-06-20.

2012-06-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (filter-window-pager): Move first and max params into
	filter.
	(filter-window-part): Rename Apply to Update Filter.  Remove First and
	Rows fields.
	(column): Use new TARGET/SORT to determine the current sorting.  Just put
	the sort= on the front of the filter, instead of doing complex parsing,
	because the manager now removes duplicates.

2012-06-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (html-targets-table): Have "Applied Filter"
	span over full table to avoid wrapping.

2012-06-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsa-style.css: Added menu item style that is indented.

	* src/html/gsad.xsl (html-gsa-navigation): Move Port Lists up,
	indented Port Lists and Credentials as they are sub-elements of
	a Target. Moved Agents to end of menu and therefore simplified
	code regarding "last" element.

2012-06-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (column-name): In both "some other column" cases sort
	ascending.

2012-06-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsa-style.css (.gbntablehead2 a:focus): Separate from a:hover
	rule so that browser applies .gbntablehead2 to a:focus too.

2012-06-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-targets-table): Note the current filter at the
	end of the table.

	* src/html/gsa-style.css (.footnote): New class for note.

2012-06-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (column-name): Rename asc and desc in filter to sort
	and sort-reverse.

2012-06-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Allow newlines in preference:value, because
	the value could be a file.

2012-06-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsa-style.css (.gbntablehead2 a): New rules.

	* src/html/omp.xsl (column-name): New template.
	(html-targets-table): Make column headings sorting links.

2012-06-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_task): Check if commands are enabled before using.

2012-06-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_target_omp): Only check port when SSH credential
	is given.

2012-06-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-target-form): If the port is empty make it
	22.

2012-06-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result-detailed): Add References for second result in
	delta "changed" case.

2012-06-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Match PDF report for Download
	column by name instead of ID, because the ID changes.

2012-06-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_oap.c (xsl_transform_omp): Add capabilities.

2012-06-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl: Add a show_closed_cves param everywhere that there is
	a autofp param.

	* src/gsad_omp.c (get_result): Add autofp arg.
	(get_result_omp): Pass show_closed_cves param to get_result.
	(new_note_omp, create_note_omp, delete_note_omp, edit_note_omp)
	(save_note_omp, new_override_omp, create_override_omp)
	(delete_override_omp, edit_override_omp, save_override_omp): Add
	show_closed_cves params alongside autofp params.

2012-06-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (view_report.html): Update Back to Tasks link text.

	* src/html/omp.xsl (report [details]): Do token in links in Closed CVEs
	table with a variable because they're inside a for-each.

2012-06-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Pass show_closed_cves to Manager now that
	there is OMP support for this.  Remove SHOW_CLOSED_CVES from XML because
	it's in the OMP report now.

	* src/html/omp.xsl (html-report-details): Add show_closed_cves params to
	alert and download columns.  Update checks for Closed CVEs checkbox and
	table to use OMP value of SHOW_CLOSED_CVES.

2012-06-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add autofp param to download
	column.

2012-06-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add autofp param to report
	links in delta report.

2012-06-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Hide "Show Closed CVEs" checkbox
	for delta reports.  The OMP report currently holds the host details for
	the first report only.  It will take some pain to add the second report
	host details.  For now the user can go to the report via the links in the
	summary to see the closed CVEs for that report.
	(report [details]): Init other case of delta arg.  Hide Closed CVE table
	for delta case.

2012-06-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [details]): Specify the report that the closed
	CVEs belong to.

2012-06-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Pass autofp to the alert OMP command
	instead of a special esc_autofp param, because they would always be the
	same.

	* src/html/omp.xsl (html-report-details): Add autofp params for Run Alert
	column.

2012-05-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [details]): List Closed CVEs by CVE instead of
	by NVT.

2012-05-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host): Add commented table of all host details.
	(report [details]): Put NVT name in Closed CVE table instead of OID.

2012-05-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_result): Add autofp to OMP command.

2012-05-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Get passing around of autofp working again.

	* src/gsad.c (init_validator): Add 2 to autofp rule.

	* src/gsad_omp.c (get_report): If autofp is 2 then make autofp_value
	2.

2012-05-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [details]): Adjust closed CVE section for
	revised location of these CVEs in the host details.

2012-05-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [details]): Add CVEs from source descriptions
	to table of closed NVTs.

2012-05-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add show_closed_cves.

	* src/gsad_omp.c (get_report): Add SHOW_CLOSED_CVES to XML.

	* src/html/omp.xsl (html-report-details): Add "Show closed CVEs" checkbox.
	(report [details]): Add "Show closed CVEs" section.

2012-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_info_cve_lnk): Strip space from CVE, otherwise the
	links are broken.

2012-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-target-form): Get hosts from OMP response
	in the "no target locators" case too.

2012-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the full/partial CVE filter working.

	* src/gsad.c (init_validator): Add autofp_value.

	* src/gsad_omp.c (get_report): Pass autofp_value in GET_REPORTS instead
	of 1 or 0.

	* src/html/omp.xsl (html-report-details): Make the "Trust vendor" radio
	depend the autofp value.  Rename it to autofp_value.
	(report [details]): Add commented "All host details" section.

2012-05-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [details]): Add "NVTs closed by updates" section
	for each host, as a start towards putting the closed CVEs there.  This is
	all the info available in the report itself.

2012-05-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Remove extra GET_REPORT, as it looks like
	the XSL stopped using this at some point.

2012-05-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add autofp arg to paging links.

2012-05-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Rework auto-fp control layout
	a bit.

2012-05-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (powerfilter.html): Add date examples.

2012-05-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl: Add autofp param to all get_report links, and to all
	links that could return to get_report.

2012-05-14  Matthew Mundell <matthew.mundell@greenbone.net>

	Start Auto FP support.  Slight modification of patch from Henri Doreau.

	* src/gsad.c (init_validator): Add autofp.

	* src/gsad_omp.c (get_report): Pass autofp param through to Manager.

	* src/html/omp.xsl (html-report-details): Add Auto FP checkbox.
	(get_result, get_results_omp, new_note_omp, create_note_omp)
	(delete_note_omp, edit_note_omp, save_note_omp, new_override_omp)
	(create_override_omp, delete_override_omp, edit_override_omp)
	(save_override_omp): Add autofp param.

2012-05-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (filter-window-pager): New template.
	(html-agents-table): Add pager to filter window.
	(html-targets-table): Call filter-window-pager to produce the pager.

2012-05-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump to 4.0+beta4.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2012-05-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 4.0+beta3 release.

	* CHANGES: Updated.

2012-05-04  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/help.xsl: Fixed icon inconsistency.

2012-05-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Get GSA working better when certain commands are disabled in Manager.

	* src/gsad_omp.c (new_task, get_tasks, get_report): Check if commands are
	enabled before sending.

	* src/html/gsad.xsl (html-gsa-navigation): Add GET commands to New Task
	requirements.

	* src/html/omp.xsl (html-task-table): Test for required commands before
	adding New Task button.

2012-05-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (command_enabled): New function.
	(get_trash): Check if command is enabled before sending.

	* src/html/omp.xsl (get_trash): Include enabled resources only.

2012-05-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl: Add availability check to many pages.
	(availability): New template.

2012-05-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (target [details]): Add creation date.  Make right hand
	column a table for neatness.

2012-05-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Add OMP capabilities support.  Match the menu to the capabilities of the
	manager.

	* src/gsad.c (struct user, user_add): Add capabilities.
	(exec_omp_post): Setup user capabilities, handle new return.
	(request_handler): Setup credential capabilities.  Add to envelope.

	* src/gsad_base.h, src/gsad_omp.h (credentials_t): Add capabilities.

	* src/gsad_omp.c (xsl_transform_omp): Add capabilities to envelope.
	(authenticate_omp): Add capabilities return arg.  Get capabilities from
	manager.

	* src/html/omp.xsl (html-gsa-navigation): Check if menu items are
	supported before including them.
	(help_response): New template.

2012-05-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (target [details]): Add "Last Modified".

2012-04-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsa-style.css: Remove underline from link text decoration.
	Show underline on mouse-over.

2012-04-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-targets-table): Offset the export icon slightly
	from the others.
	(target): Make the target name a link to Target Details.  Use the clone
	image for the clone icon.  Add per-target export icon.

2012-04-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (filter-window-part): New template.
	(html-agents-table): Add filtering controls.
	(html-targets-table): Call filter-window-part to add filtering controls.

2012-04-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Add cloning of targets.

	* src/gsad.c (init_validator): Add clone to commands.  Add id and
	resource_type validators.
	(exec_omp_post): Add clone.

	* src/gsad_omp.c (CHECK): New macro.
	(clone_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (target): Add Clone icon.

2012-04-25  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump to 4.0+beta2.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2012-04-25  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 4.0+beta2 release.

	* CHANGES: Updated.

2012-04-25  Michael Wiegand <michael.wiegand@greenbone.net>

	Clean up CMake infrastructure and ensure that compilation with modern
	gccs works.

	* CMakeLists.txt: Remove setting of OPENVAS_LIB_INSTALL_DIR and
	OPENVAS_HEADER_INSTALL_DIR as they were never used and the information
	is retrieved via pkg-config now.

	* src/CMakeLists.txt: Move include_directories and link_directories to
	target_properties and target_link_libraries. Set link libraries via
	target_link_libraries and not via LINK_FLAGS since this breaks
	compilation with more modern gccs. Take the correct flags from
	pkg-config output.

	* INSTALL: Remove references to superfluous OPENVAS_LIB_INSTALL_DIR
	and OPENVAS_HEADER_INSTALL_DIR variables.

2012-04-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/clone.png: New.

	* CMakeLists.txt: Install new icon.

2012-04-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Update UUID of PDF report
	format.

2012-04-19  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a generic GET page handler, because the handlers for the types are
	basically the same.  Use the new handler for targets and agents.

	* src/gsad_omp.c (get_many, get_agents): New functions.
	(get_agents_omp): Call through to get_agents.
	(get_targets): Call through to get_many.

2012-04-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-targets-table): Add count to export tooltip.

2012-04-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (port_list): Make the trashcan icon depend on WRITABLE
	instead of IN_USE.

2012-04-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (target): Make the trashcan icon depend on WRITABLE
	instead of IN_USE.

2012-04-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (powerfilter.html): Improve slightly.  Add NOT.

2012-04-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Adjust for new path.

	* src/html/omp.xsl (get_targets): Adjust for new path.

2012-04-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-lsc-credential-form)
	(html-create-port_list-form): Move text and password inputs out of labels
	because Firefox 3.5 jumps to the associated radio when the input area is
	clicked.

2012-04-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (main): Updated Copyright years.

2012-04-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post release version bump to 4.0+beta2.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2012-04-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Preparing the gsa 4.0+beta1 release.

	* CHANGES: Updated.

2012-04-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.c (target [details]): Indent icon section properly.  Add
	trashcan icon.

2012-04-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.c (target [details]): Add UUID where back link was.

2012-04-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (new_target.html): Add max to the new_target link,
	otherwise the empty value is interpreted as "all".
	(targets.html): Remove out of date section.

2012-04-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (new_targets.html, target_details.html)
	(targets.html): Describe new icons on target pages.  Correct typo.

2012-04-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (contents.html): Add powerfilter.
	(powerfilter.html): New template.
	(targets.html): Add filtering section and edit icon.

2012-04-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (CHECK): Go to right page on error.
	(save_target_omp): Only check port if there's an SSH credential.

2012-04-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_target, get_target): Print pass through info
	with g_markup_printf_escaped.

	* src/html/omp.xsl (modify_target_response): New template.

	* src/html/gsad.xsl (modify_task_response [response-indicator]): New
	template.
	(html-gsa-logo): Match modify_task_response for indicator.

2012-04-11  Matthew Mundell <matthew.mundell@greenbone.net>

	Add editing of targets.

	* src/gsad.c (init_validator, exec_omp_post): Add edit_target and
	save_target.

	* src/gsad_omp.c (new_target): Pass filter params in.
	(create_target): Go to Target Details if target present.  Call get_targets
	instead of getting targets by hand.
	(create_target): Call get_targets instead of getting targets by hand.
	(edit_target, edit_target_omp, get_targets): New function.
	(get_target): Pass through filter params.
	(get_targets_omp): Call through to get_targets.
	(CHECK): New macro.
	(save_target_omp): New function.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/omp.xsl (html-create-target-form, html-targets-table): Add
	filter args to Targets icon and create_target form.
	(html-edit-target-form, edit_target): New templates
	(target, target [details]): Add filter args.  Add edit icon.

2012-04-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_my_settings): Get setting from manager.
	(save_my_settings): Save Rows Per Page.

	* src/html/omp.xsl (edit_my_settings): Add Rows Per Page.

2012-04-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Allow max to be negative and empty.

	* src/gsad_omp.c (create_target_omp): Add max to GET_TARGETS.
	(get_targets_omp): If max is NULL use -2 instead of -1, to get the Rows
	Per Page rows instead of all rows.

	* src/html/omp.xsl (html-targets-table): Use -2 for max in reset, to get
	Rows Per Page rows instead of all.  When Rows is -1 make it empty, because
	that looks nicer.

2012-04-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_trash): Correct odds and evens.

2012-04-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_my_settings): Call OMP GET_SETTINGS.

	* src/html/omp.xsl (get_my_settings): Add Rows Per Page.

2012-04-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Split targets configuration help into three pages.

	* src/html/help.xsl (configure_targets.html): Remove.
	(contents.html): Split targets link into three.
	(new_target.html, target_details.html, targets.html): New templates.
	Bodies from configure_targets.html.

	* src/html/omp.xsl (html-create-target-form, html-targets-table)
	(target [details]): Switch to new target help pages.

2012-04-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_targets_omp): Make max -1 if it fails instead of 10,
	so that it is possible to get all targets.

2012-04-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (target [details]): Remove Targets link.  Superseded by
	is a list icon.

2012-04-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-targets-table): Add reset button to filtering.

2012-04-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-targets-table): Add First field to filtering.

2012-04-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Add new, list and export icons on Target Details page.

	* src/gsad.c (init_validator, exec_omp_get): Add export_target.

	* src/gsad_omp.c (new_target): Add target ID to XML for icon on Target
	Details page.
	(create_target_omp): If target ID present, go to Target Details page.
	(get_target): New function.  Body from get_target_omp.
	(get_target_omp): Pass through to get_target.
	(export_target_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (html-gsa-logo): Add create_target indicator match for
	Target Details page.
	(html-create-target-form): Add new, list and export icons.

2012-04-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-targets-table): Add Rows field to filtering.

2012-04-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (CHECK): New macro.
	(save_config_omp): Respond with an error if name or comment is NULL,
	instead of with an internal error.

2012-03-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/upload.png: New.

	* CMakeLists.txt: Added handling of new icon.

2012-03-30  Matthew Mundell <matthew.mundell@greenbone.net>

	Add Targets pagination.

	* src/gsad.c (init_validator): Add first and max.

	* src/gsad_omp.c (get_targets_omp): Pass first and max to GET_TARGETS.

	* src/html/omp.xsl (html-targets-table): Add page control.

2012-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Move the New Target window to a separate page.

	* src/gsad.c (init_validator, exec_omp_get): Add new_target.

	* src/gsad_omp.c (new_target, new_target_omp): New functions.
	(CHECK): Invoke new_target page instead of going through to get_targets.
	(create_target_omp): Pass filter through to GET_TARGETS.  If GET_TARGETS
	fails go to new_target instead of get_targets page.  Remove OMP that was
	for New Target window.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (html-create-user-form): Add list icon to link to
	Targets page.  Pass filter through.
	(html-targets-table): Add New Target icon.  Correct export tooltip.
	(get_targets): Remove html-create-target-form.
	(new_target): New template.

2012-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_targets_omp): Send with openvas_server_sendf_xml as
	there may be XML in the filter.

2012-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Add export of Targets.

	* src/gsad.c (init_validator, exec_omp_get): Add command export_targets.

	* src/gsad_omp.c (export_targets_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (html-targets-table): Add export button to Targets.

2012-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add filter.

	* src/gsad_omp.c (get_targets_omp): Send filter through to manager.

	* src/html/omp.xsl (html-targets-table): Add filter section to Targets.

2012-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c, src/gsad_omp.c, src/gsad_omp.h, src/html/omp.xsl,
	src/html/gsad.xsl, src/html/help.xsl: Rename escalator to alert everywhere.

2012-03-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post branch version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2012-03-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt, INSTALL: Set dependency for glib and gnutls
	to minimum of what openvas-libraries requires.

2012-03-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add ; and ' to comment.

2011-03-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number to 3.0.1.

	* src/html/help.xsl: Updated version number to 3.0.1.

2011-03-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Preparing the gsa 3.0.0 release.

	* CHANGES: Updated.

	* CMakeLists.txt: Updated version to 3.0.0.

	* src/html/help.xsl: Updated version number to 3.0.0.

2012-03-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (delete_user_oap): Add DESCRIBE_AUTH to commands, as this is
	needed for the Users page.

2012-03-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-note-form, note, note [details])
	(html-edit-override-form, override, override [details]): Explicitly print
	an explanation instead of an NVT name when the result was an open port.
	This is because the open port results come from the PORT OTP message and
	so lack an association with an NVT.

2012-03-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-report-format-form): Correct help link.

	* src/html/help.xsl (configure_report_formats.html): Correct anchor.  Add
	Edit Report Format action.
	(configure_users.html): Make wording a bit nicer.  Add note about roles.
	Add observer to list.

2012-03-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add , to observers now that it is accepted
	as a separator.

2012-03-16  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/help.xsl: Fixed case for consistency.

2012-03-16  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/help.xsl: Include examples of how to use ADS (domain\user)
	with new per-user-ldap authentication.

2012-03-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Ensure scan start is available
	before printing it, otherwise it ends up as NaNs.
	(get_report): Match create responses.  Needed after last commit, which
	moves location of these responses.

	* src/html/gsad.xsl (html-gsa-logo): Apply note and override create and
	delete indicator icon responses.

2012-03-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_note_omp, create_override_omp): Replace explicit
	fetching of report with call to get_report.

2012-03-15  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/oap.xsl: Match user (edit/details) in a commands_response,
	as these now have to include response to describe_auth, too.

	* src/gsad_oap.c (create_user_oap): Modify create-user command if
	enable_ldap_connect parameter is set and issue describe_auth.
	(save_user_oap): Include sources element in oap command and include
	desribe_auth command.
	(edit_user_oap): Include describe_auth command.
	(modify_auth_oap): Allow ldap_connect method, fixed typo in trace
	msg.

2011-03-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number to 3.0+rc2.

	* src/html/help.xsl: Updated version number to 3.0+rc2.

2011-03-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Preparing the gsa 3.0+rc1 release.

	* CHANGES: Updated.

	* CMakeLists.txt: Updated version to 3.0+rc1.

2012-03-15  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/oap.xsl (html-create-user-form): If per-user-ldap auth. is
	configured and enabled, allow to create a user with "ldap only"-
	option.
	(html-users-table, user): If per-user-ldap auth, add column to show
	if user is allowed to use ldap-auth only; allow modifications, too.
	(group): Include per-user-ldap-conf and link to help.
	(describe_auth_response): Match ldap_connect.

	* src/html/help.xsl: Added basic help for per-user ldap configuration.

2012-03-15  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (init_validator): Added new validation target
	"enable_ldap_connect", allow "ldap_connect" for "group" parameter,
	allow "@" within login names for "user@domain"- scenarios.

2011-03-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/wizard.png: New.

	* CMakeLists.txt: Install new icon.

2012-03-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Replace the UUID with a fixed string in the
	report name of the XML report, when it's a prognostic report.

2012-03-13  Matthew Mundell <matthew.mundell@greenbone.net>

	Add download of prognostic reports.

	* src/gsad_omp.c (get_report): Replace the UUID with a fixed string in the
	report name when it's a prognostic report.  Get the report formats when
	getting a prognostic report, for the dropdown box.

	* src/html/omp.xsl (html-report-details): Enable the Download column for
	prognostic reports.

2012-03-09  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/help.xsl: Removed double entries for scan config details
	  table.

2012-03-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add Download column.

2012-03-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-report-details): Add some space between the back
	arrows and the first number in the Filtered Results dialog heading.

2012-03-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Apply missing port list responses for
	indicator icon.

2012-03-06  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/help.xsl: Corrected typos (aspell run).

2012-03-06  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/help.xsl: Corrected typos.

2012-02-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_schedule_omp): Get minutes from correct param.

2012-02-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (target): Limit the hosts column to 500 chars.

2012-02-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (configure_targets.html): Adjust for "From file" Hosts
	option.

2012-02-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_target_omp): Only check target_locator when
	importing.

	* src/html/omp.xsl (html-create-target-form): Add the "From file" option
	to the case where target sources is empty.  Correct the maxlength in the
	other case.

2012-02-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Allow upload of targets from a file.

	* src/gsad.c (init_validator): Add file to target_source.

	* src/gsad_omp.c (create_target_omp): Get hosts from file param if
	target_source is file.

	* src/html/omp.xsl (html-create-target-form): Add file target source.

2012-02-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add target_source.

	* src/gsad_omp.c (create_target_omp): Make the type of Hosts input depend
	on the target_source param instead of on the value of the Import dropdown.
	Seems like this was or should have been the original intention.  This
	prevents the input of an empty hosts string in the Manual case, which was
	leading a target with Hosts "(null)".

	* src/html/omp.xsl (html-create-target-form): Remove the "--" option
	because a source is required and the radio parameter signals which Host
	input type to use.

2012-02-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_port_range_omp, get_port_list): Add details flag
	to GET_PORT_LISTS call.

2012-02-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (configure_port_lists.html): New template.
	(configure_targets.html): Convert port ranges to port lists.

	* src/html/omp.xsl (port_list [details]): Rename the New Port Range field
	Type to Protocol, and the button to Create port range.

2012-02-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (port_list [details]): Use the in_use element to check
	if the New Port Range form should be enabled, because the predefined
	port lists are marked with in_use.

2012-02-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-port-lists-table, port_list): Add count columns.
	(port_list [details]): Add count fields.

2012-02-21  Matthew Mundell <matthew.mundell@greenbone.net>

	Add port list import.

	* src/gsad.c (init_validator, export_omp_get): Add import_port_range.

	* src/gsad_omp.c (export_port_list_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (html-import-port-list-form): New template.
	(get_port_lists): Add import form.

2012-02-20  Matthew Mundell <matthew.mundell@greenbone.net>

	Add port list export.

	* src/gsad.c (init_validator, export_omp_get): Add export_port_list.

	* src/gsad_omp.c (export_port_list_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (port_list): Add export icon.

2012-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Add port range deletion.

	* src/gsad.c (init_validator): Add delete_port_range command and rules.
	(exec_omp_post): Add delete_port_range.

	* src/gsad_omp.c (get_port_list_omp): Move body to get_port_list.
	(get_port_list, delete_port_range_omp): New functions.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/gsad.xsl (delete_port_range_response): New template.
	(html-gsa-logo): Add delete_port_range green icon case.

	* src/html/omp.xsl (delete_port_range_response): New template.
	(port_list [details]): Add delete icon.
	(get_port_list): Match delete_port_range_response and port list after
	delete.

2012-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Add "New port range" section to Port List Details page.

	* src/gsad.c (init_validator): Add create_port_range command and port
	range rules.
	(exec_omp_post): Add create_port_range.

	* src/gsad_omp.c (create_port_range_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/gsad.xsl (create_port_range_response): New template.
	(html-gsa-logo): Add create_port_range green icon case.

	* src/html/omp.xsl (delete_port_list_response): Correct name.
	(port_list [details]): Add "New port range" form.
	(create_port_range_response): New template.
	(get_port_list): Match create_port_range_response.

2012-02-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add file and from_file.

	* src/gsad_omp.c (create_port_list_omp): Get port ranges from file if
	given in file.

	* src/html/omp.xsl (html-create-port_list-form): Add file option for
	ranges.

2012-02-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (delete_target_omp): Get the port lists too, for the
	follow on page.

2012-02-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-port_list-form): Replace "default" in
	port range with a range example.

2012-02-13  Matthew Mundell <matthew.mundell@greenbone.net>

	Add simple form for creating port lists.  Switch target creation from
	port ranges to port lists.

	* src/gsad.c (init_validator, exec_omp_post): Add create_port_list.

	* src/gsad_omp.c (create_target_omp): Replace port range with port list
	ID.  Get the port lists too.
	(get_targets_omp): Get the port lists too.
	(CHECK): New macro.
	(create_port_list_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (port_list [select]): New template.
	(html-create-target-form): Replace port range field with port lists.
	(get_targets): Pass port lists to html-create-target-form.
	(html-create-port_list-form): Convert to port lists.
	(get_port_lists): Enable call to html-create-port_list-form.

2012-02-12  Henri Doreau <henri.doreau@greenbone.net>

	* MakeLists.txt: Install VMWare OS icon.

2012-02-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Add initial port list handling.

	* src/gsad.c (init_validator): Add port list commands and params.
	(exec_omp_post, exec_omp_get): Add port list commands.

	* src/gsad_omp.c (get_trash): Get port lists too.
	(get_port_list_omp, get_port_lists_omp, delete_port_list_omp)
	(delete_trash_port_list_omp): New functions.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/gsad.xsl (create_port_list_response)
	(delete_port_list_response): New templates.
	(html-gsa-navigation): Add port lists.

	* src/html/omp.xsl (html-targets-table, target, target [trash])
	(target [details]): Switch port range to port list.
	(html-create-port_list-form, html-port-lists-table)
	(create_port_list_response, delete_port_list_response, port_list)
	(port_list [trash], port_list [details], get_port_list)
	(get_port_lists): New templates.
	(host): Add TCP and UDP port fields.
	(html-port-lists-trash-table): New template.
	(html-targets-trash-table): Switch to port list.
	(get_trash): Add port lists.

2011-02-10  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Added new entry for VMWare ESXi.

2011-02-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/os_vmware.png: New.

2011-02-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl, src/html/gsad.xsl, src/html/help.xsl: Extend
	copyright notice to 2012.

2011-02-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (html-edit-note-form, note [note], note [details])
	(html-edit-override-form, override [override], override [details])
	(result-detailed): Add oid to abbr.

2012-02-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-note-form, note [note], note [details])
	(html-edit-override-form, override [override], override [details])
	(result-detailed): Add abbr around truncated NVT name, with full name.

2012-01-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add missing esc_levels.

2012-01-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (params_append_mhd): Add missing condition_data and
	event_data cases.

2012-01-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_base.c (params_append_bin): Get the length of the value from
	the structure instead of using strlen, because the value is binary.

2011-01-09  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsa-style.css (gb_menu): Adjusted to work with
	the Chrome browser family. Patch by Karl-Heinz Ruskowski.

2012-01-03  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (ref_cve_list, ref_bid_list, ref_xref_list): New.
	List vulnerability references.
	(result-detailed): Added a reference box.

2011-12-29  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* INSTALL: Re-arranged text a bit and added some Debian 6 info.

2011-12-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (my_settings.html): Add timezone description.

2011-12-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (user_find): Use the right variable.
	(attach_sid): Switch to GMT around the printing of the expiry time.
	Switching the locale only affects the formatting of the time.

2011-12-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/oap.xsl: Wrap all radio inputs in labels.

2011-12-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl: Wrap all checkbox inputs in labels.

2011-12-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl: Wrap all radio inputs in labels.

2011-12-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (REQUIRE): Add backurl arg.  Update callers.
	(REQUIRE2): Remove.  Now same as REQUIRE.

2011-12-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add missing command.

	* src/gsad_omp.c (save_container_task_omp): Save the observers too.

2011-12-07  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (os-icon): Always display OS icon title as defined
	in os.xml to ensure consistency.

2011-12-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Switch to new report format UUID.

2011-12-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Fixed bug that caused
	problems for IE7.

2011-12-05  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (result-detailed): Added product detection box as of
	CR#57 implementation.

2011-12-05  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Added entry for Greenbone OS 1.7.

2011-12-05  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Added unnumbered entry for Greenbone OS.

2011-12-02  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-12-02  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 3.0+beta8 release.

	* CHANGES: Updated.

2011-11-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (init_validator): Add . to family rules, for
	"PCI-DSS 2.0".

2011-11-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): Make sure commands_xml is always defined,
	because it is always freed.  Free levels.  Remove some cases where xml is
	freed erroneously.

2011-11-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [assets]): Only enable the Prognostic Report
	icon when there is a prognosis.

2011-11-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Allow space around numbers.
	(params_mhd_validate_values, params_mhd_validate): If the rule is "number"
	or an alias for "number", then strip any leading and trailing space from
	the number if it is valid.

2011-11-30  Matthew Mundell <matthew.mundell@greenbone.net>

	In the validator, also store the rule name for aliases.

	* src/validator.c (openvas_validator_rule_new)
	(openvas_validator_rule_free, openvas_validator_alias_for): New functions.
	(openvas_validator_new, openvas_validator_add, openvas_validator_alias)
	(openvas_validate): Use validator_rule_t instead of regexp as hashtable
	value.

	* src/validator.h: Add header accordingly.
	(struct validator_rule): New structure.
	(validator_rule_t): New type.

2011-11-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Allow empty passwords.  If login is empty
	go to the login page with fail message, instead of an internal error page.

2011-11-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_note_omp): Add missing days init.

2011-11-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_note_omp, create_override_omp): Set both
	GET_REPORT overrides OMP flags from the URL param, so that overrides only
	show when "apply overrides" is chosen.

2011-11-30  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the result details delta case of the override edit icons working.

	* src/gsad_omp.c (edit_override_omp): Make param errors a bit nicer.
	(save_override_omp): For get_result call get_report for the delta case
	instead of get_result.

	* src/html/omp.xsl (note-detailed): Correct edit icons min_cvss_base path.
	(override-detailed): Add delta result details cases of the edit icons.

2011-11-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the result details delta case of the note edit icons working.

	* src/gsad_omp.c (REQUIRE_PARAM): New macro.
	(edit_note_omp): Make param errors a bit nicer.
	(save_note_omp): For get_result call get_report for the delta case instead
	of get_result.

	* src/html/omp.xsl (note-detailed): Add delta result details cases of the
	edit icons.

2011-11-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the note and override delete icons working, even directly after a
	delete operation.

	* src/gsad_omp.c (get_result): Remove the delta case.  Now done in caller.
	(delete_note_omp, delete_override_omp): Call get_report directly in the
	delta case when leading to get_result, instead of complicating get_result.
	Remove the parameter checks which should be done in get_result.

	* src/html/omp.xsl (note-detailed): Call the right template.
	(override-detailed): Access report ID lower down, as in the note case.

2011-11-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the delete icons working on the result details page, for delta
	results.

	* src/gsad_omp.c (REQUIRE2): New macro.
	(get_result): Add the delta case.
	(delete_note_omp, delete_override_omp): Make param errors a bit nicer.
	Pass the delta params through to get_result.

	* src/html/omp.xsl (note-detailed-delete-params)
	(override-detailed-delete-params): Remove report_id.
	(note-detailed, override-detailed): Add delta handling to the get_result
	case.
	(get_result): Match get_reports_response too, because the delta result
	detail uses this.
	(get_delta_result): Add a result loop with a "commands_response" prefix
	for the result details page.

2011-11-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (note-detailed-delete-params, note-detailed)
	(override-detailed-delete-params, override-detailed): Add missing text to
	result_host_only hidden param.

2011-11-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (delete_note_omp, delete_override_omp): Resurrect
	get_result case removed earlier.

2011-11-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result-detailed): Add missing case for delete icons
	on the Result Details page.

2011-11-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (note-detailed-delete-params)
	(override-detailed-delete-params): New templates.
	(note-detailed, override-detailed): Call new template to put down the
	delete icon params.  Use the correct base path for result 2, which is more
	deeply nested.  Adjust the paths similarly in the edit icon link.  This
	ensures that the parameters are added to the icons on result 2.

2011-11-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_override_omp): Add delta params.
	(save_override_omp): Call get_report instead of getting the report by hand.
	This means the delta case is now handled properly.

	* src/html/omp.xsl (html-edit-override-form): Add delta params to save_override
	form.
	(override-detailed): Add delta params to edit_override link.

2011-11-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (delete_override_omp): Call get_report instead of getting
	the report by hand.  This means the delta case is now handled properly.

	* src/html/omp.xsl (override-detailed): Send delta params in delta case.

2011-11-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_note_omp): Add delta params.
	(save_note_omp): Call get_report instead of getting the report by hand.
	This means the delta case is now handled properly.

	* src/html/omp.xsl (html-edit-note-form): Add delta params to save_note
	form.
	(note-detailed): Add delta params to edit_note link.

2011-11-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report): New function.  Body from get_report_omp.
	Add commands arg for extra commands.
	(get_report_omp): Call through to get_report.
	(delete_note_omp): Call get_report instead of getting the report by hand.
	This means the delta case is now handled properly.

2011-11-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (note-detailed): Send delta params in delta case.

2011-11-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_note_omp): Add missing days init.

	* src/html/omp.xsl (html-edit-note-form): Correct tag name.
	(note [details]): When note is off put "when Active" in heading.
	(result-detailed): Only show active notes.

2011-11-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_result): Set both overrides OMP flags from the
	URL param, so that overrides only show when "apply overrides" is chosen.

2011-11-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_note_omp, save_note_omp): Pass active state
	through.

	* src/html/omp.xsl (html-report-table, note, html-notes-table): Add active
	column.
	(html-create-note-form, html-edit-note-form): Add active field.
	(note [details]): Add active field.
	(note-detailed): Add active status above modification time.

2011-11-23  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-11-23  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 3.0+beta7 release.

	* CHANGES: Updated.

2011-11-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host): Always print arrows, even if time is empty.

2011-11-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host, report [report-assets]): Handle ISO time.

2011-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp): Set both overrides OMP flags from the
	URL param.

2011-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (gsa:long-time, html-report-details): Add length check.
	(html-report-table): Correct next_time check.
	(report [assets]): Handle ISO time.

2011-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (gsa:long-time): New function.
	(html-report-table, agent, agent [trash], schedule, schedule [details])
	(note [details], override [details], report_format, report_format [trash])
	(note-detailed, override-detailed): Neaten ISO times.

2011-11-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details, short_timestamp_first)
	(short_timestamp_last, report, report [overview]): Filter ISO dates.

2011-11-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (assets): Remove duplicate &amp;.

2011-11-16  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-11-16  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 3.0+beta6 release.

	* CHANGES: Updated.

2011-11-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (assets): Add override selector.  Add overrides flag
	to links.
	(html-report-details): Add overrides flag to Prognostic Report link.
	(host): Add override selector.  Add overrides flag to links.
	(report [assets]): Add overrides flag to links.

	* src/html/help.xsl (hosts.html): Add note about applying overrides.

2011-11-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (assets): When there are 0 hosts skip the host
	counts and table, and put "0 hosts".  This matches the behaviour for
	0 results in a report.

2011-11-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add - to hostport.

2011-11-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (get_info_response): Explain better the situation
	if no CPE/CVE entry was found.

2011-11-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (override [details]): Show the override in the active
	style always, with a hint in the title when it's off.  This allows the
	user to see the full text, even when the override is off.
	(override-detailed): Use the override_box_box always, and remove the
	"Active: no".

2011-11-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (override [details]): Only show appearance when active.
	(result-detailed): Show overrides only when they are active.

2011-11-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (override-detailed): Little improvement of text
	for ative flag.

2011-11-10  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/CMakeLists.txt: Adjust path to make XSLT validation work for
	out-of-source builds.

	* CMakeLists.txt: Adjust source locations in install command to enable
	installation from an out-of-source build.

2011-11-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host): Get the right pos, from the XML, for the
	prognostic report icon.

2011-11-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_note_omp, delete_note_omp, save_note_omp)
	(create_override_omp, delete_override_omp, save_override_omp): Use
	apply_min_cvss_base instead of apply_min, which was the name of the
	variable used to pass the URL param before the param passing change.

	* src/html/omp.xsl: Cast all min_cvss_base comparisons to number, so that
	the result is "0" or "1" instead of "true" or "false".

2011-11-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (override-detailed): Use apply_overrides for overrides
	param.  GSA delete_notes expects apply_overrides there, and uses that
	param for both override and apply_overrides in the OMP GET_REPORT.

2011-11-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (override-detailed): Skip active field if always on.
	Simplify active field if on with time limit.

2011-11-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add active and days.

	* src/gsad_omp.c (create_override_omp, save_override_omp): Pass active
	state through.

	* src/html/omp.xsl (html-create-override-form)
	(html-edit-override-form): Add active field.
	(override [details]): Check the length of the end_time because it's always
	present.
	(override-detailed): Lowlight the box when the override is off.  Add
	active status above modification time.

2011-11-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (cve-detail, cpe-details): Add last SCAP update time.

2011-11-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table, html-overrides-table): Add active
	column.
	(override, override [details]): Add active state.

2011-11-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Add URL trace message.  Add favicon.ico
	special case, to prevent the session from expiring when the browser
	requests this file.

2011-11-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/sensor.png: New.

	* CMakeLists.txt: Install new icon.

	* src/html/omp.xsl (task): Replace temporary icon by final one.

2011-10-03  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Removed duplicate entry.

2011-10-03  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Added entries for Slackware Linux.

2011-11-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (nvt): Make Tags align top.

2011-11-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (assets): Fixed greyed icon for prognosis.

2011-11-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/provide_view.png, src/html/img/view_other.png: New.

	* CMakeLists.txt: Install new icons.

	* src/html/omp.xsl (task): Exchanged temporary view icons
	by final ones.

2011-11-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/prognosis.png, src/html/img/prognosis_inactive.png: New.

	* CMakeLists.txt: Install new icons.

	* src/html/omp.xsl (report): Exchanged temporary prognosis icon
	by final one.

2011-11-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/os_slackware.png: New.

	* CMakeLists.txt: Install the new icon.

2011-11-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (nvt): Put each tag neatly on a line.

2011-11-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/oap.xsl: Remove "Back to" from all "Back to" links.

2011-11-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (nvt): Add version field.

2011-11-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (cpe-details): Add width to Name column, otherwise it's
	all crammed up when there's only one row.  Separate note from table by
	adding P.

2011-11-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl: Remove "Back to" from all "Back to" links.

2011-11-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host): Add Prognostic Report icon in title.

2011-11-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host, report [assets]): Change "Asset" to "Host" in
	tooltip and title.

2011-11-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (assets, report [assets]): Add result_hosts_only to
	prognostic report links.
	(html-report-details): Include the "Only show hosts..." checkbox for
	prognostic reports too.

2011-11-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (assets): Add missing report element to prognostic
	report link.
	(html-report-details): Add missing host filter params to page arrows.

2011-11-01  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (get_info_response, cpe-details): Display associated
	vulnerabilities of a CPE even if this one isn't present in the
	official CPE dictionary.

2011-10-31  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add prognostic case for the page
	arrows, because these need extra params.

2011-10-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (assets): Grey progostic report icon when list is
	empty.
	(report [assets]): Grey prognostic icon in actions when Apps is 0.  Move
	Reports column to end as other columns all refer to current report.

	* src/html/help.xsl (hosts.html): Update icon.

2011-10-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (wrap): Add outer loop on paragraphs, because
	tokenizing on lines swallows empty lines.

2011-10-26  Matthew Mundell <matthew.mundell@greenbone.net>

	Add note and override exporting.

	* src/html/omp.xsl (note, note [nvt-details], override)
	(override [nvt-details], note-detailed, override-detailed): Add export
	button.

	* src/gsad.c (init_validator): Add export commands.
	(exec_omp_get): Add export calls.

	* src/gsad_omp.c (export_note_omp, export_override_omp): New functions.

	* src/gsad_omp.h: Add headers accordingly.

2011-10-26  Matthew Mundell <matthew.mundell@greenbone.net>

	Maintain the refresh interval across most of the actions on the get_tasks
	page.

	* src/html/omp.xsl (task): Add refresh_interval to icons.

	* src/gsad_omp.c (delete_task_omp stop_task_omp pause_task_omp)
	(resume_paused_task_omp resume_stopped_task_omp start_task_omp): Pass
	refresh_interval to get_tasks.

2011-10-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (cve-details): Add "none" case for References and
	Vulnerable Products.  Format Vulnerable Products like other tables.

2011-10-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Bring the SecInfo pages closer to the others.

	* src/html/dialog.xsl (browse_infosec.html): Remove main heading.  Use H1
	for headings.

	* src/html/omp.xsl (cve-details, cpe-details): Remove main heading.  Use
	H1 for headings.  Add "Back to" link.

2011-10-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (cve-details): Use H1 for both NVT list cases.

2011-10-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_info_response): Make heading depend on type.

2011-10-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host): Link threat count to CPE Details page.

2011-10-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (cpe-details): Add list of reported vulnerabilites.

2011-10-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (cve-details): Bold only the ID field, as in other
	pages.

2011-10-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (cve-details): Add table of NVTs that address the CVE.

2011-10-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/dialog.xsl (browse_infosec.html): Make the text inputs wider
	so that an entire NVT OID fits in the field.

2011-10-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_info_response): Switch to new wrapper tags.
	(cve-details, cpe-details): Add wrapper tags.

2011-10-21  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/help.xsl: Correct help message for port range.

2011-10-19  Matthew Mundell <matthew.mundell@greenbone.net>

	Get Credential saving working.

	* src/gsad_omp.c (save_lsc_credential_omp): Get change_login from the
	presence of the login param.  This is how it was before the big parameter
	passing patch.  Use the right parameter for the login, "credential_login".
	Get change_password from "enable" instead of "login", because that's the
	form is using.

	* src/html/omp.xsl (html-edit-lsc-credential-form): Use 1 instead of yes
	for "enable" parameters, because that's what validation requires.  Use
	"password" consistently for the password, as it is safe to do so.

2011-10-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-lsc-credential-form): Correct help link.

	* src/html/help.xsl (configure_credentials.html): Add Edit Credential
	action.

2011-10-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_my_settings): Add missing TD.

2011-10-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (contents.html): Move performance to Miscellaneous
	with other Extras.  Add My Settings.  Move SecInfo up to match Extras
	order.
	(my_settings.html): New template.

2011-10-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add missing max_results to All
	Filtered case.

2011-10-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Add ROLE to ENVELOPE in help and dialog
	cases, for header bar.

2011-10-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_my_settings_omp): Set TZ when the timezone changes.

2011-10-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (user_set_password): New function.
	(exec_omp_post): Set password for session after save_my_settings_omp.

	* src/gsad_omp.c (save_my_settings_omp): Add password return.  Set when
	password successfully changed.

	* src/gsad_omp.h: Update header accordingly.

2011-10-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Remove "login" size limitation, to match
	Administrator.

	* src/gsad_oap.c (edit_user_oap): Replace assertion on name with error
	return.  Expect login name in "login" param.

	* src/html/oap.xsl (user): Pass edit_user username in "login" instead of
	"name".

	* src/html/gsad.xsl (html-gsa-logo): Truncate name at 45 characters.

2011-10-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_tasks, get_overrides): Sort overrides by NVT name,
	text.

2011-10-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_tasks, get_notes): Sort notes by NVT name, text.

2011-10-11  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/help.xsl (hosts.html): Improved help message for prognostic
	scan.

2011-10-11  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-10-11  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 3.0+beta5 release.

	* CHANGES: Updated.

	* CMakeLists.txt: Update openvas-libraries dependency.

	* INSTALL: Document updated openvas-libraries dependency.

2011-10-07  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (get_my_settings): Add dummy Password
	entry to make clear to user she could change it if pressing
	the edit icon.

2011-10-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_my_settings_omp): Add Password case.

	* src/html/omp.xsl (edit_my_settings): Add Password input.

2011-10-05  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (get_info_response): Add NVT details handling.

	* src/html/dialog.xsl (browse_infosec.html): Add input field for NVT
	lookups.

	* src/html/help.xsl (browse_infosec.html): Update help message
	accordingly.

2011-10-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Move "last" class to SecInfo.

	* src/html/help.xsl (browse_infosec.html): Add jump to dialog.

	* src/html/omp.xsl (html-create-schedule-form): Remove stray UTC.

2011-10-04  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/help.xsl (browse_infosec.html): Improve help page.

2011-10-04  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/help.xsl (browse_infosec.html): Add help page for the
	Security Information Browser.
	(contents.html): Link the new help page.

	* src/html/dialog.xsl (browse_infosec.html): Add help icon linking to
	the corresponding help page.

2011-10-04  Henri Doreau <henri.doreau@greenbone.net>

	Add a form for security information lookup.

	* src/gsad.c (request_handler): Handle /dialog/<filename> URLs.

	* src/html/dialog.xsl: New. Handle intermediate pages that don't
	directly issue OMP commands.

	* src/html/gsad.xsl: Include dialog.xsl
	(html-gsa-navigation): Add a link to the new form.

	* src/CMakeLists.txt: Add syntax check for dialog.xsl

	* CMakeLists.txt: Update install procedure accordingly (handle dialog.xsl).

2011-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Set the timezone early, so that it's in effect for the entire page
	handler.

	* src/gsad.c (exec_omp_post, exec_omp_get): Set timezone.

	* src/gsad_omp.c (xsl_transform_omp): Remove timezone setting.

	* src/gsad_oap.c (xsl_transform_oap): Remove timezone setting.

2011-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (modify_settings_response): Remove.  Now
	modify_setting_response.
	(modify_setting_response): New template.  Was modify_settings_response.

2011-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_my_settings): Ensure that timezone return arg is
	always set.  If timezone param is "" return "UTC" instead of "".

	* src/gsad_omp.h: Update header accordingly.

	* src/gsad.c (exec_omp_post): Free timezone.

2011-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (user_set_timezone): New function.
	(exec_omp_post): Update timezone after save_my_settings.

	* src/gsad_omp.c (save_my_settings): Add timezone return arg.

	* src/gsad_omp.h: Update header accordingly.

2011-09-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Add editing of My Settings.

	* src/gsad.c (init_validator, exec_omp_post, exec_omp_get): Add
	edit_my_settings and save_my_settings.

	* src/gsad_omp.c (get_my_settings, edit_my_settings)
	(edit_my_settings_omp, save_my_settings_omp): New function.
	(get_my_settings_omp): Call through to get_my_settings.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/omp.xsl (modify_settings_response, edit_my_settings): New
	templates.
	(my_settings): Remove.  Renamed to get_my_settings.
	(get_my_settings): New template.  Was my_settings.  Add edit icon.

2011-09-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Initialise role and timezone in credentials.

2011-09-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a My Settings page.

	* src/gsad.c (init_validator): Add get_my_settings to cmds.
	(exec_omp_get): Add get_my_settings.

	* src/gsad_oap.c (xsl_transform_oap): Add TIMEZONE to ENVELOPE.

	* src/gsad_omp.c (xsl_transform_oap): Add TIMEZONE to ENVELOPE.
	(get_my_settings_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/gsad.xsl (html-gsa-logo): Link username to My Settings.
	(html-gsa-navigation): Add My Settings.
	(timezone): New template.

	* src/html/omp.xsl (my_settings): New template.

2011-09-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Use the timezone given in the OMP AUTHENTICATE.  Store this timezone in
	the session.  Similarly for the user role, adding the role to the
	page header.

	* src/gsad_base.c (ctime_r_strip_newline): Use strftime to include
	timezone.

	* src/gsad_base.h (credentials_t): Add role and timezone.

	* src/gsad.c: Increase size of buffers passed to ctime_r_strip_newline.
	(struct user): Add role and timezone.
	(user_add): Add role and timezone args.
	(exec_omp_post): Pass role and timezone from authenticate_omp to user_add.
	(request_handler): Set role and timezone in credentials for page handlers.

	* src/gsad_oap.c: Increase size of buffers passed to
	ctime_r_strip_newline.
	(xsl_transform_oap): Set timezone if present.  Add role to ENVELOPE.

	* src/gsad_omp.c: Increase size of buffers passed to
	ctime_r_strip_newline.
	(xsl_transform_oap): Set timezone if present.  Add role to ENVELOPE.
	(authenticate_omp): Add role and timezone return args.  Call
	omp_authenticate_info to set them.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/gsad.xsl (html-gsa-logo): Add role.  Remove timezone.
	(role): New template.

2011-09-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp/xsl (get_info_cve_lnk, nvt): Flush trailing whitespace.
	(report [details]): Turn result icons back on for normal cases.  These
	were accidentally turned off during addition of prognostic results.

2011-09-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp): Correct delta state param name.

2011-09-26  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp/xsl (get_info_response): Improve error messages for
	unknown elements.

2011-09-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp): Correct format specifier.

2011-09-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Replace \\R with (?s) in regexps.

2011-09-26  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (result-detailed): Make CPE and CVE clickable in the
	prognostic scan reports.

2011-09-26  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (cve-details, cpe-details): Add help icons.

	* src/html/help.xsl (contents.html, glossary.html): Document CPE and
	CVE.
	(cpe.html, cve.html): New help pages.

2011-09-26  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (cve-details, nvt, host): Use one-liners to
	transmit template parameters, to improve readability.

2011-09-26  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (nvt): Add links to the CVE details dialog.
	(get_info_cve_lnk): Add an optional gsa_token parameter, to let the
	caller set the value if not available from within the template.

2011-09-26  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (get_cve_details, get_cpe_details): Make item name
	unclickable to prevent these recursive links to confuse users.

2011-09-22  Henri Doreau <henri.doreau@greenbone.net>

	Add new CVE and CPE details dialog.

	* src/gsad.c (init_validator, exec_omp_get): Add get_info command.

	* src/gsad_omp.c (get_info, get_info_omp): New functions.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (stylesheet): Add SCAP namespaces.
	(get_info_cpe_lnk, get_info_cve_lnk, get_info_response, cve_details)
	(cpe_details): Add CVE and CPE details dialog.
	(host): Apply get_info_cpe_lnk and get_info_cve_lnk to make CPE and
	CVE clickable.

2011-09-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (task): Slightly improved appearance of icons
	in name column.

2011-09-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-task-table, task): Replace owner column with
	owner icon in task column.  Also add icons for observers and slave.

2011-09-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/oap.xsl (html-create-user-form, user [edit]): Add observer
	role.

2011-09-21  Matthew Mundell <matthew.mundell@greenbone.net>

	Add task observers.

	* src/gsad.c (init_validator): Add observers.

	* src/gsad_omp.c (create_task_omp, save_task_omp): Add observers.
	(get_tasks, get_lsc_credentials, get_target_omp, get_config)
	(get_config_family, get_config_nvt): Add actions param to GET OMPs.

	* src/html/omp.xsl (html-task-table): Add owner column.
	(html-report-table, report, html-edit-task-form): Add observers field.
	Turn off icons on observed tasks.
	(task): Add owner column.  Turn off icons when observing.
	(new_task): Add observer field.

2011-09-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl: Rename assets to hosts.

	* src/html/help.xsl (assets.html): Remove to hosts.html.
	(hosts.html): New template.  Was assets.html.  Rename assets to hosts.
	Add prognosis column and icons.
	(contents.html): Add Asset Management.

	* src/html/omp.xsl (assets, html-report-details, host): Rename assets to
	hosts.

2011-09-19  Matthew Mundell <matthew.mundell@greenbone.net>

	Add multi-host prognosis report.

	* src/gsad.c (init_validator): Add host_levels alias.

	* src/html/omp.xsl (html-report-details): Correct path in Back to Assets
	link.
	(report [assets]): Pass Back to Assets link levels in host_levels.

2011-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Add multi-host prognosis report.

	* src/gsad_omp.c (get_report_omp): Add host levels to
	GET_PROGNOSTIC_REPORT.

	* src/html/omp.xsl (assets): Add overall prognostic report button.
	(html-report-details): Get back link levels from host levels.  Remove
	result hosts only button.

2011-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Pass host filtering params
	through on result filtering form too.

2011-09-16  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (host): Add hardware information table.

2011-09-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add host filters.

	* src/gsad_omp.c (get_report_omp): Add host filters to
	GET_PROGNOSTIC_REPORT.

	* src/html/omp.xsl (html-report-details): Get most filters for back link
	from new GET_PROGNOSTIC_REPORT elements, instead of using the result
	filters.
	(report [assets]): Use host names for filter params in prognostic report
	link.

2011-09-15  Matthew Mundell <matthew.mundell@greenbone.net>

	Add single host prognostic reports.

	* src/gsad.c (init_validator): Add prognostic to type.

	* src/gsad_omp.c (get_report_omp): Add prognostic case.

	* src/html/omp.xsl (html-report-details): Add prognostic report handling.
	(get_prognostic_report): New template.
	(result-detailed, report [assets], report [overview])
	(report [details]): Add prognostic cases.

2011-09-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host): Add max prognosis threat.
	(report [assets]): Add prognosis column.

2011-09-07  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (host): Moved Report info up as all
	the rest refers to the selected report. Renamed section
	"Apps" to "Detected Apps".

2011-09-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host): Add prognosis columns.

2011-09-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (check_modify_config): Add name error case.
	(save_config_omp): Pass name and comment to Manager.

	* src/html/omp.xsl (html-config-table): Add name and comment editing.

2011-09-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (host): Correct help link.

	* src/html/help.xsl (assets.html): Add actions and asset details.

2011-09-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp): Add filters to GET_ASSET.

	* src/html/omp.xsl: Add stylesheet attribs for functions.
	(gsa:build-levels): New function.
	(host, report [assets]): Add filters to links.

2011-09-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_lsc_credentials): Init sort params.

	* src/html/gsad.xsl (html-gsa-navigation): Clean up some wrapping.

2011-09-05  Matthew Mundell <matthew.mundell@greenbone.net>

	Add report scrolling to Asset Details page.

	* src/gsad.c (init_validator): Add pos.
	(get_report_omp): Send host and pos to Manager.  Remove search_phrase
	hack.

	* src/gsad_omp.c (get_report_omp): If host is given send host as
	search_phrase and wrap in get_asset.

	* src/html/omp.xsl (host, report [assets]): Add report scrolling.

2011-09-05  Matthew Mundell <matthew.mundell@greenbone.net>

	Add Asset Details page.

	* src/gsad_omp.c (get_report_omp): If host is given send host as
	search_phrase and wrap in get_asset.

	* src/html/omp.xsl (host, get_reports_response [asset], get_asset): New
	template.
	(report [assets]): Add Actions column.

2011-09-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Remove old param mechanism.

	* src/gsad.c (init_validator): Add login command and caller rule.
	(free_gchar_array, struct req_parms, append_chunk_string)
	(append_chunk_binary): Remove.
	(struct gsad_connection_info): Add cookie.  Was in struct req_parms.
	(free_resources): Remove req_parms, add cookie.
	(serve_post): Remove old param inits.
	(ELSE, ELSE_OAP): Get cmd from new params.
	(exec_omp_post): Get all params from new mechanism.
	(exec_omp_get): Remove old param inits.  Get package_format from new
	params.
	(request_handler): Use new cookie location.  Get text from new params.

2011-09-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert last pages to new param mechanism.

	* src/gsad.c (exec_omp_get): Pass single param instead of many.

	* src/gsad_oap.c (get_user_oap, get_users_oap, get_feed_oap): Replace
	multiple args with one.

	* src/gsad_omp.c (get_nvts_omp, get_target_omp, get_targets_omp)
	(get_configs_omp, get_trash_omp): Replace multiple args with one.

	* src/gsad_omp.h, src/gsad_oap.h: Update headers accordingly.

	* src/html/oap.xsl (user): Match param name to validator.

2011-09-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (get_slave_omp, get_slaves_omp, get_schedule_omp)
	(get_schedules_omp, get_system_reports_omp, get_report_format_omp)
	(get_report_formats_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-09-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (get_result): New function.  Body from get_result_omp.
	(get_result_omp): Call through to get_result.  Update callers to call
	get_result.
	(get_notes_omp, get_overrides_omp): Add params arg.

	* src/gsad_omp.h: Update headers accordingly.

2011-09-01  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (init_validator): Add rules and new commands.
	(exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (export_lsc_credential_omp): New function.  Split from
	get_lsc_credentials.
	(get_lsc_credentials): Replace multiple args with one.  Update caller.
	(get_lsc_credentials_omp, get_agents_omp, get_escalator_omp)
	(get_escalators_omp): Replace multiple args with one.
	(create_agent_omp): Improve size check because new param size can be -1.
	(get_agent_omp): New function.  Split from get_agents.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (lsc_credential, agent): Use new command names.

2011-09-01  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (verify_agent_omp, export_config_omp)
	(export_preference_file_omp, export_report_format_omp)
	(verify_report_format_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-09-01  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_get, exec_omp_post): Pass single param instead of
	many.

	* src/gsad_omp.c (edit_task, edit_report_format): Replace multiple args
	with one.  Update caller.
	(edit_task_omp, save_container_task_omp, edit_report_format_omp): Replace
	multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (html-edit-task-form): Separate into two commands.

2011-09-01  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (new_task): New function.  Body from new_task_omp.
	(new_task_omp): Call through to new_task.
	(create_report_omp): Replace multiple args with one.
	(get_config, get_config_family, get_config_nvt): New functions.  Bodies
	from *_omp versions, replacing multiple args with one.
	(get_config_omp, edit_config_omp, get_config_family_omp)
	(edit_config_family_omp, get_config_nvt_omp, edit_config_nvt_omp): Call
	through to new function.  Switch callers to new function.
	(edit_override_omp): Replace multiple args with one.
	(save_override_omp): Correct message typo.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-31  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (validator): Remove.  Out of use.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (save_task_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update header accordingly.

2011-08-31  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (init_validator): Add more rules.
	(validator_or): Remove.  Out of use.
	(params_append_mhd): Add more container cases.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_oap.c (modify_ldap_auth_oap): Remove for rename.
	(modify_auth_oap): New function.  Was modify_ldap_auth_oap.  Replace
	multiple args with one.

	* src/gsad_omp.c (stop_task_omp, pause_task_omp, resume_paused_task_omp)
	(resume_stopped_task_omp, start_task_omp, test_escalator_omp, restore_omp)
	(save_config_family_omp, save_config_nvt_omp): Replace multiple args with
	one.

	* src/gsad_omp.h, src/gsad_oap.h: Update headers accordingly.

2011-08-31  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (init_validator): Add get_task rules.
	(exec_omp_post, exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (get_report_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-report-details): Match param name to validator.

2011-08-31  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Re-ordered some entries to have the most specific
	ones at the beginning.

2011-08-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_report_omp): Get xml_file before using it.

2011-08-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad_omp.c (create_report_omp): Make it compile again by
	initializing a variable before use.

2011-08-30  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (init_validator): Add result_task_id.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (create_override_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-create-override-form): Match param name to
	validator.

2011-08-30  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (init_validator): Add result_task_id.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (create_note_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-create-note-form): Match param name to validator.

2011-08-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (init_validator): Add credential rule.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (create_target_omp, create_slave_omp)
	(create_schedule_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (params_append_mhd): Add preference check.

2011-08-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_lsc_credential_omp): Put paren in right place.

2011-08-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Get create_credential params working.

	* src/gsad.c (init_validator): Add create_credential rules.

	* src/gsad_omp.c (CHECK): New macro.
	(create_lsc_credential_omp): Use the right param names.  Check one param
	at a time.

	* src/html/omp.xsl (html-create-lsc-credential-form): Use lsc_password
	instead of password as param name.

2011-08-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert create_task to new param mechanism.

	* src/gsad.c (init_validator): Add rules for optional cases.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_base.h (GSAD_MESSAGE_INVALID): New define.

	* src/gsad_omp.c (new_task_omp): Show message.
	(CHECK): New macro.
	(create_task_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (new_task): Use optional cases of params.  Remove stray
	input.

2011-08-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (create_report_omp, create_lsc_credential_omp): Replace
	multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (init_validator): Widen method_data value.  Add escalator
	data rules.
	(escalator_data): Remove.  For old param mechanism.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (send_escalator_data, send_escalator_method_data): Expect
	data as params.
	(create_escalator_omp, create_config_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-25  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Make the first
	menu item the default when clicking on the main menu.
	Patch by Karl-Heinz Ruskowski.

2011-08-24  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Added an entry for Greenbone OS 1.6.

2011-08-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert save_override to new param mechanism.

	* src/gsad.c (exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (save_override_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (init_validator): Include newlines in xml_file.  Add
	method_data rules.
	(params_append_mhd): Add method_data check.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_oap.c (sync_feed_oap, save_settings_oap): Replace multiple
	args with one.

	* src/gsad_omp.c (get_tasks_omp, import_report_format_omp): Replace
	multiple args with one.

	* src/gsad_omp.h, src/gsad_oap.h: Update headers accordingly.

	* src/html/omp.xsl (html-task-table): Remove duplicate input.

2011-08-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (delete_task_omp, delete_report_omp): Replace multiple
	args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (delete_note_omp, delete_override_omp): Replace multiple
	args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-23  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (new_note_omp, new_override_omp): Replace multiple args
	with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-23  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (delete_trash_task_omp, delete_trash_escalator_omp)
	(delete_trash_lsc_credential_omp, delete_trash_agent_omp)
	(delete_trash_schedule_omp, delete_trash_target_omp)
	(delete_trash_config_omp, delete_trash_slave_omp)
	(delete_trash_report_format_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-23  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (exec_omp_post): Pass single param instead of many.

	* src/gsad_oap.c (delete_user_oap): Replace multiple args with one.

	* src/gsad_omp.c (delete_escalator_omp, delete_lsc_credential_omp)
	(delete_agent_omp, delete_schedule_omp, delete_target_omp, delete_config_omp)
	(delete_slave_omp, delete_report_format_omp): Replace multiple args with
	one.

	* src/gsad_omp.h, src/gsad_oap.h: Update headers accordingly.

2011-08-23  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert save_config to new param mechanism.

	* src/gsad.c (init_validator): Add config rules.
	(params_append_mhd): Catch the collection params explicitly instead of
	searching for a colon.
	(params_mhd_validate_values): New function.
	(params_mhd_validate): Validate values too.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_base.c (params_add): Set value manually to use allocated
	memory.

	* src/gsad_omp.c (member): Search in params instead of array.
	(member1): New function.
	(save_config_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update header accordingly.

2011-08-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Consistently mark
	each last menu entry with class "last".

2011-08-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Remove last from Trashcan.

2011-08-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert more pages to new param mechanism.

	* src/gsad.c (init_validator): Add xml_file regex.
	(params_append_mhd): Add filename arg.  Set in param.  Update caller.
	(exec_omp_get): Pass single param instead of many.

	* src/gsad_base.c (param_free): Add filename.
	(params_value_size, params_filename): New functions.

	* src/gsad_base.h: Add headers accordingly.
	(struct param): Add filename.

	* src/gsad_oap.c (create_user_oap): Replace multiple args with one.

	* src/gsad_oap.h: Update header accordingly.

	* src/gsad_omp.c (create_agent_omp, empty_trashcan_omp)
	(import_config_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (ELSE, ELSE_OAP): New macros.
	(exec_omp_post, exec_omp_get): Use macro for params cases.

	* src/gsad_oap.c (save_user_oap): Correct op name in message.

2011-08-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Renamed
	"Misc" to "Extras".

2011-08-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Moved "Administration"
	behind "Misc".

2011-08-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (html-task-table): Reduced width of columns
	Threat and Trend.

2011-08-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsad.xsl (html-gsa-navigation): Moved "Scan Configs"
	menu item two entries down.

	* src/html/gsad.xsl (html-gsa-navigation): Moved Performance
	menu item from "Scan Management" to "Misc".

2011-08-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsa-style.css: Removed some redundant
	color/background definitions. This patch was developed by
	Karl-Heinz Ruskowski.

2011-08-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Make Navigation a menu. This patch was developed by
	Karl-Heinz Ruskowski.

	* src/html/img/style/top_menu_buttons.png,
	src/html/img/style/menu_pointy.png: New.

	* CMakeLists.txt: Install top_menu_buttons.png and menu_pointy.png.

	* src/html/gsa-style.css (progressbar_text): increased
	z-index to 3 to have it below the menu.
	(gb_menu): New. The styles for the new menu.

	* src/html/gsad.xsl (html-gsa-navigation): Replaced
	gb_window div-container by gb_menu div container.
	(envelope): Replace the table where first column was
	Navigation with simply stacked Menu/Content.

2011-08-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert save_note to new param mechanism.

	* src/gsad.c (exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (edit_note_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update header accordingly.

2011-08-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert get_note to new param mechanism.

	* src/gsad.c (exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (get_note, get_note_omp): Replace multiple args with one.
	Update callers.

	* src/gsad_omp.h: Update header accordingly.

2011-08-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert save_notes to new param mechanism.

	* src/gsad_base.c (params_free): Free original_value.
	(params_given, params_original_value): New functions.
	(params_add): Clear memory on allocation.

	* src/gsad_base.h: Update headers accordingly.
	(RESULTS_PER_PAGE): New define.  From gsad.c.
	(struct param): Add original_value.

	* src/gsad.c (RESULTS_PER_PAGE): Remove.  To gsad_base.h.
	(params_append_mhd): Append to the param even if zero size, so that empty
	params are still added.
	(params_mhd_validate): Set original_value.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (save_note_omp): Replace multiple args with one.  Check
	validation outcome, as was done in exec_omp_post.

	* src/gsad_omp.h: Update header accordingly.

2011-08-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert save_report_format to new param mechanism.  In the process add
	handling of binary values and groups of values to the mechanism.

	* src/gsad_base.c (params_values, params_append_bin)
	(params_iterator_next): New functions.
	(params_add): Return added param.

	* src/gsad_base.h: Update headers accordingly.
	(struct param): Add values and values_size.
	(params_iterator_t, params_iterator_init): New defines.

	* src/gsad.c (params_append_mhd): If name contains a colon add the data
	to the params new named values instead of to the params single value.
	(exec_omp_post): Pass single param instead of many.

	* src/gsad_omp.c (save_report_format_omp): Replace multiple args with one.

	* src/gsad_omp.h: Update header accordingly.

2011-08-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_oap.c (save_user_oap): Remove excess tracing.

2011-08-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Convert get_lsc_credential and edit_lsc_credential to new param mechanism.

	* src/gsad.c (init_validator): Add next.
	(exec_omp_post, exec_omp_get): Pass single param instead of many.

	* src/gsad_omp.c (get_lsc_credential, get_lsc_credential_omp)
	(edit_lsc_credential, edit_lsc_credential_omp)
	(save_lsc_credential_omp): Replace request params with single arg.

	* src/gsad_omp.h: Update headers accordingly.

2011-08-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Add automatic storage and validation of request parameters.  The idea is
	to reduce the work and complexity involved in the explicit parameter
	handling.  Convert a few of the Administrator pages to this mechanism.

	* src/gsad.c (struct gsad_connection_info, free_resources): Add params.
	(params_append_mhd, params_mhd_validate, params_mhd_add): New functions.
	(serve_post): Add every param to params.
	(exec_omp_post): Validate all params.  Pass single param arg to
	save_user_oap.
	(exec_omp_get): Add and validate every param.  Pass single param arg to
	edit_settings_oap and edit_user_oap.
	(redirect_handler, request_handler): Init params.

	* src/gsad_base.c (param_free, params_new, params_free, params_get)
	(params_value, params_valid, params_add): New functions.

	* src/gsad_base.h: Add headers accordingly.
	(params_t, struct param, param_t): New types.

	* src/gsad_oap.c (save_user_oap, edit_user_oap)
	(edit_settings_oap): Replace request param args with single arg.

	* src/gsad_oap.h: Update headers accordingly.

2011-08-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (assets): Add help icons.

	* src/html/omp.xsl (assets.html): New template.
	(view_report.html): Correct window name.

2011-08-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Use "assets" in naming instead of "inventory".

	* src/gsad.c (init_validator): In type rename inventory to assets.

	* src/gsad_omp.c (get_report_omp): Rename type inventory to assets.

	* src/html/gsad.xsl (html-gsa-navigation): Rename type inventory to
	assets.

	* src/html/omp.xsl (inventory, report [inventory])
	(report [report-inventory]): Rename.
	(assets): New template.  Was "inventory".  Update caller.  Rename report
	type inventory to assets.
	(get_reports_response): Rename report type inventory to assets.
	(report [assets]): New template.  Was "report [inventory]".  Update caller.
	(report [report-assets]): New template.  Was "report [report-inventory]".
	Update caller.

2011-08-09  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Added a generic entry for Ubuntu.

2011-08-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Hide Filtered Results window
	inventory table.

2011-08-08  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/os_ubuntu.png: New.

	* CMakeLists.txt: Install the new icon.

2011-08-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (inventory): Enable search phrase field.  Add search
	phrase to page links.

2011-08-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Allow any character in authdn.

2011-08-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Enable Assets threat filtering.

	* src/gsad_omp.c (get_report_omp): Make levels fallback the empty
	string.

	* src/html/gsad.xsl (html-gsa-navigation): Add levels to Assets link.

	* src/html/omp.xsl (inventory): Enable threat filter.  Add levels to page
	links.

2011-08-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (inventory): Add Filtering window with results per
	page.

2011-08-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [report-inventory]): Match distance to Assets
	page.

2011-08-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (inventory): Add pagination.

2011-08-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl: Fixed typo: Intesity -> Intensity (3 times).

2011-08-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (inventory): Rename Inventory page to Assets.

	* src/html/gsad.xsl (html-gsa-navigation): Rename Inventory page Assets.

2011-08-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [inventory, report-inventory]): Subtract
	less from the traceroute distance so it starts at 0.

2011-08-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [inventory]): For report link Use static notes
	and overrides values, and include host as search phrase.

2011-08-01  Matthew Mundell <matthew.mundell@greenbone.net>

	Add basic host inventory page.

	* src/gsad.c (init_validator): Add type.
	(exec_omp_post): Update get_report_omp call.
	(exec_omp_get): Pass type to get_report_omp.

	* src/gsad_omp.c (get_report_omp): Add type arg.  Add to GET_REPORT
	request.  Exit earlier in inventory case.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/gsad.xsl (html-gsa-navigation): Add Asset Management section.

	* src/html/omp.xsl (inventory): New template.
	(html-report-details): Rename template in call.
	(get_reports_response): Call template according to type.
	(report [report-inventory]): New template.  Body from report [inventory].
	(report [inventory]): Replace body with full inventory page case.

2011-08-01  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Added entries for Univention Corporate Server (UCS).

2011-07-29  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/os_ucs.png: New.

	* CMakeLists.txt: Install the new icon.

2011-07-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (os-icon): New template.
	(report [inventory], report [overview]): Call os-icon.

2011-07-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add an example inventory host
	table to the Filtered Results window.
	(report [inventory]): New template.

2011-07-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-07-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 3.0+beta4 release.

	* CHANGES: Updated.

2011-07-20  Matthew Mundell <matthew.mundell@greenbone.net>

	Move performance prefs from configs to tasks.

	* src/gsad.c (init_validator, struct req_parms, free_resources)
	(serve_post): Add max_checks and max_hosts.
	(exec_omp_post): Pass max_checks and max_hosts to new_task_omp and
	save_task_omp.

	* src/gsad_omp.c (create_task_omp, create_task_omp): Add max_checks and
	max_hosts params.  Pass to OMP commands.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (html-report-table, html-edit-task-form, new_task): Add
	Scan Intensity fields.

2011-07-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add missing report params to
	result window << and >> links.

2011-07-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (struct req_parms, serve_post, exec_omp_get): Remove TODOs
	about stricter and static parameter handling, it's already too hard to
	manage the parameters.

2011-07-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Add get_result Back to Report link for delta results.

	* src/gsad.c (exec_omp_get): Pass delta params to get_result_omp.

	* src/gsad_omp.c (get_result_omp): Add delta param args.  Pass into XML.
	Update callers.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (result-details): Add Back to Report link for delta
	case.
	(result-detailed): Pass delta params to get_result.

2011-07-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (note-detailed, override-detailed)
	(result-detailed): Pass overrides to note icons from apply_overrides,
	because apply_overrides is the apply flag, whereas overrides is the
	"include overrides" flag.

2011-07-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Pass get_report params across creates on get_result page.

	* src/gsad.c (exec_omp_post): Pass get_report params to the get_result
	cases of create_note_omp and create_override_omp.
	(exec_omp_get): Pass get_report params to the get_result cases of
	new_note_omp and new_override_omp.

	* src/gsad_omp.c (create_note_omp, create_override_omp): Rename result_id
	arg to note_result_id.  Add result_id arg for get_result result.  Pass
	get_report params to get_result_omp.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (html-create-note-form, html-create-override-form): Add
	get_report params to get_result case of create icon.  Pass result ID in
	result_id instead of report_id.  Use note_result_id for result ID
	constraint of note/override instead of result_id.
	(result-detailed): Add get_report params to get_result case of create
	icon.

2011-07-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (note-detailed, override-detailed): Get edit icon
	note/override param value from XML instead of assuming it is 1.  Get
	the value from the correct element too.

2011-07-15  Matthew Mundell <matthew.mundell@greenbone.net>

	Pass get_report params across edits on get_result page.

	* src/gsad.c (exec_omp_post): Pass get_report params to the get_result
	cases of save_note_omp and save_override_omp.
	(exec_omp_get): Pass get_report params to the get_result cases of
	edit_note_omp and edit_override_omp.

	* src/gsad_omp.c (edit_note_omp, edit_override_omp): Add result_id arg.
	Pass into XML.
	(save_note_omp, save_override_omp): Pass get_report params to
	get_result_omp.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (html-edit-note-form, html-edit-override-form): Add
	result_id param for get_result, because report_id is now used for
	report_id passed from get_report page.
	(note-detailed, override-detailed): Add get_report params to edit icon in
	get_results case.

2011-07-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Pass result ID to delete_note_omp and
	delete_override_omp from result_id instead of report_id, because report_id
	is used for the get_report pass-through params now.

	* src/gsad_omp.c (delete_note_omp, delete_override_omp): Add result_id
	arg.  Use for result ID for get_result_omp instead of report_id.  Also
	correct format specifier for first and max.

	* src/gsad_omp.h: Update headers accordingly.

2011-07-15  Matthew Mundell <matthew.mundell@greenbone.net>

	Pass get_report params across deletes on get_result page.

	* src/gsad.c (exec_omp_post): Pass get_report params to delete_note_omp
	and delete_override_omp.

	* src/gsad_omp.c (REQUIRE): New macro.
	(get_result_omp): Check args with REQUIRE.
	(delete_note_omp, delete_override_omp): Pass get_report params back to
	get_result_omp.

	* src/html/omp.xsl (note-detailed, override-detailed): Add get_report
	params to delete icons.

2011-07-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_result_omp): Move the constructed report children
	up to the same level as the report, for the XSL.

	* src/html/omp.xsl (result-details): In the links that pass through the
	get_report params, expect the params at the same level above the result
	as in the get_report case, like the links that use the params for other
	purposes do.

2011-07-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_result_omp): Remove trace text.

	* src/html/omp.xsl (result-details): Add get_report params to refresh
	icon.  Correct sort paths in Back to Report link.

2011-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a Back to Report link to the single result case of the Result Details
	page.

	* src/gsad.c (init_validator): Add apply_overrides.
	(exec_omp_get): Pass get_report params through to get_result for
	back link.

	* src/gsad_omp.c (get_result_omp): Add get_report args.  Pass into XML.
	Update callers with NULLs for now.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (result-details): Add a Back to Report link.  Add
	get_report params to get_result icon.

2011-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp): Exit after the GET_TASKS for the delta
	case, because that's all that's needed.

2011-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result-details): Add delta param.  Skip overrides
	widget if set.
	(get_delta_result): Pass delta flag to result-details.

2011-07-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/os_gos.png: New.

	* CMakeLists.txt: Install the new icon.

2011-07-13  Matthew Mundell <matthew.mundell@greenbone.net>

	Enable result details for delta results.

	* src/gsad.c (exec_omp_post): Pass result_id to get_report_omp.

	* src/gsad_omp.c (get_report_omp): Add a result_id arg.  If given adjust
	the XML to be a GET_DELTA_RESULT instead of a GET_REPORT.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (result [details]): Take task info as args.
	(result-detailed): Add details icon to delta case.
	(get_delta_result): New template.

2011-07-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Pass overrides flag to delete_report_omp.

	* src/gsad_omp.c (delete_report_omp): Add apply_overrides flag.  Call
	through to get_tasks instead of doing the OMP by hand, as some of the OMP
	was missing.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (report): Add override param to delete icon.

2011-07-13  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: Updated with new entries.

2011-07-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/os_junos.png: New.

	* CMakeLists.txt: Install the new icon.

2011-06-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Allow hosts to be empty in save_note and
	save_override.

2011-06-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result [details]): Add overrides control.

2011-06-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-note-form, html-edit-note-form)
	(html-create-override-form, html-edit-override-form): Turn off the details
	button of the associated note/override.

2011-06-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table): Check whether the task is a
	container for the report template, instead of just passing 1.
	(status_bar): Remove shadowed case.

2011-06-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-note-form)
	(html-create-override-form): Move next inside the get_result params,
	because only get_result expects it.
	(result-detailed): Set next in the get_report case of the note-detailed
	call otherwise next ends up as the empty string.

2011-06-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the result details add_override working.

	* src/gsad.c (exec_omp_post): Add a get_result case for create_override.
	(exec_omp_get): Pass override_task_id instead of task_id to
	create_override_omp, because the get_result case uses task_id.

	* src/gsad_omp.c (new_override_omp): Put arg for NEW_OVERRIDE NEXT in the
	right place.
	(create_override_omp): Add args for next page, task name and task ID.  Add
	the get_result case.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-create-override-form): Add params for the
	get_result case.  Use override_task_id instead of task_id for the task_id
	of the override.
	(result-detailed): Move the new_override link to the override section.
	Use the right params in new_override link.

2011-06-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Match get_result delete ops for
	indicator.

	* src/html/omp.xsl (get_result): Match delete op responses.

2011-06-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the result details add_note working.

	* src/gsad.c (exec_omp_post): Add a get_result case for create_note.
	(exec_omp_get): Pass note_task_id instead of task_id to create_note_omp,
	because the get_result case uses task_id.

	* src/gsad_omp.c (create_note_omp): Add args for next page, task name and
	task ID.  Add the get_result case.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-create-note-form): Add params for the get_result
	case.  Use note_task_id instead of task_id for the task_id of the note.
	(result-detailed): Use the right params in new_note link.

2011-06-29  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (get_reports_response/report/report): fixed the
	conflicts reporting mechanism for OS detection.

2011-06-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* ChangeLog: Revert overwritten entry.

2011-06-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the result details save_override working.

	* src/gsad.c (exec_omp_post): Pass task name to edit_override from the
	get_result page.
	(exec_omp_get): Add a new_override case for get_result.

	* src/gsad_omp.c (new_override_omp): Add a next arg.  Add to NEW_OVERRIDE
	for XSL.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-edit-override-form): Add task name param for
	get_result.
	(result-detailed): Setup new_override link specially for get_result.

2011-06-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the result details save_note working.

	* src/gsad.c (exec_omp_post): Pass task name to edit_note from the
	get_result page.
	(exec_omp_get): Add a new_note case for get_result.

	* src/gsad_omp.c (new_note_omp): Add a next arg.  Add to NEW_NOTE
	for XSL.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-edit-note-form): Add task name param for
	get_result.
	(result-detailed): Setup new_note link specially for get_result.

2011-06-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Pass the task name into the get_result page in preparation for the
	edit icons.  As a result show the name instead of the UUID above the
	result.

	* src/gsad.c (exec_omp_post, exec_omp_get): Pass task name to note and
	override operations on the get_result page.  Pass name to get_result_omp
	too.

	* src/gsad_omp.c (get_result_omp): Add task name arg.  Add to TASK for
	XSL.
	(delete_note_omp, save_note_omp, delete_override_omp)
	(save_override_omp): Add task_name arg, pass through to get_result_omp.
	(edit_note_omp, edit_override_omp): Add task_name arg.  Add to EDIT_NOTE
	for XSL.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (note-detailed, override-detailed)
	(result-detailed): Pass task name to commands for get_result.
	(result [details]): Print task name with link instead of UUID.

2011-06-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the Result Details page edit_override working.

	* src/gsad.c (exec_omp_post): Add the get_result case of save_override.
	(exec_omp_get): Add the get_result case of edit_override.

	* src/gsad_omp.c (save_override_omp): Add a get_result case, which calls
	get_result_omp.

	* src/html/gsad.xsl (html-gsa-logo): Add get_result modify_override
	response for indicator icon.

	* src/html/omp.xsl (override-detailed): Setup args specially for
	get_result case.
	(get_result): Match modify_override response.

2011-06-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the Result Details page edit_note working.

	* src/gsad.c (exec_omp_post): Add the get_result case of save_note.
	(exec_omp_get): Add the get_result case of edit_note.

	* src/gsad_omp.c (save_note_omp): Add a get_result case, which calls
	get_result_omp.

	* src/html/gsad.xsl (html-gsa-logo): Add get_result modify_note response
	for indicator icon.

	* src/html/omp.xsl (note-detailed): Setup args specially for get_result
	case.
	(get_result): Match modify_note response.

2011-06-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Get the Result Details page delete_override working.

	* src/gsad.c (exec_omp_post): Add the get_result case of delete_override.

	* src/gsad_omp.c (delete_override_omp): Add a get_result case, which calls
	get_result_omp.

	* src/html/omp.xsl (override-detailed): Add next arg.  When get_result setup
	args for get_result page.
	(result-detailed): Pass next to override-detailed according to arg.

2011-06-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Enable Result Details page buttons and get the delete_note working.

	* src/gsad.c (exec_omp_post): Add the get_result case of delete_note.

	* src/gsad_omp.c (get_result_omp): Add commands arg.  Add TASK to
	GET_RESULT.  Wrap GET_RESULTS in COMMANDS and pass commands from arg
	through to Manager.
	(delete_note_omp): Add a get_result case, which calls get_result_omp.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (note-detailed): Add next arg.  When get_result setup
	args for get_result page.
	(result [details]): Turn on the note and override buttons.  Pass
	result_detailed a result-details flag.
	(result-detailed): Add result-details arg.  Pass next to note-detailed
	according to arg.
	(get_result): Add commands_response case.

2011-06-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (reports.html): Add delta actions.
	(view_report.html): Add delta filtering.

2011-06-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report): Remove anchor from delta first report icon.

2011-06-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (note-detailed, override-detailed): Add delta arg,
	print which result the item refers to.
	(result-detailed): Pass result number and delta flag down into
	override-detailed and note-detailed.  Print the second result notes and
	overrides too.

2011-06-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [details]): Remove "host" and quotes from port
	summary heading.

2011-06-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table): Pass container flag to report
	template.
	(report): Add name and container arg.  Use "Uploading" for upload run
	status instead of "Running".

2011-06-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (tasks.html): Add missing edit_task anchor.

2011-06-24  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-06-24  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 3.0+beta3 release.

	* CHANGES: Updated.

2011-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result [details]): Comment out the help icon for now.

2011-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_result_omp): Get notes and overrides details too,
	for the modification times.

2011-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Pass overrides to get_result_omp.

	* src/gsad_omp.c (get_result_omp): Add apply_overrides arg.  Pass through
	to Manager.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (result-detailed): Use right variable to control
	details icon.  Add overrides to icon link.

2011-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result-detailed): Add BR when NVT is missing, like
	it is for open ports, but only for delta reports, so that the delta result
	status symbol shows fully.

2011-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table): Move Add Report button back into
	FORM.

2011-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-task-form): Add an Import Report window.

2011-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Move Apply button DIV above
	threat DIV, so it stays in the window on older Firefoxes.
	(html-report-table): Move Add Report button DIV above FORM, for same
	reason.

2011-06-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a basic Result Details page.

	* src/gsad.c (init_validator): Add "get_result" command.
	(exec_omp_get): Handle "get_result".

	* src/gsad_omp.c (get_result_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/gsad.xsl (get_results_response): New indicator template.

	* src/html/omp.xsl (result [details], get_results_response)
	(get_result): New template.
	(result-detailed): Add details-button and show-overrides args.  Add a
	result details icon.

2011-06-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (html-gsa-logo): Add more gsad_msg matches.

2011-06-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (create_user_response, delete_user_response)
	(get_settings_response, modify_auth_response, modify_settings_response)
	(modify_user_response, sync_feed_response): New templates.  Mode
	"response-indicator".
	(html-gsa-logo): Match administrator responses for indicator icon.

2011-06-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_oap.c (save_settings_oap): Treat settings element as
	method_data_param_t's, as required by chunking change.

2011-06-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a command result indicator icon.  Only show command result dialog on
	failure.

	* CMakeLists.txt: Install indicator icon images.

	* src/html/gsad.xsl (indicator): New template.  Indicator icon.
	(create_agent_response, create_config_response, create_escalator_response)
	(create_lsc_credential_response, create_note_response)
	(create_override_response, create_report_format_response)
	(create_report_response, create_schedule_response, create_slave_response)
	(create_target_response, create_task_response, delete_agent_response)
	(delete_config_response, delete_escalator_response)
	(delete_lsc_credential_response, delete_note_response)
	(delete_override_response, delete_report_format_response)
	(delete_report_response, delete_schedule_response, delete_slave_response)
	(delete_target_response, delete_task_response, empty_trashcan_response)
	(get_overrides_response, get_reports_escalate_response)
	(get_reports_response, get_system_reports_response, gsad_msg)
	(modify_lsc_credential_response, modify_note_response)
	(modify_override_response, modify_report_format_response)
	(modify_task_response, restore_response, start_task_response)
	(stop_task_response, pause_task_response, resume_paused_task_response)
	(resume_stopped_task_response, test_escalator_response)
	(verify_report_format_response): New templates.  Mode "response-indicator".
	(html-gsa-logo): Match responses for indictor icon.
	(command_result_dialog): Skip the dialog in the success case.

2011-06-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Remove Escalate and Download
	columns for delta reports.
	(result-detailed): Remove note and override creation buttons for delta
	reports.

2011-06-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result-detailed): Add headings to the "changed" result
	subboxes.

2011-06-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsa-style.css (div.diff-line, div.diff-line-hunk)
	(div.diff-line-plus, diff-line-minus): New rules.

	* src/html/omp.xsl (highlight-diff, highlight-diff-line): New function.
	(result-detailed): Add highlighted DELTA/DIFF.

2011-06-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result-detailed): For changed delta results, add
	the second report's result description below the first's.

2011-06-16  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (get_reports_response/report/report): display
	the target hostname if available.

2011-06-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Swap delta_report_id and
	report_id for Apply button, else it swaps the reports.

2011-06-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add scan 2 times and progress
	bar.

2011-06-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/indicator_operation_failed.png,
	src/html/img/indicator_operation_ok.png: New.

2011-06-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add delta params to refresh and
	sorting links.

2011-06-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Skip the Full Report line in the
	Report Summary table for delta reports.

2011-06-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add delta params to paging
	arrows in delta reports.

2011-06-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (serve_post): Append method data chunk if there's an existing
	chunk.

2011-06-08  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (edit-config-preference): Added network_scan to
	the list of parameters that use yes/no radio buttons.

2011-06-08  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (get_reports_response/report/report): Report
	conflicting OS detection results.

2011-06-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details, report): Swap values of report_id
	and delta_report_id for delta case, so that the report selected first
	comes first in the delta.

2011-06-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task): Switch off threat and trend for container
	tasks.

2011-06-07  Matthew Mundell <matthew.mundell@greenbone.net>

	Add importing of reports into container tasks.

	* src/html/omp.xsl (html-report-table): Add report import window.

	* src/gsad_omp.c (create_report_omp): Add task_id arg.  Pass through to
	Manager.  Add name and comment NULL checks.

	* src/gsad_omp.h: Update header accordingly.

	* src/gsad.c (exec_omp_post): Pass task_id to create_report_omp.

2011-06-07  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/delta_second.png, src/html/img/delta.png,
	src/html/img/delta_inactive.png: Udated with better graphics.

2011-06-07  Henri Doreau <henri.doreau@greenbone.net>

	Improved OS detection reporting using host details best_os_* fields.

	* src/html/omp.xsl (get_reports_response/report/report): Refactored
	OS icon displaying code to use best_os_* fields from host details.

	* src/html/os.xml: Updated with entries for OS's that now have CPE's
	associated with.

	* CMakeLists.txt: Updated to install new OS icons.

2011-06-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Add delta state filtering to delta reports.

	* src/html/omp.xsl (html-report-details): Add delta state filtering
	control.

	* src/gsad_omp.c (get_report_omp): Add delta_states arg.  Pass through to
	Manager.

	* src/gsad.c (init_validator): Add delta state validation.
	(exec_omp_get): Pass delta states to get_report_omp.
	(exec_omp_post): Add temporary get_report_omp delta states value.

	* src/gsad_omp.h: Update header accordingly.

2011-06-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Do the filtering controls with
	DIVs instead of a table.

2011-05-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report): Use current override setting in get_report
	icons.

2011-05-26  Matthew Mundell <matthew.mundell@greenbone.net>

	Add very basic report deltas.

	* CMakeLists.txt: Add delta images.

	* src/gsad.c (exec_omp_get): Pass report_id to get_tasks for marking
	report for delta.  Pass delta_report_id to get_report_omp for report
	deltas.

	* src/gsad_omp.c (get_tasks): Add delta candidate arg.  Update callers.
	(get_report_omp): Add delta_report_id arg.  Send through to Manager.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (html-report-details): When delta is given add delta
	to headings and add report links.
	(report): Add delta buttons.
	(result-detailed): When doing delta add state indicators in result
	headings.

	* src/html/img/delta.png, src/html/img/delta_inactive.png,
	src/html/img/delta_second.png: New files.

2011-05-25  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/os_cisco.png, src/html/img/os_freebsd.png,
	src/html/img/os_linux.png, src/html/img/os_netbsd.png,
	src/html/img/os_aix.png, src/html/img/os_openbsd.png: New.

2011-05-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_escalator_omp): Increase value size for trailing
	'\0' in submethod handling.

2011-05-21  Stephan Kleine

	* src/gsad_omp.c: Remove unused variable to fix compilation with GCC 4.6

2011-05-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-escalator-form): Add an attachment option
	for Email Content.
	(escalator [details]): Add attach text to Email Content.

2011-05-19  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-05-19  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 3.0+beta2 release.

	* CHANGES: Updated.

2011-05-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (get_reports_response/report/report):
	Improved note about missing OS information.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_trash): Add missing confirm window.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (modify_note_response)
	(modify_override_response): Remove duplicate templates.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_base.c (xsl_transform): Add trace as in USE_LIBXSLT case.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_nvts, get_note, get_override): Apply templates for
	save note and override confirm windows.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (override [nvt-details]): Use correct icon.  Add XSL markup.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (create_note_omp, create_override_omp): Get escalators
	too, for report page dropdown.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (verify_agent_omp, delete_report_format_omp)
	(verify_report_format_omp): Correct message typos.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table, get_trash): Use "Scan Config"
	instead of "Config" for consistency.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table): Remove surplus } characters.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): At least survive if the caller param is
	missing.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (user): Switch the delete_user icon to POST.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table): Pass task_id and overrides params
	to note and override templates explicitly, instead of bundling them in the
	next param, which only works for GET.
	(note, override): Add params and params-get parameters.

2011-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Remove delete_note override requirement, as
	it's optional.  Validate task_id too for delete_report.  Add save_note
	and save_override NULL param checks that where previously done in
	exec_omp_get.

	* src/gsad_oap.c (delete_user_oap): Add NULL param check that was
	done in exec_omp_get when this was a GET.

	* src/gsad_omp.c: Add NULL param checks to the new POST commands.  These
	were done in exec_omp_get when the commands were GET operations.

2011-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (delete_note_omp, delete_override_omp): Revert erroneous
	NULL checks added when switching the delete_* commands to POST.

2011-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add missing filtering params to
	"All filtered results" download.  Add missing max_results param to
	"Filtered Results 1 to n" download.

2011-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (serve_post): Correct esc_first_result case.  Add missing
	esc_max_results case.

2011-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Split the escalate case of get_report out into a POST request.

	* src/gsad.c (init_validator): Add alias "escalate_report".
	(struct req_parms, free_resources, serve_post): Add required fields.
	(exec_omp_post): Add new command.

	* src/html/omp.xsl (html-report-details): Make escalate icons POST forms
	that request the new escalate_report command.

2011-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch test_escalator and the save_* commands to POST.

	* src/gsad.c (init_validator): Add alias "new_threat".
	(struct req_parms, free_resources, serve_post): Add required fields.
	(exec_omp_post): Add commands.
	(exec_omp_get): Remove commands.

	* src/html/omp.xsl (start-icon): Add cmd and alt params.
	(html-edit-task-form, html-edit-note-form, html-edit-override-form): Make
	form POST.  Add caller.
	(escalator): Use start-icon.

2011-05-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch the task control commands to POST.

	* src/gsad.c (exec_omp_post): Add task control commands.
	(exec_omp_get): Remove task control commands.

	* src/html/omp.xsl: Replace every task control icon link with a POST icon.
	(pause-icon, resume-icon, start-icon, stop-icon): New templates.

2011-05-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch the restore command to POST.

	* src/gsad.c (init_validateor): Replace . with - in uuid.
	(exec_omp_post): Add restore command.
	(exec_omp_get): Remove restore command.

	* src/html/omp.xsl: Replace every restore icon link with a POST icon.
	(restore-icon): New template.

2011-05-16  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c (handle_sighup): Do not exit upon receiving a SIGHUP.
	Even though exiting in the default POSIX action, most current
	distributions do not expect this behavior.

2011-05-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_escalators_response): New function.  Prevents
	matching of get_escalators_response on get_reports page.

2011-05-12  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch the delete_* commands to POST.

	* src/gsad.c (validate_or): New function.
	(req_parms, free_resources, serve_post): Add params for commands.
	(exec_omp_post): Add delete_* commands.
	(exec_omp_get): Remove delete_* commands.

	* src/gsad_omp.c (delete_note_omp, delete_override_omp): NULL check
	params.

	* src/html/omp.xsl: Replace every delete_* icon links with POST icons.
	(delete-button): Rename delete-icon.
	(trash-delete-icon, trashcan-icon): New templates.
	(delete-icon): New template.  Was delete-icon.

2011-05-09  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch delete_agent button to POST.

	* src/gsad.c (req_parms, free_resources, serve_post): Add agent_id.
	(exec_omp_post): Add delete_agent.
	(exec_omp_get): Remove delete_agent.

	* src/html/omp.xsl (delete-button): New template.
	(agent): Replace link with form.

2011-05-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Remove character limitations on "password".

	* src/gsad_oap.c (create_user_oap, save_user_omp): Send command with
	openvas_server_sendf_xml, as password may contain XML chars.

	* src/gsad_oap.c (create_slave_oap): Send CREATE_SLAVE with
	openvas_server_sendf_xml, as password may contain XML chars.

	* src/html/help.xsl (configure_slaves.html, configure_users.html): Update
	password syntax.

2011-05-05  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-05-05  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 3.0+beta1 release.

	* CHANGES: Updated.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-05-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add missing max_results to
	links, so that they respect "Results per page".

2011-05-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (escalator [details]): Add Sourcefire Connector data.

2011-05-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Base64 encode PKCS12 when creating Sourcefire escalator.

	* src/gsad_base.h (struct method_data_param): New struct.
	(method_data_param_t): New type.

	* src/gsad.c (escalator_data, free_resources): Expect method data in
	struct.
	(serve_post): Put method data into struct.

	* src/gsad_omp.c (send_escalator_method_data): New function.  Copy of
	send_escalator_data, with Sourcefire PKCS12 base64 special case.
	(create_escalator_omp): Switch syslog special to use struct.  Call
	send_escalator_method_data instead of send_escalator_data for method data.

2011-05-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (status_bar): Add percentage and bar to 'Uploading'.

2011-05-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a column to the report summary for escalating the report.

	* src/html/omp.xsl (get_reports_escalate_response): New template.
	(html-report-details): Add "Escalate" column.
	(get_report): Also match get_reports_escalate_response.

	* src/gsad.c (exec_omp_get): Also pass escalator filters to
	get_report_omp.

	* src/gsad_omp.c (get_report_omp): Escalate before getting report, if
	requested.  Get escalators for dropdown.
	(delete_note_omp, save_note_omp, delete_override_omp)
	(save_override_omp): Get escalators for dropdown.

	* src/gsad_omp.h: Update header accordingly.

2011-05-01  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl (get_report_response/report/report): use the
	best_os_* entries from host details to display the detected OS.

2011-04-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add missing max_results param
	for "Filtered results..." download.

2011-04-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details, html-report-table)
	(status_bar, task): Add "Uploading" case.  Grey stop and resume when
	uploading.

2011-04-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Add key pair credentials.

	* src/gsad.c (init_validator): Add "key" to "create_credentials_type".
	Remove out of date comment.
	(req_parms, free_resources): Add passphrase, private_key, public_key.
	(serve_post): Pass passphrase, private_key and public_key to
	create_lsc_credential_omp.

	* src/gsad_omp.c (create_lsc_credential_omp): Add key args.  Pass through
	to manager.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-create-lsc-credential-form): Add key pair input.

2011-04-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-escalator-form): Add Sourcefire Connector
	escalator.

2011-04-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Offer predefined reports with
	trusted reports, for download.

2011-04-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Only offer trusted report
	formats.

2011-04-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (RESULTS_PER_PAGE): New define.
	(exec_omp_post, exec_omp_get): Replace literals with new define.

	* src/html/omp.xsl (html-report-details): Add results per page field.

2011-04-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Get maximum result values from params instead
	of using constant.

	* src/html/omp.xsl (html-report-details, html-create-note-form)
	(html-edit-note-form, html-create-override-form)
	(html-edit-override-form): Add max_results to forms that lead back to the
	results page.
	(note-detailed, override-detailed, result-detailed): Add max_results to
	links that lead back to the results page.

2011-04-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Get the increment from the
	report, instead of using a fixed value.

2011-04-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report): Remove download button.

	* src/html/help.xsl (reports.html): Remove "Download a report".

2011-04-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_oap.c (get_users_oap): Align arg properly.

2011-04-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/oap.xsl (modify_user_response): New template.

2011-04-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (config): Put the writable cases the right way round.

2011-04-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-lsc-credential-form)
	(html-edit-lsc-credential-form, html-create-target-form)
	(edit-config-preference, html-create-slave-form): Turn off autocomplete
	for passwords.

2011-04-12  Matthew Mundell <matthew.mundell@greenbone.net

	* src/gsad.c (request_handler): In the GET case when the session has
	expired, skip passing the next page down to the XSL when downloading a
	report.  This prevents the login page from simply serving the exported
	file.

2011-04-12  Matthew Mundell <matthew.mundell@greenbone.net

	* src/html/help.xsl (glossary.html): Describe container tasks.
	(new_task.html): Add container task section.
	(tasks.html): Update for container tasks.

2011-04-07  Matthew Mundell <matthew.mundell@greenbone.net

	* src/html/omp.xsl (html-report-details, html-report-table, task)
	(task [trash]): Check if the status is "Container".
	(status_bar): Add a container case.

2011-04-07  Matthew Mundell <matthew.mundell@greenbone.net

	Add SSH port support for targets.

	* src/gsad.c (exec_omp_post): Pass port to create_target_omp.

	* src/gsad_omp.c (create_target_omp): Add port arg.  Send to Manager.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-create-target-form): Add port input.
	(target [details]): Add port.

	* src/html/help.xsl (configure_targets.html): Add port to New Target
	table.

2011-04-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/tmp/omp.xsl (get_trash): Renamed link tag "tasks" to "the_tasks" because
	at least the firefox mixes up the link tag with the div tag with the
	same id "tasks" (and therfore jumps to another place on that page).

2011-04-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (config): Check writable flag instead of in_use flag
	for edit button.

	* src/html/help.xsl (configure_scanconfigs.html): Note that trashcan
	tasks are considered too for edit.

2011-03-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (configure_credentials.html): Fixed 2 typos.

2011-03-30  Matthew Mundell <matthew.mundell@greenbone.net>

	Handle saving of container tasks.

	* src/html/omp.xsl (html-edit-task-form): Send target_id as "--" for
	container tasks.

	* src/gsad_omp.c (save_container_task_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/gsad.c (exec_omp_get): Call save_container_task_omp for container
	tasks.

2011-03-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table, task): Grey start button for
	container tasks.

2011-03-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task): Remove duplicate token.

2011-03-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a New Container Task window to the New Task page.

	* src/gsad.c (init_validator): Add command create_report.
	(exec_omp_post): Add create_report handling.

	* src/gsad_omp.c (create_report_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/omp.xsl (create_report_response): New template.
	(new_task): Add container task window.

2011-03-25  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/restore_inactive.png: Updated with final version.

2011-03-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl: Renamed "Trashcan Contents" to "Contents".

	* src/html/help.xsl: Fixed icons for restore.

2011-03-22  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/os.xml: complete regeneration to include every CPEs present
	in cpe.inc and their official CPE titles. Also changed the format to use
	XML entities instead of attributes.

	* src/html/omp.xsl: modified to use the new format of os.xml.

2011-03-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Log the user out when connecting to the Administrator fails.

	* src/gsad_oap.c (administrator_connect): If connecting to adminstrator
	fails, log user out and return login page in new html param.  Update all
	callers to return this html when appropriate.

2011-03-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_trash): Correct count selects.

2011-03-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Log the user out when connecting to the Manager fails.

	* src/gsad.c (user_find): New function.  Was token_user.  Update callers.
	(token_user): Replace with version that find user from token only.
	(token_user_remove): New function.  Remove user given token.

	* src/gsad_omp.c (manager_connect): If connecting to manager fails, log
	user out and return login page in new html param.  Update all callers to
	return this html when appropriate.

2011-03-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (get_trash): Added a header line for contents
	table.

2011-03-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/restore_inactive.png: New. Interims icon.

	* CMakeLists.txt: Install restore icons.

	* src/html/omp.xsl: Apply new restore icon where resume
	was used for the time being.

2011-03-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (get_trash): Make overview table use
	full width and add title for this contents.

2011-03-21  Henri Doreau <henri.doreau@greenbone.net>

	* src/html/omp.xsl: mark IPs with an icon representing the detected
	Operating System.

	* src/html/os.xml: New. Database to retrieve the OS icon and title to
	display for a given CPE.

	* CMakeLists.txt: consider the new files during the installation.

2011-03-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/indicator_software_update.png,
	src/html/img/indicator_software_update_inactive.png: New. Indicator
	Icon for availability of software update.

2011-03-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/os_apple.png, src/html/img/os_debian.png,
	src/html/img/os_centos.png, src/html/img/os_gentoo.png,
	src/html/img/os_unknown.png, src/html/img/os_windows.png,
	src/html/img/os_fedora.png, src/html/img/os_mandriva.png,
	src/html/img/os_suse.png, src/html/img/os_trustix.png,
	src/html/img/os_novell.png, src/html/img/os_conflict.png,
	src/html/img/os_sun.png, src/html/img/os_hp.png,
	src/html/img/os_redhat.png: New. Icons to mark IPs with the
	detected Operating System.

2011-03-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/restore.png: New. Restore Icon for the Trashcan.

2011-03-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): In the GET case when the session has
	expired, skip passing the next page down to the XSL when the command is
	an export command.  This prevents the login page from simply serving the
	exported file.

2011-03-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Reword down message slightly.

2011-03-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Tell the user when the login fails because the manager is down.

	* src/gsad.c (exec_omp_post): Update authenticate call.  Add message if
	manager is down.

	* src/gsad_omp.c (is_omp_authenticated): Remove.  Now authenticate_omp.
	(authenticate_omp): New function.  Was is_omp_authenticated.  Add "manager
	down" return.

	* src/gsad_omp.h: Update header accordingly.

2011-03-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (error_dialog): Get token from param.
	(gsad_response): New template.  From omp.xsl.

	* src/html/omp.xsl (gsad_response): Remove.  To gsad.xsl.

	* src/html/help.xsl (error_messages.html): Correct provoke link.

2011-03-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_trash): Correct help link.

	* src/html/help.xsl: Update Delete buttons to Trashcan buttons.
	(contents.html): Add trashcan.
	(trashcan.html): New page.

2011-03-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_trash): Add contents table.

2011-03-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_trash): Always print headers.

2011-03-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (note [details], override [details]): Indicate if task
	is in trashcan.

2011-03-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table): Use trashcan button in header.
	(task): Improve trashcan link text.

2011-03-14  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a trashcan.

	* src/html/img/trashcan.png, src/html/img/trashcan_inactive.png: New
	files.

	* src/CMakeLists.txt: Install trashcan icons.

	* src/gsad.c (init_validator): Add trashcan commands.
	(exec_omp_post): Add empty_trashcan handling.
	(exec_omp_get): Increase CMD_MAX_SIZE.  Add trashcan command handling.

	* src/gsad_omp.c (delete_trash_agent_omp, delete_trash_config_omp)
	(delete_trash_target_omp, delete_trash_lsc_credential_omp)
	(delete_trash_report_format_omp, delete_trash_schedule_omp)
	(delete_trash_slave_omp, delete_trash_target_omp)
	(delete_trash_task_omp, restore_omp, empty_trashcan_omp, get_trash)
	(get_trash_omp): New functions.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/gsad.xsl (html-gsa-navigation): Add Miscellaneous section with
	Trashcan.

	* src/html/omp.xsl (task, lsc_credential, agent, escalator, target)
	(config, schedule, slave, report): Replace Delete with To Trashcan.
	(task [trash], lsc_credential [trash], agent [trash], escalator [trash])
	(target [trash], config [trash], schedule [trash], slave [trash])
	(report [trash], empty_trashcan_response, restore_response)
	(html-agents-trash-table, html-configs-trash-table)
	(html-escalators-trash-table, html-lsc-credentials-trash-table)
	(html-report-formats-trash-table, html-schedules-trash-table)
	(html-slaves-trash-table, html-targets-trash-table)
	(html-tasks-trash-table, get_trash): New templates.

2011-03-09  Michael Wiegand <michael.wiegand@greenbone.net>

	Post branch version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-03-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (view_report.html): Add token to jump link.

2011-03-02  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-03-02  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 2.0.1 release.

	* CHANGES: Updated.

	* INSTALL: Updated prerequisites.

2011-03-01  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch to doing the XSL transform in a separate process, keeping the
	libxslt based transform as a configure time option.  This protects the
	GSA from threading and memory errors in libxslt and libxml.

	* CMakeLists.txt: Set USE_LIBXSLT.  Require xsltproc if appropriate.

	* src/CMakeLists.txt: Set USE_LIBXSLT directive.

	* src/gsad.c (main): Set SIGCHLD to SIG_DFL for glib.

	* src/gsad_base (gsad_base_init, xsl_transform): Add alternative for doing
	XSL transform in separate process.

2011-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Close some leaks found by Pavel Sejnoha.

	* src/gsad.c (file_content_response): Free path in error cases.

	* src/gsad_omp.c (get_report_omp): Free task_id.

2011-02-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (file_content_response): Add fclose before error return.
	Spotted by Felix Wolfsteller.

2011-02-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_base.c (ctime_r_strip_newline): New function.

	* src/gsad_base.h: Add header accordingly.

	* src/gsad.c, src/gsad_omp.c, src/gsad_oap.c: Replace every use of ctime
	with ctime_r_strip_newline, which is reentrant and removes the trailing
	newline.  In some cases also add the missing time call.

2011-02-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-02-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 2.0.0 release.

	* CHANGES: Updated.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-02-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Set caller to previous caller, as this is
	usually the case.

2011-02-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Correct comment.
	(main): Call gsad_base_init.

	* src/gsad_base.c (gsad_base_init): New function.  Check if libxml
	supports threading and init parser.

	* src/gsad_base.h: Add header accordingly.

2011-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (javascript.html): Correct typos.

2011-02-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/indicator_js.png: Replaced temporary icon with
	a specific one.

	* src/html/help.xsl: Reworked information about JavaScript.

	* src/html/gsad.xsl: Modified JS hint, updated copyright year.

2011-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (verify_report_format_response): New template.
	(get_report_formats): Match the verify response too.

2011-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Init credentials caller.

	* src/gsad_oap.c, src/gsad_omp.c (xsl_transform_oap): Check caller before
	using.

2011-02-18  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-02-18  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 2.0+rc5 release.

	* CHANGES: Updated.

2011-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	On relogin after a POST request due to expired session, return to the page
	that held the POST form.

	* src/gsad.c (req_parms, free_resources, serve_post): Add caller.
	(exec_omp_post): Add URL based on caller param to expired case of
	LOGIN_PAGE.  Support for URL exists already, from similarly patch for GET.
	(reconstruct_url): New function.
	(request_handler): Replace GET URL reconstruction with function call.
	Setup caller field in credentials for page handlers.

	* src/gsad_base.h (credentials_t): Add caller.

	* src/gsad_oap.c, src/gsad_omp.c (xsl_transform_oap): Add CALLER to
	ENVELOPE.

	* src/html/gsad.xsl (caller): New template.

	* src/html/oap.xsl, src/html/omp.xsl: Add hidden caller field to every
	POST form from ENVELOPE.

2011-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Remove the session cookie on logout.

	* src/gsad.c (attach_sid): Neaten doc.  Make static.
	(remove_sid): New function.
	(send_response): If sid is 0, remove cookie.
	(handler_send_response): Add remove_cookie arg.  Update callers.
	(request_handler): Flag cookie removal where appropriate.

2011-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Set the session cookie for every authenticated page, so that the
	expiration time is updated.

	* src/gsad.c (exec_omp_post): Move user return into arg.  Add return
	value.  Add new_sid return arg which contains the new SID where
	appropriate.
	(EXPIRES_LENGTH): Move up in file.
	(attach_sid): New function.  Body from send_redirect_header.  Use current
	time instead of time in user struct for simplicity.
	(send_response): Add sid arg.  Set SID cookie if given.  Update callers.
	(send_redirect_header): Move SID cookie setting out to attach_sid.
	(handler_send_response): Doc return.
	(request_handler): For both GET and POST, set the SID cookie when the user
	is authentic.

2011-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (serve_post): Remove erroneous cookie parsing.
	(request_handler): Parse the cookie with the correct name from the
	connection.

2011-02-17  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-02-17  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 2.0+rc4 release.

	* CHANGES: Updated.

2011-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (SESSION_LENGTH): Remove.
	(SESSION_TIMEOUT): New define to replace SESSION_LENGTH.
	(session_timeout): New variable
	(token_user, send_redirect_header): Read timeout as minutes from
	session_timeout.
	(main): Add --timeout.

2011-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a dedicated icon for the JavaScript indicator.  Display the icon only
	when JavaScript is on.

	* CMakeLists.txt: Install the new icon.

	* src/html/gsad.xsl (html-gsa-logo): Only display icon when JavaScript is
	on.

	* src/html/help.xsl (javascript.html): Update accordingly.

	* src/html/img/indicator_js.png: New icon.

2011-02-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Add cookie based session identification.

	* src/gsad.c (use_secure_cookie): New variable.
	(struct user): Add cookie.
	(user_add): Set cookie.
	(token_user): Add cookie arg.  Check if browser ID matches server ID.
	(struct req_parms): Add cookie.
	(free_resources): Free cookie.
	(serve_post): Read cookie.
	(exec_omp_post): Pass cookie to token_user and go to login if cookie
	missing or bad.
	(EXPIRES_LENGTH): New define.
	(send_redirect_header): Add user arg.  Send cookie if arg set.  Update all
	callers.
	(request_handler): For GET, read cookie and pass to token_user.  Handle
	new return.
	(main): Add --secure-cookie.  If given with --http-only use a secure
	cookie.

2011-02-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_override_omp): Remove premature
	openvas_server_close.

2011-02-15  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/help.xsl (performance.html): Add missing slave_id
	parameter.

2011-02-15  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c (exec_omp_get): Have sane default parameters for system
	parameters in case they are not supplied.

2011-02-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (append_param): Skip "r" too.
	(request_handler): Add "&" to dummy param, so that next param gets it.

2011-02-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Skip follow on page when logging out.

2011-02-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl: Reworked about dialog (authors and logos out).

	* src/html/img/intevation-logo.png, src/html/img/gb-logo.png,
	src/html/img/bsi-logo.png: Removed.

	* CMakeLists.txt: Don't install the logo's anymore.

2011-02-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): When generating the follow on URL, ensure
	that there is at least one parameter, to simplify appending the token.

2011-02-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Print XML with g_markup_printf_escaped
	in case login contains special XML chars.

	* src/gsad_oap.c (xsl_transform_oap): Print XML with
	g_markup_printf_escaped in case login contains special XML chars.
	Clarify doc as in xsl_transform_omp.

2011-02-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (xsl_transform_omp): Print XML with g_markup_printf_escaped
	in case login contains special XML chars.

2011-02-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Remove password and username validation
	erroneously added with token session management on 2011-02-03.

2011-02-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_system_reports_response): Add slave ID to links.

2011-02-11  Matthew Mundell <matthew.mundell@greenbone.net>

	Make the fallback report more like the others.

	* src/html/omp.xsl (system_report): Include the contents of the report if
	it's text.
	(fallback): Remove.
	(get_system_reports): Remove fallback check.

2011-02-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (fallback): New template.
	(get_system_reports): Show the fallback report on error.

2011-02-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a JavaScript indicator.

	* src/html/gsa-style.css (.status_panel): New rule.

	* src/html/gsad.xsl (html-gsa-logo): Add icon next to login panel that
	indicates whether JavaScript is enabled.

	* src/html/help.xsl (javascript.html): New template.

2011-02-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (autorefresh): Add token to URL.

2011-02-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (main): Check the --redirect flag, instead of the --rport
	variable, to see whether to redirect.

2011-02-09  Matthew Mundell <matthew.mundell@greenbone.net>

	For GET requests when the session expires, go to the requested page after
	logging in.

	* src/gsad.c (append_param): New function.
	(request_handler): Add next URL to login page XML when the session has
	expired.  Redirect to the next URL on successful login.

	* src/html/gsad.xsl (login_page): Use next URL from XML if there is one.

2011-02-08  Michael Wiegand <michael.wiegand@greenbone.net>

	Consolidation: Move most of configuration and installation handling to
	top level CMakeLists.txt and clean up top level CMakeLists.txt.

	* CMakeLists.txt: Split up package detection. Set all _CFLAGS
	and _LDFLAGS properly. Add all defines to CMAKE_C_FLAGS. Handle
	installation of logging configuration and support files.

	* src/CMakeLists.txt: Remove most configuration and installation. Use
	the LINK_FLAGS reported by pkg-config instead of hard coding them.
	Split up handling of _LIBRARIES, added TODOs.

	* doc/CMakeLists.txt: Improved handling of "make clean" stage.

2011-02-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_config_omp): Always get the NVT families.

	* src/html/omp.xsl (config [families]): Show the total number of NVTs too,
	counting from NVT families list.

2011-02-07  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/CMakeLists.txt: Removed some testing stuff that
	accidently was comitted.

2011-02-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (gsad_init, main): Replace GSA_STATE_DIR by GSA_DATA_DIR.

	* src/CMakeLists.txt: Replace GSA_STATE_DIR by GSA_DATA_DIR.

	* CMakeLists.txt: Replace GSA_STATE_DIR by GSA_DATA_DIR.

2011-02-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_note_omp): Remove premature openvas_server_close.

2011-02-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (scanconfig_details.html): Replace name in get_config
	URL with ID.

2011-02-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-02-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 2.0+rc3 release.

	* CHANGES: Updated.

2011-02-04  Michael Wiegand <michael.wiegand@greenbone.net>

	* README: Fix typo, strip now redundant part from example.

2011-02-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Add man page to gsad.

	* doc/gsad.8.xml: New. Source file for the gsad man page.

	* doc/gsad.8: New. Pregenerated man page as troff document.

	* doc/gsad.html: New. Pregenerated man page as HTML document.

	* doc/CMakeLists.txt: Add support for man page generation and
	installation.

	* CMakeLists.txt: Define DATADIR.

	* INSTALL: Updated prerequisites.

2011-02-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsad.xsl (login_page): Turn off autocomplete on input fields,
	to prevent some of the password completion performed by some browsers.

2011-02-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Replace HTTP Basic Auth based session management with token based
	session management.  In the process close the cross site request
	forgery hole that affected every URL.

	* src/gsad.c (REALM): Remove.
	(SESSION_LENGTH): New define.
	(users, mutex): New variables.
	(struct user, user_t): New type.
	(user_add, token_user, user_release, user_remove): New functions.
	(init_validator): Add "token".
	(struct req_parms, free_resources, serve_post): Add token param.
	(get_header_credentials, is_http_authenticated)
	(create_http_authenticate_response, send_http_authenticate_header): Remove.
	Part of Basic Auth.
	(exec_omp_post): Remove credentials arg.  Setup credentials from "users"
	via the "token" request param.  Add a login command.
	(exec_omp_get): Add credentials arg because the caller does all the
	request param parsing, and so the caller must get the token and setup the
	credentials.  Update single caller.
	(file_content_response): Add credentials arg for gsad_message.  Serve the
	login page via an XSL transform instead of via a static page.  For "file
	not found" errors, simply serve the error, instead of also logging out
	the user (which would require a token).  Remove Basic Auth related
	header additions.  Update single caller.
	(handler_send_response): New function.  Helper for request_handler.
	(request_handler): Simply redirect the base url to the login page, instead
	of logging the user out first.  Serve the elements of the login page and
	the decorative images before checking authentication.  Replace the GET
	Basic Auth check with a check based on the token request param.  Add
	explicit logout handling.  Add the token to ENVELOPE in the XML.  Redirect
	to the tasks page if the exec_omp_post return indicates a successful
	login.
	(gsad_init): Init mutex and users.

	* src/gsad_base.c (gsad_message): Add credentials arg, and add token to
	GSAD_RESPONSE XML.  The token is for the logout and assumed sane state
	links.  Update all callers.

	* src/gsad_base.h: Update header accordingly.
	(credentials_t): Add token.

	* src/gsad_oap.c (xsl_transform_oap): Add token to ENVELOPE XML.

	* src/gsad_omp.c (xsl_transform_omp): Add token to ENVELOPE XML.
	(is_omp_authenticated): Add const to args.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/gsad.xsl: Add token to every internal HREF, both GET and POST.
	(error_dialog): Ditto.  If the token is missing, add a login link instead
	of a logout link.
	(login_page, token): New templates.

	* src/html/help.xsl: Add token to every internal HREF.

	* src/html/oap.xsl: Add token to every internal HREF, both GET and POST.

	* src/html/omp.xsl: Add token to every internal HREF, both GET and POST.

2011-02-01  Michael Wiegand <michael.wiegand@greenbone.net>

	Switch gsa to pkg-config.

	* CMakeLists.txt: Move check for openvas-libraries to pkg-config.
	Remove duplicate libmicrohttpd check.

	* INSTALL: Update requirements and installation instructions.

	* src/CMakeLists.txt: Replace calls to libopenvas-config with the
	appropriate pkg-config calls.

2011-01-31  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c (main): Log a message if binding to a port failed before
	trying the fallback port.

2011-01-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt: Fixed minor string typo.

2011-01-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2011-01-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 2.0+rc2 release.

	* CHANGES: Updated.

2011-01-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Ensure gsa tries to bind to the appropriate privileged ports first and
	falls back to an unprivileged default port if it did not work and no
	custom port was specified.

	* src/gsad.c: Change DEFAULT_GSAD_HTTP_PORT to 80, add
	DEFAULT_GSAD_PORT with value 9392 as fallback.
	(main): Retry binding to DEFAULT_GSAD_PORT if launching the MHD daemon
	failed and no custom port was specified.

2011-01-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_log_conf.cmake_in: Add warning about passwords.

2011-01-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (openvas_server_sendf_xml): Remove.

2011-01-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Neaten formatting.

2011-01-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt: Added check for microhttpd library.

2011-01-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Allow any character in LSC passwords.

	* src/html/help.xsl (configure_credentials.html): Update lsc_password.

2011-01-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_target_omp): Create target locator string with
	g_markup_escape_text, as password may contain a &.

2011-01-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (configure_credentials.html): Add ! to lsc_password
	example.

2011-01-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add ! to lsc_password.

2010-12-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (main): Adapted --version output to
	comply with GNU Coding Standards
	(http://www.gnu.org/prep/standards/standards.html#g_t_002d_002dversion)

2010-12-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2010-12-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 2.0+rc1 release.

	* src/html/help.xsl: Updated version number.

	* CMakeLists.txt: Updated version number.

	* CHANGES: Updated.

2010-12-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add false positive to full
	download levels.

2010-12-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): In full download, put cmd first
	like other downloads, add a first_result, and get the counts from the
	correct entity.

2010-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Pass max_results to full and
	"all filtered" downloads, otherwise 1000 is used.

2010-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Only display current filtered
	results range when there are results.

2010-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add current filtered results row
	to report summary.  Remove download button from filtering window.  Move
	result pager from filtering window to filtered window.

2010-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add space to port_range, grouping
	explicitly.

2010-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add filtered result row to
	report summary.

2010-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (configure_targets.html): Add port range.

2010-12-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Move port range from config into target.

	* src/gsad.c (init_validator): Add port range validator.
	(req_parms, free_resources): Add port range.
	(serve_post): Handle port range.
	(exec_omp_post): Pass port range to create_target_omp.

	* src/gsad_omp.c (create_target_omp): Add port range arg.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-create-target-form): Add port range input.
	(html-targets-table, target, target [details]): Show port range.

2010-12-16  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Add a collection of code hardening flags to
	CMAKE_C_FLAGS, inspired by hardening-wrapper on Debian. Add -Werror to
	CMAKE_C_FLAGS to make all warnings fatal.

2010-12-16  Michael Wiegand <michael.wiegand@greenbone.net>

	* doc/CMakeLists.txt: Handle absence of doxygen more gracefully.

2010-12-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (report): Fixed string.

2010-12-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Switch table line to full report
	with download column.
	(html-report-table, report): Replace download column with download action.

	* src/html/help.xsl (configure_report_formats.html): Move predefined
	report details here.
	(reports.html): Remove predefined report details.  Add report download
	action.
	(view_report.html): Add descriptions of windows, in order to describe new
	download option.

2010-12-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (req_parms, free_resources): Add lsc_smb_credential_id.
	(serve_post): Pass two credentials to create_target_omp.

	* src/gsad_omp.c (create_target_omp): Split credential into SSH and SMB
	credentials.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/help.xsl (configure_targets.html): Update for dual credential.

	* src/html/omp.xsl (html-create-target-form, html-targets-table, target)
	(target [details]): Split into two credentials.

2010-12-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_lsc_credential_omp): Put comment tag directly
	in command string, otherwise the send function escapes brackets.

2010-12-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (configure_slaves.html, new_task.html): New templates.
	(contents.html): Add slaves item.

2010-11-30  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/omp.xsl (get_reports_response): Make error handling more
	universal.

2010-11-19  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 2.0+beta1 release.

	* src/html/help.xsl: Updated version number.

	* CMakeLists.txt: Updated version number. Changed
	CPACK_PACKAGE_VERSION for use with "+beta" versioning scheme.

2010-11-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CHANGES: Updated.

2010-11-19  Michael Wiegand <michael.wiegand@greenbone.net>

	Increased required openvas-libraries version.

	* CMakeLists.txt: Updated LO_MAJOR_MIN_VER and LO_MINOR_MIN_VER.

	* INSTALL: Document required version.

2010-11-19  Michael Wiegand <michael.wiegand@greenbone.net>

	Added proper setup for existing libexslt dependency.

	* CMakeList.txt: Added check for libexslt.

	* src/CMakeList.txt: Set LINK_FLAGS for gsad properly, avoid overwrite
	of the existing value.

	* INSTALL: Document libexslt dependency.

2010-11-09  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c, src/gsad_omp.c, src/gsad_oap.c: Adjusted include
	paths for header files of libopenvas_misc.

2010-11-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (new_task): Skip the empty config.

2010-11-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (preferences): Set action column width.

2010-11-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Increase hosts length to 2000.

	* src/html/omp.xsl (html-create-target-form): Increase hosts field to
	2000.

2010-10-31  Stephan Kleine

	* src/CMakeLists.txt: Link against exslt to fix some undefined reference
	to 'exsltRegisterAll' in gsad_base.c

2010-10-22  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c (file_content_response): Properly cast pointer to
	callback function so that gsa compiles with libmicrohttpd >= 0.9.2.

2010-10-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* CMakeLists.txt, ChangeLog, doc/CMakeLists.txt, src/gsad.c,
	src/gsad_base.c, src/gsad_base.h, src/gsad_oap.c, src/gsad_oap.h,
	src/gsad_omp.c, src/gsad_omp.h, src/html/gsa-style.css, src/html/gsad.xsl,
	src/html/help.xsl, src/html/oap.xsl, src/html/omp.xsl, src/tracef.h,
	src/validator.c, src/validator.h: Switch all Intevation addresses to
	Greenbone addresses.

	* src/CMakeLists.txt: Switch UKFSN address to Greenbone one.

2010-10-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (modify_note_response, modify_override_response): New
	templates.
	(get_notes, get_overrides): Apply modify response, to confirm save.

2010-10-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (configure_targets.html): Remove dot from hosts note.

2010-10-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (configure_targets.html): Add IPv6 to hosts note.

2010-10-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (configure_targets.html): Add IP ranges to hosts note.
	Increase hosts length.

2010-10-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (validate_hosts_parameter): Remove.  Now in Manager.
	(exec_omp_post): Remove validate_hosts_parameter calls.

2010-10-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Increase hosts length.

	* src/html/omp.xsl (html-create-target-form): Increase hosts length.

2010-10-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (edit_lsc_credential, edit_report_format): Doc next arg.

2010-10-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-lsc-credential-form): Replace login
	with credential_login.

	* src/gsad.c (validate): Neaten doc.
	(exec_omp_post): For create_lsc_credential and save_lsc_credential use
	credential_login instead of login.

2010-10-07  Matthew Mundell <matthew.mundell@greenbone.net>

	Add LSC credential editing.

	* src/html/omp.xsl (html-lsc-credentials-table): Increase action
	column width.
	(html-edit-lsc-credential-form, edit_lsc_credential)
	(modify_lsc_credential_response): New templates.
	(get_lsc_credential): Add COMMANDS to GET_LSC_CREDENTIALS path.  Apply
	modify response template.

	* src/gsad.c (init_validator): Add edit_lsc_credential and
	save_lsc_credential commands.
	(exec_omp_get): Add edit_lsc_credential and save_lsc_credential handling.

	* src/gsad_omp.c (get_lsc_credential, get_lsc_credentials): New function.
	From _omp counterpart, with commands arg.  In get_lsc_credentials allow
	result_len to be NULL.
	(get_lsc_credential_omp, get_lsc_credentials_omp): Replace body with call.
	(edit_lsc_credential, edit_lsc_credential_omp)
	(save_lsc_credential_omp): New functions.

	* src/gsad_omp.h: Add headers accordingly.

2010-10-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add & to lsc_password.

	* src/gsad_omp.c (openvas_server_sendf_xml): Move up in file.
	(create_lsc_credential_omp): Send with openvas_server_sendf_xml.

2010-10-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (check_modify_report_format): Add validation error check.

	* src/html/omp.xsl (param-edit): Set text input size according to param
	type.

2010-10-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_report_format_omp): Add NULL gaurd around param
	loop.

2010-09-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (param-edit): Make input field match param type.
	(param-details): Make value column match param type.

2010-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-formats-table): Add "(last verified)" to
	trust heading.

2010-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Add editing of report format active flag.

	* src/gsad.c (exec_omp_post): Pass enable param to save_report_format_omp.

	* src/gsad_omp.c (save_report_format_omp): Add active arg.  Save active flag.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-edit-report-format-form): Add active radio.

2010-09-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Add simple editing of report format params.

	* src/gsad.c (struct gsad_connection_info, free_resources)
	(serve_post): Add next and report_format_id params.
	(exec_omp_post): Add save_report_format page handling.
	(exec_omp_get): Remove save_report_format page handling.

	* src/gsad_omp.c (check_modify_report_format): New function.
	(edit_report_formats): Request params with report formats.
	(save_report_format_omp): Add param array arg.  Save params.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (html-edit-report-format-form): Switch form to POST.
	Add param fields.
	(param-edit): New template.

2010-09-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a slave option to the Performance page.

	* src/gsad.c (exec_omp_get): Pass slave ID to get_system_reports_omp.
	(request_handler): Pass slave ID to get_system_report_omp.

	* src/gsad_omp.c (get_system_reports_omp): Add slave ID arg.  Also get
	slaves.
	(get_system_report_omp): Add slave ID arg.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/gsad.xsl (html-gsa-navigation): Add slave_id to performance
	URL.

	* src/html/omp.xsl (system_report): Add slave_id to system report IMG.
	(get_system_reports_response): Add slave field.

2010-09-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_escalator_omp, delete_escalator_omp)
	(test_escalator_omp): Also get the report formats.

2010-09-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_escalator_omp): Also get report formats.

	* src/html/omp.xsl (escalator [details]): Give email case same
	details as new escalator form.

2010-09-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Add slave to task editing.

	* src/gsad.c (exec_omp_get): Pass slave ID to save_task_omp.

	* src/gsad_omp.c (edit_task): Get slaves too.
	(save_task_omp): Add slave arg.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-edit-task-form): Add slave field.

2010-09-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table): Add slave to Task Summary.

2010-09-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Add "first class" slaves.

	* src/gsad.c (init_validator): Add slave commands.  Add slave_id rule.
	(req_parms, free_resources): Add host.
	(serve_post, exec_omp_post, exec_omp_get): Add slave command handling.

	* src/gsad_omp.c (new_task_omp): Also get slaves.
	(create_slave_omp, delete_slave_omp, get_slave_omp, get_slaves_omp): New
	functions.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/gsad.xsl (html-gsa-navigation): Add slaves item.

	* src/html/omp.xsl (slave [newtask], html-create-slave-form)
	(html-slaves-table, create_slave_response, delete_slave_response)
	(slave, slave [details], get_slave, get_slaves): New templates.
	(new_task): Get slaves from GET_SLAVES instead of from GET_TARGETS.

2010-09-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Add report format editing.

	* src/html/omp.xsl (html-edit-report-format-form, edit_report_format)
	(modify_report_format_response): New templates.
	(report_format): Add edit report_format button.
	(get_report_format): Apply modify response template.  Add COMMANDS to
	GET_REPORT_FORMATS path.
	(get_report_formats): Apply modify response template.

	* src/gsad.c (init_validator): Add edit_report_format and
	save_report_format commands.
	(exec_omp_get): Add edit_report_format and save_report_format handling.

	* src/gsad_omp.c (get_report_format, get_report_formats): New function.
	_omp counterpart with commands arg.
	(get_report_format_omp, get_report_formats_omp): Replace body with call.
	(edit_report_format, edit_report_format_omp, save_report_format_omp): New
	functions.

	* src/gsad_omp.h: Add headers accordingly.

2010-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Add verify buttons on the agents page.

	* src/html/omp.xsl (agent): Add verify button.

	* src/gsad_omp.c (verify_agent_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/gsad.c (init_validator, exec_omp_get): Add verify command.

2010-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (agent): Add time under trust value.

2010-09-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_escalators_omp): Also get report formats.

	* src/html/omp.xsl (html-create-escalator-form): Convert format field of
	email escalator to content, with report selection.

2010-09-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report_format [details]): Add active flag.

2010-09-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (status_bar): Also print percent if progress is 0.

2010-09-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details, report): Only offer active report
	formats for download.
	(html-report-formats-table, report_format): Add active column.

2010-09-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result-detailed): Only show override details when
	applying overrides.

2010-09-09  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (configure_escalators.html): Added notes
	about HTTP GET.

2010-09-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (openvas_server_sendf_xml): New function.
	(send_escalator_data): Send with openvas_server_sendf_xml.

	* src/html/omp.xsl (html-create-escalator-form): Add HTTP Get input.

2010-09-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/CMakeLists.txt: Link gsad to libexslt.

	* src/gsad_base.c (xsl_transform): Register exslt extensions.

	* src/html/omp.xsl (wrap): Replace with line-tokenizing version which
	calls wrap-line.
	(wrap-line): New template.  Copy of old wrap.

2010-09-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_base.c (xsl_transform): Return NULL on error instead of HTML.
	(gsad_message): Return basic HTML if transformation fails.

	* src/gsad_oap.c (xsl_transform_oap): Try return error dialog page before
	basic message, on transformation failure.

	* src/gsad_omp.c (xsl_transform_omp): Try return error dialog page before
	basic message, on transformation failure.

2010-09-08  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt: Added check for subversion directory if build type
	is not release to avoid an incomplete version number.

2010-09-07  Matthew Mundell <matthew.mundell@greenbone.net>

	Add associating of slave with task.

	* src/gsad.c (gsad_connection_info, free_resources, serve_post): Add
	slave_id attribute.
	(exec_omp_post): Pass slave_id to create_task_omp.

	* src/gsad_omp.c (create_task_omp): Add slave_id param.  Pass to
	CREATE_TASK.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (new_task): Add slave input.

2010-09-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (configure_credentials.html): Added
	note on Umlauts and Domain Controller.

2010-08-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report_format): Add trust time under trust.
	(report_format [details]): Extract text part of trust only.

2010-08-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Add verify buttons on the report formats page.

	* src/html/omp.xsl (report_format): Add verify button.

	* src/gsad_omp.c (verify_report_format_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/gsad.c (init_validator, exec_omp_get): Add verify command.

2010-08-26  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/omp.xsl: Do not show the "Pause" button if the task is
	still being requested.

2010-08-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl: Consistent checked="1" everywhere.
	This is just code polishing.

	* src/html/gsad.xsl: Provide html tag with xml name space
	attribute. This was complained by HTML checker.

2010-08-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (init_validator): Allowed german umlauts for comment.

2010-08-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (configure_credentials.html): More info
	about allowed characters.

2010-08-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-lsc-credential-form): Check password
	instead of autogenerate.

2010-08-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (configure_report_formats.html): Slight improvement
	of test.

2010-08-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add - to credential_login.

2010-08-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (edit-families-family): Replace submit image with link.

2010-08-13  Matthew Mundell <matthew.mundell@greenbone.net>

	Add report formats help.

	* src/html/help.xsl (configure_report_formats.html): New template.
	(configure_scanconfigs.html, configure_targets.html): Correct spelling.
	(contents.html, glossary.html): Add report formats item.
	(reports.html): Refer to report formats page in download section.  Add TXT
	format.
	(view_report.html): Refer to report formats page in download section.

	* src/html/omp.xsl (report_format [details]): Neaten URL name.

2010-08-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-formats-table, report_format)
	(report_format [details]): Add report format trust value.

2010-08-11  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/help.xsl: Corrected typo in domain example for credential
	login.

2010-08-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl: Added domain examples for credential
	login.

2010-08-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (delete_report_omp): Get report formats for download
	dropdown.

2010-08-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report): Only activate report delete button for
	appropriate report states.

2010-08-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task): Add missing URL param name.

2010-08-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (status_bar): Just print status if the progress is -1.

2010-08-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Show overrides consistently in links to get_tasks pages.

	* src/html/gsad.xsl (html-gsa-logo, error_dialog): Pass overrides flag to
	get_tasks.

	* src/html/help.xsl: Flush trailing whitespace.
	(reports.html, tasks.html): Pass overrides flag to get_tasks.

2010-08-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Refer to report formats by UUID in OMP GET_REPORTS.

	* src/gsad.c (exec_omp_get): Expect report format ID instead of name for
	get_report_omp.

	* src/gsad_omp.c (get_report_omp): Pass UUID instead of name to
	GET_REPORTS to identify report format.

	* src/html/omp.xsl (html-report-details, report): Pass report format ID to
	get_report instead of name.

2010-08-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Pass overrides flag to edit_override_omp in
	get_tasks case.

	* src/html/omp.xsl (html-report-table): Pass overrides param to override
	template.

2010-08-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_note_omp, delete_note_omp, save_note_omp)
	(create_override_omp, delete_override_omp, save_override_omp): Get report
	formats for download dropdown.

2010-08-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (edit-config-preferences): Add drop_privileges to
	yes/no radio list.

2010-08-05  Michael Wiegand <michael.wiegand@greenbone.net>

	* INSTALL: Added information on setting PKG_CONFIG_PATH. Updated and
	rephrased section on custom paths for libraries and header files. Made
	naming of the GSA consistent. Made text width consistent.

2010-08-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (edit-config-preferences): Add yes/no radios for known
	scanner yes/no prefs.

2010-08-05  Matthew Mundell <matthew.mundell@greenbone.net>

	Add task control buttons to the task summary page.

	* src/gsad.c (exec_omp_get): Pass next to task control functions.  Pass
	overrides as ints to the same.

	* src/gsad_omp.c (delete_task_omp, save_task_omp, stop_task_omp)
	(pause_task_omp, resume_paused_task_omp, resume_stopped_task_omp)
	(start_task_omp): Add next page handling.

	* src/gsad_omp.h: Update headers accordingly.

	* src/htmp/omp.xsl (html-report-table): Add task control buttons.
	(task): Pass next page to task control pages.

2010-08-04  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c: Added mainpage directive for documentation.

2010-08-03  Michael Wiegand <michael.wiegand@greenbone.net>

	Post branch version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2010-08-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp): Wrap in GET_REPORT instead of COMMANDS.
	Get the task summary as well as the report, for the task progress info.

	* src/htmp/omp.xsl (html-report-details): Replace "Final scan run status"
	field with "Scan status" and progress bar.
	(get_report): New template.

2010-08-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsa-style.css (small_form): Separate out input to add middle
	vertical alignment.

	* src/htmp/omp.xsl (html-report-details, report): Replace download button
	with image input.

2010-08-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Add report formats.

	* src/gsad_base.h (enum content_type): Add GSAD_CONTENT_TYPE_DONE.

	* src/gsad.c (init_validator): Add report format commands and validators.
	(exec_omp_post): Add handling for report format commands.
	(exec_omp_get): Add arg for content type.  Let get_report_omp set the
	content type if it wishes.  Add handling for report format commands.
	(gsad_add_content_type_header): Add GSAD_CONTENT_TYPE_DONE case.
	(request_handler): Set the content type for exec_omp_get if required.

	* src/gsad_omp.c (get_tasks): Also get report formats.
	(export_report_format_omp): New function.
	(get_report_omp): Add content type and disposition args.  Set these
	according to report format information.  Capitalise XML format name.  Also
	get report formats.
	(create_note_omp, delete_note_omp, save_note_omp, create_override_omp)
	(delete_override_omp, save_override_omp): Capitalise XML format name.
	(get_report_format_omp, get_report_format_omp, delete_report_format_omp)
	(import_report_format_omp): New functions.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/gsad.xsl (html-gsa-navigation): Add "Report Formats" menu item.

	* src/html/omp.xsl (html-report-details, report): Replace static report
	names with dynamic ones.
	(html-report-formats-table, html-import-report-format-form)
	(get_report_formats_response)
	(create_report_format_response, delete_report_format_response)
	(report_format, param-details, report_format [details])
	(get_report_format, get_report_formats): New templates.
	(get_reports_response)
	(get_reports_response/report [overview, details]): Account for extra
	report wrapper element.

2010-07-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add - to family_page.

2010-08-02  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2010-08-02  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 1.0.0 release.

	* src/html/help.xsl: Updated version number.

	* CMakeLists.txt: Updated version number.

	* CHANGES: Updated.

	* INSTALL: Updated prerequisites.

2010-08-02  Michael Wiegand <michael.wiegand@greenbone.net>

	* INSTALL: Updated prerequisites.

	* CMakeLists.txt: Increased required openvas-libraries version.

2010-07-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_config_nvt_omp): Correct MODIFY_CONFIG call
	for NVT preferences.

2010-07-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (serve_post): Account for chunking in file and password
	parsing.

2010-07-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (serve_post): Account for chunking in preference parsing.
	Most of work by Michael Wiegand.

2010-07-22  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Fixed openvas-libraries version detection.

2010-07-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (preferences-edit-details): Correct NVT path.

2010-07-16  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2010-07-16  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 1.0.0.rc1 release.

	* src/html/help.xsl: Updated version number.

	* CMakeLists.txt: Updated version number.

	* CHANGES: Updated.

2010-07-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Validate create_user password like other
	vars.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (send_http_authenticate_header): Doc MHD type.
	(redirect_handler, request_handler): Return MHD_YES on method error, so
	that the sender gets the response page.   Doc MHD type.  Align overhang.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp): Remove TODO about g_string_new size, as
	it's hard to tell how big or small the string will get.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_base.c (xsl_transform): Check return value.  Remove premature
	free.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (main): Remove TODO that referred to a pidfile_create.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (print_header): Remove.  Now out of use.
	(redirect_handler): Clarify freeing.
	(request_handler): Remove print_header iteration.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (get_file_size): Remove.  Out of use.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (serve_post): Cleanup doc a bit.
	(request_handler): Rename arg contenttype to content_type.  Cleanup doc a
	bit.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* doc/CMakeLists.txt (.build-html, .built-html_full): Remove duplicate
	rule.  Depend on all source files.

	* src/gsad.c, src/gsad_base.h, src/gsad_omp.c: Bring docs up to date.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* doc/Doxyfile.in, doc/Doxyfile_full.in: Turn off recursive file search.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-note-form, html-edit-note-form)
	(html-create-override-form, html-create-note-form): Ensure override and
	note buttons are hidden.

2010-07-14  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table): Add overrides to refresh URLs.

2010-07-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_system_reports_omp): Use new OMP for getting list.

	* src/html/omp.xsl (system_report [image]): Remove mode.  Change path.
	(system_report): Remove.
	(get_system_reports_response, get_system_reports): New template.  Rename
	from system_report.  Adjust path for flatter report type list.

2010-07-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (configure_agents.html): Updated help page on agents.

2010-07-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Get agent filename from get_agent_omp.

	* src/gsad_omp.c (get_agents_omp): Add filename return arg.

	* src/gsad_omp.h: Update header accordingly.

2010-07-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Expect get_agents_omp html in arg return
	instead of in function return value.  Get agent before setting response
	headers, in case of error.

	* src/gsad_omp.c (get_agents_omp): Add html return arg.  Return success
	or failure.

	* src/gsad_omp.h: Update header accordingly.

2010-07-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Get credential login for filename from
	get_lsc_credentials_omp.

	* src/gsad_omp.c (get_lsc_credential_omp): Add login return arg.

	* src/gsad_omp.h: Update header accordingly.

2010-07-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Expect get_lsc_credentials_omp html in arg
	return instead of in function return value.  Get credential before setting
	response headers, in case of error.

	* src/gsad_omp.c (get_lsc_credentials_omp): Add html return arg.  Return
	success or failure.

	* src/gsad_omp.h: Update header accordingly.

2010-07-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_lsc_credential_omp): Correct comment.
	(get_lsc_credentials_omp): Correct attribute name.

2010-07-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Pass oid to edit_note_omp "get_nvts" case
	in correct parameter.  Pass overrides flag to edit_note_omp "get_tasks"
	case.

	* src/gsad_omp.c (edit_note_omp): Remove min_cvss_base NULL check, as
	only some callers use it.

	* src/html/omp.xsl (html-report-table): Add overrides flag to the request
	parameters passed to the edit_note "get_tasks" case.

2010-07-09  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl: Completed and fixed help texts for
	Overrides.

2010-07-08  Matthew Mundell <matthew.mundell@greenbone.net>

	Pass agent installer filename in CREATE_AGENT OMP.

	* src/gsad.c (struct req_parms): Add installer_filename field.
	(free_resources): Free installer_filename.
	(serve_post): Set installer_filename.
	(exec_omp_post): Pass installer_filename to create_agent_omp.

	* src/gsad_omp.c (create_agent_omp): Add installer_filename arg.  Send
	filename in CREATE_AGENT.

	* src/gsad_omp.h: Update header accordingly.

2010-07-08  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Added help for overrides.

	* src/html/help.xsl (contents.html): Added link to overrides-help.
	(glossary.html): Included overrides.
	(overrides.html): New, help for overrides.

2010-07-08  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (free_gchar_array): New function, extracted.
	(free_resources): Extracted and call new function.

2010-07-08  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Make cmake environment more flexible as discussed on
	openvas-devel: Set CMAKE_BUILD_TYPE only to "Debug" if it is not
	already set. Do not set CMAKE_VERBOSE_MAKEFILE, let it default to OFF.
	Remove redundant flags from CMAKE_C_FLAGS_DEBUG. Replace check for
	PREPARE_RELEASE with check for CMAKE_BUILD_TYPE == "Release".

2010-07-06  Matthew Mundell <matthew.mundell@greenbone.net>

	Add agent installer signatures.

	* src/gsad.c (struct req_parms): Add installer_sig fields.
	(free_resources): Free installer_sig.
	(serve_post): Fill installer_sig.
	(exec_omp_post): Pass installer_sig fields to create_agent_omp.

	* src/gsad_omp.c (create_agent_omp): Add installer_sig args.  Send
	signature in CREATE_AGENT.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-create-agent-form): Add "Installer signature"
	field.
	(html-agents-table, agent): Add trust column.

2010-07-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-escalator-form): Capitalize syslog.
	(escalator, escalator [details]): Use submethod name for syslog methods.

2010-07-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-table, overide)
	(html-overrides-table): Add From column.  Rename New Threat column to To.
	(override-detailed): Add from threat to heading.

2010-07-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-override-form): Select False Positive for
	New Threat.

2010-07-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/override.png, src/html/img/new_override.png: Updated.

2010-07-05  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/false_positive.png: New.

	* src/html/omp.xsl: Fix for consistent spelling of false_positive.png.

	* src/CMakeLists.txt: Install the new graphics file.

2010-07-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Add Syslog and SNMP escalator methods.

	* src/gsad_omp.c (create_escalator_omp): Extract the syslog "submethod"
	data from the "method" param.

	* src/html/omp.xsl (html-create-escalator-form): Add syslog and SNMP
	methods.

2010-07-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (html-report-details): Consolidate title
	bar action.

2010-07-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (html-report-table): Consolidate title
	bar action.

2010-07-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (html-task-table): Use a hook to mark
	current selection in title bar. Well, officially its
	the radic symbol, but looks good.

2010-07-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Add False Positive "threat" for overrides.

	* src/gsad.c (init_validator): Add false positive to levels and threat.
	Add level_false_positive.
	(exec_omp_get): Add false positive to level string.

	* src/html/omp.xsl (build-levels): Add False Positive.
	(html-report-details): Add false positive column and filter.
	(html-report-table): Add false positive column.
	(false_positive): New template.
	(report): Add FP to tool tip.  Fill false positive column.
	(last_report): Add FP to tool tip.
	(html-create-override-form, html-edit-override-form): Add False Positive
	to New Threat.
	(get_reports_response/report [overview]): Add false positive column.

2010-07-02  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: GSA requires glib to be at least 2.14. Modified
	library check to check glibs version as well.

2010-07-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl (html-task-table): Consolidate title bar actions.
	Mark current setting with ">". Don't us checkbox for
	nicer and consistent appearance.

2010-07-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-task-table, html-report-details)
	(html-report-table): Move the "Apply overrides" checkbox into the table
	heading.

2010-06-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_tasks): Move GET_NOTES and GET_OVERRIDES task ID
	into attribute.

2010-06-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-edit-override-form): Ensure new threat offers
	the existing value.

2010-06-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_target_omp): Send USERNAME and PASSWORD inside
	TARGET_LOCATOR.

	* src/html/omp.xsl (target_locator [select]): Get name from entity.

2010-06-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_note_omp, save_note_omp, create_override_omp)
	(create_override_omp): Move TASK IDs from text into attribute.

2010-06-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_note_omp, save_note_omp, create_override_omp)
	(create_override_omp): Move NVT and RESULT IDs from text into attribute.

2010-06-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_nvts): Align param.  Change GET_NVTS/@oid to
	nvt_oid.  Move GET_NOTES and GET_OVERRIDES elements to attributes.
	(get_config_nvt_omp, save_config_nvt_omp)
	(export_preference_file_omp): Change GET_NVTS/@oid to nvt_oid.

2010-06-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_target_omp): Add tasks attrib to GET_TARGETS.

2010-06-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_override_omp): Remove apply_overrides flag.

2010-06-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Rename report/messages to
	report/result_count.  Rename report/scan_result_count to
	report/result_count.
	(report, last_report): Rename report/messages to report/result_count.
	(messages): Remove.
	(result_count): New template.  Rename from messages.

2010-06-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp, create_note_omp, delete_note_omp)
	(save_note_omp, create_override_omp, delete_override_omp)
	(save_override_omp): Replace get_report with get_reports.

	* src/html/omp.xsl (get_report_response)
	(get_report_response/report [overview, details): Remove.
	(get_reports_response, get_reports_response/report [overview, details):
	New templates.  Renamed from "get_report" counterparts.

2010-06-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (manager_connect): Note breakpoint method of pausing.

	* src/gsad_oap.c (administrator_connect): Note breakpoint method of
	pausing.

2010-06-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-config-nvt-table): Select prefs from inside NVT.

2010-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_nvts, get_config_family_omp, get_config_family_omp)
	(get_config_nvt_omp): Adjust get_nvts with new details flags.

2010-06-23  Matthew Mundell <matthew.mundell@greenbone.net>

	Rename GET_NVT_DETAILS to GET_NVTS.

	* src/gsad.c (init_validator): Remove get_nvt_details.  Add get_nvts.
	(exec_omp_get): Call get_nvts_omp instead of get_nvt_details_omp.  Replace
	"get_nvt_details" page name args with "get_nvts".

	* src/gsad_omp.c: Replace get_nvt_details in comments and docs.
	(get_nvt_details, get_nvt_details_omp): Remove.
	(get_nvts, get_nvts_omp): New function.  Rename from "nvt_details"
	version.  Update callers.
	(get_config_nvt_omp, get_config_family_omp): Replace get_nvt_details
	command.  Add details attribute.
	(delete_note_omp, save_note_omp, delete_override_omp): Replace
	get_nvt_details in page name comparison.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (get_nvt_details): Remove.
	(get_nvt): New template.  Renamed from get_nvt_details_response.
	(html-config-family-table, html-config-nvt-table): Replace "nvt_details"
	with "nvts".

2010-06-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Rename ABORT_TASK to STOP_TASK.

	* src/gsad.c (init_validator): Remove abort_task.  Add stop_task.
	(exec_omp_get): Call stop_task_omp instead of abort_task_omp.

	* src/gsad_omp.c (abort_task_omp): Remove.
	(stop_task_omp): New function.  Rename from "abort" version.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/help.xsl (tasks.html): Replace "abort" with "stop".

	* src/html/omp.xsl (abort_task_response): Remove.
	(stop_task_response): New template.  Renamed from abort_task_response.
	(task): Replace "abort" with "stop".

2010-06-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add _ to credential_login chars.

2010-06-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task): Also pass apply_override through to task
	details page.

2010-06-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_tasks_response): Improve operation name.

2010-06-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Use correct name for
	apply_overrides in report download request.

2010-06-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add apply_overrides to report
	download request.

2010-06-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-report-details): Add "Apply overrides" checkbox.

2010-06-21  Matthew Mundell <matthew.mundell@greenbone.net>

	Remove report "Apply overrides" checkbox.  Make the actions on the task
	list preserve the override state.

	* src/gsad.c (init_validator): Add command new_task.
	(exec_omp_post): Call new_task_omp instead of gsad_newtask, passing
	"apply override" flag.  Pass "apply override" flag to create_task_omp.
	(exec_omp_get): Pass "apply override" flag to task functions that lead to
	getting the task list.  Pass "show overrides" flag to functions that lead
	to getting a single task.
	(request_handler): Remove new_task.html special case.

	* src/gsad_omp.c (gsad_newtask): Remove.
	(new_task_omp): New function.  Rename from gsad_newtask.  Add
	apply_overrides arg.
	(create_task_omp, delete_task_omp, edit_task, edit_task_omp)
	(save_task_omp, abort_task_omp, pause_task_omp, resume_paused_task_omp)
	(resume_stopped_task_omp, start_task_omp): Add apply_overrides flag.
	(delete_note_omp, save_note_omp, delete_override_omp)
	(save_override_omp): Pass overrides arg to get_tasks as apply_overrides.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/gsad.xsl (autorefresh): Add overrides to URL.
	(html-gsa-navigation): Add overrides flags to get_tasks URL.  Replace
	new_task.html with new_task command.

	* src/html/help.xsl (configure_targets.html): Correct typo.
	(new_task.html): Remove.

	* src/html/omp.xsl (apply_overrides): New template.
	(html-task-table): Get apply_overrides directly from get_tasks response.
	Replace new_task.html with command version, including overrides flag.
	Pass overrides flag to pages that return to get_tasks.
	(html-report-details): Pass overrides to get_report.  Remove overrides
	checkbox.
	(html-edit-task-form): Pass override flag on to get_tasks.
	(task): Pass overrides flag through to report and report list and to pages
	that return to get_tasks.
	(gsad_newtask): Remove.
	(new_task): New template.  Renamed from gsad_newtask.  Pass override flag
	to create_task.

2010-06-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (configure_targets.html): Added
	description for import of targets.

2010-06-19  Matthew Mundell <matthew.mundell@greenbone.net>

	Add "Apply override" checkboxes for task and report lists.

	* src/gsad.c (exec_omp_post, exec_omp_get): Pass overrides flag to
	get_tasks_omp.

	* src/gsad_omp.c (get_tasks): Add overrides arg.  Update callers.
	(get_tasks_omp): Add overrides arg.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/omp.xsl (html-task-table, html-report-table): Add "Apply
	overrides" checkbox.
	(get_tasks): New template.

2010-06-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/oap.xsl: Little facelift for ADS/LDAP dialogs.

	* src/html/help.xsl: Moved and cleaned up ADS and LDAP
	documentation into Users page.

2010-06-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp, create_note_omp, delete_note_omp)
	(save_note_omp, new_override_omp, create_override_omp)
	(delete_override_omp, save_override_omp): Pass overrides as 1 always, and
	pass apply_overrides with alongside overrides with the value overrides
	had.

	* src/html/omp.xsl (html-report-details): Rename "Show overrides" to
	"Apply overrides" and check it according to the apply_overrides filter
	setting.

2010-06-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (init_validator): Move "get_tasks" into alphabetical
	order.

2010-06-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsa-style.css: Order authors alphabetically.

2010-06-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Rename GET_STATUS to GET_TASKS.

	* src/gsad_oap.c (get_users_oap, get_feed_oap, sync_feed_oap)
	(get_settings_oap, edit_settings_oap, save_settings_oap)
	(modify_ldap_auth_oap): Replace "get_status" with "get_tasks".

	* src/gsad_omp.c: Replace "get_status" with "get_tasks" in all messages
	and comments.
	(get_status, get_status_omp): Remove.
	(get_tasks, get_tasks_omp): New function.  Renamed from "status" version.
	(edit_task_xml, start_task_xml, delete_report_omp): Replace get_status
	with get_tasks in OMP.
	(save_task_xml, delete_note_omp, save_note_omp)
	(save_override_omp): Replace get_status call with get_tasks.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/gsad.xsl (autorefresh, html_gsa_logo, html-gsa-navigation)
	(error_dialog): Replace "get_status" with "get_tasks".

	* src/html/help.xsl (feed_management.html, reports.html)
	(tasks.html): Replace "get_status" with "get_tasks".

	* src/html/login/login.html: Replace "get_status" with "get_tasks".

	* src/html/oap.xsl (user [details]): Replace "get_status" with
	"get_tasks".

	* src/html/omp.xsl: Replace "get_status" with "get_tasks" in all URLs,
	POST variables and comments.
	(get_status_response): Remove.
	(get_tasks_response): New template.  Renamed from get_status_response.

2010-06-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/img/override.png, src/html/img/new_override.png: New.
	Temporary icons for override.

	* src/CMakeLists.txt: Install new icons.

2010-06-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_task, get_status, delete_report_omp): Request
	details when getting status with task.

2010-06-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task_id, identifier): Remove.  Old templates.
	(result-detailed): Ensure that new notes and overrides use the original
	threat.

2010-06-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result [detailed]): Skip CVSS when overridden.

2010-06-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Add threat overrides.

	* src/gsad.c (init_validator): Add overrides commands and validators.
	(struct req_parms): Add overrides and new_threat.
	(free_resources): Free new_threat.
	(serve_post): Fill overrides and new_threat.
	(exec_omp_post): Pass overrides to create_note_omp.  Add handling for
	override commands.
	(exec_omp_get): Pass override request params to intermediate pages, as
	with notes request params.  Add handling for override commands.  Pass
	overrides param to get_report_omp.

	* src/gsad_omp.c (get_nvt_details): Get overrides.
	(get_report_omp, new_note_omp, create_note_omp, delete_note_omp)
	(edit_note_omp, save_note_omp): Add overrides flag arg.
	(get_overrides, get_overrides_omp, get_override, get_override_omp)
	(new_override_omp, create_override_omp, delete_override_omp)
	(edit_override_omp, save_override_omp): New function.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl: Pass overrides param to get_report.  Pass override
	request params to intermediate pages, as with notes request params.
	(html-report-details): Add overrides checkbox.
	(html-report-table): Add task overrides window.
	(get_overrides_response): New template.
	(get_nvt_details): Apply delete_override_response.  Add overrides section.
	(html-create-override-form, new_override, html-edit-override-form)
	(edit_override, modify_override_response, override, overide [nvt-details])
	(override [details], html-overrides-table, get_override, get_overrides)
	(create_override_response, delete_override_response, override-detailed): New templates.
	(result_detailed): Add override header, buttons and box.

	* src/html/gsad.xsl (html-gsa-navigation): Add "Notes" menu item.

	* src/html/gsa-style.css (.override_box_box, .override_top_line): New
	styles.

2010-06-10  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad_omp.c (create_task_omp): Fix. If no schedule is given, do
	not send schedule element with empty id, as manager will not be able
	to find it. Dont send schedule element instead. Merged with same issue
	for escalator.

2010-06-10  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/gsa-style.css: Add hover style for odd and even tr.

	* src/html/omp.xsl: Make tr's that correspond to a tr.odd
	now a tr.even.

2010-06-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_task_omp): Add missing XML quote.

2010-06-10  Matthew Mundell <matthew.mundell@greenbone.net>

	Pass config names to pages that need them.

	* src/gsad.c (exec_omp_post): Pass name to save_config_omp,
	save_config_family_omp and save_config_nvt_omp.
	(exec_omp_get): Pass name to get_config_family_omp, get_config_nvt_omp,
	get_config_family_omp and get_config_nvt_omp.

	* src/gsad_omp.c (save_config_omp, save_config_family_omp)
	(save_config_nvt_omp): Add name arguments.
	(get_config_family_omp, get_config_nvt_omp): Add name arguments.  Add
	NAME to CONFIG.  Update callers.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (html-config-family-table, preference, preferences)
	(html-config-nvt-table, html-config-table): Pass config name alongside
	UUID.

2010-06-09  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch to config UUIDs.

	* src/gsad.c (init_validator): Add validator "config_id".  Remove
	"scanconfig".
	(req_parms, free_resources, serve_post): Add config_id to required params.
	Remove scanconfig.
	(exec_omp_post): Expect create_task_omp config in config_id instead of
	scanconfig.  Expect config UUID instead of name in save_config_omp,
	save_config_family_omp and save_config_nvt_omp.
	(exec_omp_get): Pass config UUID instead of config name to config related
	functions.

	* src/gsad_omp.c (create_task_omp, get_config_omp)
	(save_config_omp, get_config_family_omp, save_config_family_omp)
	(get_config_nvt_omp, save_config_nvt_omp, delete_config_omp)
	(export_config_omp, export_preference_file_omp): Expect config as UUID
	instead of name.

	* src/html/omp.xsl (html-report-table, html-edit-task-form)
	(html-config-family-table, preference, preference-details)
	(edit-config-preference, preferences, html-config-nvt-table)
	(family, html-config-table, config, gsad_newtask): Pass
	config in "config_id" param instead of "name" or "scanconfig".
	(config [newtask]): Use UUID as value.
	(html-create-config-form): Replace predefined config names with UUIDs.

2010-06-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Use correct variable when validating family.

2010-06-09  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (validate): New function that validates a parameter from
	the request. If parameter was found invalid, free it and set the
	corresponding variable to NULL.
	(exec_omp_post): Replaced code with call to validate.

2010-06-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_task_omp): Pass schedule ID in attribute.

2010-06-09  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/omp.xsl (task): Deactivate icons when the actions are not
	applicable to the current status.

2010-06-09  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch to target UUIDs.

	* src/gsad.c (init_validator): Add validator "target_id".  Remove
	"scantarget".
	(req_parms, free_resources, serve_post): Add target_id to required params.
	Remove scantarget.
	(exec_omp_post): Expect create_task_omp target in target_id instead of
	scantarget.
	(exec_omp_get): Pass target_id instead of name to delete_target_omp and
	get_target_omp.

	* src/gsad_omp.c (create_task_omp, delete_target_omp)
	(get_target_omp): Expect target as UUID instead of name.

	* src/html/omp.xsl (html-report-table, html-edit-task-form)
	(lsc_credential [details], target, gsad_newtask): Pass
	target in "target_id" param instead of "name".
	(target [newtask]): Use UUID as value.

2010-06-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-target-form): Revert to "--" as value
	associate with "--" credential, which was already working.

2010-06-07  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch to LSC credential UUIDs.

	* src/gsad.c (init_validator): Add validator "lsc_credential_id".
	(req_parms, free_resources, serve_post): Add lsc_credential_id to required
	params.
	(exec_omp_post): Expect create_target_omp credential in lsc_credential_id.
	(exec_omp_get): Pass lsc_credential_id instead of name to
	delete_lsc_credential_omp, get_lsc_credential_omp and
	get_lsc_credentials_omp.

	* src/gsad_omp.c (delete_lsc_credential_omp, get_lsc_credential_omp)
	(get_lsc_credentials_omp): Expect lsc_credential_id instead of name param.
	(create_target_omp): Expect credential as UUID instead of name.

	* src/html/omp.xsl (lsc_credential, target, target [details]): Pass
	credential in "lsc_credential_id" param instead of "name" and
	"credential_login".
	(lsc_credential [select]): Use UUID as value.
	(html-create-target-form): Pass 0 as value associate with "--" credential.

2010-06-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_target_omp): Indent overhung assign like others.
	Bring long lines in range.  Indent args properly.

2010-06-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Indent overhang properly.

2010-06-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (scanconfig_nvt_details.html): Improve description.

	* src/html/omp.xsl: Format header comment like others.
	(html-create-target-form): Align cell.

2010-06-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (scanconfig_nvt_details.html): Added
	description of risk factors.

2010-06-06  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch to escalator UUIDs.

	* src/gsad.c (init_validator): Adapt "escalator_id" for UUIDs.  Remove
	"escalator".
	(req_parms, free_resources, serve_post): Rename escalator to escalator_id.
	(exec_omp_post): Allow escalator_id to be "--".  Rename escalator to
	escalator_id.
	(exec_omp_get): Pass escalator_id instead of name to delete_escalator_omp,
	get_escalator_omp and test_escalator_omp.

	* src/gsad_omp.c (create_task_omp): Rename escalator to escalator_id,
	and move to attrib.
	(delete_escalator_omp, get_escalator_omp, test_escalator_omp): Expect
	escalator_id instead of name param.

	* src/html/omp.xsl (html_report_table, escalator, gsad_newtask): Pass
	escalator_id instead of name in escalator URLs.
	(escalator [newtask]): Use UUID as value.
	(html-edit-task-form): Use UUID as value, using "0" to remove escalator.

2010-06-04  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad_omp.c (get_targets_omp): Corrected command name.

2010-06-04  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Reflect name change of OMP command (sources became target_locators).

	* src/gsad.c (gsad_connection_info, serve_post, exec_omp_post)
	(init_validator): Renamed source to target_locator.

	* src/gsad_omp.c (create_target_omp, delete_target_omp)
	(get_targets_omp): Renamed source to target_locator.

	* src/html/omp.xsl: Renamed source to target_locator.

2010-06-04  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad_omp.c (gsad_newtask): Added comments.

2010-06-04  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Added Import section to Targets page, allows fetching targets from
	external sources ("target locators"), if manager is configured to do
	so. Uses recent changes and additions in CREATE_TARGET and GET_SOURCES
	OMP commands.

	* src/gsad_omp.c (create_target_omp): Added parameters for source,
	username and password, include in OMP command if present.
	(delete_target_omp, get_targets_omp): Request sources after deletion
	of a target.

	* src/gsad_omp.h (create_target_omp): Adjusted proto.

	* src/gsad.c (init_validator): Added source validator.
	(gsad_connection_info): Added source field.
	(serve_post): Fill new source field.
	(exec_omp_post): Validate new parameters and pass to create_target_omp.

	* src/html/omp.xsl (source): New, creates option in a select box.
	(html-create-target-form): Updated to allow specification of source
	and respective authorization, if configured.
	(create_target_response): Pass response of get_sources as parameter.

	* src/html/help.xsl (configure_targets): Updated examples with
	comma-space separation of hosts.

2010-06-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (agent): Get UUID from "id" attrib.

2010-06-03  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/help.xsl: Handle requests for nonexistent help pages
	better. Kudos to Jan-Oliver Wagner for suggesting this approach.

2010-06-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_report_response/report [overview]): Compare to
	empty string instead of '(null)'.

2010-06-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Switch to agent UUIDs.

	* src/gsad.c (init_validator): Add validator "agent_id".
	(exec_omp_get): Pass agent_id instead of name to delete_agent_omp and
	get_agents_omp.

	* src/gsad_omp.c (delete_agent_omp, get_agents_omp): Expect agent_id
	instead of name param.

	* src/html/omp.xsl (agent): Pass agent_id instead of name in delete_agent
	and get_agents URLs.

2010-06-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-lsc-credentials-table): Widen actions column.

2010-06-03  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (exec_omp_post): For selected LSC credentials in the
	create target command, use different field in req_parms. Added todo, as
	the proper solution might include creating a new field and validator
	for this parameter.

2010-06-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_agents_omp): Indent params properly.

2010-05-31  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/help.xsl: Added help for ADS authentication configuration.
	Added table of options for LDAP authentication configuration.

	* src/html/oap.xsl: Link the respective (ADS/LDAP) section in help
	page.

2010-05-28  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/help.xsl: Updated version number.

2010-05-28  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 1.0.0-beta7 release.

	* src/html/help.xsl: Updated version number.

	* CHANGES: Updated.

2010-05-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/help.xsl (scanconfig_editor_nvt_families.html,
	scanconfig_family_details.html): Updated column table description
	(Risk and CVSS).

2010-05-27  Michael Meyer <michael.meyer@greenbone.net>

	* src/gsad.c (init_validator):
	Allow "-" character in hostnames when creating a new target.

2010-05-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad_oap.c (modify_ldap_auth_oap): Fixed conditions.

2010-05-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	For ADS configuration, send modification command to
	openvas-administrator.

	* src/gsad_oap.c (modify_ldap_auth_oap): Added new parameters for ADS
	configuration, new fail conditions. Made the command sent more flexible
	to handle both ads and "normal" ldap configurations.

	* src/gsad_oap.h (modify_ldap_auth_oap): Updated proto.

	* src/gsad.c (init_validator): Added new validators for group
	and domain.
	(req_params): Added group and domain variable.
	(free_resources): Free the new variables.
	(serve_post): Read group and domain from request.
	(exec_omp_post): Validate parameters, updated call to
	modify_ldap_auth_oap.

2010-05-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Display ADS configuration part of describe_auth response from
	administrator, if any. Modification not yet possible.

	* src/html/oap.xsl (group): Generalized, added display of ADS
	configuration.
	(describe_auth_response): Call group template with ADS configuration.

2010-05-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-config-family-table): Add columns for Risk and
	CVSS in the final row.  Remove the edit test from the end of the details
	version of the table.

2010-05-20  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/CMakeLists.txt: Cosmetics.

2010-05-20  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/oap.xsl (html-feed-form): Display a message and disable the
	synchronization button if the sync script reports that it is unable to
	sync.

2010-05-19  Matthew Mundell <matthew.mundell@greenbone.net>

	Add CVSS filtering to report results.

	* src/gsad.c (init_validator): Add validator min_cvss_base.
	(req_parms): Add min_cvss_base and apply_min_cvss_base.
	(free_resources): Free min_cvss_base and apply_min_cvss_base.
	(serve_post): Setup min_cvss_base and apply_min_cvss_base.
	(exec_omp_post): Pass min_cvss_base to create_note_omp.
	(exec_omp_get): Pass min_cvss_base to GET_REPORT related commands.

	* src/gsad_omp.c (get_report_omp, new_note_omp, create_note_omp)
	(delete_note_omp, edit_note_omp, save_note_omp): Add min_cvss_base
	arg, for GET_REPORT.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (html-report-details): Pass min_cvss_base params to
	get_report.  Add CVSS checkbox to get_report filters.
	(html-create-note-form, html-edit-note-form, note-details)
	(result-detailed): Pass min_cvss_base params to pages that lead to
	get_report.

2010-05-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (get_report_response): Add syntax error check.

2010-05-19  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/omp.xsl (report [overview]): Display a message if the task
	has not yet finished.

2010-05-19  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/omp.xsl (report [overview]): Fix display of end time for
	still running scans.

2010-05-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl: Fix number of columns for "Result Filtering".

2010-05-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/omp.xsl: Make "Result Filtering" box look nicer.

2010-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/CMakeLists.txt: Add tags targets.

2010-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c: Add newline at end of file.
	(modify_ldap_auth_oap): Improve some formatting.

2010-05-18  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (init_validator): Added new hostport-rule. Allow port
	definitions in ldap-host input validation.

	* src/html/help.xsl (configure_manager_auth.html): Added fact that port
	can specified in the hostname parameter.

2010-05-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Add "Only show hosts that have results" filtering to report results.

	* src/gsad.c (init_validator): Add validator alias.
	(req_parms): Add result_hosts_only.
	(serve_post): Check for result_hosts_only.
	(exec_omp_post): Pass result_hosts_only to create_note_omp.
	(exec_omp_get): Pass result_hosts_only to delete_note_omp, edit_note_omp,
	get_report_omp, new_note_omp and save_note_omp.

	* src/gsad_omp.c (get_report_omp, new_note_omp, create_note_omp)
	(delete_note_omp, edit_note_omp, save_note_omp): Add result_hosts_only
	arg.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/omp.xsl (html-report-details): Pass result_hosts_only in
	get_report requests.  Add a result_hosts_only checkbox.
	(report, task, html-create-note-form, html-edit-note-form, note-detailed)
	(result_detailed): Pass result_hosts_only in requests that can return to
	the get_report page.

2010-05-18  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/omp.xsl (report [overview]): Shorten displayed start and
	and times.

2010-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (report [overview]): Add start and end times to host
	table.

2010-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (configure_targets.html): Change CIDR limit to 20.

2010-05-17  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad_base.c (xsl_transform): Return newly allocated error
	messages in case MHD decides to free them.

2010-05-17  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad_base.c (xsl_transform): Handle errors during XSL
	transformation more gracefully, clean up and return an error message
	if the transformation failed instead of aborting.

2010-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (validate_hosts_parameter): Limit CIDR mask to 20.

2010-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result-detailed): Add CVSS alongside result NVT name.

2010-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-config-family-table): Align CVSS right.

2010-05-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (risk_factor): New template.
	(html-config-family-table): Replace risk colour coding with "Risk" column.

2010-05-14  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c (init_validator): Expand search phrase validator to allow
	punctuation characters and German umlauts.

2010-05-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (nvt): Add CVSS base and risk factor.

2010-05-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/gsa-style.css (div.Critical, div.High, div.Medium, div.Low)
	(div.None): New rules.

	* src/html/omp.xsl (html-config-family-table): Add CVSS column, coloured
	according to risk factor.

2010-05-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (edit-config-preference): Make password entry like file
	entry.  Only show the download button for file prefs.

2010-05-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (tasks.html): Describe the new stopped and pause
	progress bars.  Improve the "running" description a little.

2010-05-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (result-detailed): Skip NVT header line if OID is 0.

2010-05-11  Matthew Mundell <matthew.mundell@greenbone.net>

	Add downloading of file preferences.

	* src/gsad.c (init_validator): Add export_preference_file command.
	(exec_omp_get): Add export_preference_file handling.

	* src/gsad_omp.c (export_preference_file_omp): New function.
	(get_status): Always send the refresh interval, even when 0.

	* src/gsad_omp.h: Add headers accordingly.

	* src/html/omp.xsl (preference): Add file download button.
	(preference [details]): Name preference-details.  Add "config" param and
	file download button.
	(edit-config-preference): Rename param "config" to "for_config_details".
	Add param "config" and file download button.
	(preferences [details, edit-details]): Name preferences-details.  Add
	"config" param; pass through to preference-details and
	edit-config-preference.
	(html-config-nvt-table): Pass config through to preferences templates.

2010-05-11  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c (file_content_response): Check whether the requested path
	really is a regular file before trying to serve it as a file and
	report an error message if it is not.

2010-05-11  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (init_validator): Improve validation to avoid formatting
	string attacks.

	* src/html/help.xsl (configure_manager_auth.html): Added need for %s
	in authdn parameter.

	* src/gsad_oap.c (modify_ldap_auth_oap): Added warning about %s in
	input string.

2010-05-11  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad_oap.c (modify_ldap_auth_oap): Handle input validation
	failure case, communicate to user.

	* src/html/oap.xsl (get_users_response, modify_auth_response): Show
	result of modify_auth command (and input validation).

2010-05-11  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Added handling of DESCRIBE_AUTH and MODIFY_AUTH oap commands.

	* src/gsad.c (init_validator): Added new modify auth and the important
	parameters authdn, ldaphost and enable to the validator.
	(gsad_connection_info): Added the parameters to req_parms struct.
	(serve_post): Fill the new parameters with chunks from request.
	(exec_omp_post): Handle modify_auth command, validate parameters,
	call new modify_ldap_auth_oap function.

	* src/gsad_oap.c (get_users_oap): Issue a DESCRIBE_AUTH when requesting
	users list.
	(modify_ldap_auth_oap): New. Implementation of new MODIFY_AUTH command.

	* src/gsad_oap.h (modify_ldap_auth_oap): Added proto.

	* src/html/help.xsl (configure_manager_auth.html): Added stub for
	help of new elements.

	* src/html/oap.xsl (get_users_response): Match describe_auth response.
	(group, describe_auth_response): Added window showing the and allowing
	modification of authentication settings, if any.

2010-05-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (save_user_oap): Send an empty HOSTS to set "Allow All".

2010-05-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (task): Grey the stop button for "Internal Error".

2010-05-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (status_bar): Add progress bar and percentage for
	paused and stopped tasks.

2010-05-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/img/pause.png, src/html/img/pause_inactive.png: New files.

	* src/CMakeLists.txt: Install pause images.

2010-05-07  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/help.xsl (tasks.html): Add pausing states and pause action.

2010-05-07  Matthew Mundell <matthew.mundell@greenbone.net>

	Add pausing of tasks.

	* src/html/omp.xsl (status_bar): Add pausing states.
	(pause_task_response, resume_paused_task_response): New templates.
	(task): Show pause button for requested and running tasks.  Show resume
	button for paused tasks.

	* src/gsad_omp.c (pause_task_omp, resume_paused_task_omp): New functions.

	* src/gsad_omp.h: Add headers accordingly.

	* src/gsad.c (init_validator, exec_omp_get): Add pausing commands.

2010-05-07  Michael Wiegand <michael.wiegand@greenbone.net>

	Handle requests to non-existent pages more gracefully.

	* src/gsad.c: Include gsad_base.h directly.
	(file_content_response): Display an error message if a logged-in user
	requests a file that does not exist instead of logging him out
	forcefully.
	(request_handler): Display an error message if the requested help page
	does not start with a valid character.

2010-05-07  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/gsad.xsl (error_dialog), src/html/help.xsl (glossary.html):
	Fixed broken links to get_status page.

2010-05-07  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c: Added define MAX_HELP_NAME_SIZE to limit the maximum
	length of the name of help "files" against resource exhaustion
	attacks.
	(request_handler): Test if the name of the requested help page starts
	with a valid character before even considering it. Duplicate and
	truncate it to fit MAX_HELP_NAME_SIZE. Removed superfluous handling of
	"#" character since it is not present in the request sent by the
	browser anyway.

2010-05-07  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Added simple compile time syntax checks on the xsl files.

	* CMakeLists.txt: Lowercased a cmake command, check for xsltproc
	program.

	* src/CMakeLists.txt: Check xsl stylesheets with xsltproc, if found.

2010-05-07  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt, src/CMakeLists.txt: Lowercased cmake commands as in
	all other openvas modules, converted tab to whitespaces.

2010-05-07  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c (init_validator): Allow "@" and "." characters in LSC
	login. Allow "@" character in LSC password.

2010-05-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl, src/html/oap.xsl: Convert tabs to spaces.

2010-05-06  Matthew Mundell <matthew.mundell@greenbone.net>

	Make saving of file preferences conditional on a checkbox.

	* src/html/omp.xsl (edit-config-preference): Add checkbox to "file"
	preferences so that saving the file is optional.

	* src/gsad_omp.c (save_config_nvt_omp): Add files arg which lists files
	that must be updated.

	* src/gsad_omp.h: Update header accordingly.

	* src/gsad.c (req_parms): Add files array.
	(free_resources): Free files.
	(serve_post): Collect files.
	(exec_omp_post): Pass files to save_config_nvt_omp.

2010-05-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (preference [details]): Print "File attached."
	instead of the contents of file preferences.

2010-05-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (preference [preference]): Print "File attached."
	instead of the contents of file preferences.

2010-05-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/omp.xsl (html-create-escalator-form): Add "threat level
	changed" condition.
	(escalator, escalator [details]): Add "threat level changed" handling.

2010-05-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/: Finally remove empty directory.

2010-05-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Move up the html files on directory in order to eliminate
	the unnecessary additional directory "src".

	* src/html/src/favicon.gif, src/html/src/gsad.xsl,
	src/html/src/gsa-style.css, src/html/src/help.xsl,
	src/html/src/IE6fixes.css, src/html/src/img,
	src/html/src/login, src/html/src/oap.xsl, src/html/src/omp.xsl:
	Moved to src/html/.

	* src/CMakeLists.txt: Adjusted paths.

2010-05-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c: Added ":" to hosts validator to allow
	IPv6 adresses.

2010-04-28  Hartmut Goebel <h.goebel@goebel-consult.de>

	* src/html/src/IE6fixes.css: Fixed: In reports IE6 did shift
	issues to the left more and more.

2010-04-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/gsa-style.css, src/html/src/omp.xsl,
	src/html/src/gsad.xsl, src/html/src/oap.xsl,
	src/html/src/IE6fixes.css, src/html/src/help.xsl: Made
	older Konqueror work again. Thanks to Hartmut Goebel
	for this proposed fix.

2010-04-23  Hartmut Goebel <h.goebel@goebel-consult.de>

	* src/html/src/gsad.xsl, src/html/src/help.xsl
	src/html/src/omp.xsl, src/html/src/oap.xsl,
	src/html/src/gsa-style.css, src/html/src/login/login.html ,
	src/CMakeLists.txt: Fixed: IE6 did not display some content
	elements at all and table headers were visually cluttered.

	* src/html/src/IE6fixes.css: New stylesheet (onyl used by IE6).

2010-04-22  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad_omp.c (create_task_omp): Fixed syntax for schedule element
	when creating a new task.

2010-04-22  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/gsad.xsl, src/html/src/help.xsl: Add default duration
	for links to the performance monitor.

2010-04-15  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/src/help.xsl: Updated version number.

2010-04-15  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 1.0.0-beta6 release.

	* src/html/src/help.xsl: Updated version number.

	* CHANGES: Updated.

	* CMakeLists.txt: Added autogenerated files to
	CPACK_SOURCE_IGNORE_FILES.

	* doc/.built-html: Removed superfluous file.

2010-04-15  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/help.xsl: Corrected the maximum comment length.
	(glossary.html): Added entry for schedule to glossary.
	(new_task.html): Added missing help for comment field, added help for
	schedule field.
	(reports.html): Updated help for report summary.

2010-04-14  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/help.xsl (tasks.html): Updated help for tasks list with
	new features and elements.

2010-04-14  Michael Wiegand <michael.wiegand@greenbone.net>

	Set the GSA to use UTC as timezone to stay consistent with the manager
	when scheduling.

	* src/gsad.c (main): Set timezone to UTC.

	* src/html/src/omp.xsl (html-create-schedule-form): Mark time as UTC.

	* src/html/src/gsad.xsl (html-gsa-logo): Mark time as UTC.

2010-04-14  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/help.xsl (configure_escalators.html): Comments are
	not mandatory for escalators.

2010-04-14  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/help.xsl (configure_schedules.html): Added help for
	scheduling.

2010-04-13  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/help.xsl: Flush trailing whitespace.

2010-04-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/CMakeLists.txt: Fix some installation directives to
	make the login dialog appear properly.

2010-04-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/make_html, src/html/header.m4, src/html/template.m4,
	src/html/footer.m4: Removed.

	* src/CMakeLists.txt: Instead of insalling the build directory
	do direct installation.

2010-04-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/gsad.xsl: Changed URL for about page.

	* src/html/src/help.xsl: Added content of pages "about" and "gplv2".

	* src/html/src/about.htm4, src/html/src/gplv2.htm4: Removed.

2010-04-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Static help files are not necessary anymore.

	* src/html/make_html: Don't create directory "help".

	* src/html/src/help/view_report.htm4,
	src/html/src/help/scanconfig_nvt_details.htm4,
	src/html/src/help/scanconfig_editor_nvt.htm4,
	src/html/src/help/configure_targets.htm4,
	src/html/src/help/new_task.htm4,
	src/html/src/help/scanconfig_details.htm4,
	src/html/src/help/scanconfig_editor_nvt_families.htm4,
	src/html/src/help/scanconfig_editor.htm4,
	src/html/src/help/error_messages.htm4,
	src/html/src/help/scanconfig_family_details.htm4,
	src/html/src/help/configure_agents.htm4,
	src/html/src/help/tasks.htm4,
	src/html/src/help/notes.htm4,
	src/html/src/help/nvts.htm4,
	src/html/src/help/contents.htm4,
	src/html/src/help/reports.htm4,
	src/html/src/help/configure_scanconfigs.htm4,
	src/html/src/help/configure_credentials.htm4,
	src/html/src/help/feed_management.htm4,
	src/html/src/help/settings.htm4,
	src/html/src/help/performance.htm4,
	src/html/src/help/configure_escalators.htm4,
	src/html/src/help/configure_users.htm4,
	src/html/src/help/glossary.htm4, src/html/src/help/: Removed.

2010-04-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Patch contributed by Mareike Piechowiak <noplant@gmx.de>.

	This moves all help page content to XSL and thus allows
	to have user name and date in the header (which was not
	possible with the static files).

	* src/gsad.c (request_handler): Added handling of any URL
	with "/help/".

	* src/html/src/help.xsl: New. Contains all help texts
	of the .htm4 files.

	* src/html/src/gsad.xsl: Added inclusion of help.xsl.

2010-04-10 Stephan Kleine

	* src/CMakeLists.txt: Fix build with as-needed and remove duplicate lines.

2010-04-10 Stephan Kleine

	* CMakeLists.txt: Add support for out-of-source builds.

	* src/CMakeLists.txt: Add support for out-of-source builds.

2010-04-06  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/oap.xsl (html-feed-form): Display feed version.

2010-04-01  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/about.htm4: Make sure that supporters are in
	alphabetical order.

2010-04-01  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/omp.xsl (nvt): Display NVT tags if they are set.

2010-03-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (xsl_transform_omp): Add TIME to ENVELOPE.

	* src/gsad_oap.c (xsl_transform_oap): Add TIME to ENVELOPE.

	* src/html/src/gsad.xsl (html-gsa-logo): Add time under logout.
	(time): New template.
	(envelope): Pass time to html-gsa-logo.

2010-03-30  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Add NULL guard for duration.

2010-03-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_schedules_omp, create_schedule_omp)
	(delete_schedule_omp): Add TIME to GET_SCHEDULES.

	* src/html/src/omp.xsl (opt): New template.
	(html-create-schedule-form): Create first time input via "opt" so that
	currect time is selected.

2010-03-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_task): New function.  Body from edit_task_omp.  Add
	extra_xml arg.
	(edit_task_omp): Call through to edit_task.
	(save_task_omp): For comment or name error, put up the parameter error
	message on the edit_task page.

2010-03-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-edit-task-form): Make escalator editable.

	* src/gsad.c (init_validator): Add rule "escalator_id".
	(exec_omp_get): Pass escalator to save_task_omp.

	* src/gsad_omp.h: Update header accordingly.

	* src/gsad_omp.c (save_task_omp): Add schedule_id arg.  Include in
	MODIFY_TASK command.

2010-03-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-create-schedule-form): Remove minute units
	from period and duration.
	(html-edit-task-form): Add "(immutable)" to target and config input names.

2010-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (edit_task_omp): Add next and refresh_interval NULL
	checks.
	(save_task_omp): Remove refresh_interval NULL enforcement.

2010-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Add basic task editing.

	* src/html/src/gsad.xsl (autorefresh [html-header-meta]): Only add header
	if interval is above 0.

	* src/html/src/omp.xsl (html-task-table): Widen actions column.
	(html-edit-task-form, edit_task, modify_task_response): New templates.
	(task): Add edit task button.

	* src/gsad.c (init_validator): Add edit_task and save_task commands.
	(exec_omp_get): Add edit_task and save_task handling.

	* src/gsad_omp.c (edit_task_omp, save_task_omp): New functions.
	(get_status): Always send the refresh interval, even when 0.

	* src/gsad_omp.h: Add headers accordingly.

2010-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (gsad_newtask): Add comment entry.

	* src/gsad.c (exec_omp_post): Pass comment from request to
	create_task_omp.

2010-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-report-table): Add comment field.
	(task): Add comment under name.

2010-03-28  Matthew Mundell <matthew.mundell@greenbone.net>

	Display schedule intervals in unit format.

	* src/html/src/omp.xsl (interval-with-unit): New template.
	(schedule): Call interval-with-unit for intervals.
	(schedule [details]): Display unit interval instead of just seconds.

2010-03-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-create-schedule-form): Add odd row
	background colours.  Switch period and duration input to time and unit
	dropdowns.
	(html-schedules-table): Remove "(s)" from period heading.
	(schedule): Include period months.  Add unit to period cells.  Shorten
	entire duration text.

	* src/gsad.c (init_validator): Add calendar_unit rule and duration_unit
	and period_unit aliases.
	(struct req_parms): Add duration_unit and period_unit.
	(free_resources): Free duration_unit and period_unit.
	(serve_post): Also pass units to create_schedule_omp.

	* src/gsad_omp.c (create_schedule_omp): Add period_unit and duration_unit
	args.  Add to CREATE_SCHEDULE request.

	* src/gsad_omp.h: Update header accordingly.

2010-03-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (schedule [details]): Add units to period and
	duration.

2010-03-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (schedule): Correct delete URL.

2010-03-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-create-schedule-form): Add "(optional)" to
	period and duration fields.

2010-03-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (schedule [details]): Get next_time for next time,
	instead of first_time.

2010-03-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-report-table): Get next time for "Next due",
	instead of name.

2010-03-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Add schedule input to "New Task" page.

	* src/gsad.c (struct req_parms): Add schedule_id.
	(free_resources): Free schedule_id.
	(serve_post): Pass schedule ID to create_task_omp.

	* src/gsad_omp.c (gsad_newtask): Also get schedules.
	(create_task_omp): Add schedule_id arg.  Send to Manager in CREATE_TASK.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/src/omp.xsl (schedule [newtask]): New template.
	(gsad_newtask): Add schedule field.

2010-03-23  Matthew Mundell <matthew.mundell@greenbone.net>

	Add schedule creation.

	* src/gsad.c (init_validator): Add create_schedule command.
	Add validators for create_schedule.  Change duration to an
	"optional_number".
	(struct req_parms): Add params.
	(free_resources): Add param freeing.
	(serve_post): Add create_schedule handling.
	(exec_omp_get): Pass "0" to get_system_reports_omp if duration is empty.

	* src/gsad_omp.c (create_schedule_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/src/omp.xsl (html-create-schedule-form): Add schedule params.
	(get_schedules): Add call to html-create-schedule-form.

2010-03-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Complete support for removing schedules.

	* src/gsad.c (init_validator): Add delete_schedule command.
	(exec_omp_get): Handle command "delete_schedule".

	* src/gsad_omp.c (delete_schedule_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

2010-03-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (delete_note_omp): Remove openvas_server_close called
	before session is open.  Closes #1334 (http://bugs.openvas.org/1334).

2010-03-20  Stephan Kleine

	* src/CMakeLists.txt: Install gsad into ${SBINDIR} since it is a service.

2010-03-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-report-table): Add schedule.

2010-03-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Start list and details pages for schedules.

	* src/gsad_omp.c (get_schedule_omp, get_schedules_omp): New function.

	* src/gsad_omp.h: Add headers accordingly.

	* src/gsad.c (init_validator): Add get_schedule and get_schedules command.
	Add schedule_id validator.
	(exec_omp_get): Add get_schedule and get_schedules command handling.

	* src/html/src/omp.xsl (html-create-schedule-form, html-schedules-table)
	(create_schedule_response, delete_schedule_response, schedule)
	(schedule [details], get_schedule, get_schedules): New templates.

	* src/html/header.m4, src/html/src/gsad.xsl: Add "Schedules" menu item.

2010-03-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (task): Always grey resume and stop buttons for
	scheduled tasks.  Replace start button with scheduled button for scheduled
	tasks.

	* src/html/src/img/scheduled.png, src/html/src/img/scheduled_inactive.png:
	New files.  Created by Karl-Heinz Ruskowski.

2010-03-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/img/resume.png, src/html/src/img/resume_inactive.png: Make
	right margin wider.  Thanks to Karl-Heinz Ruskowski.

2010-03-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (DEFAULT_GSAD_PORT): Remove.
	(DEFAULT_GSAD_HTTP_PORT, DEFAULT_GSAD_HTTPS_PORT): New defines.
	(main): Use appropriate define for gsad_port, depending on http_only.

2010-03-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/help/scanconfig_details.htm4: Close tags properly.

2010-03-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (task): Use details button instead of list button
	for summary link.  Always enable this details button.
	(escalator [details], target [details], html-config-table): Use details
	button instead of list button for task summary link.

	* src/html/src/help/tasks.htm4: Make "Reports" section "Task Details".

	* src/html/src/help/scanconfig_details.htm4,
	src/html/src/help/scanconfig_editor.htm4: Switch to details button.

2010-03-15  Matthew Mundell <matthew.mundell@greenbone.net>

	Complete last commit: Add Manager-side task resuming.

	* src/html/src/omp.xsl (resume_stopped_task_response): New template.
	(task): Add resume button.

2010-03-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add command resume_stopped_task.
	(exec_omp_get): Add resume_stopped_task handling.

	* src/gsad_omp.c (resume_stopped_task_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/src/help/tasks.htm4: Add Resume Task section.

	* src/html/src/img/resume.png, src/html/src/img/resume_inactive.png: New
	files.  Created by Karl-Heinz Ruskowski.

2010-03-08  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/omp.xsl: Enable all levels for report downloads in the
	task summary.

2010-03-08  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/help/reports.htm4: Corrected image filenames.

2010-03-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (report): Add ITG and CPE to download formats.

2010-03-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_config_family_omp, get_config_family_omp)
	(get_config_nvt_omp): Add table qualifier to GET_NVT_DETAILS sort field.

2010-03-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (trend_meter): Get trend from OMP.

2010-03-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/src/about.htm4: Updated version number.

2010-03-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 1.0.0-beta5 release, part two.

	* src/html/src/about.htm4: Updated version number.

	* CHANGES: Updated, added line missing from last commit.

	* ChangeLog: Corrected entry.

2010-03-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CHANGES: Updated and improved a bit for beta4.

2010-03-04  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/help/reports.htm4: Added help texts for ITG and CPE.

2010-03-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 1.0.0-beta5 release, part one.

	* ChangeLog: Restored lost entry.

	* CHANGES: Updated.

2010-03-04  Michael Wiegand <michael.wiegand@greenbone.net>

	Add format for CPE inventory report.

	* src/html/src/omp.xsl (html-report-details): Add report format "CPE".

2010-03-03  Matthew Mundell <matthew.mundell@greenbone.net>

	Add format for IT-Grundschutz (German FSI IT baseline protection) report.

	* src/gsad.c (init_validator): Relax "format" rule.

	* src/gsad_omp.c (get_report_omp): Relax report format check.

	* src/html/src/omp.xsl (html-report-details): Add report format "ITG".

2010-03-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (DATE_2822_LEN): New define.
	(file_content_response): Add Last-Modified and Expires headers.

2010-03-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (get_nvt_details): Add a help button.

	* src/html/src/help/nvts.htm4: New page.

	* src/html/src/help/contents.htm4: Link to NVT Details in NVT help.

2010-03-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (wrap): Select substring correctly after wrap.

2010-03-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-edit-note-form): Add NVT name row before
	constraint rows.

2010-03-02  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-edit-note-form): Add details button.
	(note [details]): Correct alignment.

2010-03-02  Matthew Mundell <matthew.mundell@greenbone.net>

	Add edit button to get_note page.

	* src/gsad.c (exec_omp_get): Add edit_note and save_note cases for
	get_note page.

	* src/gsad_omp.c (get_note): New function.  Body from get_note_omp.
	(get_note_omp): Wrap get_note.
	(save_note_omp): Add get_note page handling.

	* src/html/src/omp.xsl (note [details]): Add edit button.
	(get_note): Expect get_notes_response in a commands_response.

2010-02-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (serve_post): Use append_chunk_string to setup string request
	parameters.

2010-02-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/oap.xsl (html-users-table): Sort by role then name.

2010-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Add notes help.

	* src/html/src/help/notes.htm4: New file.

	* src/html/src/help/view_report.htm4: Correct typo.  Add notes sections.
	Mention "Show notes" filter.

	* src/html/src/help/glossay.htm4: Add a note entry.  Improve the NVT
	entry a little.

	* src/html/src/help/reports.htm4: Add notes section.

	* src/html/src/help/contents.htm4: Add notes item.

	* src/html/src/omp.xsl (html-report-table): Link help to reports help.
	(note [details], html-notes-table): Link help to notes.html.

2010-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (note [details]): Label task and result in orphans,
	otherwise they show as "Any".

2010-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (note, note [nvt-details]): Mark orphans.

2010-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/gsa-style.css (.issue_box_head): Remove stray colon.

2010-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (note-detailed): Use normal delete button.

2010-02-25  Matthew Mundell <matthew.mundell@greenbone.net>

	Add note editing.

	* src/html/src/omp.xsl (html-edit-note-form, edit_note)
	(modify_note_response): New templates.
	(note, note [nvt_details], note-detailed): Add edit note button.

	* src/gsad.c (init_validator): Add edit_note and save_note commands.  Add
	hosts_opt, note_task_id and note_result_id rules.
	(exec_omp_get): Add edit_note and save_note handling.

	* src/gsad_omp.c (edit_note_omp, save_note_omp): New functions.

	* src/gsad_omp.h: Add headers accordingly.

2010-02-23  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (result-detailed): Compare note count with 0
	instead of 1.

2010-02-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add DVI to "format".

	* src/gsad_omp.c (get_report_omp): Allow DVI as format.

2010-02-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (note): Decrease max to 35 so NVT name always fits
	on a single line.

2010-02-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (note-detailed): Put the "Last modified" line
	after the button float, so that Konqueror keeps the buttons inside the
	box.

2010-02-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-create-note-form): Check the more specific
	option in most constraints instead of the general option.

2010-02-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-create-note-form): Replace "All" with "Any".
	(note) [details]: Capitalise "any".

2010-02-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/omp.xsl (html-report-details): Prevent unnecessary
	wrapping.

2010-02-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (wrap): Handle the case of a single line that must
	wrap.

2010-02-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_get): Use fixed max_results values for notes.

	* src/html/src/omp.xsl (html-create-note-form): Remove max_results
	passthrough.
	(note-detailed, result-detailed): Remove max_results from requests.

2010-02-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (new_note_omp): Check all args.

2010-02-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (get_nvt_details): Only add notes table when there
	are notes.

2010-02-19  Matthew Mundell <matthew.mundell@greenbone.net>

	Add delete buttons on all note lists.

	* src/gsad.c (exec_omp_get): Call delete_note_omp according to page that
	must follow.

	* src/gsad_omp.c (get_nvt_details, get_status, get_note): New function.
	Bodies from _omp versions.
	(get_nvt_details_omp, get_status_omp, get_notes_omp): Call through to
	static functions.
	(delete_note_omp): Add more passthrough args, and next page arg.  Pass
	work to handler of next page.

	* src/gsad_omp.h: Update header accordingly.

	* src/html/src/omp.xsl (html-report-table): Pass next page to note
	template.
	(get_nvt_details_response): Remove.
	(get_nvt_details): New template.
	(note): Add next param.  Enable button.
	(note) [nvt-details]: Enable button.
	(get_notes): Expect entites in a commands_response.
	(note-detailed): Add next page to request.

2010-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_nvt_details_omp, get_status_omp, get_notes_omp): Add
	GET_NOTES sort fields.

2010-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-create-note-form): Refer to anchor in query.
	(note-detailed): Refer to anchor in delete_note query.
	(result-detailed): Add anchor.

2010-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (result-detailed): Add notes button.

2010-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (note-detailed): Add details button.

2010-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_status_omp): Request notes with task.

	* src/html/src/omp.xsl (html-report-table): Add notes window.

2010-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Extend the "port" rule to allow ports like
	"port-name (111/tcp)".

2010-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-report-details, report, task)
	(html-create-note-form, note-detailed, result-detailed): Pass the "notes"
	flag when requesting a report.  Preserve the notes flag across new_note
	and delete_note.

2010-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-report-details): Test filters/notes directly
	instead of counting it.

2010-02-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-config-family-table): Count in
	get_nvt_details_response instead of all/get_nvt_details_response, in
	view case.

2010-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/gsa-style.css (.note_top_line): New style.

	* src/html/src/omp.xsl (note) [details]: Put note text in yellow box.

2010-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a note details page.

	* src/gsad_omp.c (get_note_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/gsad.c (init_validator): Add get_note command.
	(exec_omp_get): Add get_note command handling.

	* src/html/src/omp.xsl (note): Enable details button.
	(note) [nvt-details]: Enable details button.
	(note) [details]: New template.
	(get_note): New template.

2010-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_nvt_details_omp): Also request notes for the NVT.

	* src/html/src/omp.xsl (get_notes_response): New template.
	(get_nvt_details_response): Add notes section.
	(note, html-notes-table): Replace OID column with text column.
	(note) [nvt-details]: New template.

2010-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Add notes management page.

	* src/gsad_omp.c (get_notes_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/gsad.c (init_validator): Add get_notes command.
	(exec_omp_get): Add get_notes command handling.

	* src/html/src/omp.xsl (note, html-notes-table, get_notes): New templates.

	* src/html/header.m4, src/html/src/gsad.xsl: Add "Notes" menu item.

2010-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Add note filtering in reports.

	* src/html/src/omp.xsl (html-report-details): Add "Show notes" checkbox.

	* src/gsad.c (init_validator): Add "notes" validator.
	(struct req_parms): Add notes.
	(free_resources): Add param freeing.
	(serve_post): Pass notes arg to create_note_omp.
	(exec_omp_get): Pass notes arg to report related functions.

	* src/gsad_omp.c (get_report_omp, new_note_omp, create_note_omp)
	(delete_note_omp) Add notes arg.

	* src/gsad_omp.h: Update headers accordingly.

2010-02-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Put result on "New Note" page.

	* src/html/src/omp.xsl (html-create-note-form): Add "Associated Result"
	section.
	(html-result-box): Remove.
	(new_note): Remove call to html-result-box.
	(note, result) [detailed]: Add template name.  Add note-buttons param to
	control display of note buttons.

	* src/gsad_omp.c (new_note_omp): Include result in response.

2010-02-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/img/new_note.png, src/html/src/img/delete_note.png,
	src/html/src/img/note.png: New files.

	* src/html/src/omp.xsl (note, result) [detailed]: Use new note images.

	* ChangeLog: Correct omp.xsl paths.

2010-02-16  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/omp.xsl: Fixed a typo regarding refresh
	intervals. When selecting 60 seconds, the GUI applied 60
	but showed 30.

2010-02-15  Matthew Mundell <matthew.mundell@greenbone.net>

	Add note constraints.

	* src/gsad.c (init_validator): Add "port", "result_id" and "threat"
	validators.
	(struct req_parms): Add params.
	(free_resources): Add param freeing.
	(serve_post): Pass contraint args to create_note_omp.
	(exec_omp_get): Pass contraint args to new_note_omp.

	* src/gsad_omp.c (new_note_omp): Add constraint args.
	(create_note_omp): Add constraint args.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/src/omp.xsl (html-create-note-form): Add contraint input.
	(new_note): Pass contraint values to new_note.

2010-02-12  Matthew Mundell <matthew.mundell@greenbone.net>

	Add adding of notes.

	* src/gsad.c (init_validator): Add create_note and new_note commands.
	Add "max_results" and "text" validators.
	(struct req_parms): Add params.
	(free_resources): Add param freeing.
	(append_chunk_string): New function.
	(serve_post): Add create_note handling.
	(exec_omp_get): Pass get_report params to delete_note_omp.  Add new_note
	handling.

	* src/gsad_omp.c (new_note_omp, create_note_omp): New function.
	(delete_note_omp): Add get_report params.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/src/omp.xsl (html-create-note-form, html-result-box, new_note)
	(create_note_response): New templates.
	(note) [detailed]: Wrap note text.  Pass get_report params to delete_note.
	(result) [detailed]: Add "new note" button.

2010-02-12  Matthew Mundell <matthew.mundell@greenbone.net>

	Add removal of notes.

	* src/gsad.c (init_validator): Add delete_note command.  Add "note_id"
	validator.
	(exec_omp_get): Handle command "delete_note".

	* src/gsad_omp.c (delete_note_omp): New function.

	* src/gsad_omp.h: Add header accordingly.

	* src/html/src/omp.xsl (delete_note_response): New template.
	(note) [detailed]: Add delete button.

2010-02-12  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (note) [detailed]: New template.
	(result) [detailed]: Apply any notes.

	* src/html/src/gsa-style.css (.issue_box_box): Zero margin-bottom.
	(.note_box_box): New style.

	* src/gsad_omp.c (get_report_omp): Request notes.

2010-02-10  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (escalator) [details]: Remove greying of method
	background.

2010-02-08  Tim Brown <timb@openvas.org>

	* src/gsad.c: Fixed couple of leaks reported by cppcheck.

2010-02-05  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (wrap): Lower wrap column to 90.

2010-02-05  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/src/about.htm4: Updated version number.

2010-02-05  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 1.0.0-beta4 release.

	* src/html/src/about.htm4: Updated version number.

	* CHANGES: Updated.

2010-02-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Wrap lines of result descriptions during the XSL transform.

	* src/html/src/omp.xsl (wrap): New template.
	(result) [detailed]: Add PRE around description.  Filter description
	through wrap template.

	* src/html/src/gsa-style.css (.issue_box_box): Remove white-space and
	font-family.

2010-02-04  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/omp.xsl: Reconciled value of of increment with max value
	in exec_omp_get in gsad.c to repair pagination.

2010-02-03  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (result) [detailed]: Remove PRE from description.

	* src/html/src/gsa-style.css (.issue_box_box): Add line wrapping, space
	preservation and PRE like font.

2010-02-01  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (lsc_credential) [details]: Remove colon from
	heading.

2010-02-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/omp.xsl: Made file entries have same length
	as text entries.

2010-01-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (get_status_response): Correct substring args.
	(html-create-lsc-credential-form): Add empty values to some empty inputs.

	* src/html/src/gsad.xsl (html-gsa-logo): Add image title.

	* src/gsad_oap.c (save_user_oap): Correct comment.
	(get_feed_oap): Correct message texts.

2010-01-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/oap.xsl (describe_feed_response): Check for failure.
	(html-feed-form): Add details if sync in progress.  Correct button
	greying test.

2010-01-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* ChangeLog: Format last entry better.

2010-01-28  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad_oap.c (create_user_oap, save_user_oap, delete_user_oap)
	(edit_user_oap, get_user_oapt_users_oap, get_feed_oap, sync_feed_oap)
	(get_settings_oap, edit_settings_oap, save_settings_oap): Use new
	library read_string function to access only the string of gnutls
	session.

	* src/gsad_omp (check_modify_config, gsad_newtask, get_status_omp)
	(create_lsc_credential_omp, get_lsc_credential_omp, create_agent_omp)
	(delete_agent_omp, create_escalator_omp, delete_escalator_omp)
	(get_escalator_omp, get_escalators_xml, test_escalator_omp)
	(create_target_omp, delete_target_omp, get_target_omp, get_targets_omp)
	(create_config_omp, import_config_omp, get_config_family_omp)
	(get_config_nvt_omp, get_report_omp, get_system_reports_omp): Use new
	library read_string function to access only the string of gnutls
	session.

2010-01-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (send_redirect_header)
	(create_http_authenticate_response): Add Expires and Cache-Control
	headers.
	(file_content_response): Use MHD defines for header names.

2010-01-28  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (file_content_response): Indent args.  Downcase @todos.
	Move fopen return check for default_file into block that does fopen.
	Add Expires and Cache-Control headers if path matches default_file.

2010-01-28  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (request_handler): Simplified conditional.

2010-01-27  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/src/about.htm4: Updated version number.

2010-01-27  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 1.0.0-beta3 release.

	* src/html/src/about.htm4: Updated version number.

	* CHANGES: Updated.

2010-01-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* README: Updated.

2010-01-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Add option to run in chroot.  Most of work by Felix Wolfsteller.

	* src/gsad.c (file_content_response): Make file path relative.
	(drop_privileges): New function.
	(main): Add option --do-chroot.  Change into the state directory
	before starting the HTTP daemon, so that all paths can be relative.
	If --do-chroot is given, chroot into the state dir and drop
	privileges.  Move PID file creation to come before the chroot.

	* src/gsad_base.c (XSL_PATH): Make relative.

2010-01-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (request_handler): Collapse two conditionals with
	identical body.

2010-01-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Basic input checking when serving files. Set content type for images.

	* src/gsad_base.h: Added new content type (text/css).

	* src/gsad.c (gsad_add_content_type_header): Added new text/css
	content type.
	(file_content_response): Set content type and disposition, check url
	parameter to not contain "..".
	(request_handler): Pass content type and disposition to
	file_content_response.

2010-01-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (create_http_authenticate_response): New, extracted from
	(send_http_authenticate_header).
	(file_content_response): New, extracted from request_handler
	(request_handler): Call extracted function, use http_response code
	variable to store the response code instead of immediate sending
	responses.

2010-01-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c: Added TODOs.

2010-01-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Set content-type header for error pages.

	* src/gsad.c (send_response): Add content type header to response.
	(send_redirect_header, send_http_authenticate_header): Use
	libmicrohttpd macros.

2010-01-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Further removal of global variables, closing mem leaks.

	* src/gsad.c: Removed global variable content_disposition and
	response_size.
	(exec_omp_get): Added new parameter.
	(request_handler): Added local variables as replacements for the global
	ones, pass as new parameter to functions.

2010-01-27  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Switched from using dynamic strings as http header content-type field
	to static strings, resolving a mem leak and possible contention issues.
	Set the content-type header field for more responses, minor consistency
	improvements of response-building.

	* src/gsad_base.h: Introduced new enum "content_type".

	* src/gsad.c: Removed global content_type variable.
	(content_type_from_format_string): New function.
	(exec_omp_get): Added content type return parameter instead of
	modification of global variable from within function, updated call to
	export_config_omp.
	(gsad_add_content_type_header): New function to add content type
	header to responses.
	(request_handler): Adjusted doc, added TODO about weird
	function/comment, use new content_type, minor refactoring of response-
	building code blocks.
	(main): Adjusted comment, moved pointers to certificate and key into
	single block where they are used.

	* src/gsad_omp.c (delete_lsc_crendential_omp)
	(get_lsc_crendential_omp, save_config_family_omp, save_config_nvt_omp):
	Repaired doc.
	(export_config_omp, get_system_reports_omp, get_system_report_omp): Use
	new content_type.

	* src/gsad_omp.h: Adjusted protos.

2010-01-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/src/about.htm4: Updated version number.

2010-01-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt: Added files to ignore for source packaging.

2010-01-27  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Preparing the gsa 1.0.0-beta2 release.

	* src/html/src/about.htm4: Updated version number.

	* CHANGES: Updated.

2010-01-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (main): Add options --alisten and --mlisten.

	* src/gsad_omp.c (manager_address): New variable.
	(omp_init): Add address argument.
	(is_omp_authenticated, manager_connect): Pass address to
	openvas_server_open.

	* src/gsad_omp.h: Update header accordingly.

	* src/gsad_oap.c (administrator_address): New variable.
	(oap_init): Add address argument.
	(administrator_connect): Pass address to openvas_server_open.

	* src/gsad_oap.h: Update header accordingly.

2010-01-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (gsad_address): New variable.
	(main): Add --listen option.  Pass address to MHD_start_daemon.

2010-01-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (main): Neaten MHD_start_daemon calls.

2010-01-26  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/src/help/configure_targets.htm4: Removed part about
	definition of ip-ranges and noted the cidr-netmask limit.

2010-01-26  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad_omp.c (serve_post): Own conditional for host parameter
	validation.
	(exec_omp_post): Validate host parameter
	(validate_hosts_parameter): Use gchar and respective function instead
	of char.

2010-01-26  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad.c (validate_hosts_parameter): New function, checks cidr
	netmasks.
	(serve_post): Call new validation function for hosts parameter.

2010-01-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (main): Add option --http-only.

2010-01-25  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad_omp.c (get_report_omp): Do not close the server connection
	a second time in error case.

2010-01-25  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/gsad_omp.c (get_report_omp): Just send the xml describing the
	report if xml report is requested.

2010-01-25  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_report_omp): If the format is XML send the plain
	XML, and if the format is NULL send the XSL transformed XML (that is,
	send the HTML page).

2010-01-25  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Updated help.

	* src/html/help/configure_credentials.htm4,
	src/html/help/configure_targets.htm4,
	src/html/help/configure_users.htm4,
	src/html/help/glossray.htm4: Updated help.

2010-01-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/gsa-style.css (.gb_window_part_center)
	(.gb_window_part_center_error, .logo_l, .logo_r, .logout_panel): Set
	colours so that text shows up when images are off in the browser.

2010-01-22  Matthew Mundell <matthew.mundell@greenbone.net>

	Remain on the task page after deleting the task's last report.

	* src/html/src/omp.xsl (html-report-table): Apply the report
	template explicitly.
	(report): Replace with body of get_status_response/task/report.  Go two
	up to get to the task ID.
	(get_status_response/task/report): Remove.
	(get_status_response): Determine if the reports are present by checking
	for task/reports instead of a task/report.
	(commands_response/get_status_response): Remove, redundant.

2010-01-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (redirect_pid): New variable.
	(gsad_cleanup): Kill redirect child in parent.
	(main): Set redirect_pid in parent.  Set SIGCHLD to SIG_IGN.  Remove
	pidfile creation from redirect child.

2010-01-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/oap.xsl (user) [edit]: Switch the modify_password values.

2010-01-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/oap.xsl (user): Account for "custom" access rules.

2010-01-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/oap.xsl (user) [edit]: Make the Host Access radios match
	the user's rights.

2010-01-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Revert create_target hosts validator to
	"hosts".

2010-01-20  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl: Make all alt's "Details" for details buttons.

2010-01-20  Matthew Mundell <matthew.mundell@greenbone.net>

	Add user details page and editing of user details.

	* src/gsad.c (init_validator): Add "edit_user", "get_user" and "save_user"
	commands.  Add rule "modify_password".
	(struct req_parms): Add modify_password.
	(free_resources, serve_post): Add modify_password handling.
	(exec_omp_post): Add save_user command.
	(exec_omp_get): Add edit_user and get_user commands.

	* src/gsad_oap.c (save_user_oap, edit_user_oap, get_user_oap): New
	functions.

	* src/gsad_oap.h: Add headers accordingly.

	* src/html/src/oap.xsl (html-create-user-form): Order options
	alphabetically, and force selection of "User".
	(user): Add details and edit buttons.
	(user) [details] [edit]: New templates.
	(edit_user, get_user): New templates.

2010-01-19  Matthew Mundell <matthew.mundell@greenbone.net>

	Add user host access to user list.  Make "Allow All" possible when
	creating a user.

	* src/gsad.c (init_validator): Add "access_hosts" rule.  Add 2 to
	"hosts_allow".
	(struct req_parms): Add access_hosts.
	(free_resources, serve_post): Add access_hosts handling.
	(exec_omp_post): Pass access_hosts instead of hosts to create_user_oap.

	* src/gsad_oap.c (create_user_oap): Leave out HOSTS if hosts_allow is 2.

	* src/html/src/oap.xsl (html-create-user-form): Make "Host Access"
	mandatory, with a "Allow All" radio.
	(html-users-table): Add "Host Access" column.
	(user): Add host access details.

2010-01-19  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/gsad.xsl, src/html/src/about.htm4: Extending Copyright
	to 2010.

2010-01-19  Matthew Mundell <matthew.mundell@greenbone.net>

	Add setting of user host access.

	* src/gsad.c (init_validator): Add "hosts_allow" rule.
	(struct req_parms): Add hosts_allow.
	(free_resources, serve_post): Add hosts_allow handling.
	(exec_omp_post): Pass hosts and hosts_allow to create_user_oap.

	* src/gsad_oap.c (create_user_oap): Add HOSTS to CREATE_USER according to
	new args hosts and hosts_allow.

	* src/gsad_oap.h: Update header accordingly.

	* src/html/src/oap.xsl (html-create-user-form): Add "Host Access" input.

2010-01-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (exec_omp_post): Make create_user "name" a "login".

	* src/html/src/oap.xsl (html-create-user-form): Relabel "Name" as
	"Login Name", and make the input name "login".

2010-01-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add \ to credential_login characters.

2010-01-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/oap.xsl (user): Grey delete button for current user.

2010-01-19  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add \ to lsc_password characters.

2010-01-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/oap.xsl (scanner_settings): Only enable edit button if
	settings are editable.

2010-01-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (get_status_response)
	(commands_response/get_status_response): Add error check.

	* src/html/src/oap.xsl (get_settings_response): Indent by 2 like rest.

2010-01-14  Matthew Mundell <matthew.mundell@greenbone.net>

	Add editing of scanner settings.

	* src/gsad.c (init_validator): Add commands "edit_settings" and
	"save_settings".
	(exec_omp_post): Add command "save_settings".
	(exec_omp_get): Add command "edit_settings".

	* src/gsad_oap.c (edit_settings_oap, save_settings_oap): New functions.

	* src/gsad_oap.h: Add headers accordingly.

	* src/html/src/oap.xsl (scanner_settings): Add edit button.
	(scanner_settings, setting, get_settings_response) [edit]: New templates.
	(get_settings, edit_settings): New templates.

2010-01-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/about.htm4: Added supporters with their logos.

	* src/html/src/img/bsi-logo.png, src/html/src/img/gb-logo.png,
	src/html/src/img/intevation-logo.png: New.

2010-01-13  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_oap.c (sync_feed_oap): Add DESCRIBE_FEED to COMMANDS so that
	the sync result comes back on the Feed Management page.

2010-01-13  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Updated help.

	* src/html/src/help/scanconfig_familiy_details.htm4,
	src/html/scanconfig_editor.htm4,
	src/html/scanconfig_editor_nvt_families.htm4,
	src/html/src/help/scanconfig_details.htm4,
	src/html/src/help/scanconfig_family_details.htm4: Added links to other
	help pages.

	* src/html/src/help/scanconfig_editor_nvt.htm4: New. Accidentally
	ommitted in last commits. Contains help texts regarding
	Scan Config NVT Editor.

2010-01-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/help/contents.htm4: Indention for subgroups.
	Added a link for each separate file.

2010-01-12  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Updated help.

	* src/html/src/help/scanconfig_familiy_details.htm4: New. Contains
	help texts regarding Family Details Viewing functionality.

	* src/html/src/help/scanconfig_nvt_details.htm4: New. Contains help
	texts regarding NVT and NVT Preference Viewing functionality

	* src/html/src/omp.xsl: Added links to new help pages.

2010-01-12  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/src/about.htm4: Updated.

2010-01-12  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 1.0.0-beta1 release.

	* CMakeLists.txt: Updated version number.

	* src/html/src/about.htm4: Updated.

	* CHANGES: New.

2010-01-12  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Minor help improvements and fixes.

	* src/html/src/help/scanconfig_editor.htm4: Fixed link.

	* src/html/src/help/scanconfig_editor_nvt_families.htm4: Added links
	to glossary.

2010-01-12  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Added help and some fixes.

	* src/html/src/help/scanconfig_editor_nvt_families.htm4: New. Contains
	help texts regarding Scan Config Editors Family Details functionality.

	* src/html/src/help/scanconfig_editor.htm4: Fixed closing tags, added
	note about non-modificatability of scan configs in use.

	* src/html/src/help/scanconfig_details.htm4: Fixed/Added missing quote.

	* src/html/header.m4: Added macros for details and edit icons.

	* src/html/src/omp.xsl: Added link to new help page.

2010-01-12  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Added help.

	* src/html/src/help/scanconfig_editor.htm4: Updated with help
	texts describing the Scan Config Editor functionality.

	* src/html/src/help/scanconfig_details.htm4: Added alt and title
	parameters to icons, corrected heading.

	* src/html/src/omp.xsl: Added link to new help page.

2010-01-11  Matthew Mundell <matthew.mundell@greenbone.net>

	Add text phrase filtering to report results.

	* src/html/src/gsa-style.css (table.odd): New style.

	* src/gsad.c (init_validator): Add rule "search_phrase".
	(exec_omp_get): Pass search_phrase to get_report_omp.

	* src/gsad_omp.c (get_report_omp): Add argument search_phrase.

	* src/gsad_omp.h: Update headers accordingly.

	* src/html/src/omp.xsl (html-report-details): Add test phrase filter to
	threat filter.  Grey background of both.  Remove threat filter
	"Current View" and rename "New Filter" to "Threat".

	* src/html/src/help/reports.htm4: Try improve some descriptions.  Correct
	typos.  Describe text phrase filtering.

2010-01-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (request_handler): Pass gsize to get_system_report_omp.

2010-01-11  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Updated help.

	* src/html/src/help/configure_credentials.htm4,
	src/html/src/help/configure_escalators.html4,
	src/html/src/help/configure_targets.htm4: Updated with "details"
	section.

	* src/html/src/omp.xsl: Link from pages to new help texts.

2010-01-11  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (result) [detailed]: Add NVT name.

2010-01-11  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Updating help.

	* src/html/src/help/tasks.htm4: Added section on auto-refresh.

	* src/html/src/help/contents.htm4: Added more link.
	Ordered according to user interface.

	* src/html/src/help/configure_scanconfigs.htm4: Fixed links.

	* src/html/src/help/scanconfig_editor.htm4: New.

	* src/html/src/help/configure_escalators.htm4: Added section
	on test escalator.

2010-01-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/gsa-style.css (small_inline_form): New style.

	* src/html/src/omp.xsl (html-task-table): Neaten indentation.  Put the
	form inside a small_inline_form div.  Remove the font-size and display
	styles from the form and select.
	(html-create-escalator-form): Alternate background colours of rows.
	(create_config_response): Only print details if a config was created and
	there's a config/name in the response.

	* src/html/src/help/reports.htm4: Correct phrase.

2010-01-09  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (get_system_reports): Add failure message.

2010-01-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/help/performance.htm4: New file.

2010-01-08  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (create_lsc_credential_omp): Add check for password
	validation failure.

	* src/gsad.c (init_validator): Add rule "lsc_password".
	(exec_omp_post): Verify create_lsc_credential_omp password with
	"lsc_password".

2010-01-08  Matthew Mundell <matthew.mundell@greenbone.net>

	Add HTTP to HTTPS redirection.

	* src/gsad.c (DEFAULT_GSAD_REDIRECT_PORT, MAX_HOST_LEN): New defines.
	(redirect_location): New variable.
	(redirect_handler): New function.
	(main): Add options --rport and --redirect.  If --redirect is present then
	fork an HTTP server that redirects any request to the HTTPS server.

2010-01-07  Matthew Mundell <matthew.mundell@greenbone.net>

	Add performance reports page.

	* src/gsad_omp.c (get_system_reports_omp, get_system_report_omp): New
	function.

	* src/gsad_omp.h: Add headers accordingly.

	* src/gsad.c (init_validator): Add get_system_reports command.  Add rule
	"duration".
	(exec_omp_get): Add get_system_reports command handling.
	(request_handler): Add system report image response.

	* src/html/src/omp.xsl (system_report, get_system_reports): New templates.

	* src/html/header.m4, src/html/src/gsad.xsl: Add "Performance" menu item.

2010-01-06  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/src/help/configure_scanconfigs.htm4: Added help text about
	import and export scan configs, removed text about importing openvasrc.

	* src/html/src/omp.xsl: Link to new help section.

2010-01-06  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Resolved compile issues on 64bit systems.

	* src/gsad.c (serve_post): Cast size_t to int (.* format expects
	integer).

2010-01-06  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (create_config_response): Pass config name in
	result details.

2010-01-06  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/src/omp.xsl: Fixed TODO: pre-select the chosen refresh
	interval in task overview table.

2010-01-06  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt: Corrected libopenvas version check.

	* ChangeLog: Corrected date.

2010-01-05  Matthew Mundell <matthew.mundell@greenbone.net>

	Add XML config importing.  Remove RC file importing.

	* src/gsad_omp.c (create_config_omp): Remove RC file handling.
	(import_config_omp): New function.
	(export_config_omp): Use GET_CONFIGS export attribute.

	* src/gsad_omp.h: Update headers accordingly.

	* src/gsad.c (init_validator): Add import_config command.  Remove rule
	"rcfile".  Add rule "xml_file".
	(struct req_parms): Remove rcfile.  Add xml_file.
	(free_resources, serve_post, exec_omp_post): Remove rcfile handling.  Add
	xml_file handling.
	(exec_omp_get): Handle command import_config.

	* src/html/src/omp.xsl (html-create-config-form): Remove RC import option.
	(html-import-config-form): New template.
	(get_configs_response): Call html-import-config-form.

2010-01-05  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Added basic auto-refresh functionality for the tasks table.

	* src/gsad.c (init_validator): Added new "number" and refresh_interval
	entries, sorted.
	(exec_omp_post): Pass new parameter to get_status_omp.
	(exec_omp_get): Minor formatting, read passed refresh_interval request
	parameter, validate and pass it to get_status_omp.

	* src/gsad_omp.c (get_nvt_details_omp): Added parameter and pass new
	<autorefresh> element to the xsl transformation.
	(create_lsc_credential_omp): Analogous to get_nvt_details_omp, allocate
	GString only when needed.

	* src/gsad_omp.h (get_nvt_details_omp): Adjusted header.

	* src/html/src/gsad.xsl: Added handling of new <auto_refresh> element.

	* src/html/src/omp.xsl: For the tasks table case, added a form to chose
	the refresh interval. Added TODO about pre-selecting the selected value
	after a refresh happened.

	* src/html/make_html: Removed second newline at end of file.

2010-01-05  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt: Corrected version check for libopenvas, required
	version is now 3.0.1.

2010-01-05  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt: Added clumsy libopenvas required version check and
	TODO regarding possible improvements.

2010-01-05  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt: Lowercased some cmake commands.

2010-01-04  Matthew Mundell <matthew.mundell@greenbone.net>

	Add config exporting.

	* src/gsad_omp.c (export_config_omp): New function.

	* src/gsad_omp.h: Add header.

	* src/gsad.c (init_validator): Add export_config command.
	(exec_omp_get): Handle command export_config.

	* src/html/src/omp.xsl (config): Add an export button.

2010-01-04  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Add email rule.
	(escalator_data): New function.
	(exec_omp_post): Check email addresses.

	* src/html/src/omp.xsl (html-create-escalator-form): Match email length to
	validator.

2009-12-31  Matthew Mundell <matthew.mundell@greenbone.net>

	Add test escalator buttons to the escalators page.  Add "From
	Address" to escalator email input.

	* src/gsad_omp.c (get_escalators_xml, test_escalator_omp): New functions.
	(get_escalators_omp): Call get_escalators_xml.

	* src/gsad_omp.h: Add header.

	* src/gsad.c (init_validator): Add test_escalator command.
	(exec_omp_get): Handle command test_escalator.

	* src/html/src/omp.xsl (html-create-escalator-form): Add "From
	Address" field.  Rename "Message" to "Format".
	(escalator): Add test button.  Add "To" to before address.
	(test_escalator_response): New template.
	(escalator mode=details): Add from address.
	(get_escalators): Apply test_escalator_response.

2009-12-31  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Updated help texts.

	* src/html/src/configure_agents.htm4,
	src/html/src/configure_credentials.htm4,
	src/html/src/configure_targets.htm4: Updated.

2009-12-31  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/src/omp.xsl: Link help from scanconfig details page.

	* src/html/src/help/scanconfig_details.htm4: New.

	* src/html/src/help/configure_scanconfigs.htm4: Slightly improved, link
	to new help page.

2009-12-31  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* ChangeLog: Corrected paths.

	* src/html/src/help/configure_escalators.htm4: New.

	* src/html/src/help/configure_scanconfigs.htm4,
	src/html/src/help/glossary.htm4,
	src/html/src/help/new_task.htm4,
	src/html/src/help/tasks.htm4,
	src/html/src/help/view_report.htm4: Updated new and changed options.

2009-12-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/help/tasks.htm4: Added information to
	status "Stopped".

2009-12-30  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/src/help/configure_agents.htm4,
	src/html/src/help/configure_credentials.htm4,
	src/html/src/help/configure_targets.htm4,
	src/html/src/help/configure_users.htm4,
	src/html/src/help/tasks.htm4: Fixed typo.

2009-12-30  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt: Adjusted todo, as check for libmicrohttpd is already
	done.

	* src/CMakeLists.txt: Declared libraries as static.

2009-12-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/help/contents.htm4: Add a "you".

	* src/html/src/help/tasks.htm4: Correct a few typos.

2009-12-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c: Clean and add some todos and comments.
	(exec_omp_post): Format strcmp like others.
	(free_resources): Remove NULL checks from around frees.

2009-12-29  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (nvt, get_nvt_details_response): Match to other
	details pages.

2009-12-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a escalator details page.

	* src/gsad_omp.c (get_escalator_omp): New function.

	* src/gsad_omp.h: Add header.

	* src/gsad.c (init_validator): Add get_escalator command.
	(exec_omp_get): Handle command get_escalator.

	* src/html/src/omp.xsl (html-report-table): Link escalator to details.
	(escalator): Add details button.
	(escalator mode=details, get_escalator): New templates.

2009-12-29  Matthew Mundell <matthew.mundell@greenbone.net>

	Handle the OMP MODIFY_CONFIG "config in use" error with a small error
	dialog instead of a generic big dialog.

	* src/gsad_omp.c (check_modify_config): New function.
	(save_config_omp, save_config_family_omp, save_config_nvt_omp): Call
	check_modify_config instead of check_response to check response.

2009-12-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a credential details page.

	* src/gsad_omp.c (get_lsc_credential_omp): New function.

	* src/gsad_omp.h: Add header.

	* src/gsad.c (init_validator): Add get_lsc_credential command.
	(exec_omp_get): Handle command get_lsc_credential.

	* src/html/src/omp.xsl (target): Link credential to details.
	(target mode=details): Correct element name.  Link credential to details.
	(lsc_credential): Add details button.
	(lsc_credential mode=details, get_lsc_credential): New templates.

2009-12-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* ChangeLog: Repair after last commit.

2009-12-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-create-escalator-form): Add 'Threat level
	at least' condition.
	(escalator): Print level with 'Threat level at least' condition.

2009-12-27  Matthew Mundell <matthew.mundell@greenbone.net>

	Add a target details page.

	* src/gsad_omp.c (get_target_omp): New function.

	* src/gsad_omp.h: Add header.

	* src/gsad.c (init_validator): Add get_target command.
	(exec_omp_get): Handle command get_target.

	* src/html/src/omp.xsl (html-report-table): Link target to details.
	(target): Add details button.
	(target mode=details, get_target): New templates.

2009-12-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Add Escalators.

	* src/gsad.c (init_validator): Add escalator commands.  Add "condition",
	"escalator", "event" and "method" validators.
	(struct req_parms): Add fields for escalator commands.
	(free_resources): Init escalator resources.
	(serve_post): Check and setup escalator keys.
	(exec_omp_post): Handle command "create_escalator".  Pass escalator to
	create_task_omp.
	(exec_omp_get): Handle commands "delete_escalator" and "get_escalators".

	* src/gsad_omp.c (gsad_newtask): Also get escalators.  Correct two error
	message strings.
	(create_task_omp): Add escalator arg.
	(send_escalator_data, create_escalator_omp, delete_escalator_omp)
	(get_escalators_omp): New functions.

	* src/gsad_omp.h: Add and update headers accordingly.

	* src/html/src/omp.xsl (html-report-table): Add escalator link.
	(escalator, html-create-escalator-form, html-escalators-table)
	(create_escalator_response, delete_escalator_response)
	(escalator, get_escalator): New templates.
	(gsad_newtask): Add escalator selector.

	* src/html/src/gsad.xsl (html-gsa-navigation): Add Escalators menu item.

	* src/html/src/help/contents.htm4: Add Escalators menu item.

	* src/html/headers.m4: Add Escalators menu item.

2009-12-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad_omp.h: Updated according to last commit.

2009-12-22  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.c (get_agents_omp): Change result_len to gsize.

2009-12-22  Michael Wiegand <michael.wiegand@greenbone.net>

	Fixed variable types for 64bit compatibility in Base64 decoding.

	* src/gsad_omp.c (get_lsc_credentials_omp): Changed result_len to gsize.
	(get_report_omp): Changed report_len to gsize.

	* src/gsad_omp.h: Updated.

	* src/gsad.c: Changed response_size and header_auth_decoded_len to
	gsize.

2009-12-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* CMakeLists.txt: Updated version number.

	* src/html/src/about.htm4: Updated.

2009-12-21  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 0.8.3 release.

	* src/html/src/about.htm4: Updated.

2009-12-21  Michael Wiegand <michael.wiegand@greenbone.net>

	* CMakeLists.txt: Don't ignore necessary files when creating the source
	tarball.

2009-12-21  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/help/contents.htm4: Added agent help to help contents.

2009-12-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/img/agent.png: New.

2009-12-21  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/oap.xsl: Include settings error message if there is one.
	Make sure filename is correctly aligned, even in Konqueror.

2009-12-21  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (append_chunk_binary): New function.
	(serve_post): Use append_chunk_binary for binary keys.
	(request_handler): Move authentication check down into GET and POST cases.
	Only authentication for the first chunk of a POST request.

	* src/html/src/omp.xsl (html-create-agent-form): Comment out the HOWTOs.

2009-12-18  Matthew Mundell <matthew.mundell@greenbone.net>

	Enable agent download button.

	* src/gsad.c (init_validator): Add "agent_format".
	(struct req_parms): Add fields for agent installer and HOWTO.
	(free_resources): Free installer and HOWTO fields.
	(serve_post): Fill installer and HOWTO fields.
	(exec_omp_post): Pass installer and HOWTO fields to create_agent_omp.
	(exec_omp_get): Expect format in request parameter "agent_format"
	instead of in "package_format".  Switch MIME type to
	application/octet-stream.

	* src/gsad_omp.c (create_agent_omp): Add installer and HOWTO args.  Encode
	installer and HOWTO before sending.

	* src/gsad_omp.h: Update header.

	* src/html/src/omp.xsl (agent): Enable single download button.

	* src/html/src/help/configure_agents.htm4: Correct typo.  Use agent.png.
	Close comment.

	* src/CMakeLists.txt: Neaten heading description.

2009-12-18  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/CMakeLists.txt: Remove HEADERS_TEMP and LIBS_TEMP as the OpenVAS
	flags are provided by other variables.  Set OpenVAS compile flags on
	gsad_omp and gsad_oap.

2009-12-18  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Add an agents page.

	* src/gsad.c (init_validator, exec_omp_post, exec_omp_get): Added
	handling for agents.

	* src/gsad_omp.c (create_agent_omp, delete_agent_omp)
	(get_agents_omp): New functions.

	* src/gsad_omp.h: Added according protos.

	* src/html/src/omp.xsl (html-create-agent-form, html-agents-table)
	(create_agent_response, delete_agent_response, agent, get_agents_response)
	(agents_response): New templates.

	* src/html/src/gsad.xsl, src/html/header.m4: Added link to agents.

	* src/html/src/help/configure_agents.htm4: New.

2009-12-18  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt, src/CMakeLists.txt: Added checks for gnutls, libxml
	and libxslt. Tried to use "elegant" cmake mechanisms to add the
	respective linker and compiler flags, but failed.
	Todo with link to workaround added.

2009-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-config-table): Bold name.

2009-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Improve cross referencing.

	* src/html/src/omp.xsl (html-report-table): Add config and target to
	summary.
	(target): Link credential to credentials page.
	(html-config-table): Add section "Tasks using this Config".

2009-12-17  Michael Wiegand <michael.wiegand@greenbone.net>

	Added support for retrieving settings from the openvas-admininistrator.

	* src/gsad.c (init_validator): Added get_settings to the list of
	valid commands, fixed sorting of commands.
	(exec_omp_get): Added handling of get_settings command.

	* src/gsad_oap.c (get_settings_oap): New function to handle
	get_settings.

	* src/gsad_oap.h: Updated.

	* src/html/src/oap.xsl: Added handling of get_settings_response.

	* src/html/src/gsad.xsl: Added new menu item.

	* src/html/src/help/contents.htm4: Added new list item.

	* src/html/src/help/settings.htm4: New.

	* src/html/header.m4: Added new menu item.

2009-12-17  Matthew Mundell <matthew.mundell@greenbone.net>

	Add sort buttons for task and status to the get_status page.

	* src/html/src/omp.xsl (sort): New template.
	(html-task-table): Add task and status sort buttons.

	* src/gsad.c (init_validator): Add '_' to sort_field.
	(exec_omp_post): Pass sort field and order to get_status_omp.

2009-12-17  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	Use versioning mechanism as in the other OpenVAS CMake-based projects,
	added files and targets to generate documentation.

	* VERSION.in: New.

	* VERSION: Removed, will be generated by CMake.

	* doc/, doc/Doxyfile.in, doc/Doxyfile_full.in, doc/CMakeLists.txt,
	doc/.built-html: New, files to be used to generate documentation using
	doxygen.

	* CMakeLists.txt: Added versioning and documentation mechanism from
	openvas-manager.

2009-12-17  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt: Fixed formatting by adding missing quotes.

2009-12-17  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/omp.xsl: Make report filter dialog
	look nicer in Konqueror.

2009-12-17  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (exec_omp_get): Maximum result count back down
	to 1000 as we have pagination acticated.

2009-12-17  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt: Use pkg-config module to check for correct
	libmicrohttpd version.

	* src/CMakeLists.txt: Added TODOs to check for other libraries using
	the same mechanism as in the top-level CMakeLists.txt and to use
	the proper variables at compiling and linking step.

2009-12-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c (init_validator): Increase credential_login max size to 40.

2009-12-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-report-details): Align table better.  Move
	per-host summary into filtered results.  Add a summary of total threat
	counts.  Rename the "Results per Host" window "Filtered Results".

2009-12-16  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-report-details): Only display result range
	and result headings when there are results.  Add first_result to download
	URL.

2009-12-16  Matthew Mundell <matthew.mundell@greenbone.net>

	Separate credential name from credential login name.

	* src/gsad.c (init_validator): Add credential_login.
	(struct gsad_connection_info): Add req_parms.credential_login.
	(free_resources): Free credential login.
	(serve_post): Check for credential_login key.
	(exec_omp_post): In create_lsc_credential case pass credential_login to
	create_lsc_credential_omp.

	* src/gsad_omp.c (create_lsc_credential_omp): Add login arg.  Send to
	manager as login entity.

	* src/gsad_omp.h: Update header.

	* src/html/src/omp.xsl (html-create-lsc-credential-form): Add Login field.
	(html-lsc-credentials-table): Add Login heading.
	(lsc_credential): Add Login column.

2009-12-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c: Order authors alphabetically by surname.

	* ChangeLog: Improve formatting.

2009-12-15  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad.c: Correct doc.  Neaten comments.  Format strcmp conditionals
	consistently.

2009-12-10  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/gsad.c (exec_omp_get): Increased maximum result count.

2009-12-09  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* src/html/header.m4: Adjusted menu to dynamic pages. (use plural
	"Scan Configs").

2009-12-08  Michael Wiegand <michael.wiegand@greenbone.net>

	Post release version bump.

	* VERSION: Set to 0.8.3.SVN.

	* CMakeLists.txt: Updated CPACK_PACKAGE_VERSION_PATCH.

	* src/html/src/about.htm4: Updated.

2009-12-08  Michael Wiegand <michael.wiegand@greenbone.net>

	Preparing the gsa 0.8.2 release.

	* VERSION: Set to 0.8.2.

	* CMakeLists.txt: Updated CPACK_PACKAGE_VERSION_PATCH.

	* src/html/src/about.htm4: Updated.

2009-12-07  Michael Wiegand <michael.wiegand@greenbone.net>

	Fixed a bug which caused the GSA to hang or crash when editing the
	configuration for a family containing ":".

	* src/gsad.c (init_validator): Added / fixed regular expressions for
	family names.
	(exec_omp_post): Repaired validator usage.

2009-12-07  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt: Improved checks for pkg-config and libopenvas-config,
	Intention was to first collect missing tools and then report on them to
	avoid configure-install cycles.

2009-12-07  Felix Wolfsteller <felix.wolfsteller@greenbone.net>

	* CMakeLists.txt: Added checks for pkg-config and libopenvas-config.

2009-12-03  Michael Wiegand <michael.wiegand@greenbone.net>

	Added initial NVT feed synchronization support.

	* src/gsad.c (init_validator): Mark get_feed and sync_feed as valid
	commands.
	(exec_omp_post): Add handling of sync_feed command.
	(exec_omp_get): Add handling of get_feed command.

	* src/gsad_oap.c: Added functions for getting the description of a feed
	and for synchronization with a feed.
	(get_feed_oap, sync_feed_oap): New.

	* src/gsad_oap.h: Updated header.

	* src/html/src/gsad.xsl, src/html/src/help/contents.htm4,
	src/html/header.m4: Add menu item for feed management.

	* src/html/src/oap.xsl: Add support for new response types.

	* src/html/src/help/feed_management.htm4: New.

2009-12-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/make_html: Fix grep for static files to exclude
	SVN elements.

2009-12-03  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (REALM, POST_BUFFER_SIZE, FILE_NOT_FOUND,
	ERROR_PAGE, SERVER_ERROR, content_type, content_disposition,
	response_size, log_config, verbose): New.

2009-12-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (exec_omp_post, exec_omp_get): New.

2009-12-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (serve_post): New.

2009-12-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (free_resources, check_is_dir): New.

2009-12-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (gsad_connection_info, get_header_credentials)
	(is_http_authenticated, file_reader, get_file_size): New.

2009-12-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (print_header, send_response)
	(send_http_authenticate_header, request_handler): Improve documentation.
	(request_handler): Use "const" where possible. Introduce
	oap_cgi_base. Improve redirect for non-base URLs. Redirect
	"/login/". Fix memleak.
	(gsad_init): Improve documentation. Call init_validator.

2009-12-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c: Fixed some comments. Added list of includes.
	(DEFAULT_GSAD_PORT, DEFAULT_OPENVAS_ADMINISTRATOR_PORT)
	(DEFAULT_OPENVAS_MANAGER_PORT, GCRY_THREAD_OPTION_PTHREAD_IMPL)
	(gsad_daemon, validator, init_validator): New.
	(main): Use unified exit code. Improved comments.

2009-12-02  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad_oap.h: Fixed comment.

	* src/CMakeLists.txt: Reformatted.

2009-12-02  Michael Wiegand <michael.wiegand@greenbone.net>

	* src/html/src/omp.xsl: Make 'Full and fast' accessible again as a scan
	config template.

2009-12-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* VERSION, CMakeLists.txt, src/html/src/about.htm4: Version set
	to 0.8.2.SVN.

2009-12-01  Michael Wiegand <michael.wiegand@greenbone.net>

	Add support for new empty scan config template.

	* src/html/src/omp.xsl: Switch default to 'empty'.

	* src/gsad_omp.c (create_config_omp): Switch default to 'empty'.

2009-12-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/omp.xsl: Grey out Stop/Delete in case a Task is "Requested".

2009-11-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_omp.h, src/gsad_omp.c: New files.

	* src/CMakeLists.txt: Add static analysis rules.

2009-11-27  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl (html-config-nvt-table): Always show the
	preferences, as there is always the timeout preference.

2009-11-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* VERSION, CMakeLists.txt, src/html/src/about.htm4: Version set
	to 0.8.1.SVN.

2009-11-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/header.m4, src/html/footer.m4, src/html/template.m4: New.

	* src/html/make_html: New.

	* src/html/src/login/login.html,
	src/html/src/help/error_messages.htm4: New.

2009-11-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl: Match input widths to validator widths.
	(get_targets): Apply gsad_msg.

2009-11-26  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/omp.xsl: Convert tabs to spaces.

2009-11-24  Matthew Mundell <matthew.mundell@greenbone.net>

	Add per-NVT timeout support.

	* src/html/src/omp.xsl (html-config-family-table): Add timeout column.
	Always enable the NVT edit button.
	[details, edit-details] (preferences): Add always-present timeout
	preference.

2009-11-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/gsad_base.c (gsad_message): Add function and line arguments.  Free
	the allocated XML.

	* src/gsad_base.h: Update header.

	* src/gsad_oap.c: New file.

2009-11-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/gsad.xsl, src/html/src/omp.xsl, src/html/src/oap.xsl:
	Convert tabs to spaces.

2009-11-24  Matthew Mundell <matthew.mundell@greenbone.net>

	* src/html/src/gsad.xsl, src/html/src/omp.xsl, src/html/src/oap.xsl: New
	files.

2009-11-21  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* VERSION, CMakeLists.txt, src/html/src/about.htm4: Version set
	to 0.8.0.SVN.

	* src/gsad_base.h (preference_t): New.

	* src/gsad_oap.h: Updated proto for get_users_oap.

2009-11-07  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/gsa-style.css, src/html/src/help/view_report.htm4: New.

2009-11-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad_base.h, src/gsad_base.c: Cleanups and documentation.

2009-11-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/help/reports.htm4: New.

	* src/validator.c (openvas_validator_alias): New.
	(openvas_validate): Some more tracef-calls.

	* src/validator.h: Add proto accordingly.

2009-11-06  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	*  src/html/src/about.htm4, src/html/src/gplv2.htm4: New.

	* src/html/src/img/edit_inactive.png,
	src/html/src/img/ascending_inactive.png, src/html/src/img/edit.png,
	src/html/src/img/descending_inactive.png: New.

2009-11-04  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/img/descending.png, src/html/src/img/ascending.png: New.

2009-10-31  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/validator.c: New.

2009-10-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/img/download.png, src/html/src/img/bullet2.png,
	src/html/src/img/bullet.png, src/html/src/img/alert_sign.png: New.

2009-10-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad_oap.h: Some cosmetics.

	* src/gsad_base.h: Updated protos and added message string.

	* src/gsad_base.c (xsl_transform): Take only xml text now
	instead of files for xml and xsl.
	(gsad_message): New.

2009-10-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/help/tasks.htm4, src/html/src/help/contents.htm4,
	src/html/src/help/glossary.htm4: New.

	* src/html/src/img/high_big.png, src/html/src/img/medium_big.png,
	src/html/src/img/none_big.png, src/html/src/img/low_big.png: New.

2009-10-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/img/list_inactive.png, src/html/src/img/list.png,
	src/html/src/img/log.png, src/html/src/img/gsa_splash.png,
	src/html/src/img/low.png, src/html/src/img/high.png,
	src/html/src/img/medium.png: New.

2009-10-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/img/style/, src/html/src/img/style/logo_l.png,
	src/html/src/img/style/logo_m.png, src/html/src/img/style/logo_r.png,
	src/html/src/img/style/window_dec_a_error.png,
	src/html/src/img/style/window_dec_a.png,
	src/html/src/img/style/window_dec_b_error.png,
	src/html/src/img/style/window_dec_b.png,
	src/html/src/img/style/window_dec_c_error.png,
	src/html/src/img/style/window_dec_c.png: New.

	* src/validator.h: New.

	* src/CMakeLists.txt: Add module validator, fix sequence of modules,
	make libs static, remove cmake minimum requirement.

2009-10-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* VERSION, CMakeLists.txt: Upgraded from 0.7.3.SVN to 0.7.4.SVN.

2009-10-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/help/configure_scanconfigs.htm4,
	src/html/src/help/configure_credentials.htm4,
	src/html/src/help/configure_users.htm4: New. More documentation.

2009-10-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/CMakeLists.txt: Changed - to _ in module names.

	* src/gsad_oap.h: Fixed filename in doc.

	* src/gsad_base.h: Fixed filename in doc. Added missing proto.

2009-10-26  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad_base.c: New.

	* src/CMakeLists.txt: Added handling of module gsad_base.

2009-10-25  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad_oap.h: Renamed to src/gsad_oap.h.

2009-10-25  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad-base.h: Renamed to src/gsad_base.h.

	* src/gsad-oap.h: Adjusted include name accordingly.

2009-10-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (print_header, send_response, send_redirect_header): New.

2009-10-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* VERSION, CMakeLists.txt: Increased from 0.7.2.SVN to 0.7.3.SVN.

	* src/gsad_log_conf.cmake_in: Added "level".

	* src/CMakeLists.txt: Better handling of compile flags.

2009-10-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (main): Apply DEBUG flag for MHD.
	(request_handler): Fix typo.

2009-10-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (request_handler): Fix call of gsad_newtask,
	use g_strconcat.
	(gsad_init): Init glib.
	(main): Adjust logging to avoid recursion.

2009-10-23  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (send_http_authenticate_header): New.

2009-10-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (gsad_cleanup, main): Factored out pidfile management.

2009-10-20  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (request_handler): New.

2009-10-15  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/img/p_bar_bg.png, src/html/src/img/p_bar_done.png,
	src/html/src/img/p_bar_error.png, src/html/src/img/p_bar_new.png,
	src/html/src/img/p_bar.png, src/html/src/img/p_bar_request.png,
	src/html/src/img/trend_down.png, src/html/src/img/trend_less.png,
	src/html/src/img/trend_more.png, src/html/src/img/trend_nochange.png,
	src/html/src/img/trend_up.png: New.

2009-10-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (gsad_init): New.

2009-10-14  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad.c (main): omp_init splits into omp_init and oap_init.
	(gsad_cleanup): New.

2009-10-13  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/gsad-oap.h: New.

	* src/gsad-base.h: New.

	* src/tracef.h: New.

	* src/CMakeLists.txt: Handle modules gsad-omp and gsad-oap.

2009-10-12  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* VERSION: New.

	* src/gsad_log_conf.cmake_in: New.

	* src/CMakeLists.txt: New.

	* src/html/src/img/rpm.png, src/html/src/img/exe.png,
	src/html/src/img/key.png, src/html/src/img/deb.png: New.

	* gsad.c: New.

2009-10-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/img/new.png: New.

2009-10-01  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/help/configure_targets.htm4,
	src/html/src/help/new_task.htm4: New.

2009-09-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/img/start.png, src/html/src/img/refresh.png,
	src/html/src/img/start_inactive.png, src/html/src/img/delete.png,
	src/html/src/img/delete_inactive.png, src/html/src/img/details.png,
	src/html/src/img/stop.png, src/html/src/img/stop_inactive.png,
	src/html/src/img/help.png: New.

2009-09-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/help/, src/html/src/login/, src/html/src/img/,
	src/html/src/favicon.gif: New.

2009-09-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* src/html/src/: New.

2009-09-30  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* CMakeLists.txt: New.

	* src/html/: New.

2009-09-28  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* INSTALL: New.

	* README: New.

2009-09-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	* COPYING: New. The GNU GPLv2.

	* src/: New.

2009-09-22  Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>

	Starting package "gsa" (Greenbone Security Assistant)
